{
  "version": 3,
  "sources": ["../../@superviz/react-sdk/dist/annotation-pin-K67PIXO5-DO-QXLt6.js"],
  "sourcesContent": ["import { y as d, g as l, A as r, e as m } from \"./index-CtPfqlcy.js\";\nimport { u as p } from \"./chunk-K5TMEGOR-DaSvC8Mu.js\";\nimport \"./chunk-3MEZQQ2J-CHe_tQrN.js\";\nimport { c as h } from \"./chunk-SDMTFDEM-n5DHnLs2.js\";\nimport { n as u } from \"./chunk-6U6BYUHV-TZ4JwLT4.js\";\nimport { D as v } from \"./chunk-MVFOLHBC-BeDRo2V6.js\";\nimport { V as e, a as y, t as S } from \"./chunk-WG46WHJF-JdNs68CV.js\";\nd();\nvar c = v(y), _ = [c.styles, h], s = class extends c {\n  constructor() {\n    super(), this.focusInput = () => {\n      var t, n;\n      this.inputElement || (this.inputElement = (n = (t = this.shadowRoot) == null ? void 0 : t.querySelector(\"superviz-comments-comment-input\")) == null ? void 0 : n.shadowRoot.querySelector(\"textarea\")), this.inputElement.focus();\n    }, this.setInputSide = () => {\n      let t = this.commentsSide === \"right\" ? 320 : 0, n = this.annotationSides.right + 293, i = this.containerSides.right - t;\n      if (n < i) {\n        this.horizontalSide = \"right\";\n        return;\n      }\n      t = this.commentsSide === \"left\" ? 320 : 0;\n      let o = this.annotationSides.left - 293, a = this.containerSides.left + t;\n      if (o > a) {\n        this.horizontalSide = \"left\";\n        return;\n      }\n      this.horizontalSide = a - o > n - i ? \"right\" : \"left\";\n    }, this.createComment = ({ detail: t }) => {\n      this.annotationSent = !0, document.body.dispatchEvent(new CustomEvent(\"create-annotation\", { detail: l(r({}, t), { position: l(r({}, this.originalPosition), { type: \"canvas\" }) }) })), this.annotation = null;\n    }, this.cancelTemporaryAnnotation = () => {\n      this.annotation = null;\n    }, this.cancelTemporaryAnnotationEsc = (t) => {\n      this.annotation = null;\n    }, this.avatar = () => {\n      if (this.type === \"add\" && !this.showInput) return e`<div\n        class=\"comments__annotation-pin__avatar comments__annotation-pin__avatar--add\"\n      >\n        <superviz-icon name=\"add\"></superviz-icon>\n      </div>`;\n      let t = this.userAvatar;\n      return t ? e`<div class=\"comments__annotation-pin__avatar\">\n        <img src=${t} />\n      </div>` : e`<div class=\"comments__annotation-pin__avatar\">\n      <p class=\"text text-bold text-big\">${this.userInitial}</p>\n    </div>`;\n    }, this.input = () => {\n      if (!(!this.showInput || this.annotationSent)) return e`<div class=\"floating-input\">\n      <superviz-comments-comment-input\n        @create-annotation=${this.createComment}\n        eventType=\"create-annotation\"\n        @comment-input-ready=${this.focusInput}\n        participantsList=${JSON.stringify(this.participantsList)}\n      >\n      </superviz-comments-comment-input>\n    </div>`;\n    }, this.position = { x: 0, y: 0 }, setTimeout(() => {\n      this.firstLoad = !1;\n    }, 800);\n  }\n  updated(t) {\n    super.updated(t), !(!t.has(\"movedPosition\") || !this.annotationSides) && (this.annotationSides = this.pinAnnotation.getBoundingClientRect(), this.setInputSide(), this.inputElement && this.focusInput());\n  }\n  firstUpdated(t) {\n    var n;\n    super.firstUpdated(t), u.call(this, [\"comments\"]), this.showInput && (this.originalPosition = r({}, this.position), this.pinAnnotation = (n = this.shadowRoot) == null ? void 0 : n.querySelector(\".comments__annotation-pin\"), this.annotationSides = this.pinAnnotation.getBoundingClientRect(), this.setInputSide());\n  }\n  connectedCallback() {\n    if (super.connectedCallback(), this.type !== \"add\") return;\n    let { localParticipant: t } = this.useStore(\"global-store\");\n    t.subscribe((n) => {\n      var i;\n      this.localAvatar = (i = n == null ? void 0 : n.avatar) == null ? void 0 : i.imageUrl, this.localName = n == null ? void 0 : n.name;\n    }), window.document.body.addEventListener(\"close-temporary-annotation\", this.cancelTemporaryAnnotation), window.document.body.addEventListener(\"keyup\", (n) => {\n      n.key === \"Escape\" && this.cancelTemporaryAnnotationEsc(n);\n    });\n  }\n  disconnectedCallback() {\n    super.disconnectedCallback(), this.type === \"add\" && (window.document.body.removeEventListener(\"close-temporary-annotation\", this.cancelTemporaryAnnotation), window.document.body.removeEventListener(\"keyup\", (t) => {\n      t.key === \"Escape\" && this.cancelTemporaryAnnotationEsc(t);\n    }));\n  }\n  get userAvatar() {\n    var t, n, i, o;\n    return ((o = (i = (n = (t = this.annotation) == null ? void 0 : t.comments) == null ? void 0 : n.at(0)) == null ? void 0 : i.participant) == null ? void 0 : o.avatar) || this.localAvatar;\n  }\n  get userInitial() {\n    var t, n, i, o, a;\n    return (((a = (o = (i = (n = (t = this.annotation) == null ? void 0 : t.comments) == null ? void 0 : n.at(0)) == null ? void 0 : i.participant) == null ? void 0 : o.name) != null ? a : this.localName) || \"Anonymous\")[0].toUpperCase();\n  }\n  emitClick() {\n    var t;\n    document.body.dispatchEvent(new CustomEvent(\"select-annotation\", { detail: { uuid: (t = this.annotation) == null ? void 0 : t.uuid } }));\n  }\n  render() {\n    let t = { \"comments__annotation-pin\": !0, preload: this.firstLoad === void 0, \"comments__annotation-pin--active\": this.active, \"comments__cursor-pointer\": this.type === \"add\" && !this.showInput, \"comments__annotation-pin--add\": this.type === \"add\" && this.showInput, [this.horizontalSide]: !0 }, n = { \"comments__annotation-pin-wrapper\": !0, \"comments__annotation-pin-wrapper--new\": this.newPin }, i = this.keepPositionRatio ? \"%\" : \"px\", o = `top: ${this.position.y}${i}; left: ${this.position.x}${i};`;\n    return this.type === \"add\" ? e`\n        <div class=${p(t)} style=${o}>${this.avatar()} ${this.input()}</div>\n      ` : e`<div class=${p(n)} style=${o}>\n      <div @click=${this.emitClick} class=${p(t)}>${this.avatar()}</div>\n    </div> `;\n  }\n};\ns.styles = _, s.properties = { type: { type: String }, annotation: { type: Object }, position: { type: Object }, active: { type: Boolean }, showInput: { type: Boolean }, containerSides: { type: Object }, horizontalSide: { type: String }, commentsSide: { type: String }, movedPosition: { type: String }, pinAnnotation: { type: Object }, localAvatar: { type: String }, annotationSent: { type: Boolean }, localName: { type: String }, keepPositionRatio: { type: Boolean }, participantsList: { type: Object }, firstLoad: { type: Boolean }, newPin: { type: Boolean } }, s = m([S(\"superviz-comments-annotation-pin\")], s);\nexport {\n  s as CommentsAnnotationPin\n};\n"],
  "mappings": "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",
  "names": ["c"]
}
