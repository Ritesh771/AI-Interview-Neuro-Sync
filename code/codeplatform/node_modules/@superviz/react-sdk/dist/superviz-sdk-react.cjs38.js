"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const r=require("./room-DPWLzMyU.cjs"),g=require("./index-BiWKhIYU.cjs"),t=require("react");function v({matterportSdkInstance:n,children:u,...m}){const{room:o,component:e,addComponent:f,removeComponent:a}=r.useInternalFeatures("presence3dMatterport"),[p,c]=t.useState(null);return t.useEffect(()=>{if(!o||!n)return;const l=new g.vr(n,m);f(l),c(Date.now())},[o,n]),t.useEffect(()=>{!e&&p&&c(null)},[e]),t.useEffect(()=>{(!n||!o)&&e&&a(e)},[n,o]),u??r.jsxRuntimeExports.jsx(r.jsxRuntimeExports.Fragment,{})}function y({isAvatarsEnabled:n,isLaserEnabled:u,isNameEnabled:m,avatarConfig:o,bundleUrl:e,matterportKey:f,onMpSdkLoaded:a,...p}){const{room:c,removeComponent:l,component:R}=r.useInternalFeatures("presence3dMatterport"),i=t.useRef(null),[x,d]=t.useState(null),E=t.useRef("");t.useEffect(()=>{i.current&&h()},[e,i.current]),t.useEffect(()=>{var s;!c&&x&&(d(null),(s=i.current)==null||s.remove())},[c]);const h=t.useCallback(async()=>{if(E.current===e)return;E.current=e,x&&(d(null),l(R));const s=document.getElementById("showcase"),w=s.contentWindow;if(s.setAttribute("src",e),!w){console.error("[SuperViz] Matterport Showcase iframe not found");return}const I=await new Promise(S=>{const j=async()=>{const M=await w.MP_SDK.connect(w,f);a&&a({matterportSdkInstance:M,showcaseWindow:i.current}),S(M),s.removeEventListener("load",j)};s.addEventListener("load",j)});d(I)},[e]);return r.jsxRuntimeExports.jsxs(r.jsxRuntimeExports.Fragment,{children:[r.jsxRuntimeExports.jsx(v,{matterportSdkInstance:x,isAvatarsEnabled:n,isLaserEnabled:u,isNameEnabled:m,avatarConfig:o}),r.jsxRuntimeExports.jsx("iframe",{ref:i,id:"showcase",...p})]})}exports.MatterportIframe=y;exports.MatterportPresence=v;
