"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const r=require("./chunk-DX57ODX6-ClzWz6Mr.cjs"),l=require("./index-N3n6WSly.cjs");require("./chunk-3MEZQQ2J-Bai2OMk0.cjs");const u=require("./chunk-SDMTFDEM-DMM8sQyi.cjs"),d=require("./chunk-MVFOLHBC-C85clPX2.cjs"),s=require("./chunk-WG46WHJF-D0x9jAhS.cjs");l.y();var c=d.D(s.C),h=[c.styles,u.a];exports.CommentsContent=class extends c{constructor(){super(),this.unselectAnnotation=()=>{this.selectedAnnotation=null},this.unselectAnnotationEsc=t=>{t&&(t==null?void 0:t.key)!=="Escape"||(this.selectedAnnotation=null)},this.selectAnnotation=({detail:t})=>{let{uuid:n}=t;if(this.selectedAnnotation===n){this.selectedAnnotation=null;return}this.selectedAnnotation=n},this.checkLastAnnotation=t=>{var n,o;let i=this.annotations.filter(a=>a.resolved),e=this.annotations.filter(a=>!a.resolved);return this.annotationFilter==="All comments"?t===((n=i[i.length-1])==null?void 0:n.uuid):t===((o=e[e.length-1])==null?void 0:o.uuid)},this.annotations=[],this.participantsList=[]}updated(t){super.updated(t),this.updateComplete.then(()=>{let n=this.shadowRoot.querySelector(`[uuid='${this.selectedAnnotation}']`);if(!n)return;let o=this.lastCommentId===this.selectedAnnotation,i=o?0:-150,e=n.getClientRects()[0];e&&(this.scrollBy(0,e.y+i),o&&setTimeout(()=>{this.scrollBy(0,e.y+i)},200))})}connectedCallback(){super.connectedCallback(),window.document.body.addEventListener("select-annotation",this.selectAnnotation),window.document.body.addEventListener("keyup",this.unselectAnnotationEsc),window.document.body.addEventListener("unselect-annotation",this.unselectAnnotation)}disconnectedCallback(){super.disconnectedCallback(),window.document.body.removeEventListener("select-annotation",this.selectAnnotation),window.document.body.removeEventListener("keyup",this.unselectAnnotationEsc),window.document.body.removeEventListener("unselect-annotation",this.unselectAnnotation)}render(){return s.Vt` ${r.j(this.annotations.filter(t=>{var n;return(n=t.comments)==null?void 0:n.length}),t=>t.uuid,t=>s.Vt`
        <superviz-comments-annotation-item
          annotation=${JSON.stringify(t)}
          selected="${this.selectedAnnotation}"
          annotationFilter=${this.annotationFilter}
          uuid=${t.uuid}
          ?resolved=${t.resolved}
          isLastComment=${this.checkLastAnnotation(t.uuid)}
          participantsList=${JSON.stringify(this.participantsList)}
        >
        </superviz-comments-annotation-item>
      `)}`}};exports.CommentsContent.styles=h,exports.CommentsContent.properties={annotations:{type:Object},selectedAnnotation:{type:String},annotationFilter:{type:String},participantsList:{type:Object}},exports.CommentsContent=l.F([s.ts("superviz-comments-content")],exports.CommentsContent);
