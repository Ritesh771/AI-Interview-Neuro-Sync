"use strict";const fw=require("yjs");function mw(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const i in e)if(i!=="default"){const r=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:()=>e[i]})}}return t.default=e,Object.freeze(t)}const cs=mw(fw);var vw=Object.create,Ya=Object.defineProperty,gw=Object.defineProperties,yw=Object.getOwnPropertyDescriptor,bw=Object.getOwnPropertyDescriptors,ww=Object.getOwnPropertyNames,Ss=Object.getOwnPropertySymbols,_w=Object.getPrototypeOf,Qa=Object.prototype.hasOwnProperty,$h=Object.prototype.propertyIsEnumerable,Cw=Math.pow,Xc=(e,t,i)=>t in e?Ya(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,B=(e,t)=>{for(var i in t||(t={}))Qa.call(t,i)&&Xc(e,i,t[i]);if(Ss)for(var i of Ss(t))$h.call(t,i)&&Xc(e,i,t[i]);return e},de=(e,t)=>gw(e,bw(t)),Ea=(e,t)=>{var i={};for(var r in e)Qa.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&Ss)for(var r of Ss(e))t.indexOf(r)<0&&$h.call(e,r)&&(i[r]=e[r]);return i},Ew=(e,t)=>()=>(e&&(t=e(e=0)),t),We=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Pw=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of ww(t))!Qa.call(e,o)&&o!==i&&Ya(e,o,{get:()=>t[o],enumerable:!(r=yw(t,o))||r.enumerable});return e},Wt=(e,t,i)=>(i=e!=null?vw(_w(e)):{},Pw(!e||!e.__esModule?Ya(i,"default",{value:e,enumerable:!0}):i,e)),Aw=(e,t,i,r)=>{for(var o=t,a=e.length-1,u;a>=0;a--)(u=e[a])&&(o=u(o)||o);return o},ue=(e,t,i)=>new Promise((r,o)=>{var a=p=>{try{c(i.next(p))}catch(h){o(h)}},u=p=>{try{c(i.throw(p))}catch(h){o(h)}},c=p=>p.done?r(p.value):Promise.resolve(p.value).then(a,u);c((i=i.apply(e,t)).next())}),Xa,O=Ew(()=>{Xa={}});O();var el=(e=>(e.MEETING_START="meeting.start",e.MEETING_LEAVE="meeting.leave",e.MEETING_PARTICIPANT_AMOUNT_UPDATE="meeting.amount-of-participants-update",e.MEETING_PARTICIPANT_LIST_UPDATE="meeting.participant-list-update",e.MEETING_PARTICIPANT_JOINED="meeting.participant-joined",e.MEETING_PARTICIPANT_LEFT="meeting.participant-left",e.MEETING_JOIN="meeting.join",e.MEETING_PARTICIPANT_PROPERTIES="meeting.participant-properties",e.MEETING_HOST_CHANGE="meeting.host-change",e.MEETING_HOST_AVAILABLE="meeting.host-available",e.MEETING_NO_HOST_AVAILABLE="meeting.no-host-available",e.MEETING_SAME_PARTICIPANT_ERROR="meeting.same-participant-error",e.MEETING_DEVICES_CHANGE="meeting.devices-change",e.MEETING_KICK_PARTICIPANTS="meeting.kick-all-participants",e.MEETING_STATE_UPDATE="meeting.state-update",e.MEETING_CONNECTION_STATUS_CHANGE="meeting.connection-status-change",e.MEETING_WAITING_FOR_HOST="meeting.waiting-for-host",e.MY_PARTICIPANT_UPDATED="my-participant.update",e.MY_PARTICIPANT_LEFT="my-participant.left",e.MY_PARTICIPANT_JOINED="my-participant.joined",e.MEETING_KICK_PARTICIPANT="meeting.kick-participant",e.DESTROY="destroy",e))(el||{}),tl=(e=>(e.FRAME_LOAD="frame.load",e.FRAME_DIMENSIONS_UPDATE="frame.dimensions-update",e.FRAME_PARENT_SIZE_UPDATE="frame.parent-window-size-update",e.FRAME_LOCALE_UPDATE="frame.locales-update",e.FRAME_AVATAR_LIST_UPDATE="frame.avatar-list-update",e.FRAME_COLOR_LIST_UPDATE="frame.color-list-update",e.FRAME_STYLES_UPDATE="frame.styles-update",e.FRAME_CALLBACKS_UPDATE="frame.callbacks-update",e))(tl||{}),zh=(e=>(e.TOGGLE_MEETING_CHAT="meeting-controls.toggle-chat",e.TOGGLE_MEETING_SETUP="meeting-controls.toggle-setup",e.TOGGLE_MICROPHONE="meeting-controls.toggle-microphone",e.TOGGLE_CAM="meeting-controls.toggle-cam",e.TOGGLE_SCREENSHARE="meeting-controls.toggle-screenshare",e.TOGGLE_RECORDING="meeting-controls.toggle-recording",e.HANG_UP="hang-up",e.CALLBACK_CALLED="callback-called",e))(zh||{}),Wh=(e=>(e.REALTIME_PARTICIPANT_LIST_UPDATE="realtime.participant-list-update",e.REALTIME_HOST_CHANGE="realtime.host-change",e.REALTIME_GRID_MODE_CHANGE="realtime.grid-mode-change",e.REALTIME_WAIT_FOR_HOST="realtime.wait-for-host",e.REALTIME_AUTHENTICATION_FAILED="realtime.authentication-failed",e.REALTIME_GO_TO_PARTICIPANT="realtime.go-to-participant",e.REALTIME_GATHER="realtime.gather",e.REALTIME_FOLLOW_PARTICIPANT="realtime.follow-participant",e.REALTIME_LOCAL_FOLLOW_PARTICIPANT="realtime.local-follow-participant",e.REALTIME_SET_AVATAR="realtime.set-avatar",e.REALTIME_DRAWING_CHANGE="realtime.drawing-change",e.REALTIME_TRANSCRIPT_CHANGE="realtime.transcript-change",e.REALTIME_PRIVATE_MODE="realtime.private-mode",e))(Wh||{}),Vh=(e=>(e[e.MEETING_FAILED=-1]="MEETING_FAILED",e[e.MEETING_DISCONNECTED=0]="MEETING_DISCONNECTED",e[e.MEETING_INITIALIZING=1]="MEETING_INITIALIZING",e[e.MEETING_READY_TO_JOIN=2]="MEETING_READY_TO_JOIN",e[e.MEETING_CONNECTING=3]="MEETING_CONNECTING",e[e.MEETING_CONNECTED=4]="MEETING_CONNECTED",e[e.MEETING_RECONNECT=5]="MEETING_RECONNECT",e[e.FRAME_INITIALIZING=6]="FRAME_INITIALIZING",e[e.FRAME_INITIALIZED=7]="FRAME_INITIALIZED",e[e.FRAME_UNINITIALIZED=8]="FRAME_UNINITIALIZED",e))(Vh||{}),il=(e=>(e.JOINED="participant.joined",e.LOCAL_JOINED="participant.local-joined",e.LEFT="participant.left",e.LOCAL_LEFT="participant.local-left",e.LOCAL_UPDATED="participant.updated",e.LIST_UPDATED="participant.list-updated",e.SAME_ACCOUNT_ERROR="participant.same-account-error",e))(il||{}),Gh=(e=>(e[e.NOT_AVAILABLE=0]="NOT_AVAILABLE",e[e.GOOD=1]="GOOD",e[e.BAD=2]="BAD",e[e.POOR=3]="POOR",e[e.DISCONNECTED=4]="DISCONNECTED",e[e.RECONNECTING=5]="RECONNECTING",e[e.LOST_CONNECTION=6]="LOST_CONNECTION",e))(Gh||{}),Zh=(e=>(e.NO_CAM="devices.no-cam",e.NO_DEVICES="devices.no-devices",e.DEVICES_BLOCKED="devices.blocked",e.DEVICES_CAM_BLOCKED="devices.cam-blocked",e.DEVICES_INITIALIZATION_ERROR="devices.inititalization-error",e.DEVICES_UNKNOWN_ERROR="devices.unknown-error",e.DEVICES_ALLOWED="devices.allowed",e))(Zh||{}),Jh=(e=>(e.PIN_ACTIVE="pin-mode.active",e.PIN_INACTIVE="pin-mode.inactive",e))(Jh||{}),Us=(e=>(e.MOUNT="mount",e.UNMOUNT="unmount",e))(Us||{}),qh=(e=>(e.START_FOLLOWING_PARTICIPANT="who-is-online.start-following-participant",e.STOP_FOLLOWING_PARTICIPANT="who-is-online.stop-following-participant",e.ENTER_PRIVATE_MODE="who-is-online.enter-private-mode",e.LEAVE_PRIVATE_MODE="who-is-online.leave-private-mode",e.GATHER_ALL="who-is-online.gather-all",e.GO_TO_PARTICIPANT="who-is-online.go-to-participant",e.START_FOLLOW_ME="who-is-online.start-follow-me",e.STOP_FOLLOW_ME="who-is-online.stop-follow-me",e))(qh||{});O();var Sw=["rosybrown","red","saddlebrown","coral","orange","brown","goldenrod","olivegreen","darkolivegreen","seagreen","lightsea","teal","cadetblue","pastelblue","mediumslateblue","bluedark","navy","rebeccapurple","purple","vividorchid","darkmagenta","deepmagenta","fuchsia","violetred","pink","vibrantpink","paleredviolet","carmine","wine"],Ut={turquoise:"#31E0B0",orange:"#FF5E10",blue:"#00ABF7",pink:"#FF00BB",purple:"#9C29FF",green:"#6FDD00",red:"#E30000",bluedark:"#304AFF",pinklight:"#FF89C4",purplelight:"#D597FF",greenlight:"#C6EC5C",orangelight:"#FFA115",bluelight:"#75DEFE",redlight:"#FAA291",brown:"#BB813F",yellow:"#FFEF33",olivegreen:"#93A000",lightyellow:"#FAE391",violetred:"#C03FA3",rosybrown:"#B58787",cadetblue:"#2095BB",lightsteelblue:"#ABB5FF",seagreen:"#04B45F",palegreen:"#8DE990",saddlebrown:"#964C42",pastelblue:"#77A1CC",palesilver:"#D2BABA",coral:"#DF6B6B",bisque:"#FFD9C4",goldenrod:"#DAA520",tan:"#D2BD93",darkolivegreen:"#536C27",mint:"#ADE6DF",lightsea:"#45AFAA",teal:"#036E6E",wine:"#760040",cyan:"#00FFFF",mediumslateblue:"#6674D7",navy:"#0013BB",rebeccapurple:"#663399",vividorchid:"#D429FF",darkmagenta:"#810E81",deepmagenta:"#C303C6",fuchsia:"#FA00FF",lavendermagenta:"#EE82EE",thistle:"#EEB4DD",vibrantpink:"#FF007A",cottoncandy:"#FFC0DE",paleredviolet:"#D96598",carmine:"#B50A52",gray:"#878291"};O();var Hh=(e=>(e.TOP_LEFT="top-left",e.TOP_RIGHT="top-right",e.BOTTOM_LEFT="bottom-left",e.BOTTOM_RIGHT="bottom-right",e))(Hh||{});O();var Pa=(e=>(e.LEFT="left",e.RIGHT="right",e))(Pa||{}),Kh=(e=>(e.TOP_LEFT="top-left",e.TOP_RIGHT="top-right",e.BOTTOM_LEFT="bottom-left",e.BOTTOM_RIGHT="bottom-right",e))(Kh||{});O();var Yh=(e=>(e.ADD="add",e.SHOW="show",e))(Yh||{}),wn=We((e,t)=>{O(),(function(){var i,r="4.17.21",o=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",c="Invalid `variable` option passed into `_.template`",p="__lodash_hash_undefined__",h=500,f="__lodash_placeholder__",m=1,y=2,g=4,_=1,E=2,R=1,N=2,j=4,U=8,K=16,ie=32,we=64,pe=128,Se=256,Le=512,Oe=30,xe="...",it=800,fi=16,pt=1,Ee=2,V=3,ve=1/0,oe=9007199254740991,Ne=17976931348623157e292,Ke=NaN,Re=4294967295,mi=Re-1,vi=Re>>>1,Ri=[["ary",pe],["bind",R],["bindKey",N],["curry",U],["curryRight",K],["flip",Le],["partial",ie],["partialRight",we],["rearg",Se]],kt="[object Arguments]",yr="[object Array]",Tp="[object AsyncFunction]",En="[object Boolean]",Pn="[object Date]",xp="[object DOMException]",br="[object Error]",wr="[object Function]",Cl="[object GeneratorFunction]",It="[object Map]",An="[object Number]",kp="[object Null]",Xt="[object Object]",El="[object Promise]",Ip="[object Proxy]",Sn="[object RegExp]",Mt="[object Set]",On="[object String]",_r="[object Symbol]",Mp="[object Undefined]",Tn="[object WeakMap]",Rp="[object WeakSet]",xn="[object ArrayBuffer]",Hi="[object DataView]",Gs="[object Float32Array]",Zs="[object Float64Array]",Js="[object Int8Array]",qs="[object Int16Array]",Hs="[object Int32Array]",Ks="[object Uint8Array]",Ys="[object Uint8ClampedArray]",Qs="[object Uint16Array]",Xs="[object Uint32Array]",Fp=/\b__p \+= '';/g,Lp=/\b(__p \+=) '' \+/g,Np=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Pl=/&(?:amp|lt|gt|quot|#39);/g,Al=/[&<>"']/g,Dp=RegExp(Pl.source),jp=RegExp(Al.source),Bp=/<%-([\s\S]+?)%>/g,Up=/<%([\s\S]+?)%>/g,Sl=/<%=([\s\S]+?)%>/g,$p=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,zp=/^\w*$/,Wp=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,eo=/[\\^$.*+?()[\]{}|]/g,Vp=RegExp(eo.source),to=/^\s+/,Gp=/\s/,Zp=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Jp=/\{\n\/\* \[wrapped with (.+)\] \*/,qp=/,? & /,Hp=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Kp=/[()=,{}\[\]\/\s]/,Yp=/\\(\\)?/g,Qp=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ol=/\w*$/,Xp=/^[-+]0x[0-9a-f]+$/i,ef=/^0b[01]+$/i,tf=/^\[object .+?Constructor\]$/,nf=/^0o[0-7]+$/i,rf=/^(?:0|[1-9]\d*)$/,sf=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Cr=/($^)/,of=/['\n\r\u2028\u2029\\]/g,Er="\\ud800-\\udfff",af="\\u0300-\\u036f",lf="\\ufe20-\\ufe2f",uf="\\u20d0-\\u20ff",Tl=af+lf+uf,xl="\\u2700-\\u27bf",kl="a-z\\xdf-\\xf6\\xf8-\\xff",cf="\\xac\\xb1\\xd7\\xf7",hf="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",df="\\u2000-\\u206f",pf=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Il="A-Z\\xc0-\\xd6\\xd8-\\xde",Ml="\\ufe0e\\ufe0f",Rl=cf+hf+df+pf,io="['’]",ff="["+Er+"]",Fl="["+Rl+"]",Pr="["+Tl+"]",Ll="\\d+",mf="["+xl+"]",Nl="["+kl+"]",Dl="[^"+Er+Rl+Ll+xl+kl+Il+"]",no="\\ud83c[\\udffb-\\udfff]",vf="(?:"+Pr+"|"+no+")",jl="[^"+Er+"]",ro="(?:\\ud83c[\\udde6-\\uddff]){2}",so="[\\ud800-\\udbff][\\udc00-\\udfff]",Ki="["+Il+"]",Bl="\\u200d",Ul="(?:"+Nl+"|"+Dl+")",gf="(?:"+Ki+"|"+Dl+")",$l="(?:"+io+"(?:d|ll|m|re|s|t|ve))?",zl="(?:"+io+"(?:D|LL|M|RE|S|T|VE))?",Wl=vf+"?",Vl="["+Ml+"]?",yf="(?:"+Bl+"(?:"+[jl,ro,so].join("|")+")"+Vl+Wl+")*",bf="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",wf="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Gl=Vl+Wl+yf,_f="(?:"+[mf,ro,so].join("|")+")"+Gl,Cf="(?:"+[jl+Pr+"?",Pr,ro,so,ff].join("|")+")",Ef=RegExp(io,"g"),Pf=RegExp(Pr,"g"),oo=RegExp(no+"(?="+no+")|"+Cf+Gl,"g"),Af=RegExp([Ki+"?"+Nl+"+"+$l+"(?="+[Fl,Ki,"$"].join("|")+")",gf+"+"+zl+"(?="+[Fl,Ki+Ul,"$"].join("|")+")",Ki+"?"+Ul+"+"+$l,Ki+"+"+zl,wf,bf,Ll,_f].join("|"),"g"),Sf=RegExp("["+Bl+Er+Tl+Ml+"]"),Of=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Tf=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],xf=-1,Ie={};Ie[Gs]=Ie[Zs]=Ie[Js]=Ie[qs]=Ie[Hs]=Ie[Ks]=Ie[Ys]=Ie[Qs]=Ie[Xs]=!0,Ie[kt]=Ie[yr]=Ie[xn]=Ie[En]=Ie[Hi]=Ie[Pn]=Ie[br]=Ie[wr]=Ie[It]=Ie[An]=Ie[Xt]=Ie[Sn]=Ie[Mt]=Ie[On]=Ie[Tn]=!1;var ke={};ke[kt]=ke[yr]=ke[xn]=ke[Hi]=ke[En]=ke[Pn]=ke[Gs]=ke[Zs]=ke[Js]=ke[qs]=ke[Hs]=ke[It]=ke[An]=ke[Xt]=ke[Sn]=ke[Mt]=ke[On]=ke[_r]=ke[Ks]=ke[Ys]=ke[Qs]=ke[Xs]=!0,ke[br]=ke[wr]=ke[Tn]=!1;var kf={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},If={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Mf={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Rf={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ff=parseFloat,Lf=parseInt,Zl=typeof window=="object"&&window&&window.Object===Object&&window,Nf=typeof self=="object"&&self&&self.Object===Object&&self,Ze=Zl||Nf||Function("return this")(),ao=typeof e=="object"&&e&&!e.nodeType&&e,Fi=ao&&typeof t=="object"&&t&&!t.nodeType&&t,Jl=Fi&&Fi.exports===ao,lo=Jl&&Zl.process,wt=function(){try{var A=Fi&&Fi.require&&Fi.require("util").types;return A||lo&&lo.binding&&lo.binding("util")}catch{}}(),ql=wt&&wt.isArrayBuffer,Hl=wt&&wt.isDate,Kl=wt&&wt.isMap,Yl=wt&&wt.isRegExp,Ql=wt&&wt.isSet,Xl=wt&&wt.isTypedArray;function ft(A,x,T){switch(T.length){case 0:return A.call(x);case 1:return A.call(x,T[0]);case 2:return A.call(x,T[0],T[1]);case 3:return A.call(x,T[0],T[1],T[2])}return A.apply(x,T)}function Df(A,x,T,W){for(var ne=-1,_e=A==null?0:A.length;++ne<_e;){var Ve=A[ne];x(W,Ve,T(Ve),A)}return W}function _t(A,x){for(var T=-1,W=A==null?0:A.length;++T<W&&x(A[T],T,A)!==!1;);return A}function jf(A,x){for(var T=A==null?0:A.length;T--&&x(A[T],T,A)!==!1;);return A}function eu(A,x){for(var T=-1,W=A==null?0:A.length;++T<W;)if(!x(A[T],T,A))return!1;return!0}function gi(A,x){for(var T=-1,W=A==null?0:A.length,ne=0,_e=[];++T<W;){var Ve=A[T];x(Ve,T,A)&&(_e[ne++]=Ve)}return _e}function Ar(A,x){var T=A==null?0:A.length;return!!T&&Yi(A,x,0)>-1}function uo(A,x,T){for(var W=-1,ne=A==null?0:A.length;++W<ne;)if(T(x,A[W]))return!0;return!1}function Fe(A,x){for(var T=-1,W=A==null?0:A.length,ne=Array(W);++T<W;)ne[T]=x(A[T],T,A);return ne}function yi(A,x){for(var T=-1,W=x.length,ne=A.length;++T<W;)A[ne+T]=x[T];return A}function co(A,x,T,W){var ne=-1,_e=A==null?0:A.length;for(W&&_e&&(T=A[++ne]);++ne<_e;)T=x(T,A[ne],ne,A);return T}function Bf(A,x,T,W){var ne=A==null?0:A.length;for(W&&ne&&(T=A[--ne]);ne--;)T=x(T,A[ne],ne,A);return T}function ho(A,x){for(var T=-1,W=A==null?0:A.length;++T<W;)if(x(A[T],T,A))return!0;return!1}var Uf=po("length");function $f(A){return A.split("")}function zf(A){return A.match(Hp)||[]}function tu(A,x,T){var W;return T(A,function(ne,_e,Ve){if(x(ne,_e,Ve))return W=_e,!1}),W}function Sr(A,x,T,W){for(var ne=A.length,_e=T+(W?1:-1);W?_e--:++_e<ne;)if(x(A[_e],_e,A))return _e;return-1}function Yi(A,x,T){return x===x?em(A,x,T):Sr(A,iu,T)}function Wf(A,x,T,W){for(var ne=T-1,_e=A.length;++ne<_e;)if(W(A[ne],x))return ne;return-1}function iu(A){return A!==A}function nu(A,x){var T=A==null?0:A.length;return T?mo(A,x)/T:Ke}function po(A){return function(x){return x==null?i:x[A]}}function fo(A){return function(x){return A==null?i:A[x]}}function ru(A,x,T,W,ne){return ne(A,function(_e,Ve,Te){T=W?(W=!1,_e):x(T,_e,Ve,Te)}),T}function Vf(A,x){var T=A.length;for(A.sort(x);T--;)A[T]=A[T].value;return A}function mo(A,x){for(var T,W=-1,ne=A.length;++W<ne;){var _e=x(A[W]);_e!==i&&(T=T===i?_e:T+_e)}return T}function vo(A,x){for(var T=-1,W=Array(A);++T<A;)W[T]=x(T);return W}function Gf(A,x){return Fe(x,function(T){return[T,A[T]]})}function su(A){return A&&A.slice(0,uu(A)+1).replace(to,"")}function mt(A){return function(x){return A(x)}}function go(A,x){return Fe(x,function(T){return A[T]})}function kn(A,x){return A.has(x)}function ou(A,x){for(var T=-1,W=A.length;++T<W&&Yi(x,A[T],0)>-1;);return T}function au(A,x){for(var T=A.length;T--&&Yi(x,A[T],0)>-1;);return T}function Zf(A,x){for(var T=A.length,W=0;T--;)A[T]===x&&++W;return W}var Jf=fo(kf),qf=fo(If);function Hf(A){return"\\"+Rf[A]}function Kf(A,x){return A==null?i:A[x]}function Qi(A){return Sf.test(A)}function Yf(A){return Of.test(A)}function Qf(A){for(var x,T=[];!(x=A.next()).done;)T.push(x.value);return T}function yo(A){var x=-1,T=Array(A.size);return A.forEach(function(W,ne){T[++x]=[ne,W]}),T}function lu(A,x){return function(T){return A(x(T))}}function bi(A,x){for(var T=-1,W=A.length,ne=0,_e=[];++T<W;){var Ve=A[T];(Ve===x||Ve===f)&&(A[T]=f,_e[ne++]=T)}return _e}function Or(A){var x=-1,T=Array(A.size);return A.forEach(function(W){T[++x]=W}),T}function Xf(A){var x=-1,T=Array(A.size);return A.forEach(function(W){T[++x]=[W,W]}),T}function em(A,x,T){for(var W=T-1,ne=A.length;++W<ne;)if(A[W]===x)return W;return-1}function tm(A,x,T){for(var W=T+1;W--;)if(A[W]===x)return W;return W}function Xi(A){return Qi(A)?nm(A):Uf(A)}function Rt(A){return Qi(A)?rm(A):$f(A)}function uu(A){for(var x=A.length;x--&&Gp.test(A.charAt(x)););return x}var im=fo(Mf);function nm(A){for(var x=oo.lastIndex=0;oo.test(A);)++x;return x}function rm(A){return A.match(oo)||[]}function sm(A){return A.match(Af)||[]}var om=function A(x){x=x==null?Ze:wi.defaults(Ze.Object(),x,wi.pick(Ze,Tf));var T=x.Array,W=x.Date,ne=x.Error,_e=x.Function,Ve=x.Math,Te=x.Object,bo=x.RegExp,am=x.String,Ct=x.TypeError,Tr=T.prototype,lm=_e.prototype,en=Te.prototype,xr=x["__core-js_shared__"],kr=lm.toString,Pe=en.hasOwnProperty,um=0,cu=function(){var n=/[^.]+$/.exec(xr&&xr.keys&&xr.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),Ir=en.toString,cm=kr.call(Te),hm=Ze._,dm=bo("^"+kr.call(Pe).replace(eo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Mr=Jl?x.Buffer:i,_i=x.Symbol,Rr=x.Uint8Array,hu=Mr?Mr.allocUnsafe:i,Fr=lu(Te.getPrototypeOf,Te),du=Te.create,pu=en.propertyIsEnumerable,Lr=Tr.splice,fu=_i?_i.isConcatSpreadable:i,In=_i?_i.iterator:i,Li=_i?_i.toStringTag:i,Nr=function(){try{var n=Ui(Te,"defineProperty");return n({},"",{}),n}catch{}}(),pm=x.clearTimeout!==Ze.clearTimeout&&x.clearTimeout,fm=W&&W.now!==Ze.Date.now&&W.now,mm=x.setTimeout!==Ze.setTimeout&&x.setTimeout,Dr=Ve.ceil,jr=Ve.floor,wo=Te.getOwnPropertySymbols,vm=Mr?Mr.isBuffer:i,mu=x.isFinite,gm=Tr.join,ym=lu(Te.keys,Te),Ge=Ve.max,Xe=Ve.min,bm=W.now,wm=x.parseInt,vu=Ve.random,_m=Tr.reverse,_o=Ui(x,"DataView"),Mn=Ui(x,"Map"),Co=Ui(x,"Promise"),tn=Ui(x,"Set"),Rn=Ui(x,"WeakMap"),Fn=Ui(Te,"create"),Br=Rn&&new Rn,nn={},Cm=$i(_o),Em=$i(Mn),Pm=$i(Co),Am=$i(tn),Sm=$i(Rn),Ur=_i?_i.prototype:i,Ln=Ur?Ur.valueOf:i,gu=Ur?Ur.toString:i;function b(n){if(je(n)&&!re(n)&&!(n instanceof me)){if(n instanceof Et)return n;if(Pe.call(n,"__wrapped__"))return yc(n)}return new Et(n)}var rn=function(){function n(){}return function(s){if(!De(s))return{};if(du)return du(s);n.prototype=s;var l=new n;return n.prototype=i,l}}();function $r(){}function Et(n,s){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!s,this.__index__=0,this.__values__=i}b.templateSettings={escape:Bp,evaluate:Up,interpolate:Sl,variable:"",imports:{_:b}},b.prototype=$r.prototype,b.prototype.constructor=b,Et.prototype=rn($r.prototype),Et.prototype.constructor=Et;function me(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Re,this.__views__=[]}function Om(){var n=new me(this.__wrapped__);return n.__actions__=at(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=at(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=at(this.__views__),n}function Tm(){if(this.__filtered__){var n=new me(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function xm(){var n=this.__wrapped__.value(),s=this.__dir__,l=re(n),d=s<0,v=l?n.length:0,w=$v(0,v,this.__views__),C=w.start,P=w.end,S=P-C,I=d?P:C-1,M=this.__iteratees__,F=M.length,D=0,G=Xe(S,this.__takeCount__);if(!l||!d&&v==S&&G==S)return $u(n,this.__actions__);var q=[];e:for(;S--&&D<G;){I+=s;for(var le=-1,H=n[I];++le<F;){var fe=M[le],ge=fe.iteratee,yt=fe.type,st=ge(H);if(yt==Ee)H=st;else if(!st){if(yt==pt)continue e;break e}}q[D++]=H}return q}me.prototype=rn($r.prototype),me.prototype.constructor=me;function Ni(n){var s=-1,l=n==null?0:n.length;for(this.clear();++s<l;){var d=n[s];this.set(d[0],d[1])}}function km(){this.__data__=Fn?Fn(null):{},this.size=0}function Im(n){var s=this.has(n)&&delete this.__data__[n];return this.size-=s?1:0,s}function Mm(n){var s=this.__data__;if(Fn){var l=s[n];return l===p?i:l}return Pe.call(s,n)?s[n]:i}function Rm(n){var s=this.__data__;return Fn?s[n]!==i:Pe.call(s,n)}function Fm(n,s){var l=this.__data__;return this.size+=this.has(n)?0:1,l[n]=Fn&&s===i?p:s,this}Ni.prototype.clear=km,Ni.prototype.delete=Im,Ni.prototype.get=Mm,Ni.prototype.has=Rm,Ni.prototype.set=Fm;function ei(n){var s=-1,l=n==null?0:n.length;for(this.clear();++s<l;){var d=n[s];this.set(d[0],d[1])}}function Lm(){this.__data__=[],this.size=0}function Nm(n){var s=this.__data__,l=zr(s,n);if(l<0)return!1;var d=s.length-1;return l==d?s.pop():Lr.call(s,l,1),--this.size,!0}function Dm(n){var s=this.__data__,l=zr(s,n);return l<0?i:s[l][1]}function jm(n){return zr(this.__data__,n)>-1}function Bm(n,s){var l=this.__data__,d=zr(l,n);return d<0?(++this.size,l.push([n,s])):l[d][1]=s,this}ei.prototype.clear=Lm,ei.prototype.delete=Nm,ei.prototype.get=Dm,ei.prototype.has=jm,ei.prototype.set=Bm;function ti(n){var s=-1,l=n==null?0:n.length;for(this.clear();++s<l;){var d=n[s];this.set(d[0],d[1])}}function Um(){this.size=0,this.__data__={hash:new Ni,map:new(Mn||ei),string:new Ni}}function $m(n){var s=es(this,n).delete(n);return this.size-=s?1:0,s}function zm(n){return es(this,n).get(n)}function Wm(n){return es(this,n).has(n)}function Vm(n,s){var l=es(this,n),d=l.size;return l.set(n,s),this.size+=l.size==d?0:1,this}ti.prototype.clear=Um,ti.prototype.delete=$m,ti.prototype.get=zm,ti.prototype.has=Wm,ti.prototype.set=Vm;function Di(n){var s=-1,l=n==null?0:n.length;for(this.__data__=new ti;++s<l;)this.add(n[s])}function Gm(n){return this.__data__.set(n,p),this}function Zm(n){return this.__data__.has(n)}Di.prototype.add=Di.prototype.push=Gm,Di.prototype.has=Zm;function Ft(n){var s=this.__data__=new ei(n);this.size=s.size}function Jm(){this.__data__=new ei,this.size=0}function qm(n){var s=this.__data__,l=s.delete(n);return this.size=s.size,l}function Hm(n){return this.__data__.get(n)}function Km(n){return this.__data__.has(n)}function Ym(n,s){var l=this.__data__;if(l instanceof ei){var d=l.__data__;if(!Mn||d.length<o-1)return d.push([n,s]),this.size=++l.size,this;l=this.__data__=new ti(d)}return l.set(n,s),this.size=l.size,this}Ft.prototype.clear=Jm,Ft.prototype.delete=qm,Ft.prototype.get=Hm,Ft.prototype.has=Km,Ft.prototype.set=Ym;function yu(n,s){var l=re(n),d=!l&&zi(n),v=!l&&!d&&Si(n),w=!l&&!d&&!v&&ln(n),C=l||d||v||w,P=C?vo(n.length,am):[],S=P.length;for(var I in n)(s||Pe.call(n,I))&&!(C&&(I=="length"||v&&(I=="offset"||I=="parent")||w&&(I=="buffer"||I=="byteLength"||I=="byteOffset")||si(I,S)))&&P.push(I);return P}function bu(n){var s=n.length;return s?n[Ro(0,s-1)]:i}function Qm(n,s){return ts(at(n),ji(s,0,n.length))}function Xm(n){return ts(at(n))}function Eo(n,s,l){(l!==i&&!Lt(n[s],l)||l===i&&!(s in n))&&ii(n,s,l)}function Nn(n,s,l){var d=n[s];(!(Pe.call(n,s)&&Lt(d,l))||l===i&&!(s in n))&&ii(n,s,l)}function zr(n,s){for(var l=n.length;l--;)if(Lt(n[l][0],s))return l;return-1}function ev(n,s,l,d){return Ci(n,function(v,w,C){s(d,v,l(v),C)}),d}function wu(n,s){return n&&Gt(s,Je(s),n)}function tv(n,s){return n&&Gt(s,ut(s),n)}function ii(n,s,l){s=="__proto__"&&Nr?Nr(n,s,{configurable:!0,enumerable:!0,value:l,writable:!0}):n[s]=l}function Po(n,s){for(var l=-1,d=s.length,v=T(d),w=n==null;++l<d;)v[l]=w?i:ra(n,s[l]);return v}function ji(n,s,l){return n===n&&(l!==i&&(n=n<=l?n:l),s!==i&&(n=n>=s?n:s)),n}function Pt(n,s,l,d,v,w){var C,P=s&m,S=s&y,I=s&g;if(l&&(C=v?l(n,d,v,w):l(n)),C!==i)return C;if(!De(n))return n;var M=re(n);if(M){if(C=Wv(n),!P)return at(n,C)}else{var F=et(n),D=F==wr||F==Cl;if(Si(n))return Vu(n,P);if(F==Xt||F==kt||D&&!v){if(C=S||D?{}:uc(n),!P)return S?Mv(n,tv(C,n)):Iv(n,wu(C,n))}else{if(!ke[F])return v?n:{};C=Vv(n,F,P)}}w||(w=new Ft);var G=w.get(n);if(G)return G;w.set(n,C),jc(n)?n.forEach(function(H){C.add(Pt(H,s,l,H,n,w))}):Nc(n)&&n.forEach(function(H,fe){C.set(fe,Pt(H,s,l,fe,n,w))});var q=I?S?Vo:Wo:S?ut:Je,le=M?i:q(n);return _t(le||n,function(H,fe){le&&(fe=H,H=n[fe]),Nn(C,fe,Pt(H,s,l,fe,n,w))}),C}function iv(n){var s=Je(n);return function(l){return _u(l,n,s)}}function _u(n,s,l){var d=l.length;if(n==null)return!d;for(n=Te(n);d--;){var v=l[d],w=s[v],C=n[v];if(C===i&&!(v in n)||!w(C))return!1}return!0}function Cu(n,s,l){if(typeof n!="function")throw new Ct(u);return Wn(function(){n.apply(i,l)},s)}function Dn(n,s,l,d){var v=-1,w=Ar,C=!0,P=n.length,S=[],I=s.length;if(!P)return S;l&&(s=Fe(s,mt(l))),d?(w=uo,C=!1):s.length>=o&&(w=kn,C=!1,s=new Di(s));e:for(;++v<P;){var M=n[v],F=l==null?M:l(M);if(M=d||M!==0?M:0,C&&F===F){for(var D=I;D--;)if(s[D]===F)continue e;S.push(M)}else w(s,F,d)||S.push(M)}return S}var Ci=Hu(Vt),Eu=Hu(So,!0);function nv(n,s){var l=!0;return Ci(n,function(d,v,w){return l=!!s(d,v,w),l}),l}function Wr(n,s,l){for(var d=-1,v=n.length;++d<v;){var w=n[d],C=s(w);if(C!=null&&(P===i?C===C&&!gt(C):l(C,P)))var P=C,S=w}return S}function rv(n,s,l,d){var v=n.length;for(l=ae(l),l<0&&(l=-l>v?0:v+l),d=d===i||d>v?v:ae(d),d<0&&(d+=v),d=l>d?0:Uc(d);l<d;)n[l++]=s;return n}function Pu(n,s){var l=[];return Ci(n,function(d,v,w){s(d,v,w)&&l.push(d)}),l}function Ye(n,s,l,d,v){var w=-1,C=n.length;for(l||(l=Zv),v||(v=[]);++w<C;){var P=n[w];s>0&&l(P)?s>1?Ye(P,s-1,l,d,v):yi(v,P):d||(v[v.length]=P)}return v}var Ao=Ku(),Au=Ku(!0);function Vt(n,s){return n&&Ao(n,s,Je)}function So(n,s){return n&&Au(n,s,Je)}function Vr(n,s){return gi(s,function(l){return oi(n[l])})}function Bi(n,s){s=Pi(s,n);for(var l=0,d=s.length;n!=null&&l<d;)n=n[Zt(s[l++])];return l&&l==d?n:i}function Su(n,s,l){var d=s(n);return re(n)?d:yi(d,l(n))}function nt(n){return n==null?n===i?Mp:kp:Li&&Li in Te(n)?Uv(n):Xv(n)}function Oo(n,s){return n>s}function sv(n,s){return n!=null&&Pe.call(n,s)}function ov(n,s){return n!=null&&s in Te(n)}function av(n,s,l){return n>=Xe(s,l)&&n<Ge(s,l)}function To(n,s,l){for(var d=l?uo:Ar,v=n[0].length,w=n.length,C=w,P=T(w),S=1/0,I=[];C--;){var M=n[C];C&&s&&(M=Fe(M,mt(s))),S=Xe(M.length,S),P[C]=!l&&(s||v>=120&&M.length>=120)?new Di(C&&M):i}M=n[0];var F=-1,D=P[0];e:for(;++F<v&&I.length<S;){var G=M[F],q=s?s(G):G;if(G=l||G!==0?G:0,!(D?kn(D,q):d(I,q,l))){for(C=w;--C;){var le=P[C];if(!(le?kn(le,q):d(n[C],q,l)))continue e}D&&D.push(q),I.push(G)}}return I}function lv(n,s,l,d){return Vt(n,function(v,w,C){s(d,l(v),w,C)}),d}function jn(n,s,l){s=Pi(s,n),n=pc(n,s);var d=n==null?n:n[Zt(St(s))];return d==null?i:ft(d,n,l)}function Ou(n){return je(n)&&nt(n)==kt}function uv(n){return je(n)&&nt(n)==xn}function cv(n){return je(n)&&nt(n)==Pn}function Bn(n,s,l,d,v){return n===s?!0:n==null||s==null||!je(n)&&!je(s)?n!==n&&s!==s:hv(n,s,l,d,Bn,v)}function hv(n,s,l,d,v,w){var C=re(n),P=re(s),S=C?yr:et(n),I=P?yr:et(s);S=S==kt?Xt:S,I=I==kt?Xt:I;var M=S==Xt,F=I==Xt,D=S==I;if(D&&Si(n)){if(!Si(s))return!1;C=!0,M=!1}if(D&&!M)return w||(w=new Ft),C||ln(n)?oc(n,s,l,d,v,w):jv(n,s,S,l,d,v,w);if(!(l&_)){var G=M&&Pe.call(n,"__wrapped__"),q=F&&Pe.call(s,"__wrapped__");if(G||q){var le=G?n.value():n,H=q?s.value():s;return w||(w=new Ft),v(le,H,l,d,w)}}return D?(w||(w=new Ft),Bv(n,s,l,d,v,w)):!1}function dv(n){return je(n)&&et(n)==It}function xo(n,s,l,d){var v=l.length,w=v,C=!d;if(n==null)return!w;for(n=Te(n);v--;){var P=l[v];if(C&&P[2]?P[1]!==n[P[0]]:!(P[0]in n))return!1}for(;++v<w;){P=l[v];var S=P[0],I=n[S],M=P[1];if(C&&P[2]){if(I===i&&!(S in n))return!1}else{var F=new Ft;if(d)var D=d(I,M,S,n,s,F);if(!(D===i?Bn(M,I,_|E,d,F):D))return!1}}return!0}function Tu(n){if(!De(n)||qv(n))return!1;var s=oi(n)?dm:tf;return s.test($i(n))}function pv(n){return je(n)&&nt(n)==Sn}function fv(n){return je(n)&&et(n)==Mt}function mv(n){return je(n)&&as(n.length)&&!!Ie[nt(n)]}function xu(n){return typeof n=="function"?n:n==null?ct:typeof n=="object"?re(n)?Mu(n[0],n[1]):Iu(n):Yc(n)}function ko(n){if(!zn(n))return ym(n);var s=[];for(var l in Te(n))Pe.call(n,l)&&l!="constructor"&&s.push(l);return s}function vv(n){if(!De(n))return Qv(n);var s=zn(n),l=[];for(var d in n)d=="constructor"&&(s||!Pe.call(n,d))||l.push(d);return l}function Io(n,s){return n<s}function ku(n,s){var l=-1,d=lt(n)?T(n.length):[];return Ci(n,function(v,w,C){d[++l]=s(v,w,C)}),d}function Iu(n){var s=Zo(n);return s.length==1&&s[0][2]?hc(s[0][0],s[0][1]):function(l){return l===n||xo(l,n,s)}}function Mu(n,s){return qo(n)&&cc(s)?hc(Zt(n),s):function(l){var d=ra(l,n);return d===i&&d===s?sa(l,n):Bn(s,d,_|E)}}function Gr(n,s,l,d,v){n!==s&&Ao(s,function(w,C){if(v||(v=new Ft),De(w))gv(n,s,C,l,Gr,d,v);else{var P=d?d(Ko(n,C),w,C+"",n,s,v):i;P===i&&(P=w),Eo(n,C,P)}},ut)}function gv(n,s,l,d,v,w,C){var P=Ko(n,l),S=Ko(s,l),I=C.get(S);if(I){Eo(n,l,I);return}var M=w?w(P,S,l+"",n,s,C):i,F=M===i;if(F){var D=re(S),G=!D&&Si(S),q=!D&&!G&&ln(S);M=S,D||G||q?re(P)?M=P:Be(P)?M=at(P):G?(F=!1,M=Vu(S,!0)):q?(F=!1,M=Gu(S,!0)):M=[]:Vn(S)||zi(S)?(M=P,zi(P)?M=$c(P):(!De(P)||oi(P))&&(M=uc(S))):F=!1}F&&(C.set(S,M),v(M,S,d,w,C),C.delete(S)),Eo(n,l,M)}function Ru(n,s){var l=n.length;if(l)return s+=s<0?l:0,si(s,l)?n[s]:i}function Fu(n,s,l){s.length?s=Fe(s,function(w){return re(w)?function(C){return Bi(C,w.length===1?w[0]:w)}:w}):s=[ct];var d=-1;s=Fe(s,mt(J()));var v=ku(n,function(w,C,P){var S=Fe(s,function(I){return I(w)});return{criteria:S,index:++d,value:w}});return Vf(v,function(w,C){return kv(w,C,l)})}function yv(n,s){return Lu(n,s,function(l,d){return sa(n,d)})}function Lu(n,s,l){for(var d=-1,v=s.length,w={};++d<v;){var C=s[d],P=Bi(n,C);l(P,C)&&Un(w,Pi(C,n),P)}return w}function bv(n){return function(s){return Bi(s,n)}}function Mo(n,s,l,d){var v=d?Wf:Yi,w=-1,C=s.length,P=n;for(n===s&&(s=at(s)),l&&(P=Fe(n,mt(l)));++w<C;)for(var S=0,I=s[w],M=l?l(I):I;(S=v(P,M,S,d))>-1;)P!==n&&Lr.call(P,S,1),Lr.call(n,S,1);return n}function Nu(n,s){for(var l=n?s.length:0,d=l-1;l--;){var v=s[l];if(l==d||v!==w){var w=v;si(v)?Lr.call(n,v,1):No(n,v)}}return n}function Ro(n,s){return n+jr(vu()*(s-n+1))}function wv(n,s,l,d){for(var v=-1,w=Ge(Dr((s-n)/(l||1)),0),C=T(w);w--;)C[d?w:++v]=n,n+=l;return C}function Fo(n,s){var l="";if(!n||s<1||s>oe)return l;do s%2&&(l+=n),s=jr(s/2),s&&(n+=n);while(s);return l}function he(n,s){return Yo(dc(n,s,ct),n+"")}function _v(n){return bu(un(n))}function Cv(n,s){var l=un(n);return ts(l,ji(s,0,l.length))}function Un(n,s,l,d){if(!De(n))return n;s=Pi(s,n);for(var v=-1,w=s.length,C=w-1,P=n;P!=null&&++v<w;){var S=Zt(s[v]),I=l;if(S==="__proto__"||S==="constructor"||S==="prototype")return n;if(v!=C){var M=P[S];I=d?d(M,S,P):i,I===i&&(I=De(M)?M:si(s[v+1])?[]:{})}Nn(P,S,I),P=P[S]}return n}var Du=Br?function(n,s){return Br.set(n,s),n}:ct,Ev=Nr?function(n,s){return Nr(n,"toString",{configurable:!0,enumerable:!1,value:aa(s),writable:!0})}:ct;function Pv(n){return ts(un(n))}function At(n,s,l){var d=-1,v=n.length;s<0&&(s=-s>v?0:v+s),l=l>v?v:l,l<0&&(l+=v),v=s>l?0:l-s>>>0,s>>>=0;for(var w=T(v);++d<v;)w[d]=n[d+s];return w}function Av(n,s){var l;return Ci(n,function(d,v,w){return l=s(d,v,w),!l}),!!l}function Zr(n,s,l){var d=0,v=n==null?d:n.length;if(typeof s=="number"&&s===s&&v<=vi){for(;d<v;){var w=d+v>>>1,C=n[w];C!==null&&!gt(C)&&(l?C<=s:C<s)?d=w+1:v=w}return v}return Lo(n,s,ct,l)}function Lo(n,s,l,d){var v=0,w=n==null?0:n.length;if(w===0)return 0;s=l(s);for(var C=s!==s,P=s===null,S=gt(s),I=s===i;v<w;){var M=jr((v+w)/2),F=l(n[M]),D=F!==i,G=F===null,q=F===F,le=gt(F);if(C)var H=d||q;else I?H=q&&(d||D):P?H=q&&D&&(d||!G):S?H=q&&D&&!G&&(d||!le):G||le?H=!1:H=d?F<=s:F<s;H?v=M+1:w=M}return Xe(w,mi)}function ju(n,s){for(var l=-1,d=n.length,v=0,w=[];++l<d;){var C=n[l],P=s?s(C):C;if(!l||!Lt(P,S)){var S=P;w[v++]=C===0?0:C}}return w}function Bu(n){return typeof n=="number"?n:gt(n)?Ke:+n}function vt(n){if(typeof n=="string")return n;if(re(n))return Fe(n,vt)+"";if(gt(n))return gu?gu.call(n):"";var s=n+"";return s=="0"&&1/n==-ve?"-0":s}function Ei(n,s,l){var d=-1,v=Ar,w=n.length,C=!0,P=[],S=P;if(l)C=!1,v=uo;else if(w>=o){var I=s?null:Nv(n);if(I)return Or(I);C=!1,v=kn,S=new Di}else S=s?[]:P;e:for(;++d<w;){var M=n[d],F=s?s(M):M;if(M=l||M!==0?M:0,C&&F===F){for(var D=S.length;D--;)if(S[D]===F)continue e;s&&S.push(F),P.push(M)}else v(S,F,l)||(S!==P&&S.push(F),P.push(M))}return P}function No(n,s){return s=Pi(s,n),n=pc(n,s),n==null||delete n[Zt(St(s))]}function Uu(n,s,l,d){return Un(n,s,l(Bi(n,s)),d)}function Jr(n,s,l,d){for(var v=n.length,w=d?v:-1;(d?w--:++w<v)&&s(n[w],w,n););return l?At(n,d?0:w,d?w+1:v):At(n,d?w+1:0,d?v:w)}function $u(n,s){var l=n;return l instanceof me&&(l=l.value()),co(s,function(d,v){return v.func.apply(v.thisArg,yi([d],v.args))},l)}function Do(n,s,l){var d=n.length;if(d<2)return d?Ei(n[0]):[];for(var v=-1,w=T(d);++v<d;)for(var C=n[v],P=-1;++P<d;)P!=v&&(w[v]=Dn(w[v]||C,n[P],s,l));return Ei(Ye(w,1),s,l)}function zu(n,s,l){for(var d=-1,v=n.length,w=s.length,C={};++d<v;){var P=d<w?s[d]:i;l(C,n[d],P)}return C}function jo(n){return Be(n)?n:[]}function Bo(n){return typeof n=="function"?n:ct}function Pi(n,s){return re(n)?n:qo(n,s)?[n]:gc(Ce(n))}var Sv=he;function Ai(n,s,l){var d=n.length;return l=l===i?d:l,!s&&l>=d?n:At(n,s,l)}var Wu=pm||function(n){return Ze.clearTimeout(n)};function Vu(n,s){if(s)return n.slice();var l=n.length,d=hu?hu(l):new n.constructor(l);return n.copy(d),d}function Uo(n){var s=new n.constructor(n.byteLength);return new Rr(s).set(new Rr(n)),s}function Ov(n,s){var l=s?Uo(n.buffer):n.buffer;return new n.constructor(l,n.byteOffset,n.byteLength)}function Tv(n){var s=new n.constructor(n.source,Ol.exec(n));return s.lastIndex=n.lastIndex,s}function xv(n){return Ln?Te(Ln.call(n)):{}}function Gu(n,s){var l=s?Uo(n.buffer):n.buffer;return new n.constructor(l,n.byteOffset,n.length)}function Zu(n,s){if(n!==s){var l=n!==i,d=n===null,v=n===n,w=gt(n),C=s!==i,P=s===null,S=s===s,I=gt(s);if(!P&&!I&&!w&&n>s||w&&C&&S&&!P&&!I||d&&C&&S||!l&&S||!v)return 1;if(!d&&!w&&!I&&n<s||I&&l&&v&&!d&&!w||P&&l&&v||!C&&v||!S)return-1}return 0}function kv(n,s,l){for(var d=-1,v=n.criteria,w=s.criteria,C=v.length,P=l.length;++d<C;){var S=Zu(v[d],w[d]);if(S){if(d>=P)return S;var I=l[d];return S*(I=="desc"?-1:1)}}return n.index-s.index}function Ju(n,s,l,d){for(var v=-1,w=n.length,C=l.length,P=-1,S=s.length,I=Ge(w-C,0),M=T(S+I),F=!d;++P<S;)M[P]=s[P];for(;++v<C;)(F||v<w)&&(M[l[v]]=n[v]);for(;I--;)M[P++]=n[v++];return M}function qu(n,s,l,d){for(var v=-1,w=n.length,C=-1,P=l.length,S=-1,I=s.length,M=Ge(w-P,0),F=T(M+I),D=!d;++v<M;)F[v]=n[v];for(var G=v;++S<I;)F[G+S]=s[S];for(;++C<P;)(D||v<w)&&(F[G+l[C]]=n[v++]);return F}function at(n,s){var l=-1,d=n.length;for(s||(s=T(d));++l<d;)s[l]=n[l];return s}function Gt(n,s,l,d){var v=!l;l||(l={});for(var w=-1,C=s.length;++w<C;){var P=s[w],S=d?d(l[P],n[P],P,l,n):i;S===i&&(S=n[P]),v?ii(l,P,S):Nn(l,P,S)}return l}function Iv(n,s){return Gt(n,Jo(n),s)}function Mv(n,s){return Gt(n,ac(n),s)}function qr(n,s){return function(l,d){var v=re(l)?Df:ev,w=s?s():{};return v(l,n,J(d,2),w)}}function sn(n){return he(function(s,l){var d=-1,v=l.length,w=v>1?l[v-1]:i,C=v>2?l[2]:i;for(w=n.length>3&&typeof w=="function"?(v--,w):i,C&&rt(l[0],l[1],C)&&(w=v<3?i:w,v=1),s=Te(s);++d<v;){var P=l[d];P&&n(s,P,d,w)}return s})}function Hu(n,s){return function(l,d){if(l==null)return l;if(!lt(l))return n(l,d);for(var v=l.length,w=s?v:-1,C=Te(l);(s?w--:++w<v)&&d(C[w],w,C)!==!1;);return l}}function Ku(n){return function(s,l,d){for(var v=-1,w=Te(s),C=d(s),P=C.length;P--;){var S=C[n?P:++v];if(l(w[S],S,w)===!1)break}return s}}function Rv(n,s,l){var d=s&R,v=$n(n);function w(){var C=this&&this!==Ze&&this instanceof w?v:n;return C.apply(d?l:this,arguments)}return w}function Yu(n){return function(s){s=Ce(s);var l=Qi(s)?Rt(s):i,d=l?l[0]:s.charAt(0),v=l?Ai(l,1).join(""):s.slice(1);return d[n]()+v}}function on(n){return function(s){return co(Hc(qc(s).replace(Ef,"")),n,"")}}function $n(n){return function(){var s=arguments;switch(s.length){case 0:return new n;case 1:return new n(s[0]);case 2:return new n(s[0],s[1]);case 3:return new n(s[0],s[1],s[2]);case 4:return new n(s[0],s[1],s[2],s[3]);case 5:return new n(s[0],s[1],s[2],s[3],s[4]);case 6:return new n(s[0],s[1],s[2],s[3],s[4],s[5]);case 7:return new n(s[0],s[1],s[2],s[3],s[4],s[5],s[6])}var l=rn(n.prototype),d=n.apply(l,s);return De(d)?d:l}}function Fv(n,s,l){var d=$n(n);function v(){for(var w=arguments.length,C=T(w),P=w,S=an(v);P--;)C[P]=arguments[P];var I=w<3&&C[0]!==S&&C[w-1]!==S?[]:bi(C,S);if(w-=I.length,w<l)return ic(n,s,Hr,v.placeholder,i,C,I,i,i,l-w);var M=this&&this!==Ze&&this instanceof v?d:n;return ft(M,this,C)}return v}function Qu(n){return function(s,l,d){var v=Te(s);if(!lt(s)){var w=J(l,3);s=Je(s),l=function(P){return w(v[P],P,v)}}var C=n(s,l,d);return C>-1?v[w?s[C]:C]:i}}function Xu(n){return ri(function(s){var l=s.length,d=l,v=Et.prototype.thru;for(n&&s.reverse();d--;){var w=s[d];if(typeof w!="function")throw new Ct(u);if(v&&!C&&Xr(w)=="wrapper")var C=new Et([],!0)}for(d=C?d:l;++d<l;){w=s[d];var P=Xr(w),S=P=="wrapper"?Go(w):i;S&&Ho(S[0])&&S[1]==(pe|U|ie|Se)&&!S[4].length&&S[9]==1?C=C[Xr(S[0])].apply(C,S[3]):C=w.length==1&&Ho(w)?C[P]():C.thru(w)}return function(){var I=arguments,M=I[0];if(C&&I.length==1&&re(M))return C.plant(M).value();for(var F=0,D=l?s[F].apply(this,I):M;++F<l;)D=s[F].call(this,D);return D}})}function Hr(n,s,l,d,v,w,C,P,S,I){var M=s&pe,F=s&R,D=s&N,G=s&(U|K),q=s&Le,le=D?i:$n(n);function H(){for(var fe=arguments.length,ge=T(fe),yt=fe;yt--;)ge[yt]=arguments[yt];if(G)var st=an(H),bt=Zf(ge,st);if(d&&(ge=Ju(ge,d,v,G)),w&&(ge=qu(ge,w,C,G)),fe-=bt,G&&fe<I){var Ue=bi(ge,st);return ic(n,s,Hr,H.placeholder,l,ge,Ue,P,S,I-fe)}var Nt=F?l:this,li=D?Nt[n]:n;return fe=ge.length,P?ge=eg(ge,P):q&&fe>1&&ge.reverse(),M&&S<fe&&(ge.length=S),this&&this!==Ze&&this instanceof H&&(li=le||$n(li)),li.apply(Nt,ge)}return H}function ec(n,s){return function(l,d){return lv(l,n,s(d),{})}}function Kr(n,s){return function(l,d){var v;if(l===i&&d===i)return s;if(l!==i&&(v=l),d!==i){if(v===i)return d;typeof l=="string"||typeof d=="string"?(l=vt(l),d=vt(d)):(l=Bu(l),d=Bu(d)),v=n(l,d)}return v}}function $o(n){return ri(function(s){return s=Fe(s,mt(J())),he(function(l){var d=this;return n(s,function(v){return ft(v,d,l)})})})}function Yr(n,s){s=s===i?" ":vt(s);var l=s.length;if(l<2)return l?Fo(s,n):s;var d=Fo(s,Dr(n/Xi(s)));return Qi(s)?Ai(Rt(d),0,n).join(""):d.slice(0,n)}function Lv(n,s,l,d){var v=s&R,w=$n(n);function C(){for(var P=-1,S=arguments.length,I=-1,M=d.length,F=T(M+S),D=this&&this!==Ze&&this instanceof C?w:n;++I<M;)F[I]=d[I];for(;S--;)F[I++]=arguments[++P];return ft(D,v?l:this,F)}return C}function tc(n){return function(s,l,d){return d&&typeof d!="number"&&rt(s,l,d)&&(l=d=i),s=ai(s),l===i?(l=s,s=0):l=ai(l),d=d===i?s<l?1:-1:ai(d),wv(s,l,d,n)}}function Qr(n){return function(s,l){return typeof s=="string"&&typeof l=="string"||(s=Ot(s),l=Ot(l)),n(s,l)}}function ic(n,s,l,d,v,w,C,P,S,I){var M=s&U,F=M?C:i,D=M?i:C,G=M?w:i,q=M?i:w;s|=M?ie:we,s&=~(M?we:ie),s&j||(s&=~(R|N));var le=[n,s,v,G,F,q,D,P,S,I],H=l.apply(i,le);return Ho(n)&&fc(H,le),H.placeholder=d,mc(H,n,s)}function zo(n){var s=Ve[n];return function(l,d){if(l=Ot(l),d=d==null?0:Xe(ae(d),292),d&&mu(l)){var v=(Ce(l)+"e").split("e"),w=s(v[0]+"e"+(+v[1]+d));return v=(Ce(w)+"e").split("e"),+(v[0]+"e"+(+v[1]-d))}return s(l)}}var Nv=tn&&1/Or(new tn([,-0]))[1]==ve?function(n){return new tn(n)}:ca;function nc(n){return function(s){var l=et(s);return l==It?yo(s):l==Mt?Xf(s):Gf(s,n(s))}}function ni(n,s,l,d,v,w,C,P){var S=s&N;if(!S&&typeof n!="function")throw new Ct(u);var I=d?d.length:0;if(I||(s&=~(ie|we),d=v=i),C=C===i?C:Ge(ae(C),0),P=P===i?P:ae(P),I-=v?v.length:0,s&we){var M=d,F=v;d=v=i}var D=S?i:Go(n),G=[n,s,l,d,v,M,F,w,C,P];if(D&&Yv(G,D),n=G[0],s=G[1],l=G[2],d=G[3],v=G[4],P=G[9]=G[9]===i?S?0:n.length:Ge(G[9]-I,0),!P&&s&(U|K)&&(s&=~(U|K)),!s||s==R)var q=Rv(n,s,l);else s==U||s==K?q=Fv(n,s,P):(s==ie||s==(R|ie))&&!v.length?q=Lv(n,s,l,d):q=Hr.apply(i,G);var le=D?Du:fc;return mc(le(q,G),n,s)}function rc(n,s,l,d){return n===i||Lt(n,en[l])&&!Pe.call(d,l)?s:n}function sc(n,s,l,d,v,w){return De(n)&&De(s)&&(w.set(s,n),Gr(n,s,i,sc,w),w.delete(s)),n}function Dv(n){return Vn(n)?i:n}function oc(n,s,l,d,v,w){var C=l&_,P=n.length,S=s.length;if(P!=S&&!(C&&S>P))return!1;var I=w.get(n),M=w.get(s);if(I&&M)return I==s&&M==n;var F=-1,D=!0,G=l&E?new Di:i;for(w.set(n,s),w.set(s,n);++F<P;){var q=n[F],le=s[F];if(d)var H=C?d(le,q,F,s,n,w):d(q,le,F,n,s,w);if(H!==i){if(H)continue;D=!1;break}if(G){if(!ho(s,function(fe,ge){if(!kn(G,ge)&&(q===fe||v(q,fe,l,d,w)))return G.push(ge)})){D=!1;break}}else if(!(q===le||v(q,le,l,d,w))){D=!1;break}}return w.delete(n),w.delete(s),D}function jv(n,s,l,d,v,w,C){switch(l){case Hi:if(n.byteLength!=s.byteLength||n.byteOffset!=s.byteOffset)return!1;n=n.buffer,s=s.buffer;case xn:return!(n.byteLength!=s.byteLength||!w(new Rr(n),new Rr(s)));case En:case Pn:case An:return Lt(+n,+s);case br:return n.name==s.name&&n.message==s.message;case Sn:case On:return n==s+"";case It:var P=yo;case Mt:var S=d&_;if(P||(P=Or),n.size!=s.size&&!S)return!1;var I=C.get(n);if(I)return I==s;d|=E,C.set(n,s);var M=oc(P(n),P(s),d,v,w,C);return C.delete(n),M;case _r:if(Ln)return Ln.call(n)==Ln.call(s)}return!1}function Bv(n,s,l,d,v,w){var C=l&_,P=Wo(n),S=P.length,I=Wo(s),M=I.length;if(S!=M&&!C)return!1;for(var F=S;F--;){var D=P[F];if(!(C?D in s:Pe.call(s,D)))return!1}var G=w.get(n),q=w.get(s);if(G&&q)return G==s&&q==n;var le=!0;w.set(n,s),w.set(s,n);for(var H=C;++F<S;){D=P[F];var fe=n[D],ge=s[D];if(d)var yt=C?d(ge,fe,D,s,n,w):d(fe,ge,D,n,s,w);if(!(yt===i?fe===ge||v(fe,ge,l,d,w):yt)){le=!1;break}H||(H=D=="constructor")}if(le&&!H){var st=n.constructor,bt=s.constructor;st!=bt&&"constructor"in n&&"constructor"in s&&!(typeof st=="function"&&st instanceof st&&typeof bt=="function"&&bt instanceof bt)&&(le=!1)}return w.delete(n),w.delete(s),le}function ri(n){return Yo(dc(n,i,_c),n+"")}function Wo(n){return Su(n,Je,Jo)}function Vo(n){return Su(n,ut,ac)}var Go=Br?function(n){return Br.get(n)}:ca;function Xr(n){for(var s=n.name+"",l=nn[s],d=Pe.call(nn,s)?l.length:0;d--;){var v=l[d],w=v.func;if(w==null||w==n)return v.name}return s}function an(n){var s=Pe.call(b,"placeholder")?b:n;return s.placeholder}function J(){var n=b.iteratee||la;return n=n===la?xu:n,arguments.length?n(arguments[0],arguments[1]):n}function es(n,s){var l=n.__data__;return Jv(s)?l[typeof s=="string"?"string":"hash"]:l.map}function Zo(n){for(var s=Je(n),l=s.length;l--;){var d=s[l],v=n[d];s[l]=[d,v,cc(v)]}return s}function Ui(n,s){var l=Kf(n,s);return Tu(l)?l:i}function Uv(n){var s=Pe.call(n,Li),l=n[Li];try{n[Li]=i;var d=!0}catch{}var v=Ir.call(n);return d&&(s?n[Li]=l:delete n[Li]),v}var Jo=wo?function(n){return n==null?[]:(n=Te(n),gi(wo(n),function(s){return pu.call(n,s)}))}:ha,ac=wo?function(n){for(var s=[];n;)yi(s,Jo(n)),n=Fr(n);return s}:ha,et=nt;(_o&&et(new _o(new ArrayBuffer(1)))!=Hi||Mn&&et(new Mn)!=It||Co&&et(Co.resolve())!=El||tn&&et(new tn)!=Mt||Rn&&et(new Rn)!=Tn)&&(et=function(n){var s=nt(n),l=s==Xt?n.constructor:i,d=l?$i(l):"";if(d)switch(d){case Cm:return Hi;case Em:return It;case Pm:return El;case Am:return Mt;case Sm:return Tn}return s});function $v(n,s,l){for(var d=-1,v=l.length;++d<v;){var w=l[d],C=w.size;switch(w.type){case"drop":n+=C;break;case"dropRight":s-=C;break;case"take":s=Xe(s,n+C);break;case"takeRight":n=Ge(n,s-C);break}}return{start:n,end:s}}function zv(n){var s=n.match(Jp);return s?s[1].split(qp):[]}function lc(n,s,l){s=Pi(s,n);for(var d=-1,v=s.length,w=!1;++d<v;){var C=Zt(s[d]);if(!(w=n!=null&&l(n,C)))break;n=n[C]}return w||++d!=v?w:(v=n==null?0:n.length,!!v&&as(v)&&si(C,v)&&(re(n)||zi(n)))}function Wv(n){var s=n.length,l=new n.constructor(s);return s&&typeof n[0]=="string"&&Pe.call(n,"index")&&(l.index=n.index,l.input=n.input),l}function uc(n){return typeof n.constructor=="function"&&!zn(n)?rn(Fr(n)):{}}function Vv(n,s,l){var d=n.constructor;switch(s){case xn:return Uo(n);case En:case Pn:return new d(+n);case Hi:return Ov(n,l);case Gs:case Zs:case Js:case qs:case Hs:case Ks:case Ys:case Qs:case Xs:return Gu(n,l);case It:return new d;case An:case On:return new d(n);case Sn:return Tv(n);case Mt:return new d;case _r:return xv(n)}}function Gv(n,s){var l=s.length;if(!l)return n;var d=l-1;return s[d]=(l>1?"& ":"")+s[d],s=s.join(l>2?", ":" "),n.replace(Zp,`{
/* [wrapped with `+s+`] */
`)}function Zv(n){return re(n)||zi(n)||!!(fu&&n&&n[fu])}function si(n,s){var l=typeof n;return s=s??oe,!!s&&(l=="number"||l!="symbol"&&rf.test(n))&&n>-1&&n%1==0&&n<s}function rt(n,s,l){if(!De(l))return!1;var d=typeof s;return(d=="number"?lt(l)&&si(s,l.length):d=="string"&&s in l)?Lt(l[s],n):!1}function qo(n,s){if(re(n))return!1;var l=typeof n;return l=="number"||l=="symbol"||l=="boolean"||n==null||gt(n)?!0:zp.test(n)||!$p.test(n)||s!=null&&n in Te(s)}function Jv(n){var s=typeof n;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?n!=="__proto__":n===null}function Ho(n){var s=Xr(n),l=b[s];if(typeof l!="function"||!(s in me.prototype))return!1;if(n===l)return!0;var d=Go(l);return!!d&&n===d[0]}function qv(n){return!!cu&&cu in n}var Hv=xr?oi:da;function zn(n){var s=n&&n.constructor,l=typeof s=="function"&&s.prototype||en;return n===l}function cc(n){return n===n&&!De(n)}function hc(n,s){return function(l){return l==null?!1:l[n]===s&&(s!==i||n in Te(l))}}function Kv(n){var s=ss(n,function(d){return l.size===h&&l.clear(),d}),l=s.cache;return s}function Yv(n,s){var l=n[1],d=s[1],v=l|d,w=v<(R|N|pe),C=d==pe&&l==U||d==pe&&l==Se&&n[7].length<=s[8]||d==(pe|Se)&&s[7].length<=s[8]&&l==U;if(!(w||C))return n;d&R&&(n[2]=s[2],v|=l&R?0:j);var P=s[3];if(P){var S=n[3];n[3]=S?Ju(S,P,s[4]):P,n[4]=S?bi(n[3],f):s[4]}return P=s[5],P&&(S=n[5],n[5]=S?qu(S,P,s[6]):P,n[6]=S?bi(n[5],f):s[6]),P=s[7],P&&(n[7]=P),d&pe&&(n[8]=n[8]==null?s[8]:Xe(n[8],s[8])),n[9]==null&&(n[9]=s[9]),n[0]=s[0],n[1]=v,n}function Qv(n){var s=[];if(n!=null)for(var l in Te(n))s.push(l);return s}function Xv(n){return Ir.call(n)}function dc(n,s,l){return s=Ge(s===i?n.length-1:s,0),function(){for(var d=arguments,v=-1,w=Ge(d.length-s,0),C=T(w);++v<w;)C[v]=d[s+v];v=-1;for(var P=T(s+1);++v<s;)P[v]=d[v];return P[s]=l(C),ft(n,this,P)}}function pc(n,s){return s.length<2?n:Bi(n,At(s,0,-1))}function eg(n,s){for(var l=n.length,d=Xe(s.length,l),v=at(n);d--;){var w=s[d];n[d]=si(w,l)?v[w]:i}return n}function Ko(n,s){if(!(s==="constructor"&&typeof n[s]=="function")&&s!="__proto__")return n[s]}var fc=vc(Du),Wn=mm||function(n,s){return Ze.setTimeout(n,s)},Yo=vc(Ev);function mc(n,s,l){var d=s+"";return Yo(n,Gv(d,tg(zv(d),l)))}function vc(n){var s=0,l=0;return function(){var d=bm(),v=fi-(d-l);if(l=d,v>0){if(++s>=it)return arguments[0]}else s=0;return n.apply(i,arguments)}}function ts(n,s){var l=-1,d=n.length,v=d-1;for(s=s===i?d:s;++l<s;){var w=Ro(l,v),C=n[w];n[w]=n[l],n[l]=C}return n.length=s,n}var gc=Kv(function(n){var s=[];return n.charCodeAt(0)===46&&s.push(""),n.replace(Wp,function(l,d,v,w){s.push(v?w.replace(Yp,"$1"):d||l)}),s});function Zt(n){if(typeof n=="string"||gt(n))return n;var s=n+"";return s=="0"&&1/n==-ve?"-0":s}function $i(n){if(n!=null){try{return kr.call(n)}catch{}try{return n+""}catch{}}return""}function tg(n,s){return _t(Ri,function(l){var d="_."+l[0];s&l[1]&&!Ar(n,d)&&n.push(d)}),n.sort()}function yc(n){if(n instanceof me)return n.clone();var s=new Et(n.__wrapped__,n.__chain__);return s.__actions__=at(n.__actions__),s.__index__=n.__index__,s.__values__=n.__values__,s}function ig(n,s,l){(l?rt(n,s,l):s===i)?s=1:s=Ge(ae(s),0);var d=n==null?0:n.length;if(!d||s<1)return[];for(var v=0,w=0,C=T(Dr(d/s));v<d;)C[w++]=At(n,v,v+=s);return C}function ng(n){for(var s=-1,l=n==null?0:n.length,d=0,v=[];++s<l;){var w=n[s];w&&(v[d++]=w)}return v}function rg(){var n=arguments.length;if(!n)return[];for(var s=T(n-1),l=arguments[0],d=n;d--;)s[d-1]=arguments[d];return yi(re(l)?at(l):[l],Ye(s,1))}var sg=he(function(n,s){return Be(n)?Dn(n,Ye(s,1,Be,!0)):[]}),og=he(function(n,s){var l=St(s);return Be(l)&&(l=i),Be(n)?Dn(n,Ye(s,1,Be,!0),J(l,2)):[]}),ag=he(function(n,s){var l=St(s);return Be(l)&&(l=i),Be(n)?Dn(n,Ye(s,1,Be,!0),i,l):[]});function lg(n,s,l){var d=n==null?0:n.length;return d?(s=l||s===i?1:ae(s),At(n,s<0?0:s,d)):[]}function ug(n,s,l){var d=n==null?0:n.length;return d?(s=l||s===i?1:ae(s),s=d-s,At(n,0,s<0?0:s)):[]}function cg(n,s){return n&&n.length?Jr(n,J(s,3),!0,!0):[]}function hg(n,s){return n&&n.length?Jr(n,J(s,3),!0):[]}function dg(n,s,l,d){var v=n==null?0:n.length;return v?(l&&typeof l!="number"&&rt(n,s,l)&&(l=0,d=v),rv(n,s,l,d)):[]}function bc(n,s,l){var d=n==null?0:n.length;if(!d)return-1;var v=l==null?0:ae(l);return v<0&&(v=Ge(d+v,0)),Sr(n,J(s,3),v)}function wc(n,s,l){var d=n==null?0:n.length;if(!d)return-1;var v=d-1;return l!==i&&(v=ae(l),v=l<0?Ge(d+v,0):Xe(v,d-1)),Sr(n,J(s,3),v,!0)}function _c(n){var s=n==null?0:n.length;return s?Ye(n,1):[]}function pg(n){var s=n==null?0:n.length;return s?Ye(n,ve):[]}function fg(n,s){var l=n==null?0:n.length;return l?(s=s===i?1:ae(s),Ye(n,s)):[]}function mg(n){for(var s=-1,l=n==null?0:n.length,d={};++s<l;){var v=n[s];d[v[0]]=v[1]}return d}function Cc(n){return n&&n.length?n[0]:i}function vg(n,s,l){var d=n==null?0:n.length;if(!d)return-1;var v=l==null?0:ae(l);return v<0&&(v=Ge(d+v,0)),Yi(n,s,v)}function gg(n){var s=n==null?0:n.length;return s?At(n,0,-1):[]}var yg=he(function(n){var s=Fe(n,jo);return s.length&&s[0]===n[0]?To(s):[]}),bg=he(function(n){var s=St(n),l=Fe(n,jo);return s===St(l)?s=i:l.pop(),l.length&&l[0]===n[0]?To(l,J(s,2)):[]}),wg=he(function(n){var s=St(n),l=Fe(n,jo);return s=typeof s=="function"?s:i,s&&l.pop(),l.length&&l[0]===n[0]?To(l,i,s):[]});function _g(n,s){return n==null?"":gm.call(n,s)}function St(n){var s=n==null?0:n.length;return s?n[s-1]:i}function Cg(n,s,l){var d=n==null?0:n.length;if(!d)return-1;var v=d;return l!==i&&(v=ae(l),v=v<0?Ge(d+v,0):Xe(v,d-1)),s===s?tm(n,s,v):Sr(n,iu,v,!0)}function Eg(n,s){return n&&n.length?Ru(n,ae(s)):i}var Pg=he(Ec);function Ec(n,s){return n&&n.length&&s&&s.length?Mo(n,s):n}function Ag(n,s,l){return n&&n.length&&s&&s.length?Mo(n,s,J(l,2)):n}function Sg(n,s,l){return n&&n.length&&s&&s.length?Mo(n,s,i,l):n}var Og=ri(function(n,s){var l=n==null?0:n.length,d=Po(n,s);return Nu(n,Fe(s,function(v){return si(v,l)?+v:v}).sort(Zu)),d});function Tg(n,s){var l=[];if(!(n&&n.length))return l;var d=-1,v=[],w=n.length;for(s=J(s,3);++d<w;){var C=n[d];s(C,d,n)&&(l.push(C),v.push(d))}return Nu(n,v),l}function Qo(n){return n==null?n:_m.call(n)}function xg(n,s,l){var d=n==null?0:n.length;return d?(l&&typeof l!="number"&&rt(n,s,l)?(s=0,l=d):(s=s==null?0:ae(s),l=l===i?d:ae(l)),At(n,s,l)):[]}function kg(n,s){return Zr(n,s)}function Ig(n,s,l){return Lo(n,s,J(l,2))}function Mg(n,s){var l=n==null?0:n.length;if(l){var d=Zr(n,s);if(d<l&&Lt(n[d],s))return d}return-1}function Rg(n,s){return Zr(n,s,!0)}function Fg(n,s,l){return Lo(n,s,J(l,2),!0)}function Lg(n,s){var l=n==null?0:n.length;if(l){var d=Zr(n,s,!0)-1;if(Lt(n[d],s))return d}return-1}function Ng(n){return n&&n.length?ju(n):[]}function Dg(n,s){return n&&n.length?ju(n,J(s,2)):[]}function jg(n){var s=n==null?0:n.length;return s?At(n,1,s):[]}function Bg(n,s,l){return n&&n.length?(s=l||s===i?1:ae(s),At(n,0,s<0?0:s)):[]}function Ug(n,s,l){var d=n==null?0:n.length;return d?(s=l||s===i?1:ae(s),s=d-s,At(n,s<0?0:s,d)):[]}function $g(n,s){return n&&n.length?Jr(n,J(s,3),!1,!0):[]}function zg(n,s){return n&&n.length?Jr(n,J(s,3)):[]}var Wg=he(function(n){return Ei(Ye(n,1,Be,!0))}),Vg=he(function(n){var s=St(n);return Be(s)&&(s=i),Ei(Ye(n,1,Be,!0),J(s,2))}),Gg=he(function(n){var s=St(n);return s=typeof s=="function"?s:i,Ei(Ye(n,1,Be,!0),i,s)});function Zg(n){return n&&n.length?Ei(n):[]}function Jg(n,s){return n&&n.length?Ei(n,J(s,2)):[]}function qg(n,s){return s=typeof s=="function"?s:i,n&&n.length?Ei(n,i,s):[]}function Xo(n){if(!(n&&n.length))return[];var s=0;return n=gi(n,function(l){if(Be(l))return s=Ge(l.length,s),!0}),vo(s,function(l){return Fe(n,po(l))})}function Pc(n,s){if(!(n&&n.length))return[];var l=Xo(n);return s==null?l:Fe(l,function(d){return ft(s,i,d)})}var Hg=he(function(n,s){return Be(n)?Dn(n,s):[]}),Kg=he(function(n){return Do(gi(n,Be))}),Yg=he(function(n){var s=St(n);return Be(s)&&(s=i),Do(gi(n,Be),J(s,2))}),Qg=he(function(n){var s=St(n);return s=typeof s=="function"?s:i,Do(gi(n,Be),i,s)}),Xg=he(Xo);function ey(n,s){return zu(n||[],s||[],Nn)}function ty(n,s){return zu(n||[],s||[],Un)}var iy=he(function(n){var s=n.length,l=s>1?n[s-1]:i;return l=typeof l=="function"?(n.pop(),l):i,Pc(n,l)});function Ac(n){var s=b(n);return s.__chain__=!0,s}function ny(n,s){return s(n),n}function is(n,s){return s(n)}var ry=ri(function(n){var s=n.length,l=s?n[0]:0,d=this.__wrapped__,v=function(w){return Po(w,n)};return s>1||this.__actions__.length||!(d instanceof me)||!si(l)?this.thru(v):(d=d.slice(l,+l+(s?1:0)),d.__actions__.push({func:is,args:[v],thisArg:i}),new Et(d,this.__chain__).thru(function(w){return s&&!w.length&&w.push(i),w}))});function sy(){return Ac(this)}function oy(){return new Et(this.value(),this.__chain__)}function ay(){this.__values__===i&&(this.__values__=Bc(this.value()));var n=this.__index__>=this.__values__.length,s=n?i:this.__values__[this.__index__++];return{done:n,value:s}}function ly(){return this}function uy(n){for(var s,l=this;l instanceof $r;){var d=yc(l);d.__index__=0,d.__values__=i,s?v.__wrapped__=d:s=d;var v=d;l=l.__wrapped__}return v.__wrapped__=n,s}function cy(){var n=this.__wrapped__;if(n instanceof me){var s=n;return this.__actions__.length&&(s=new me(this)),s=s.reverse(),s.__actions__.push({func:is,args:[Qo],thisArg:i}),new Et(s,this.__chain__)}return this.thru(Qo)}function hy(){return $u(this.__wrapped__,this.__actions__)}var dy=qr(function(n,s,l){Pe.call(n,l)?++n[l]:ii(n,l,1)});function py(n,s,l){var d=re(n)?eu:nv;return l&&rt(n,s,l)&&(s=i),d(n,J(s,3))}function fy(n,s){var l=re(n)?gi:Pu;return l(n,J(s,3))}var my=Qu(bc),vy=Qu(wc);function gy(n,s){return Ye(ns(n,s),1)}function yy(n,s){return Ye(ns(n,s),ve)}function by(n,s,l){return l=l===i?1:ae(l),Ye(ns(n,s),l)}function Sc(n,s){var l=re(n)?_t:Ci;return l(n,J(s,3))}function Oc(n,s){var l=re(n)?jf:Eu;return l(n,J(s,3))}var wy=qr(function(n,s,l){Pe.call(n,l)?n[l].push(s):ii(n,l,[s])});function _y(n,s,l,d){n=lt(n)?n:un(n),l=l&&!d?ae(l):0;var v=n.length;return l<0&&(l=Ge(v+l,0)),ls(n)?l<=v&&n.indexOf(s,l)>-1:!!v&&Yi(n,s,l)>-1}var Cy=he(function(n,s,l){var d=-1,v=typeof s=="function",w=lt(n)?T(n.length):[];return Ci(n,function(C){w[++d]=v?ft(s,C,l):jn(C,s,l)}),w}),Ey=qr(function(n,s,l){ii(n,l,s)});function ns(n,s){var l=re(n)?Fe:ku;return l(n,J(s,3))}function Py(n,s,l,d){return n==null?[]:(re(s)||(s=s==null?[]:[s]),l=d?i:l,re(l)||(l=l==null?[]:[l]),Fu(n,s,l))}var Ay=qr(function(n,s,l){n[l?0:1].push(s)},function(){return[[],[]]});function Sy(n,s,l){var d=re(n)?co:ru,v=arguments.length<3;return d(n,J(s,4),l,v,Ci)}function Oy(n,s,l){var d=re(n)?Bf:ru,v=arguments.length<3;return d(n,J(s,4),l,v,Eu)}function Ty(n,s){var l=re(n)?gi:Pu;return l(n,os(J(s,3)))}function xy(n){var s=re(n)?bu:_v;return s(n)}function ky(n,s,l){(l?rt(n,s,l):s===i)?s=1:s=ae(s);var d=re(n)?Qm:Cv;return d(n,s)}function Iy(n){var s=re(n)?Xm:Pv;return s(n)}function My(n){if(n==null)return 0;if(lt(n))return ls(n)?Xi(n):n.length;var s=et(n);return s==It||s==Mt?n.size:ko(n).length}function Ry(n,s,l){var d=re(n)?ho:Av;return l&&rt(n,s,l)&&(s=i),d(n,J(s,3))}var Fy=he(function(n,s){if(n==null)return[];var l=s.length;return l>1&&rt(n,s[0],s[1])?s=[]:l>2&&rt(s[0],s[1],s[2])&&(s=[s[0]]),Fu(n,Ye(s,1),[])}),rs=fm||function(){return Ze.Date.now()};function Ly(n,s){if(typeof s!="function")throw new Ct(u);return n=ae(n),function(){if(--n<1)return s.apply(this,arguments)}}function Tc(n,s,l){return s=l?i:s,s=n&&s==null?n.length:s,ni(n,pe,i,i,i,i,s)}function xc(n,s){var l;if(typeof s!="function")throw new Ct(u);return n=ae(n),function(){return--n>0&&(l=s.apply(this,arguments)),n<=1&&(s=i),l}}var ea=he(function(n,s,l){var d=R;if(l.length){var v=bi(l,an(ea));d|=ie}return ni(n,d,s,l,v)}),kc=he(function(n,s,l){var d=R|N;if(l.length){var v=bi(l,an(kc));d|=ie}return ni(s,d,n,l,v)});function Ic(n,s,l){s=l?i:s;var d=ni(n,U,i,i,i,i,i,s);return d.placeholder=Ic.placeholder,d}function Mc(n,s,l){s=l?i:s;var d=ni(n,K,i,i,i,i,i,s);return d.placeholder=Mc.placeholder,d}function Rc(n,s,l){var d,v,w,C,P,S,I=0,M=!1,F=!1,D=!0;if(typeof n!="function")throw new Ct(u);s=Ot(s)||0,De(l)&&(M=!!l.leading,F="maxWait"in l,w=F?Ge(Ot(l.maxWait)||0,s):w,D="trailing"in l?!!l.trailing:D);function G(Ue){var Nt=d,li=v;return d=v=i,I=Ue,C=n.apply(li,Nt),C}function q(Ue){return I=Ue,P=Wn(fe,s),M?G(Ue):C}function le(Ue){var Nt=Ue-S,li=Ue-I,Qc=s-Nt;return F?Xe(Qc,w-li):Qc}function H(Ue){var Nt=Ue-S,li=Ue-I;return S===i||Nt>=s||Nt<0||F&&li>=w}function fe(){var Ue=rs();if(H(Ue))return ge(Ue);P=Wn(fe,le(Ue))}function ge(Ue){return P=i,D&&d?G(Ue):(d=v=i,C)}function yt(){P!==i&&Wu(P),I=0,d=S=v=P=i}function st(){return P===i?C:ge(rs())}function bt(){var Ue=rs(),Nt=H(Ue);if(d=arguments,v=this,S=Ue,Nt){if(P===i)return q(S);if(F)return Wu(P),P=Wn(fe,s),G(S)}return P===i&&(P=Wn(fe,s)),C}return bt.cancel=yt,bt.flush=st,bt}var Ny=he(function(n,s){return Cu(n,1,s)}),Dy=he(function(n,s,l){return Cu(n,Ot(s)||0,l)});function jy(n){return ni(n,Le)}function ss(n,s){if(typeof n!="function"||s!=null&&typeof s!="function")throw new Ct(u);var l=function(){var d=arguments,v=s?s.apply(this,d):d[0],w=l.cache;if(w.has(v))return w.get(v);var C=n.apply(this,d);return l.cache=w.set(v,C)||w,C};return l.cache=new(ss.Cache||ti),l}ss.Cache=ti;function os(n){if(typeof n!="function")throw new Ct(u);return function(){var s=arguments;switch(s.length){case 0:return!n.call(this);case 1:return!n.call(this,s[0]);case 2:return!n.call(this,s[0],s[1]);case 3:return!n.call(this,s[0],s[1],s[2])}return!n.apply(this,s)}}function By(n){return xc(2,n)}var Uy=Sv(function(n,s){s=s.length==1&&re(s[0])?Fe(s[0],mt(J())):Fe(Ye(s,1),mt(J()));var l=s.length;return he(function(d){for(var v=-1,w=Xe(d.length,l);++v<w;)d[v]=s[v].call(this,d[v]);return ft(n,this,d)})}),ta=he(function(n,s){var l=bi(s,an(ta));return ni(n,ie,i,s,l)}),Fc=he(function(n,s){var l=bi(s,an(Fc));return ni(n,we,i,s,l)}),$y=ri(function(n,s){return ni(n,Se,i,i,i,s)});function zy(n,s){if(typeof n!="function")throw new Ct(u);return s=s===i?s:ae(s),he(n,s)}function Wy(n,s){if(typeof n!="function")throw new Ct(u);return s=s==null?0:Ge(ae(s),0),he(function(l){var d=l[s],v=Ai(l,0,s);return d&&yi(v,d),ft(n,this,v)})}function Vy(n,s,l){var d=!0,v=!0;if(typeof n!="function")throw new Ct(u);return De(l)&&(d="leading"in l?!!l.leading:d,v="trailing"in l?!!l.trailing:v),Rc(n,s,{leading:d,maxWait:s,trailing:v})}function Gy(n){return Tc(n,1)}function Zy(n,s){return ta(Bo(s),n)}function Jy(){if(!arguments.length)return[];var n=arguments[0];return re(n)?n:[n]}function qy(n){return Pt(n,g)}function Hy(n,s){return s=typeof s=="function"?s:i,Pt(n,g,s)}function Ky(n){return Pt(n,m|g)}function Yy(n,s){return s=typeof s=="function"?s:i,Pt(n,m|g,s)}function Qy(n,s){return s==null||_u(n,s,Je(s))}function Lt(n,s){return n===s||n!==n&&s!==s}var Xy=Qr(Oo),eb=Qr(function(n,s){return n>=s}),zi=Ou(function(){return arguments}())?Ou:function(n){return je(n)&&Pe.call(n,"callee")&&!pu.call(n,"callee")},re=T.isArray,tb=ql?mt(ql):uv;function lt(n){return n!=null&&as(n.length)&&!oi(n)}function Be(n){return je(n)&&lt(n)}function ib(n){return n===!0||n===!1||je(n)&&nt(n)==En}var Si=vm||da,nb=Hl?mt(Hl):cv;function rb(n){return je(n)&&n.nodeType===1&&!Vn(n)}function sb(n){if(n==null)return!0;if(lt(n)&&(re(n)||typeof n=="string"||typeof n.splice=="function"||Si(n)||ln(n)||zi(n)))return!n.length;var s=et(n);if(s==It||s==Mt)return!n.size;if(zn(n))return!ko(n).length;for(var l in n)if(Pe.call(n,l))return!1;return!0}function ob(n,s){return Bn(n,s)}function ab(n,s,l){l=typeof l=="function"?l:i;var d=l?l(n,s):i;return d===i?Bn(n,s,i,l):!!d}function ia(n){if(!je(n))return!1;var s=nt(n);return s==br||s==xp||typeof n.message=="string"&&typeof n.name=="string"&&!Vn(n)}function lb(n){return typeof n=="number"&&mu(n)}function oi(n){if(!De(n))return!1;var s=nt(n);return s==wr||s==Cl||s==Tp||s==Ip}function Lc(n){return typeof n=="number"&&n==ae(n)}function as(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=oe}function De(n){var s=typeof n;return n!=null&&(s=="object"||s=="function")}function je(n){return n!=null&&typeof n=="object"}var Nc=Kl?mt(Kl):dv;function ub(n,s){return n===s||xo(n,s,Zo(s))}function cb(n,s,l){return l=typeof l=="function"?l:i,xo(n,s,Zo(s),l)}function hb(n){return Dc(n)&&n!=+n}function db(n){if(Hv(n))throw new ne(a);return Tu(n)}function pb(n){return n===null}function fb(n){return n==null}function Dc(n){return typeof n=="number"||je(n)&&nt(n)==An}function Vn(n){if(!je(n)||nt(n)!=Xt)return!1;var s=Fr(n);if(s===null)return!0;var l=Pe.call(s,"constructor")&&s.constructor;return typeof l=="function"&&l instanceof l&&kr.call(l)==cm}var na=Yl?mt(Yl):pv;function mb(n){return Lc(n)&&n>=-oe&&n<=oe}var jc=Ql?mt(Ql):fv;function ls(n){return typeof n=="string"||!re(n)&&je(n)&&nt(n)==On}function gt(n){return typeof n=="symbol"||je(n)&&nt(n)==_r}var ln=Xl?mt(Xl):mv;function vb(n){return n===i}function gb(n){return je(n)&&et(n)==Tn}function yb(n){return je(n)&&nt(n)==Rp}var bb=Qr(Io),wb=Qr(function(n,s){return n<=s});function Bc(n){if(!n)return[];if(lt(n))return ls(n)?Rt(n):at(n);if(In&&n[In])return Qf(n[In]());var s=et(n),l=s==It?yo:s==Mt?Or:un;return l(n)}function ai(n){if(!n)return n===0?n:0;if(n=Ot(n),n===ve||n===-ve){var s=n<0?-1:1;return s*Ne}return n===n?n:0}function ae(n){var s=ai(n),l=s%1;return s===s?l?s-l:s:0}function Uc(n){return n?ji(ae(n),0,Re):0}function Ot(n){if(typeof n=="number")return n;if(gt(n))return Ke;if(De(n)){var s=typeof n.valueOf=="function"?n.valueOf():n;n=De(s)?s+"":s}if(typeof n!="string")return n===0?n:+n;n=su(n);var l=ef.test(n);return l||nf.test(n)?Lf(n.slice(2),l?2:8):Xp.test(n)?Ke:+n}function $c(n){return Gt(n,ut(n))}function _b(n){return n?ji(ae(n),-oe,oe):n===0?n:0}function Ce(n){return n==null?"":vt(n)}var Cb=sn(function(n,s){if(zn(s)||lt(s)){Gt(s,Je(s),n);return}for(var l in s)Pe.call(s,l)&&Nn(n,l,s[l])}),zc=sn(function(n,s){Gt(s,ut(s),n)}),us=sn(function(n,s,l,d){Gt(s,ut(s),n,d)}),Eb=sn(function(n,s,l,d){Gt(s,Je(s),n,d)}),Pb=ri(Po);function Ab(n,s){var l=rn(n);return s==null?l:wu(l,s)}var Sb=he(function(n,s){n=Te(n);var l=-1,d=s.length,v=d>2?s[2]:i;for(v&&rt(s[0],s[1],v)&&(d=1);++l<d;)for(var w=s[l],C=ut(w),P=-1,S=C.length;++P<S;){var I=C[P],M=n[I];(M===i||Lt(M,en[I])&&!Pe.call(n,I))&&(n[I]=w[I])}return n}),Ob=he(function(n){return n.push(i,sc),ft(Wc,i,n)});function Tb(n,s){return tu(n,J(s,3),Vt)}function xb(n,s){return tu(n,J(s,3),So)}function kb(n,s){return n==null?n:Ao(n,J(s,3),ut)}function Ib(n,s){return n==null?n:Au(n,J(s,3),ut)}function Mb(n,s){return n&&Vt(n,J(s,3))}function Rb(n,s){return n&&So(n,J(s,3))}function Fb(n){return n==null?[]:Vr(n,Je(n))}function Lb(n){return n==null?[]:Vr(n,ut(n))}function ra(n,s,l){var d=n==null?i:Bi(n,s);return d===i?l:d}function Nb(n,s){return n!=null&&lc(n,s,sv)}function sa(n,s){return n!=null&&lc(n,s,ov)}var Db=ec(function(n,s,l){s!=null&&typeof s.toString!="function"&&(s=Ir.call(s)),n[s]=l},aa(ct)),jb=ec(function(n,s,l){s!=null&&typeof s.toString!="function"&&(s=Ir.call(s)),Pe.call(n,s)?n[s].push(l):n[s]=[l]},J),Bb=he(jn);function Je(n){return lt(n)?yu(n):ko(n)}function ut(n){return lt(n)?yu(n,!0):vv(n)}function Ub(n,s){var l={};return s=J(s,3),Vt(n,function(d,v,w){ii(l,s(d,v,w),d)}),l}function $b(n,s){var l={};return s=J(s,3),Vt(n,function(d,v,w){ii(l,v,s(d,v,w))}),l}var zb=sn(function(n,s,l){Gr(n,s,l)}),Wc=sn(function(n,s,l,d){Gr(n,s,l,d)}),Wb=ri(function(n,s){var l={};if(n==null)return l;var d=!1;s=Fe(s,function(w){return w=Pi(w,n),d||(d=w.length>1),w}),Gt(n,Vo(n),l),d&&(l=Pt(l,m|y|g,Dv));for(var v=s.length;v--;)No(l,s[v]);return l});function Vb(n,s){return Vc(n,os(J(s)))}var Gb=ri(function(n,s){return n==null?{}:yv(n,s)});function Vc(n,s){if(n==null)return{};var l=Fe(Vo(n),function(d){return[d]});return s=J(s),Lu(n,l,function(d,v){return s(d,v[0])})}function Zb(n,s,l){s=Pi(s,n);var d=-1,v=s.length;for(v||(v=1,n=i);++d<v;){var w=n==null?i:n[Zt(s[d])];w===i&&(d=v,w=l),n=oi(w)?w.call(n):w}return n}function Jb(n,s,l){return n==null?n:Un(n,s,l)}function qb(n,s,l,d){return d=typeof d=="function"?d:i,n==null?n:Un(n,s,l,d)}var Gc=nc(Je),Zc=nc(ut);function Hb(n,s,l){var d=re(n),v=d||Si(n)||ln(n);if(s=J(s,4),l==null){var w=n&&n.constructor;v?l=d?new w:[]:De(n)?l=oi(w)?rn(Fr(n)):{}:l={}}return(v?_t:Vt)(n,function(C,P,S){return s(l,C,P,S)}),l}function Kb(n,s){return n==null?!0:No(n,s)}function Yb(n,s,l){return n==null?n:Uu(n,s,Bo(l))}function Qb(n,s,l,d){return d=typeof d=="function"?d:i,n==null?n:Uu(n,s,Bo(l),d)}function un(n){return n==null?[]:go(n,Je(n))}function Xb(n){return n==null?[]:go(n,ut(n))}function e0(n,s,l){return l===i&&(l=s,s=i),l!==i&&(l=Ot(l),l=l===l?l:0),s!==i&&(s=Ot(s),s=s===s?s:0),ji(Ot(n),s,l)}function t0(n,s,l){return s=ai(s),l===i?(l=s,s=0):l=ai(l),n=Ot(n),av(n,s,l)}function i0(n,s,l){if(l&&typeof l!="boolean"&&rt(n,s,l)&&(s=l=i),l===i&&(typeof s=="boolean"?(l=s,s=i):typeof n=="boolean"&&(l=n,n=i)),n===i&&s===i?(n=0,s=1):(n=ai(n),s===i?(s=n,n=0):s=ai(s)),n>s){var d=n;n=s,s=d}if(l||n%1||s%1){var v=vu();return Xe(n+v*(s-n+Ff("1e-"+((v+"").length-1))),s)}return Ro(n,s)}var n0=on(function(n,s,l){return s=s.toLowerCase(),n+(l?Jc(s):s)});function Jc(n){return oa(Ce(n).toLowerCase())}function qc(n){return n=Ce(n),n&&n.replace(sf,Jf).replace(Pf,"")}function r0(n,s,l){n=Ce(n),s=vt(s);var d=n.length;l=l===i?d:ji(ae(l),0,d);var v=l;return l-=s.length,l>=0&&n.slice(l,v)==s}function s0(n){return n=Ce(n),n&&jp.test(n)?n.replace(Al,qf):n}function o0(n){return n=Ce(n),n&&Vp.test(n)?n.replace(eo,"\\$&"):n}var a0=on(function(n,s,l){return n+(l?"-":"")+s.toLowerCase()}),l0=on(function(n,s,l){return n+(l?" ":"")+s.toLowerCase()}),u0=Yu("toLowerCase");function c0(n,s,l){n=Ce(n),s=ae(s);var d=s?Xi(n):0;if(!s||d>=s)return n;var v=(s-d)/2;return Yr(jr(v),l)+n+Yr(Dr(v),l)}function h0(n,s,l){n=Ce(n),s=ae(s);var d=s?Xi(n):0;return s&&d<s?n+Yr(s-d,l):n}function d0(n,s,l){n=Ce(n),s=ae(s);var d=s?Xi(n):0;return s&&d<s?Yr(s-d,l)+n:n}function p0(n,s,l){return l||s==null?s=0:s&&(s=+s),wm(Ce(n).replace(to,""),s||0)}function f0(n,s,l){return(l?rt(n,s,l):s===i)?s=1:s=ae(s),Fo(Ce(n),s)}function m0(){var n=arguments,s=Ce(n[0]);return n.length<3?s:s.replace(n[1],n[2])}var v0=on(function(n,s,l){return n+(l?"_":"")+s.toLowerCase()});function g0(n,s,l){return l&&typeof l!="number"&&rt(n,s,l)&&(s=l=i),l=l===i?Re:l>>>0,l?(n=Ce(n),n&&(typeof s=="string"||s!=null&&!na(s))&&(s=vt(s),!s&&Qi(n))?Ai(Rt(n),0,l):n.split(s,l)):[]}var y0=on(function(n,s,l){return n+(l?" ":"")+oa(s)});function b0(n,s,l){return n=Ce(n),l=l==null?0:ji(ae(l),0,n.length),s=vt(s),n.slice(l,l+s.length)==s}function w0(n,s,l){var d=b.templateSettings;l&&rt(n,s,l)&&(s=i),n=Ce(n),s=us({},s,d,rc);var v=us({},s.imports,d.imports,rc),w=Je(v),C=go(v,w),P,S,I=0,M=s.interpolate||Cr,F="__p += '",D=bo((s.escape||Cr).source+"|"+M.source+"|"+(M===Sl?Qp:Cr).source+"|"+(s.evaluate||Cr).source+"|$","g"),G="//# sourceURL="+(Pe.call(s,"sourceURL")?(s.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++xf+"]")+`
`;n.replace(D,function(H,fe,ge,yt,st,bt){return ge||(ge=yt),F+=n.slice(I,bt).replace(of,Hf),fe&&(P=!0,F+=`' +
__e(`+fe+`) +
'`),st&&(S=!0,F+=`';
`+st+`;
__p += '`),ge&&(F+=`' +
((__t = (`+ge+`)) == null ? '' : __t) +
'`),I=bt+H.length,H}),F+=`';
`;var q=Pe.call(s,"variable")&&s.variable;if(!q)F=`with (obj) {
`+F+`
}
`;else if(Kp.test(q))throw new ne(c);F=(S?F.replace(Fp,""):F).replace(Lp,"$1").replace(Np,"$1;"),F="function("+(q||"obj")+`) {
`+(q?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(P?", __e = _.escape":"")+(S?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+F+`return __p
}`;var le=Kc(function(){return _e(w,G+"return "+F).apply(i,C)});if(le.source=F,ia(le))throw le;return le}function _0(n){return Ce(n).toLowerCase()}function C0(n){return Ce(n).toUpperCase()}function E0(n,s,l){if(n=Ce(n),n&&(l||s===i))return su(n);if(!n||!(s=vt(s)))return n;var d=Rt(n),v=Rt(s),w=ou(d,v),C=au(d,v)+1;return Ai(d,w,C).join("")}function P0(n,s,l){if(n=Ce(n),n&&(l||s===i))return n.slice(0,uu(n)+1);if(!n||!(s=vt(s)))return n;var d=Rt(n),v=au(d,Rt(s))+1;return Ai(d,0,v).join("")}function A0(n,s,l){if(n=Ce(n),n&&(l||s===i))return n.replace(to,"");if(!n||!(s=vt(s)))return n;var d=Rt(n),v=ou(d,Rt(s));return Ai(d,v).join("")}function S0(n,s){var l=Oe,d=xe;if(De(s)){var v="separator"in s?s.separator:v;l="length"in s?ae(s.length):l,d="omission"in s?vt(s.omission):d}n=Ce(n);var w=n.length;if(Qi(n)){var C=Rt(n);w=C.length}if(l>=w)return n;var P=l-Xi(d);if(P<1)return d;var S=C?Ai(C,0,P).join(""):n.slice(0,P);if(v===i)return S+d;if(C&&(P+=S.length-P),na(v)){if(n.slice(P).search(v)){var I,M=S;for(v.global||(v=bo(v.source,Ce(Ol.exec(v))+"g")),v.lastIndex=0;I=v.exec(M);)var F=I.index;S=S.slice(0,F===i?P:F)}}else if(n.indexOf(vt(v),P)!=P){var D=S.lastIndexOf(v);D>-1&&(S=S.slice(0,D))}return S+d}function O0(n){return n=Ce(n),n&&Dp.test(n)?n.replace(Pl,im):n}var T0=on(function(n,s,l){return n+(l?" ":"")+s.toUpperCase()}),oa=Yu("toUpperCase");function Hc(n,s,l){return n=Ce(n),s=l?i:s,s===i?Yf(n)?sm(n):zf(n):n.match(s)||[]}var Kc=he(function(n,s){try{return ft(n,i,s)}catch(l){return ia(l)?l:new ne(l)}}),x0=ri(function(n,s){return _t(s,function(l){l=Zt(l),ii(n,l,ea(n[l],n))}),n});function k0(n){var s=n==null?0:n.length,l=J();return n=s?Fe(n,function(d){if(typeof d[1]!="function")throw new Ct(u);return[l(d[0]),d[1]]}):[],he(function(d){for(var v=-1;++v<s;){var w=n[v];if(ft(w[0],this,d))return ft(w[1],this,d)}})}function I0(n){return iv(Pt(n,m))}function aa(n){return function(){return n}}function M0(n,s){return n==null||n!==n?s:n}var R0=Xu(),F0=Xu(!0);function ct(n){return n}function la(n){return xu(typeof n=="function"?n:Pt(n,m))}function L0(n){return Iu(Pt(n,m))}function N0(n,s){return Mu(n,Pt(s,m))}var D0=he(function(n,s){return function(l){return jn(l,n,s)}}),j0=he(function(n,s){return function(l){return jn(n,l,s)}});function ua(n,s,l){var d=Je(s),v=Vr(s,d);l==null&&!(De(s)&&(v.length||!d.length))&&(l=s,s=n,n=this,v=Vr(s,Je(s)));var w=!(De(l)&&"chain"in l)||!!l.chain,C=oi(n);return _t(v,function(P){var S=s[P];n[P]=S,C&&(n.prototype[P]=function(){var I=this.__chain__;if(w||I){var M=n(this.__wrapped__),F=M.__actions__=at(this.__actions__);return F.push({func:S,args:arguments,thisArg:n}),M.__chain__=I,M}return S.apply(n,yi([this.value()],arguments))})}),n}function B0(){return Ze._===this&&(Ze._=hm),this}function ca(){}function U0(n){return n=ae(n),he(function(s){return Ru(s,n)})}var $0=$o(Fe),z0=$o(eu),W0=$o(ho);function Yc(n){return qo(n)?po(Zt(n)):bv(n)}function V0(n){return function(s){return n==null?i:Bi(n,s)}}var G0=tc(),Z0=tc(!0);function ha(){return[]}function da(){return!1}function J0(){return{}}function q0(){return""}function H0(){return!0}function K0(n,s){if(n=ae(n),n<1||n>oe)return[];var l=Re,d=Xe(n,Re);s=J(s),n-=Re;for(var v=vo(d,s);++l<n;)s(l);return v}function Y0(n){return re(n)?Fe(n,Zt):gt(n)?[n]:at(gc(Ce(n)))}function Q0(n){var s=++um;return Ce(n)+s}var X0=Kr(function(n,s){return n+s},0),ew=zo("ceil"),tw=Kr(function(n,s){return n/s},1),iw=zo("floor");function nw(n){return n&&n.length?Wr(n,ct,Oo):i}function rw(n,s){return n&&n.length?Wr(n,J(s,2),Oo):i}function sw(n){return nu(n,ct)}function ow(n,s){return nu(n,J(s,2))}function aw(n){return n&&n.length?Wr(n,ct,Io):i}function lw(n,s){return n&&n.length?Wr(n,J(s,2),Io):i}var uw=Kr(function(n,s){return n*s},1),cw=zo("round"),hw=Kr(function(n,s){return n-s},0);function dw(n){return n&&n.length?mo(n,ct):0}function pw(n,s){return n&&n.length?mo(n,J(s,2)):0}return b.after=Ly,b.ary=Tc,b.assign=Cb,b.assignIn=zc,b.assignInWith=us,b.assignWith=Eb,b.at=Pb,b.before=xc,b.bind=ea,b.bindAll=x0,b.bindKey=kc,b.castArray=Jy,b.chain=Ac,b.chunk=ig,b.compact=ng,b.concat=rg,b.cond=k0,b.conforms=I0,b.constant=aa,b.countBy=dy,b.create=Ab,b.curry=Ic,b.curryRight=Mc,b.debounce=Rc,b.defaults=Sb,b.defaultsDeep=Ob,b.defer=Ny,b.delay=Dy,b.difference=sg,b.differenceBy=og,b.differenceWith=ag,b.drop=lg,b.dropRight=ug,b.dropRightWhile=cg,b.dropWhile=hg,b.fill=dg,b.filter=fy,b.flatMap=gy,b.flatMapDeep=yy,b.flatMapDepth=by,b.flatten=_c,b.flattenDeep=pg,b.flattenDepth=fg,b.flip=jy,b.flow=R0,b.flowRight=F0,b.fromPairs=mg,b.functions=Fb,b.functionsIn=Lb,b.groupBy=wy,b.initial=gg,b.intersection=yg,b.intersectionBy=bg,b.intersectionWith=wg,b.invert=Db,b.invertBy=jb,b.invokeMap=Cy,b.iteratee=la,b.keyBy=Ey,b.keys=Je,b.keysIn=ut,b.map=ns,b.mapKeys=Ub,b.mapValues=$b,b.matches=L0,b.matchesProperty=N0,b.memoize=ss,b.merge=zb,b.mergeWith=Wc,b.method=D0,b.methodOf=j0,b.mixin=ua,b.negate=os,b.nthArg=U0,b.omit=Wb,b.omitBy=Vb,b.once=By,b.orderBy=Py,b.over=$0,b.overArgs=Uy,b.overEvery=z0,b.overSome=W0,b.partial=ta,b.partialRight=Fc,b.partition=Ay,b.pick=Gb,b.pickBy=Vc,b.property=Yc,b.propertyOf=V0,b.pull=Pg,b.pullAll=Ec,b.pullAllBy=Ag,b.pullAllWith=Sg,b.pullAt=Og,b.range=G0,b.rangeRight=Z0,b.rearg=$y,b.reject=Ty,b.remove=Tg,b.rest=zy,b.reverse=Qo,b.sampleSize=ky,b.set=Jb,b.setWith=qb,b.shuffle=Iy,b.slice=xg,b.sortBy=Fy,b.sortedUniq=Ng,b.sortedUniqBy=Dg,b.split=g0,b.spread=Wy,b.tail=jg,b.take=Bg,b.takeRight=Ug,b.takeRightWhile=$g,b.takeWhile=zg,b.tap=ny,b.throttle=Vy,b.thru=is,b.toArray=Bc,b.toPairs=Gc,b.toPairsIn=Zc,b.toPath=Y0,b.toPlainObject=$c,b.transform=Hb,b.unary=Gy,b.union=Wg,b.unionBy=Vg,b.unionWith=Gg,b.uniq=Zg,b.uniqBy=Jg,b.uniqWith=qg,b.unset=Kb,b.unzip=Xo,b.unzipWith=Pc,b.update=Yb,b.updateWith=Qb,b.values=un,b.valuesIn=Xb,b.without=Hg,b.words=Hc,b.wrap=Zy,b.xor=Kg,b.xorBy=Yg,b.xorWith=Qg,b.zip=Xg,b.zipObject=ey,b.zipObjectDeep=ty,b.zipWith=iy,b.entries=Gc,b.entriesIn=Zc,b.extend=zc,b.extendWith=us,ua(b,b),b.add=X0,b.attempt=Kc,b.camelCase=n0,b.capitalize=Jc,b.ceil=ew,b.clamp=e0,b.clone=qy,b.cloneDeep=Ky,b.cloneDeepWith=Yy,b.cloneWith=Hy,b.conformsTo=Qy,b.deburr=qc,b.defaultTo=M0,b.divide=tw,b.endsWith=r0,b.eq=Lt,b.escape=s0,b.escapeRegExp=o0,b.every=py,b.find=my,b.findIndex=bc,b.findKey=Tb,b.findLast=vy,b.findLastIndex=wc,b.findLastKey=xb,b.floor=iw,b.forEach=Sc,b.forEachRight=Oc,b.forIn=kb,b.forInRight=Ib,b.forOwn=Mb,b.forOwnRight=Rb,b.get=ra,b.gt=Xy,b.gte=eb,b.has=Nb,b.hasIn=sa,b.head=Cc,b.identity=ct,b.includes=_y,b.indexOf=vg,b.inRange=t0,b.invoke=Bb,b.isArguments=zi,b.isArray=re,b.isArrayBuffer=tb,b.isArrayLike=lt,b.isArrayLikeObject=Be,b.isBoolean=ib,b.isBuffer=Si,b.isDate=nb,b.isElement=rb,b.isEmpty=sb,b.isEqual=ob,b.isEqualWith=ab,b.isError=ia,b.isFinite=lb,b.isFunction=oi,b.isInteger=Lc,b.isLength=as,b.isMap=Nc,b.isMatch=ub,b.isMatchWith=cb,b.isNaN=hb,b.isNative=db,b.isNil=fb,b.isNull=pb,b.isNumber=Dc,b.isObject=De,b.isObjectLike=je,b.isPlainObject=Vn,b.isRegExp=na,b.isSafeInteger=mb,b.isSet=jc,b.isString=ls,b.isSymbol=gt,b.isTypedArray=ln,b.isUndefined=vb,b.isWeakMap=gb,b.isWeakSet=yb,b.join=_g,b.kebabCase=a0,b.last=St,b.lastIndexOf=Cg,b.lowerCase=l0,b.lowerFirst=u0,b.lt=bb,b.lte=wb,b.max=nw,b.maxBy=rw,b.mean=sw,b.meanBy=ow,b.min=aw,b.minBy=lw,b.stubArray=ha,b.stubFalse=da,b.stubObject=J0,b.stubString=q0,b.stubTrue=H0,b.multiply=uw,b.nth=Eg,b.noConflict=B0,b.noop=ca,b.now=rs,b.pad=c0,b.padEnd=h0,b.padStart=d0,b.parseInt=p0,b.random=i0,b.reduce=Sy,b.reduceRight=Oy,b.repeat=f0,b.replace=m0,b.result=Zb,b.round=cw,b.runInContext=A,b.sample=xy,b.size=My,b.snakeCase=v0,b.some=Ry,b.sortedIndex=kg,b.sortedIndexBy=Ig,b.sortedIndexOf=Mg,b.sortedLastIndex=Rg,b.sortedLastIndexBy=Fg,b.sortedLastIndexOf=Lg,b.startCase=y0,b.startsWith=b0,b.subtract=hw,b.sum=dw,b.sumBy=pw,b.template=w0,b.times=K0,b.toFinite=ai,b.toInteger=ae,b.toLength=Uc,b.toLower=_0,b.toNumber=Ot,b.toSafeInteger=_b,b.toString=Ce,b.toUpper=C0,b.trim=E0,b.trimEnd=P0,b.trimStart=A0,b.truncate=S0,b.unescape=O0,b.uniqueId=Q0,b.upperCase=T0,b.upperFirst=oa,b.each=Sc,b.eachRight=Oc,b.first=Cc,ua(b,function(){var n={};return Vt(b,function(s,l){Pe.call(b.prototype,l)||(n[l]=s)}),n}(),{chain:!1}),b.VERSION=r,_t(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){b[n].placeholder=b}),_t(["drop","take"],function(n,s){me.prototype[n]=function(l){l=l===i?1:Ge(ae(l),0);var d=this.__filtered__&&!s?new me(this):this.clone();return d.__filtered__?d.__takeCount__=Xe(l,d.__takeCount__):d.__views__.push({size:Xe(l,Re),type:n+(d.__dir__<0?"Right":"")}),d},me.prototype[n+"Right"]=function(l){return this.reverse()[n](l).reverse()}}),_t(["filter","map","takeWhile"],function(n,s){var l=s+1,d=l==pt||l==V;me.prototype[n]=function(v){var w=this.clone();return w.__iteratees__.push({iteratee:J(v,3),type:l}),w.__filtered__=w.__filtered__||d,w}}),_t(["head","last"],function(n,s){var l="take"+(s?"Right":"");me.prototype[n]=function(){return this[l](1).value()[0]}}),_t(["initial","tail"],function(n,s){var l="drop"+(s?"":"Right");me.prototype[n]=function(){return this.__filtered__?new me(this):this[l](1)}}),me.prototype.compact=function(){return this.filter(ct)},me.prototype.find=function(n){return this.filter(n).head()},me.prototype.findLast=function(n){return this.reverse().find(n)},me.prototype.invokeMap=he(function(n,s){return typeof n=="function"?new me(this):this.map(function(l){return jn(l,n,s)})}),me.prototype.reject=function(n){return this.filter(os(J(n)))},me.prototype.slice=function(n,s){n=ae(n);var l=this;return l.__filtered__&&(n>0||s<0)?new me(l):(n<0?l=l.takeRight(-n):n&&(l=l.drop(n)),s!==i&&(s=ae(s),l=s<0?l.dropRight(-s):l.take(s-n)),l)},me.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},me.prototype.toArray=function(){return this.take(Re)},Vt(me.prototype,function(n,s){var l=/^(?:filter|find|map|reject)|While$/.test(s),d=/^(?:head|last)$/.test(s),v=b[d?"take"+(s=="last"?"Right":""):s],w=d||/^find/.test(s);v&&(b.prototype[s]=function(){var C=this.__wrapped__,P=d?[1]:arguments,S=C instanceof me,I=P[0],M=S||re(C),F=function(fe){var ge=v.apply(b,yi([fe],P));return d&&D?ge[0]:ge};M&&l&&typeof I=="function"&&I.length!=1&&(S=M=!1);var D=this.__chain__,G=!!this.__actions__.length,q=w&&!D,le=S&&!G;if(!w&&M){C=le?C:new me(this);var H=n.apply(C,P);return H.__actions__.push({func:is,args:[F],thisArg:i}),new Et(H,D)}return q&&le?n.apply(this,P):(H=this.thru(F),q?d?H.value()[0]:H.value():H)})}),_t(["pop","push","shift","sort","splice","unshift"],function(n){var s=Tr[n],l=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",d=/^(?:pop|shift)$/.test(n);b.prototype[n]=function(){var v=arguments;if(d&&!this.__chain__){var w=this.value();return s.apply(re(w)?w:[],v)}return this[l](function(C){return s.apply(re(C)?C:[],v)})}}),Vt(me.prototype,function(n,s){var l=b[s];if(l){var d=l.name+"";Pe.call(nn,d)||(nn[d]=[]),nn[d].push({name:s,func:l})}}),nn[Hr(i,N).name]=[{name:"wrapper",func:i}],me.prototype.clone=Om,me.prototype.reverse=Tm,me.prototype.value=xm,b.prototype.at=ry,b.prototype.chain=sy,b.prototype.commit=oy,b.prototype.next=ay,b.prototype.plant=uy,b.prototype.reverse=cy,b.prototype.toJSON=b.prototype.valueOf=b.prototype.value=hy,b.prototype.first=b.prototype.head,In&&(b.prototype[In]=ly),b},wi=om();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Ze._=wi,define(function(){return wi})):Fi?((Fi.exports=wi)._=wi,ao._=wi):Ze._=wi}).call(e)});O();var Qh=(e=>(e.GLOBAL="global-store",e.COMMENTS="comments-store",e.WHO_IS_ONLINE="who-is-online-store",e.VIDEO="video-store",e.PRESENCE_3D="presence-3d-store",e.CORE="core-store",e))(Qh||{});O();var Ow=Wt(wn()),Tw=class{setConfig(e){this.configuration=e}get(e,t){return this.configuration?(0,Ow.get)(this.configuration,e,t):t}},Q=new Tw;O();O();function pr(){return{set value(e){this.instance=e,setTimeout(()=>Object.freeze(this))},get value(){return this.instance}}}O();O();O();O();O();var Aa=function(e,t){return Aa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},Aa(e,t)};function Qt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Aa(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}function xw(e,t,i,r){function o(a){return a instanceof i?a:new i(function(u){u(a)})}return new(i||(i=Promise))(function(a,u){function c(f){try{h(r.next(f))}catch(m){u(m)}}function p(f){try{h(r.throw(f))}catch(m){u(m)}}function h(f){f.done?a(f.value):o(f.value).then(c,p)}h((r=r.apply(e,[])).next())})}function Xh(e,t){var i={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,o,a,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(h){return function(f){return p([h,f])}}function p(h){if(r)throw new TypeError("Generator is already executing.");for(;u&&(u=0,h[0]&&(i=0)),i;)try{if(r=1,o&&(a=h[0]&2?o.return:h[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,h[1])).done)return a;switch(o=0,a&&(h=[h[0]&2,a.value]),h[0]){case 0:case 1:a=h;break;case 4:return i.label++,{value:h[1],done:!1};case 5:i.label++,o=h[1],h=[0];continue;case 7:h=i.ops.pop(),i.trys.pop();continue;default:if(a=i.trys,!(a=a.length>0&&a[a.length-1])&&(h[0]===6||h[0]===2)){i=0;continue}if(h[0]===3&&(!a||h[1]>a[0]&&h[1]<a[3])){i.label=h[1];break}if(h[0]===6&&i.label<a[1]){i.label=a[1],a=h;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(h);break}a[2]&&i.ops.pop(),i.trys.pop();continue}h=t.call(e,i)}catch(f){h=[6,f],o=0}finally{r=a=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function fn(e){var t=typeof Symbol=="function"&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ki(e,t){var i=typeof Symbol=="function"&&e[Symbol.iterator];if(!i)return e;var r=i.call(e),o,a=[],u;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)a.push(o.value)}catch(c){u={error:c}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(u)throw u.error}}return a}function Gi(e,t,i){if(arguments.length===2)for(var r=0,o=t.length,a;r<o;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function dn(e){return this instanceof dn?(this.v=e,this):new dn(e)}function kw(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=i.apply(e,t||[]),o,a=[];return o={},u("next"),u("throw"),u("return"),o[Symbol.asyncIterator]=function(){return this},o;function u(y){r[y]&&(o[y]=function(g){return new Promise(function(_,E){a.push([y,g,_,E])>1||c(y,g)})})}function c(y,g){try{p(r[y](g))}catch(_){m(a[0][3],_)}}function p(y){y.value instanceof dn?Promise.resolve(y.value.v).then(h,f):m(a[0][2],y)}function h(y){c("next",y)}function f(y){c("throw",y)}function m(y,g){y(g),a.shift(),a.length&&c(a[0][0],a[0][1])}}function Iw(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],i;return t?t.call(e):(e=typeof fn=="function"?fn(e):e[Symbol.iterator](),i={},r("next"),r("throw"),r("return"),i[Symbol.asyncIterator]=function(){return this},i);function r(a){i[a]=e[a]&&function(u){return new Promise(function(c,p){u=e[a](u),o(c,p,u.done,u.value)})}}function o(a,u,c,p){Promise.resolve(p).then(function(h){a({value:h,done:c})},u)}}O();function Me(e){return typeof e=="function"}O();O();O();function ed(e){var t=function(r){Error.call(r),r.stack=new Error().stack},i=e(t);return i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,i}var pa=ed(function(e){return function(t){e(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(i,r){return r+1+") "+i.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});O();function Os(e,t){if(e){var i=e.indexOf(t);0<=i&&e.splice(i,1)}}var fr=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,i,r,o,a;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var c=fn(u),p=c.next();!p.done;p=c.next()){var h=p.value;h.remove(this)}}catch(E){t={error:E}}finally{try{p&&!p.done&&(i=c.return)&&i.call(c)}finally{if(t)throw t.error}}else u.remove(this);var f=this.initialTeardown;if(Me(f))try{f()}catch(E){a=E instanceof pa?E.errors:[E]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var y=fn(m),g=y.next();!g.done;g=y.next()){var _=g.value;try{eh(_)}catch(E){a=a??[],E instanceof pa?a=Gi(Gi([],ki(a)),ki(E.errors)):a.push(E)}}}catch(E){r={error:E}}finally{try{g&&!g.done&&(o=y.return)&&o.call(y)}finally{if(r)throw r.error}}}if(a)throw new pa(a)}},e.prototype.add=function(t){var i;if(t&&t!==this)if(this.closed)eh(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(i=this._finalizers)!==null&&i!==void 0?i:[]).push(t)}},e.prototype._hasParent=function(t){var i=this._parentage;return i===t||Array.isArray(i)&&i.includes(t)},e.prototype._addParent=function(t){var i=this._parentage;this._parentage=Array.isArray(i)?(i.push(t),i):i?[i,t]:t},e.prototype._removeParent=function(t){var i=this._parentage;i===t?this._parentage=null:Array.isArray(i)&&Os(i,t)},e.prototype.remove=function(t){var i=this._finalizers;i&&Os(i,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),td=fr.EMPTY;function id(e){return e instanceof fr||e&&"closed"in e&&Me(e.remove)&&Me(e.add)&&Me(e.unsubscribe)}function eh(e){Me(e)?e():e.unsubscribe()}O();var nd={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};O();O();var Mw={setTimeout:function(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return setTimeout.apply(void 0,Gi([e,t],ki(i)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function rd(e){Mw.setTimeout(function(){throw e})}O();function th(){}O();O();function bs(e){e()}var nl=function(e){Qt(t,e);function t(i){var r=e.call(this)||this;return r.isStopped=!1,i?(r.destination=i,id(i)&&i.add(r)):r.destination=Nw,r}return t.create=function(i,r,o){return new Kn(i,r,o)},t.prototype.next=function(i){this.isStopped?void 0:this._next(i)},t.prototype.error=function(i){this.isStopped?void 0:(this.isStopped=!0,this._error(i))},t.prototype.complete=function(){this.isStopped?void 0:(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(i){this.destination.next(i)},t.prototype._error=function(i){try{this.destination.error(i)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(fr),Rw=Function.prototype.bind;function fa(e,t){return Rw.call(e,t)}var Fw=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var i=this.partialObserver;if(i.next)try{i.next(t)}catch(r){hs(r)}},e.prototype.error=function(t){var i=this.partialObserver;if(i.error)try{i.error(t)}catch(r){hs(r)}else hs(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(i){hs(i)}},e}(),Kn=function(e){Qt(t,e);function t(i,r,o){var a=e.call(this)||this,u;if(Me(i)||!i)u={next:i??void 0,error:r??void 0,complete:o??void 0};else{var c;a&&nd.useDeprecatedNextContext?(c=Object.create(i),c.unsubscribe=function(){return a.unsubscribe()},u={next:i.next&&fa(i.next,c),error:i.error&&fa(i.error,c),complete:i.complete&&fa(i.complete,c)}):u=i}return a.destination=new Fw(u),a}return t}(nl);function hs(e){rd(e)}function Lw(e){throw e}var Nw={closed:!0,next:th,error:Lw,complete:th};O();var rl=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();O();O();function sd(e){return e}function Dw(e){return e.length===0?sd:e.length===1?e[0]:function(t){return e.reduce(function(i,r){return r(i)},t)}}var Ht=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var i=new e;return i.source=this,i.operator=t,i},e.prototype.subscribe=function(t,i,r){var o=this,a=Bw(t)?t:new Kn(t,i,r);return bs(function(){var u=o,c=u.operator,p=u.source;a.add(c?c.call(a,p):p?o._subscribe(a):o._trySubscribe(a))}),a},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(i){t.error(i)}},e.prototype.forEach=function(t,i){var r=this;return i=ih(i),new i(function(o,a){var u=new Kn({next:function(c){try{t(c)}catch(p){a(p),u.unsubscribe()}},error:a,complete:o});r.subscribe(u)})},e.prototype._subscribe=function(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)},e.prototype[rl]=function(){return this},e.prototype.pipe=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return Dw(t)(this)},e.prototype.toPromise=function(t){var i=this;return t=ih(t),new t(function(r,o){var a;i.subscribe(function(u){return a=u},function(u){return o(u)},function(){return r(a)})})},e.create=function(t){return new e(t)},e}();function ih(e){var t;return(t=e??nd.Promise)!==null&&t!==void 0?t:Promise}function jw(e){return e&&Me(e.next)&&Me(e.error)&&Me(e.complete)}function Bw(e){return e&&e instanceof nl||jw(e)&&id(e)}O();function Uw(e){return Me(e==null?void 0:e.lift)}function mr(e){return function(t){if(Uw(t))return t.lift(function(i){try{return e(i,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}O();function mn(e,t,i,r,o){return new $w(e,t,i,r,o)}var $w=function(e){Qt(t,e);function t(i,r,o,a,u,c){var p=e.call(this,i)||this;return p.onFinalize=u,p.shouldUnsubscribe=c,p._next=r?function(h){try{r(h)}catch(f){i.error(f)}}:e.prototype._next,p._error=a?function(h){try{a(h)}catch(f){i.error(f)}finally{this.unsubscribe()}}:e.prototype._error,p._complete=o?function(){try{o()}catch(h){i.error(h)}finally{this.unsubscribe()}}:e.prototype._complete,p}return t.prototype.unsubscribe=function(){var i;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((i=this.onFinalize)===null||i===void 0||i.call(this))}},t}(nl);O();O();var zw=ed(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),vr=function(e){Qt(t,e);function t(){var i=e.call(this)||this;return i.closed=!1,i.currentObservers=null,i.observers=[],i.isStopped=!1,i.hasError=!1,i.thrownError=null,i}return t.prototype.lift=function(i){var r=new nh(this,this);return r.operator=i,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new zw},t.prototype.next=function(i){var r=this;bs(function(){var o,a;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var u=fn(r.currentObservers),c=u.next();!c.done;c=u.next()){var p=c.value;p.next(i)}}catch(h){o={error:h}}finally{try{c&&!c.done&&(a=u.return)&&a.call(u)}finally{if(o)throw o.error}}}})},t.prototype.error=function(i){var r=this;bs(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=i;for(var o=r.observers;o.length;)o.shift().error(i)}})},t.prototype.complete=function(){var i=this;bs(function(){if(i._throwIfClosed(),!i.isStopped){i.isStopped=!0;for(var r=i.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var i;return((i=this.observers)===null||i===void 0?void 0:i.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(i){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,i)},t.prototype._subscribe=function(i){return this._throwIfClosed(),this._checkFinalizedStatuses(i),this._innerSubscribe(i)},t.prototype._innerSubscribe=function(i){var r=this,o=this,a=o.hasError,u=o.isStopped,c=o.observers;return a||u?td:(this.currentObservers=null,c.push(i),new fr(function(){r.currentObservers=null,Os(c,i)}))},t.prototype._checkFinalizedStatuses=function(i){var r=this,o=r.hasError,a=r.thrownError,u=r.isStopped;o?i.error(a):u&&i.complete()},t.prototype.asObservable=function(){var i=new Ht;return i.source=this,i},t.create=function(i,r){return new nh(i,r)},t}(Ht),nh=function(e){Qt(t,e);function t(i,r){var o=e.call(this)||this;return o.destination=i,o.source=r,o}return t.prototype.next=function(i){var r,o;(o=(r=this.destination)===null||r===void 0?void 0:r.next)===null||o===void 0||o.call(r,i)},t.prototype.error=function(i){var r,o;(o=(r=this.destination)===null||r===void 0?void 0:r.error)===null||o===void 0||o.call(r,i)},t.prototype.complete=function(){var i,r;(r=(i=this.destination)===null||i===void 0?void 0:i.complete)===null||r===void 0||r.call(i)},t.prototype._subscribe=function(i){var r,o;return(o=(r=this.source)===null||r===void 0?void 0:r.subscribe(i))!==null&&o!==void 0?o:td},t}(vr);O();var od=function(e){Qt(t,e);function t(i){var r=e.call(this)||this;return r._value=i,r}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(i){var r=e.prototype._subscribe.call(this,i);return!r.closed&&i.next(this._value),r},t.prototype.getValue=function(){var i=this,r=i.hasError,o=i.thrownError,a=i._value;if(r)throw o;return this._throwIfClosed(),a},t.prototype.next=function(i){e.prototype.next.call(this,this._value=i)},t}(vr);O();O();var sl={now:function(){return(sl.delegate||Date).now()},delegate:void 0},Ww=function(e){Qt(t,e);function t(i,r,o){i===void 0&&(i=1/0),r===void 0&&(r=1/0),o===void 0&&(o=sl);var a=e.call(this)||this;return a._bufferSize=i,a._windowTime=r,a._timestampProvider=o,a._buffer=[],a._infiniteTimeWindow=!0,a._infiniteTimeWindow=r===1/0,a._bufferSize=Math.max(1,i),a._windowTime=Math.max(1,r),a}return t.prototype.next=function(i){var r=this,o=r.isStopped,a=r._buffer,u=r._infiniteTimeWindow,c=r._timestampProvider,p=r._windowTime;o||(a.push(i),!u&&a.push(c.now()+p)),this._trimBuffer(),e.prototype.next.call(this,i)},t.prototype._subscribe=function(i){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(i),o=this,a=o._infiniteTimeWindow,u=o._buffer,c=u.slice(),p=0;p<c.length&&!i.closed;p+=a?1:2)i.next(c[p]);return this._checkFinalizedStatuses(i),r},t.prototype._trimBuffer=function(){var i=this,r=i._bufferSize,o=i._timestampProvider,a=i._buffer,u=i._infiniteTimeWindow,c=(u?1:2)*r;if(r<1/0&&c<a.length&&a.splice(0,a.length-c),!u){for(var p=o.now(),h=0,f=1;f<a.length&&a[f]<=p;f+=2)h=f;h&&a.splice(0,h+1)}},t}(vr);O();O();var Vw=function(e){Qt(t,e);function t(i,r){return e.call(this)||this}return t.prototype.schedule=function(i,r){return this},t}(fr);O();var Sa={setInterval:function(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o=Sa.delegate;return o!=null&&o.setInterval?o.setInterval.apply(o,Gi([e,t],ki(i))):setInterval.apply(void 0,Gi([e,t],ki(i)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},Gw=function(e){Qt(t,e);function t(i,r){var o=e.call(this,i,r)||this;return o.scheduler=i,o.work=r,o.pending=!1,o}return t.prototype.schedule=function(i,r){var o;if(r===void 0&&(r=0),this.closed)return this;this.state=i;var a=this.id,u=this.scheduler;return a!=null&&(this.id=this.recycleAsyncId(u,a,r)),this.pending=!0,this.delay=r,this.id=(o=this.id)!==null&&o!==void 0?o:this.requestAsyncId(u,this.id,r),this},t.prototype.requestAsyncId=function(i,r,o){return o===void 0&&(o=0),Sa.setInterval(i.flush.bind(i,this),o)},t.prototype.recycleAsyncId=function(i,r,o){if(o===void 0&&(o=0),o!=null&&this.delay===o&&this.pending===!1)return r;r!=null&&Sa.clearInterval(r)},t.prototype.execute=function(i,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var o=this._execute(i,r);if(o)return o;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(i,r){var o=!1,a;try{this.work(i)}catch(u){o=!0,a=u||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),a},t.prototype.unsubscribe=function(){if(!this.closed){var i=this,r=i.id,o=i.scheduler,a=o.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Os(a,this),r!=null&&(this.id=this.recycleAsyncId(o,r,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(Vw);O();O();var rh=function(){function e(t,i){i===void 0&&(i=e.now),this.schedulerActionCtor=t,this.now=i}return e.prototype.schedule=function(t,i,r){return i===void 0&&(i=0),new this.schedulerActionCtor(this,t).schedule(r,i)},e.now=sl.now,e}(),Zw=function(e){Qt(t,e);function t(i,r){r===void 0&&(r=rh.now);var o=e.call(this,i,r)||this;return o.actions=[],o._active=!1,o}return t.prototype.flush=function(i){var r=this.actions;if(this._active){r.push(i);return}var o;this._active=!0;do if(o=i.execute(i.state,i.delay))break;while(i=r.shift());if(this._active=!1,o){for(;i=r.shift();)i.unsubscribe();throw o}},t}(rh);O();var ad=new Zw(Gw),Jw=ad;O();function qw(e){return e&&Me(e.schedule)}O();O();var ld=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};O();function Hw(e){return Me(e==null?void 0:e.then)}O();function Kw(e){return Me(e[rl])}O();function Yw(e){return Symbol.asyncIterator&&Me(e==null?void 0:e[Symbol.asyncIterator])}O();function Qw(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}O();O();function Xw(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var e_=Xw();function t_(e){return Me(e==null?void 0:e[e_])}O();function i_(e){return kw(this,arguments,function(){var t,i,r,o;return Xh(this,function(a){switch(a.label){case 0:t=e.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,dn(t.read())];case 3:return i=a.sent(),r=i.value,o=i.done,o?[4,dn(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,dn(r)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function n_(e){return Me(e==null?void 0:e.getReader)}function _n(e){if(e instanceof Ht)return e;if(e!=null){if(Kw(e))return r_(e);if(ld(e))return s_(e);if(Hw(e))return o_(e);if(Yw(e))return ud(e);if(t_(e))return a_(e);if(n_(e))return l_(e)}throw Qw(e)}function r_(e){return new Ht(function(t){var i=e[rl]();if(Me(i.subscribe))return i.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function s_(e){return new Ht(function(t){for(var i=0;i<e.length&&!t.closed;i++)t.next(e[i]);t.complete()})}function o_(e){return new Ht(function(t){e.then(function(i){t.closed||(t.next(i),t.complete())},function(i){return t.error(i)}).then(null,rd)})}function a_(e){return new Ht(function(t){var i,r;try{for(var o=fn(e),a=o.next();!a.done;a=o.next()){var u=a.value;if(t.next(u),t.closed)return}}catch(c){i={error:c}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}t.complete()})}function ud(e){return new Ht(function(t){u_(e,t).catch(function(i){return t.error(i)})})}function l_(e){return ud(i_(e))}function u_(e,t){var i,r,o,a;return xw(this,void 0,void 0,function(){var u,c;return Xh(this,function(p){switch(p.label){case 0:p.trys.push([0,5,6,11]),i=Iw(e),p.label=1;case 1:return[4,i.next()];case 2:if(r=p.sent(),!!r.done)return[3,4];if(u=r.value,t.next(u),t.closed)return[2];p.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=p.sent(),o={error:c},[3,11];case 6:return p.trys.push([6,,9,10]),r&&!r.done&&(a=i.return)?[4,a.call(i)]:[3,8];case 7:p.sent(),p.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}O();function c_(e,t,i,r,o){r===void 0&&(r=0),o===void 0&&(o=!1);var a=t.schedule(function(){i(),o?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!o)return a}O();function h_(e){return e instanceof Date&&!isNaN(e)}O();O();function cd(e,t){return mr(function(i,r){var o=0;i.subscribe(mn(r,function(a){r.next(e.call(t,a,o++))}))})}var d_=Array.isArray;function p_(e,t){return d_(t)?e.apply(void 0,Gi([],ki(t))):e(t)}function f_(e){return cd(function(t){return p_(e,t)})}O();O();function m_(e,t,i,r,o,a,u,c){var p=[],h=0,f=0,m=!1,y=function(){m&&!p.length&&!h&&t.complete()},g=function(E){return h<r?_(E):p.push(E)},_=function(E){h++;var R=!1;_n(i(E,f++)).subscribe(mn(t,function(N){t.next(N)},function(){R=!0},void 0,function(){if(R)try{h--;for(var N=function(){var j=p.shift();u?c_(t,u,function(){return _(j)}):_(j)};p.length&&h<r;)N();y()}catch(j){t.error(j)}}))};return e.subscribe(mn(t,g,function(){m=!0,y()})),function(){}}function hd(e,t,i){return i===void 0&&(i=1/0),Me(t)?hd(function(r,o){return cd(function(a,u){return t(r,a,o,u)})(_n(e(r,o)))},i):(typeof t=="number"&&(i=t),mr(function(r,o){return m_(r,o,e,i)}))}O();var v_=["addListener","removeListener"],g_=["addEventListener","removeEventListener"],y_=["on","off"];function Oa(e,t,i,r){if(Me(i)&&(r=i,i=void 0),r)return Oa(e,t,i).pipe(f_(r));var o=ki(__(e)?g_.map(function(c){return function(p){return e[c](t,p,i)}}):b_(e)?v_.map(sh(e,t)):w_(e)?y_.map(sh(e,t)):[],2),a=o[0],u=o[1];if(!a&&ld(e))return hd(function(c){return Oa(c,t,i)})(_n(e));if(!a)throw new TypeError("Invalid event target");return new Ht(function(c){var p=function(){for(var h=[],f=0;f<arguments.length;f++)h[f]=arguments[f];return c.next(1<h.length?h:h[0])};return a(p),function(){return u(p)}})}function sh(e,t){return function(i){return function(r){return e[i](t,r)}}}function b_(e){return Me(e.addListener)&&Me(e.removeListener)}function w_(e){return Me(e.on)&&Me(e.off)}function __(e){return Me(e.addEventListener)&&Me(e.removeEventListener)}O();function C_(e,t,i){i===void 0&&(i=Jw);var r=-1;return t!=null&&(qw(t)?i=t:r=t),new Ht(function(o){var a=h_(e)?+e-i.now():e;a<0&&(a=0);var u=0;return i.schedule(function(){o.closed||(o.next(u++),0<=r?this.schedule(void 0,r):o.complete())},a)})}O();function oh(e,t){return t===void 0&&(t=sd),e=e??E_,mr(function(i,r){var o,a=!0;i.subscribe(mn(r,function(u){var c=t(u);(a||!e(o,c))&&(a=!1,o=c,r.next(u))}))})}function E_(e,t){return e===t}O();function P_(e){e===void 0&&(e={});var t=e.connector,i=t===void 0?function(){return new vr}:t,r=e.resetOnError,o=r===void 0?!0:r,a=e.resetOnComplete,u=a===void 0?!0:a,c=e.resetOnRefCountZero,p=c===void 0?!0:c;return function(h){var f,m,y,g=0,_=!1,E=!1,R=function(){m==null||m.unsubscribe(),m=void 0},N=function(){R(),f=y=void 0,_=E=!1},j=function(){var U=f;N(),U==null||U.unsubscribe()};return mr(function(U,K){g++,!E&&!_&&R();var ie=y=y??i();K.add(function(){g--,g===0&&!E&&!_&&(m=ma(j,p))}),ie.subscribe(K),!f&&g>0&&(f=new Kn({next:function(we){return ie.next(we)},error:function(we){E=!0,R(),m=ma(N,o,we),ie.error(we)},complete:function(){_=!0,R(),m=ma(N,u),ie.complete()}}),_n(U).subscribe(f))})(h)}}function ma(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(t===!0){e();return}if(t!==!1){var o=new Kn({next:function(){o.unsubscribe(),e()}});return _n(t.apply(void 0,Gi([],ki(i)))).subscribe(o)}}O();function ah(e,t,i){var r,o,a,u,c=!1;return e&&typeof e=="object"?(r=e.bufferSize,u=r===void 0?1/0:r,o=e.windowTime,t=o===void 0?1/0:o,a=e.refCount,c=a===void 0?!1:a,i=e.scheduler):u=e??1/0,P_({connector:function(){return new Ww(u,t,i)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:c})}O();function A_(e,t){return mr(function(i,r){var o=t??{},a=o.leading,u=a===void 0?!0:a,c=o.trailing,p=c===void 0?!1:c,h=!1,f=null,m=null,y=!1,g=function(){m==null||m.unsubscribe(),m=null,p&&(R(),y&&r.complete())},_=function(){m=null,y&&r.complete()},E=function(N){return m=_n(e(N)).subscribe(mn(r,g,_))},R=function(){if(h){h=!1;var N=f;f=null,r.next(N),!y&&E(N)}};i.subscribe(mn(r,function(N){h=!0,f=N,!(m&&!m.closed)&&(u?R():E(N))},function(){y=!0,!(p&&h&&m&&!m.closed)&&r.complete()}))})}O();function S_(e,t,i){t===void 0&&(t=ad);var r=C_(e,t);return A_(function(){return r},i)}var O_=class{constructor(e,t){this.subscriptions=new Map,this.setValue=i=>{this.state=i,this.subject.next(this.state)},this.subscribe=(i,r)=>{let o=this.subject.subscribe(r);if(this.subscriptions.has(i)){this.subscriptions.get(i).push(o);return}this.subscriptions.set(i,[o])},this.state=e,this.firstState=e,this.subject=t.pipe(oh(),ah({bufferSize:1,refCount:!0}))}getValue(){return this.state}unsubscribe(e){var t;(t=this.subscriptions.get(e))==null||t.forEach(i=>i.unsubscribe()),this.subscriptions.delete(e)}destroy(){this.subscriptions.clear(),this.subject.complete(),this.restart()}restart(){this.state=this.firstState,this.subject=new od(this.firstState).pipe(oh(),ah({bufferSize:1,refCount:!0}))}expose(){let e=this.subscribe.bind(this),t=this.unsubscribe.bind(this),i=this.getValue.bind(this),r=this.setValue.bind(this);return{get value(){return i()},set value(o){r(o)},subscribe:e,unsubscribe:t}}};function Ae(e){let t=new od(e);return new O_(e,t)}var lh=pr(),T_=class{constructor(){if(this.localParticipant=Ae({}),this.participants=Ae({}),this.group=Ae(null),this.isDomainWhitelisted=Ae(!0),this.hasJoinedRoom=Ae(!1),lh.value)throw new Error("CommentsStore is a singleton. There can only be one instance of it.");lh.value=this}destroy(){this.localParticipant.destroy(),this.participants.destroy(),this.group.destroy(),this.isDomainWhitelisted.destroy(),this.hasJoinedRoom.destroy()}},Zi=new T_,x_=Zi.destroy.bind(Zi),k_=Zi.group.expose(),I_=Zi.participants.expose(),M_=Zi.localParticipant.expose(),R_=Zi.isDomainWhitelisted.expose(),F_=Zi.hasJoinedRoom.expose();function ol(){return{localParticipant:M_,participants:I_,group:k_,isDomainWhitelisted:R_,hasJoinedRoom:F_,destroy:x_}}O();O();var uh=pr(),L_=class{constructor(){if(this.localParticipant=Ae({}),this.participants=Ae({}),uh.value)throw new Error("CoreStore is a singleton. There can only be one instance of it.");uh.value=this}destroy(){this.localParticipant.destroy(),this.participants.destroy()}},Ts=new L_,N_=Ts.destroy.bind(Ts),D_=Ts.localParticipant.expose(),j_=Ts.participants.expose();function B_(){return{localParticipant:D_,participants:j_,destroy:N_}}O();var ch=pr(),U_=class{constructor(){if(this.hasJoined3D=Ae(!1),this.participants=Ae([]),ch.value)throw new Error("Presence3DStore is a singleton. There can only be one instance of it.");ch.value=this}destroy(){this.hasJoined3D.destroy(),this.participants.destroy()}},xs=new U_,$_=xs.destroy.bind(xs),z_=xs.hasJoined3D.expose(),W_=xs.participants.expose();function V_(){return{hasJoined3D:z_,participants:W_,destroy:$_}}O();O();var dd=(e=>(e[e.DISCONNECTED=0]="DISCONNECTED",e[e.INITIALIZING=1]="INITIALIZING",e[e.READY_TO_JOIN=2]="READY_TO_JOIN",e[e.CONNECTING=3]="CONNECTING",e[e.CONNECTED=4]="CONNECTED",e[e.JOINED=5]="JOINED",e[e.FAILED=-1]="FAILED",e[e.RETRYING=-2]="RETRYING",e))(dd||{}),hh=pr(),G_=class{constructor(){if(this.meetingState=Ae(0),this.gather=Ae(!1),this.hostId=Ae(""),this.isGridModeEnabled=Ae(!1),this.followParticipantId=Ae(""),this.drawing=Ae(null),this.transcript=Ae(null),hh.value)throw new Error("VideoStore is a singleton. There can only be one instance of it.");hh.value=this}destroy(){this.meetingState.destroy(),this.gather.destroy(),this.hostId.destroy(),this.isGridModeEnabled.destroy(),this.followParticipantId.destroy(),this.drawing.destroy(),this.transcript.destroy()}},hi=new G_,Z_=hi.destroy.bind(hi),J_=hi.meetingState.expose(),q_=hi.gather.expose(),H_=hi.hostId.expose(),K_=hi.isGridModeEnabled.expose(),Y_=hi.followParticipantId.expose(),Q_=hi.drawing.expose(),X_=hi.transcript.expose();function eC(){return{meetingState:J_,gather:q_,destroy:Z_,hostId:H_,isGridModeEnabled:K_,followParticipantId:Y_,drawing:Q_,transcript:X_}}O();var dh=pr(),tC=class{constructor(){if(this.disablePresenceControls=Ae(!1),this.disableGoToParticipant=Ae(!1),this.disableFollowParticipant=Ae(!1),this.disablePrivateMode=Ae(!1),this.disableGatherAll=Ae(!1),this.disableFollowMe=Ae(!1),this.participants=Ae([]),this.extras=Ae([]),this.joinedPresence=Ae(void 0),this.everyoneFollowsMe=Ae(!1),this.privateMode=Ae(!1),this.following=Ae(void 0),dh.value)throw new Error("WhoIsOnlineStore is a singleton. There can only be one instance of it.");dh.value=this}destroy(){this.disableGoToParticipant.destroy(),this.disablePresenceControls.destroy(),this.disableFollowParticipant.destroy(),this.disablePrivateMode.destroy(),this.disableGatherAll.destroy(),this.disableFollowMe.destroy(),this.participants.destroy(),this.extras.destroy(),this.joinedPresence.destroy(),this.everyoneFollowsMe.destroy(),this.privateMode.destroy(),this.following.destroy()}},ht=new tC,iC=ht.destroy.bind(ht),nC=ht.disablePresenceControls.expose(),rC=ht.disableGoToParticipant.expose(),sC=ht.disableFollowParticipant.expose(),oC=ht.disablePrivateMode.expose(),aC=ht.disableGatherAll.expose(),lC=ht.disableFollowMe.expose(),uC=ht.joinedPresence.expose(),cC=ht.participants.expose(),hC=ht.extras.expose(),dC=ht.everyoneFollowsMe.expose(),pC=ht.privateMode.expose(),fC=ht.following.expose();function mC(){return{disablePresenceControls:nC,disableGoToParticipant:rC,disableFollowParticipant:sC,disablePrivateMode:oC,disableGatherAll:aC,disableFollowMe:lC,participants:cC,extras:hC,joinedPresence:uC,everyoneFollowsMe:dC,privateMode:pC,following:fC,destroy:iC}}var vC={"global-store":ol,"who-is-online-store":mC,"video-store":eC,"presence-3d-store":V_,"core-store":B_};function gC(e,t,i){t.subscribe(this,()=>{i?i(t.value):this[e]=t.value,this.requestUpdate&&this.requestUpdate()}),this.unsubscribeFrom||(this.unsubscribeFrom=[]),this.unsubscribeFrom.push(t.unsubscribe)}function tt(e){let t=vC[e](),i=gC.bind(this);return new Proxy(t,{get(r,o){return o==="destroy"?r.destroy:{subscribe(a){i(o,r[o],a)},subject:r[o],get value(){return this.subject.value},publish(a){this.subject.value=a}}}})}/*! Bundled license information:

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/var yC=We((e,t)=>{O();var i=1e3,r=i*60,o=r*60,a=o*24,u=a*7,c=a*365.25;t.exports=function(y,g){g=g||{};var _=typeof y;if(_==="string"&&y.length>0)return p(y);if(_==="number"&&isFinite(y))return g.long?f(y):h(y);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(y))};function p(y){if(y=String(y),!(y.length>100)){var g=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);if(g){var _=parseFloat(g[1]),E=(g[2]||"ms").toLowerCase();switch(E){case"years":case"year":case"yrs":case"yr":case"y":return _*c;case"weeks":case"week":case"w":return _*u;case"days":case"day":case"d":return _*a;case"hours":case"hour":case"hrs":case"hr":case"h":return _*o;case"minutes":case"minute":case"mins":case"min":case"m":return _*r;case"seconds":case"second":case"secs":case"sec":case"s":return _*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return _;default:return}}}}function h(y){var g=Math.abs(y);return g>=a?Math.round(y/a)+"d":g>=o?Math.round(y/o)+"h":g>=r?Math.round(y/r)+"m":g>=i?Math.round(y/i)+"s":y+"ms"}function f(y){var g=Math.abs(y);return g>=a?m(y,g,a,"day"):g>=o?m(y,g,o,"hour"):g>=r?m(y,g,r,"minute"):g>=i?m(y,g,i,"second"):y+" ms"}function m(y,g,_,E){var R=g>=_*1.5;return Math.round(y/_)+" "+E+(R?"s":"")}}),bC=We((e,t)=>{O();function i(r){a.debug=a,a.default=a,a.coerce=m,a.disable=p,a.enable=c,a.enabled=h,a.humanize=yC(),a.destroy=y,Object.keys(r).forEach(g=>{a[g]=r[g]}),a.names=[],a.skips=[],a.formatters={};function o(g){let _=0;for(let E=0;E<g.length;E++)_=(_<<5)-_+g.charCodeAt(E),_|=0;return a.colors[Math.abs(_)%a.colors.length]}a.selectColor=o;function a(g){let _,E=null,R,N;function j(...U){if(!j.enabled)return;let K=j,ie=Number(new Date),we=ie-(_||ie);K.diff=we,K.prev=_,K.curr=ie,_=ie,U[0]=a.coerce(U[0]),typeof U[0]!="string"&&U.unshift("%O");let pe=0;U[0]=U[0].replace(/%([a-zA-Z%])/g,(Se,Le)=>{if(Se==="%%")return"%";pe++;let Oe=a.formatters[Le];if(typeof Oe=="function"){let xe=U[pe];Se=Oe.call(K,xe),U.splice(pe,1),pe--}return Se}),a.formatArgs.call(K,U),(K.log||a.log).apply(K,U)}return j.namespace=g,j.useColors=a.useColors(),j.color=a.selectColor(g),j.extend=u,j.destroy=a.destroy,Object.defineProperty(j,"enabled",{enumerable:!0,configurable:!1,get:()=>E!==null?E:(R!==a.namespaces&&(R=a.namespaces,N=a.enabled(g)),N),set:U=>{E=U}}),typeof a.init=="function"&&a.init(j),j}function u(g,_){let E=a(this.namespace+(typeof _>"u"?":":_)+g);return E.log=this.log,E}function c(g){a.save(g),a.namespaces=g,a.names=[],a.skips=[];let _,E=(typeof g=="string"?g:"").split(/[\s,]+/),R=E.length;for(_=0;_<R;_++)E[_]&&(g=E[_].replace(/\*/g,".*?"),g[0]==="-"?a.skips.push(new RegExp("^"+g.slice(1)+"$")):a.names.push(new RegExp("^"+g+"$")))}function p(){let g=[...a.names.map(f),...a.skips.map(f).map(_=>"-"+_)].join(",");return a.enable(""),g}function h(g){if(g[g.length-1]==="*")return!0;let _,E;for(_=0,E=a.skips.length;_<E;_++)if(a.skips[_].test(g))return!1;for(_=0,E=a.names.length;_<E;_++)if(a.names[_].test(g))return!0;return!1}function f(g){return g.toString().substring(2,g.toString().length-2).replace(/\.\*\?$/,"*")}function m(g){return g instanceof Error?g.stack||g.message:g}function y(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return a.enable(a.load()),a}t.exports=i}),pd=We((e,t)=>{O(),e.formatArgs=r,e.save=o,e.load=a,e.useColors=i,e.storage=u(),e.destroy=(()=>{let p=!1;return()=>{p||(p=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function i(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let p;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(p=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(p[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(p){if(p[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+p[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;let h="color: "+this.color;p.splice(1,0,h,"color: inherit");let f=0,m=0;p[0].replace(/%[a-zA-Z%]/g,y=>{y!=="%%"&&(f++,y==="%c"&&(m=f))}),p.splice(m,0,h)}e.log=console.debug||console.log||(()=>{});function o(p){try{p?e.storage.setItem("debug",p):e.storage.removeItem("debug")}catch{}}function a(){let p;try{p=e.storage.getItem("debug")}catch{}return!p&&typeof process<"u"&&"env"in process&&(p=Xa.DEBUG),p}function u(){try{return localStorage}catch{}}t.exports=bC()(e);var{formatters:c}=t.exports;c.j=function(p){try{return JSON.stringify(p)}catch(h){return"[UnexpectedJSONParseError]: "+h.message}}}),al=We((e,t)=>{O();function i(r){var o=typeof r;return r!=null&&(o=="object"||o=="function")}t.exports=i}),wC=We((e,t)=>{O();var i=typeof window=="object"&&window&&window.Object===Object&&window;t.exports=i}),fd=We((e,t)=>{O();var i=wC(),r=typeof self=="object"&&self&&self.Object===Object&&self,o=i||r||Function("return this")();t.exports=o}),_C=We((e,t)=>{O();var i=fd(),r=function(){return i.Date.now()};t.exports=r}),CC=We((e,t)=>{O();var i=/\s/;function r(o){for(var a=o.length;a--&&i.test(o.charAt(a)););return a}t.exports=r}),EC=We((e,t)=>{O();var i=CC(),r=/^\s+/;function o(a){return a&&a.slice(0,i(a)+1).replace(r,"")}t.exports=o}),md=We((e,t)=>{O();var i=fd(),r=i.Symbol;t.exports=r}),PC=We((e,t)=>{O();var i=md(),r=Object.prototype,o=r.hasOwnProperty,a=r.toString,u=i?i.toStringTag:void 0;function c(p){var h=o.call(p,u),f=p[u];try{p[u]=void 0;var m=!0}catch{}var y=a.call(p);return m&&(h?p[u]=f:delete p[u]),y}t.exports=c}),AC=We((e,t)=>{O();var i=Object.prototype,r=i.toString;function o(a){return r.call(a)}t.exports=o}),SC=We((e,t)=>{O();var i=md(),r=PC(),o=AC(),a="[object Null]",u="[object Undefined]",c=i?i.toStringTag:void 0;function p(h){return h==null?h===void 0?u:a:c&&c in Object(h)?r(h):o(h)}t.exports=p}),OC=We((e,t)=>{O();function i(r){return r!=null&&typeof r=="object"}t.exports=i}),TC=We((e,t)=>{O();var i=SC(),r=OC(),o="[object Symbol]";function a(u){return typeof u=="symbol"||r(u)&&i(u)==o}t.exports=a}),xC=We((e,t)=>{O();var i=EC(),r=al(),o=TC(),a=NaN,u=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,p=/^0o[0-7]+$/i,h=parseInt;function f(m){if(typeof m=="number")return m;if(o(m))return a;if(r(m)){var y=typeof m.valueOf=="function"?m.valueOf():m;m=r(y)?y+"":y}if(typeof m!="string")return m===0?m:+m;m=i(m);var g=c.test(m);return g||p.test(m)?h(m.slice(2),g?2:8):u.test(m)?a:+m}t.exports=f}),kC=We((e,t)=>{O();var i=al(),r=_C(),o=xC(),a="Expected a function",u=Math.max,c=Math.min;function p(h,f,m){var y,g,_,E,R,N,j=0,U=!1,K=!1,ie=!0;if(typeof h!="function")throw new TypeError(a);f=o(f)||0,i(m)&&(U=!!m.leading,K="maxWait"in m,_=K?u(o(m.maxWait)||0,f):_,ie="trailing"in m?!!m.trailing:ie);function we(Ee){var V=y,ve=g;return y=g=void 0,j=Ee,E=h.apply(ve,V),E}function pe(Ee){return j=Ee,R=setTimeout(Oe,f),U?we(Ee):E}function Se(Ee){var V=Ee-N,ve=Ee-j,oe=f-V;return K?c(oe,_-ve):oe}function Le(Ee){var V=Ee-N,ve=Ee-j;return N===void 0||V>=f||V<0||K&&ve>=_}function Oe(){var Ee=r();if(Le(Ee))return xe(Ee);R=setTimeout(Oe,Se(Ee))}function xe(Ee){return R=void 0,ie&&y?we(Ee):(y=g=void 0,E)}function it(){R!==void 0&&clearTimeout(R),j=0,y=N=g=R=void 0}function fi(){return R===void 0?E:xe(r())}function pt(){var Ee=r(),V=Le(Ee);if(y=arguments,g=this,N=Ee,V){if(R===void 0)return pe(N);if(K)return clearTimeout(R),R=setTimeout(Oe,f),we(N)}return R===void 0&&(R=setTimeout(Oe,f)),E}return pt.cancel=it,pt.flush=fi,pt}t.exports=p}),vd=We((e,t)=>{O();var i=kC(),r=al(),o="Expected a function";function a(u,c,p){var h=!0,f=!0;if(typeof u!="function")throw new TypeError(o);return r(p)&&(h="leading"in p?!!p.leading:h,f="trailing"in p?!!p.trailing:f),i(u,c,{leading:h,maxWait:c,trailing:f})}t.exports=a}),IC=We((e,t)=>{O(),function(i,r){typeof e=="object"&&typeof t=="object"?t.exports=r():typeof define=="function"&&define.amd?define([],r):typeof e=="object"?e.bowser=r():i.bowser=r()}(e,function(){return function(i){var r={};function o(a){if(r[a])return r[a].exports;var u=r[a]={i:a,l:!1,exports:{}};return i[a].call(u.exports,u,u.exports,o),u.l=!0,u.exports}return o.m=i,o.c=r,o.d=function(a,u,c){o.o(a,u)||Object.defineProperty(a,u,{enumerable:!0,get:c})},o.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},o.t=function(a,u){if(1&u&&(a=o(a)),8&u||4&u&&typeof a=="object"&&a&&a.__esModule)return a;var c=Object.create(null);if(o.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:a}),2&u&&typeof a!="string")for(var p in a)o.d(c,p,(function(h){return a[h]}).bind(null,p));return c},o.n=function(a){var u=a&&a.__esModule?function(){return a.default}:function(){return a};return o.d(u,"a",u),u},o.o=function(a,u){return Object.prototype.hasOwnProperty.call(a,u)},o.p="",o(o.s=90)}({17:function(i,r,o){r.__esModule=!0,r.default=void 0;var a=o(18),u=function(){function c(){}return c.getFirstMatch=function(p,h){var f=h.match(p);return f&&f.length>0&&f[1]||""},c.getSecondMatch=function(p,h){var f=h.match(p);return f&&f.length>1&&f[2]||""},c.matchAndReturnConst=function(p,h,f){if(p.test(h))return f},c.getWindowsVersionName=function(p){switch(p){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},c.getMacOSVersionName=function(p){var h=p.split(".").splice(0,2).map(function(f){return parseInt(f,10)||0});if(h.push(0),h[0]===10)switch(h[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},c.getAndroidVersionName=function(p){var h=p.split(".").splice(0,2).map(function(f){return parseInt(f,10)||0});if(h.push(0),!(h[0]===1&&h[1]<5))return h[0]===1&&h[1]<6?"Cupcake":h[0]===1&&h[1]>=6?"Donut":h[0]===2&&h[1]<2?"Eclair":h[0]===2&&h[1]===2?"Froyo":h[0]===2&&h[1]>2?"Gingerbread":h[0]===3?"Honeycomb":h[0]===4&&h[1]<1?"Ice Cream Sandwich":h[0]===4&&h[1]<4?"Jelly Bean":h[0]===4&&h[1]>=4?"KitKat":h[0]===5?"Lollipop":h[0]===6?"Marshmallow":h[0]===7?"Nougat":h[0]===8?"Oreo":h[0]===9?"Pie":void 0},c.getVersionPrecision=function(p){return p.split(".").length},c.compareVersions=function(p,h,f){f===void 0&&(f=!1);var m=c.getVersionPrecision(p),y=c.getVersionPrecision(h),g=Math.max(m,y),_=0,E=c.map([p,h],function(R){var N=g-c.getVersionPrecision(R),j=R+new Array(N+1).join(".0");return c.map(j.split("."),function(U){return new Array(20-U.length).join("0")+U}).reverse()});for(f&&(_=g-Math.min(m,y)),g-=1;g>=_;){if(E[0][g]>E[1][g])return 1;if(E[0][g]===E[1][g]){if(g===_)return 0;g-=1}else if(E[0][g]<E[1][g])return-1}},c.map=function(p,h){var f,m=[];if(Array.prototype.map)return Array.prototype.map.call(p,h);for(f=0;f<p.length;f+=1)m.push(h(p[f]));return m},c.find=function(p,h){var f,m;if(Array.prototype.find)return Array.prototype.find.call(p,h);for(f=0,m=p.length;f<m;f+=1){var y=p[f];if(h(y,f))return y}},c.assign=function(p){for(var h,f,m=p,y=arguments.length,g=new Array(y>1?y-1:0),_=1;_<y;_++)g[_-1]=arguments[_];if(Object.assign)return Object.assign.apply(Object,[p].concat(g));var E=function(){var R=g[h];typeof R=="object"&&R!==null&&Object.keys(R).forEach(function(N){m[N]=R[N]})};for(h=0,f=g.length;h<f;h+=1)E();return p},c.getBrowserAlias=function(p){return a.BROWSER_ALIASES_MAP[p]},c.getBrowserTypeByAlias=function(p){return a.BROWSER_MAP[p]||""},c}();r.default=u,i.exports=r.default},18:function(i,r,o){r.__esModule=!0,r.ENGINE_MAP=r.OS_MAP=r.PLATFORMS_MAP=r.BROWSER_MAP=r.BROWSER_ALIASES_MAP=void 0,r.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},r.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},r.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},r.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},r.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(i,r,o){r.__esModule=!0,r.default=void 0;var a,u=(a=o(91))&&a.__esModule?a:{default:a},c=o(18);function p(f,m){for(var y=0;y<m.length;y++){var g=m[y];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}var h=function(){function f(){}var m,y,g;return f.getParser=function(_,E){if(E===void 0&&(E=!1),typeof _!="string")throw new Error("UserAgent should be a string");return new u.default(_,E)},f.parse=function(_){return new u.default(_).getResult()},m=f,g=[{key:"BROWSER_MAP",get:function(){return c.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return c.ENGINE_MAP}},{key:"OS_MAP",get:function(){return c.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return c.PLATFORMS_MAP}}],(y=null)&&p(m.prototype,y),g&&p(m,g),f}();r.default=h,i.exports=r.default},91:function(i,r,o){r.__esModule=!0,r.default=void 0;var a=f(o(92)),u=f(o(93)),c=f(o(94)),p=f(o(95)),h=f(o(17));function f(y){return y&&y.__esModule?y:{default:y}}var m=function(){function y(_,E){if(E===void 0&&(E=!1),_==null||_==="")throw new Error("UserAgent parameter can't be empty");this._ua=_,this.parsedResult={},E!==!0&&this.parse()}var g=y.prototype;return g.getUA=function(){return this._ua},g.test=function(_){return _.test(this._ua)},g.parseBrowser=function(){var _=this;this.parsedResult.browser={};var E=h.default.find(a.default,function(R){if(typeof R.test=="function")return R.test(_);if(R.test instanceof Array)return R.test.some(function(N){return _.test(N)});throw new Error("Browser's test function is not valid")});return E&&(this.parsedResult.browser=E.describe(this.getUA())),this.parsedResult.browser},g.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},g.getBrowserName=function(_){return _?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},g.getBrowserVersion=function(){return this.getBrowser().version},g.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},g.parseOS=function(){var _=this;this.parsedResult.os={};var E=h.default.find(u.default,function(R){if(typeof R.test=="function")return R.test(_);if(R.test instanceof Array)return R.test.some(function(N){return _.test(N)});throw new Error("Browser's test function is not valid")});return E&&(this.parsedResult.os=E.describe(this.getUA())),this.parsedResult.os},g.getOSName=function(_){var E=this.getOS().name;return _?String(E).toLowerCase()||"":E||""},g.getOSVersion=function(){return this.getOS().version},g.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},g.getPlatformType=function(_){_===void 0&&(_=!1);var E=this.getPlatform().type;return _?String(E).toLowerCase()||"":E||""},g.parsePlatform=function(){var _=this;this.parsedResult.platform={};var E=h.default.find(c.default,function(R){if(typeof R.test=="function")return R.test(_);if(R.test instanceof Array)return R.test.some(function(N){return _.test(N)});throw new Error("Browser's test function is not valid")});return E&&(this.parsedResult.platform=E.describe(this.getUA())),this.parsedResult.platform},g.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},g.getEngineName=function(_){return _?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},g.parseEngine=function(){var _=this;this.parsedResult.engine={};var E=h.default.find(p.default,function(R){if(typeof R.test=="function")return R.test(_);if(R.test instanceof Array)return R.test.some(function(N){return _.test(N)});throw new Error("Browser's test function is not valid")});return E&&(this.parsedResult.engine=E.describe(this.getUA())),this.parsedResult.engine},g.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},g.getResult=function(){return h.default.assign({},this.parsedResult)},g.satisfies=function(_){var E=this,R={},N=0,j={},U=0;if(Object.keys(_).forEach(function(xe){var it=_[xe];typeof it=="string"?(j[xe]=it,U+=1):typeof it=="object"&&(R[xe]=it,N+=1)}),N>0){var K=Object.keys(R),ie=h.default.find(K,function(xe){return E.isOS(xe)});if(ie){var we=this.satisfies(R[ie]);if(we!==void 0)return we}var pe=h.default.find(K,function(xe){return E.isPlatform(xe)});if(pe){var Se=this.satisfies(R[pe]);if(Se!==void 0)return Se}}if(U>0){var Le=Object.keys(j),Oe=h.default.find(Le,function(xe){return E.isBrowser(xe,!0)});if(Oe!==void 0)return this.compareVersion(j[Oe])}},g.isBrowser=function(_,E){E===void 0&&(E=!1);var R=this.getBrowserName().toLowerCase(),N=_.toLowerCase(),j=h.default.getBrowserTypeByAlias(N);return E&&j&&(N=j.toLowerCase()),N===R},g.compareVersion=function(_){var E=[0],R=_,N=!1,j=this.getBrowserVersion();if(typeof j=="string")return _[0]===">"||_[0]==="<"?(R=_.substr(1),_[1]==="="?(N=!0,R=_.substr(2)):E=[],_[0]===">"?E.push(1):E.push(-1)):_[0]==="="?R=_.substr(1):_[0]==="~"&&(N=!0,R=_.substr(1)),E.indexOf(h.default.compareVersions(j,R,N))>-1},g.isOS=function(_){return this.getOSName(!0)===String(_).toLowerCase()},g.isPlatform=function(_){return this.getPlatformType(!0)===String(_).toLowerCase()},g.isEngine=function(_){return this.getEngineName(!0)===String(_).toLowerCase()},g.is=function(_,E){return E===void 0&&(E=!1),this.isBrowser(_,E)||this.isOS(_)||this.isPlatform(_)},g.some=function(_){var E=this;return _===void 0&&(_=[]),_.some(function(R){return E.is(R)})},y}();r.default=m,i.exports=r.default},92:function(i,r,o){r.__esModule=!0,r.default=void 0;var a,u=(a=o(17))&&a.__esModule?a:{default:a},c=/version\/(\d+(\.?_?\d+)+)/i,p=[{test:[/googlebot/i],describe:function(h){var f={name:"Googlebot"},m=u.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,h)||u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/opera/i],describe:function(h){var f={name:"Opera"},m=u.default.getFirstMatch(c,h)||u.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/opr\/|opios/i],describe:function(h){var f={name:"Opera"},m=u.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,h)||u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/SamsungBrowser/i],describe:function(h){var f={name:"Samsung Internet for Android"},m=u.default.getFirstMatch(c,h)||u.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/Whale/i],describe:function(h){var f={name:"NAVER Whale Browser"},m=u.default.getFirstMatch(c,h)||u.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/MZBrowser/i],describe:function(h){var f={name:"MZ Browser"},m=u.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,h)||u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/focus/i],describe:function(h){var f={name:"Focus"},m=u.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,h)||u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/swing/i],describe:function(h){var f={name:"Swing"},m=u.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,h)||u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/coast/i],describe:function(h){var f={name:"Opera Coast"},m=u.default.getFirstMatch(c,h)||u.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(h){var f={name:"Opera Touch"},m=u.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,h)||u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/yabrowser/i],describe:function(h){var f={name:"Yandex Browser"},m=u.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,h)||u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/ucbrowser/i],describe:function(h){var f={name:"UC Browser"},m=u.default.getFirstMatch(c,h)||u.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/Maxthon|mxios/i],describe:function(h){var f={name:"Maxthon"},m=u.default.getFirstMatch(c,h)||u.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/epiphany/i],describe:function(h){var f={name:"Epiphany"},m=u.default.getFirstMatch(c,h)||u.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/puffin/i],describe:function(h){var f={name:"Puffin"},m=u.default.getFirstMatch(c,h)||u.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/sleipnir/i],describe:function(h){var f={name:"Sleipnir"},m=u.default.getFirstMatch(c,h)||u.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/k-meleon/i],describe:function(h){var f={name:"K-Meleon"},m=u.default.getFirstMatch(c,h)||u.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/micromessenger/i],describe:function(h){var f={name:"WeChat"},m=u.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,h)||u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/qqbrowser/i],describe:function(h){var f={name:/qqbrowserlite/i.test(h)?"QQ Browser Lite":"QQ Browser"},m=u.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,h)||u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/msie|trident/i],describe:function(h){var f={name:"Internet Explorer"},m=u.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/\sedg\//i],describe:function(h){var f={name:"Microsoft Edge"},m=u.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/edg([ea]|ios)/i],describe:function(h){var f={name:"Microsoft Edge"},m=u.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/vivaldi/i],describe:function(h){var f={name:"Vivaldi"},m=u.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/seamonkey/i],describe:function(h){var f={name:"SeaMonkey"},m=u.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/sailfish/i],describe:function(h){var f={name:"Sailfish"},m=u.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,h);return m&&(f.version=m),f}},{test:[/silk/i],describe:function(h){var f={name:"Amazon Silk"},m=u.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/phantom/i],describe:function(h){var f={name:"PhantomJS"},m=u.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/slimerjs/i],describe:function(h){var f={name:"SlimerJS"},m=u.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(h){var f={name:"BlackBerry"},m=u.default.getFirstMatch(c,h)||u.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/(web|hpw)[o0]s/i],describe:function(h){var f={name:"WebOS Browser"},m=u.default.getFirstMatch(c,h)||u.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/bada/i],describe:function(h){var f={name:"Bada"},m=u.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/tizen/i],describe:function(h){var f={name:"Tizen"},m=u.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,h)||u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/qupzilla/i],describe:function(h){var f={name:"QupZilla"},m=u.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,h)||u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/firefox|iceweasel|fxios/i],describe:function(h){var f={name:"Firefox"},m=u.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/electron/i],describe:function(h){var f={name:"Electron"},m=u.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/MiuiBrowser/i],describe:function(h){var f={name:"Miui"},m=u.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/chromium/i],describe:function(h){var f={name:"Chromium"},m=u.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,h)||u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/chrome|crios|crmo/i],describe:function(h){var f={name:"Chrome"},m=u.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/GSA/i],describe:function(h){var f={name:"Google Search"},m=u.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:function(h){var f=!h.test(/like android/i),m=h.test(/android/i);return f&&m},describe:function(h){var f={name:"Android Browser"},m=u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/playstation 4/i],describe:function(h){var f={name:"PlayStation 4"},m=u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/safari|applewebkit/i],describe:function(h){var f={name:"Safari"},m=u.default.getFirstMatch(c,h);return m&&(f.version=m),f}},{test:[/.*/i],describe:function(h){var f=h.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:u.default.getFirstMatch(f,h),version:u.default.getSecondMatch(f,h)}}}];r.default=p,i.exports=r.default},93:function(i,r,o){r.__esModule=!0,r.default=void 0;var a,u=(a=o(17))&&a.__esModule?a:{default:a},c=o(18),p=[{test:[/Roku\/DVP/],describe:function(h){var f=u.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,h);return{name:c.OS_MAP.Roku,version:f}}},{test:[/windows phone/i],describe:function(h){var f=u.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,h);return{name:c.OS_MAP.WindowsPhone,version:f}}},{test:[/windows /i],describe:function(h){var f=u.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,h),m=u.default.getWindowsVersionName(f);return{name:c.OS_MAP.Windows,version:f,versionName:m}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(h){var f={name:c.OS_MAP.iOS},m=u.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,h);return m&&(f.version=m),f}},{test:[/macintosh/i],describe:function(h){var f=u.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,h).replace(/[_\s]/g,"."),m=u.default.getMacOSVersionName(f),y={name:c.OS_MAP.MacOS,version:f};return m&&(y.versionName=m),y}},{test:[/(ipod|iphone|ipad)/i],describe:function(h){var f=u.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,h).replace(/[_\s]/g,".");return{name:c.OS_MAP.iOS,version:f}}},{test:function(h){var f=!h.test(/like android/i),m=h.test(/android/i);return f&&m},describe:function(h){var f=u.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,h),m=u.default.getAndroidVersionName(f),y={name:c.OS_MAP.Android,version:f};return m&&(y.versionName=m),y}},{test:[/(web|hpw)[o0]s/i],describe:function(h){var f=u.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,h),m={name:c.OS_MAP.WebOS};return f&&f.length&&(m.version=f),m}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(h){var f=u.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,h)||u.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,h)||u.default.getFirstMatch(/\bbb(\d+)/i,h);return{name:c.OS_MAP.BlackBerry,version:f}}},{test:[/bada/i],describe:function(h){var f=u.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,h);return{name:c.OS_MAP.Bada,version:f}}},{test:[/tizen/i],describe:function(h){var f=u.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,h);return{name:c.OS_MAP.Tizen,version:f}}},{test:[/linux/i],describe:function(){return{name:c.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:c.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(h){var f=u.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,h);return{name:c.OS_MAP.PlayStation4,version:f}}}];r.default=p,i.exports=r.default},94:function(i,r,o){r.__esModule=!0,r.default=void 0;var a,u=(a=o(17))&&a.__esModule?a:{default:a},c=o(18),p=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(h){var f=u.default.getFirstMatch(/(can-l01)/i,h)&&"Nova",m={type:c.PLATFORMS_MAP.mobile,vendor:"Huawei"};return f&&(m.model=f),m}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:c.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:c.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:c.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:c.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:c.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:c.PLATFORMS_MAP.tablet}}},{test:function(h){var f=h.test(/ipod|iphone/i),m=h.test(/like (ipod|iphone)/i);return f&&!m},describe:function(h){var f=u.default.getFirstMatch(/(ipod|iphone)/i,h);return{type:c.PLATFORMS_MAP.mobile,vendor:"Apple",model:f}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:c.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:c.PLATFORMS_MAP.mobile}}},{test:function(h){return h.getBrowserName(!0)==="blackberry"},describe:function(){return{type:c.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(h){return h.getBrowserName(!0)==="bada"},describe:function(){return{type:c.PLATFORMS_MAP.mobile}}},{test:function(h){return h.getBrowserName()==="windows phone"},describe:function(){return{type:c.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(h){var f=Number(String(h.getOSVersion()).split(".")[0]);return h.getOSName(!0)==="android"&&f>=3},describe:function(){return{type:c.PLATFORMS_MAP.tablet}}},{test:function(h){return h.getOSName(!0)==="android"},describe:function(){return{type:c.PLATFORMS_MAP.mobile}}},{test:function(h){return h.getOSName(!0)==="macos"},describe:function(){return{type:c.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(h){return h.getOSName(!0)==="windows"},describe:function(){return{type:c.PLATFORMS_MAP.desktop}}},{test:function(h){return h.getOSName(!0)==="linux"},describe:function(){return{type:c.PLATFORMS_MAP.desktop}}},{test:function(h){return h.getOSName(!0)==="playstation 4"},describe:function(){return{type:c.PLATFORMS_MAP.tv}}},{test:function(h){return h.getOSName(!0)==="roku"},describe:function(){return{type:c.PLATFORMS_MAP.tv}}}];r.default=p,i.exports=r.default},95:function(i,r,o){r.__esModule=!0,r.default=void 0;var a,u=(a=o(17))&&a.__esModule?a:{default:a},c=o(18),p=[{test:function(h){return h.getBrowserName(!0)==="microsoft edge"},describe:function(h){if(/\sedg\//i.test(h))return{name:c.ENGINE_MAP.Blink};var f=u.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,h);return{name:c.ENGINE_MAP.EdgeHTML,version:f}}},{test:[/trident/i],describe:function(h){var f={name:c.ENGINE_MAP.Trident},m=u.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:function(h){return h.test(/presto/i)},describe:function(h){var f={name:c.ENGINE_MAP.Presto},m=u.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:function(h){var f=h.test(/gecko/i),m=h.test(/like gecko/i);return f&&!m},describe:function(h){var f={name:c.ENGINE_MAP.Gecko},m=u.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:c.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(h){var f={name:c.ENGINE_MAP.WebKit},m=u.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,h);return m&&(f.version=m),f}}];r.default=p,i.exports=r.default}})})});O();O();var ph=Wt(pd());O();var gd=(e=>(e.svPrimary="sv-primary",e.svPrimary900="sv-primary-900",e.svPrimary200="sv-primary-200",e.svSecondary="sv-secondary",e.svGray="sv-gray",e.svSuccess="sv-success",e.svDanger="sv-danger",e.svBlack="sv-black",e.svWhite="sv-white",e.svGray100="sv-gray-100",e.svGray200="sv-gray-200",e.svGray300="sv-gray-300",e.svGray400="sv-gray-400",e.svGray500="sv-gray-500",e.svGray600="sv-gray-600",e.svGray700="sv-gray-700",e.svGray800="sv-gray-800",e))(gd||{});O();O();O();O();var qe=(e,t,i,...r)=>ue(void 0,[e,t,i,...r],function*(o,a,u,c={}){let p=yield fetch(o,{method:a,headers:B({"Content-Type":"application/json"},c),body:u?JSON.stringify(u):null});if(!p.ok)throw p;try{return yield p.json()}catch{return p.ok}});O();var MC=Wt(pd()),He=class{constructor(e){this.debug=(0,MC.default)(e)}log(e,...t){this.debug(e,...t)}};O();O();var RC=Wt(vd()),$e=class{constructor(e={}){this.subscribe=r=>{this.callbacks.push(r)},this.unsubscribe=r=>{this.callbacks=this.callbacks.filter(o=>o!==r)},this.publish=(...r)=>{this.callbacks&&this.callbacks.forEach(o=>{this.callListener(o,r).catch(a=>{var u;(u=this.logger)==null||u.log("superviz-sdk:observer-helper:publish:error",`
            Failed to execute callback on publish value.
            Callback: ${o.name}
            Event: ${JSON.stringify(r)}
            Error: ${a}
          `)})})},this.reset=()=>{this.callbacks=[]},this.destroy=()=>{delete this.logger,delete this.callbacks},this.callListener=(r,o)=>new Promise((a,u)=>{try{let c=r(...o);a(c)}catch(c){u(c)}});let{logger:t,throttleTime:i}=e;this.logger=t||new He("@superviz/sdk/observer-helper"),this.throttle=i,this.callbacks=[],this.throttle&&(this.publish=(0,RC.default)(this.publish,this.throttle))}},ll=class{constructor(){this.observers={},this.subscribe=(e,t)=>{this.logger.log(`subscribed to ${e} event`),this.observers[e]||(this.observers[e]=new $e({logger:this.logger})),this.observers[e].subscribe(t)},this.unsubscribe=(e,t)=>{if(this.logger.log(`unsubscribed from ${e} event`),!!this.observers[e]){if(!t){this.observers[e].destroy(),delete this.observers[e];return}this.observers[e].unsubscribe(t)}},this.publish=(e,t)=>{e in this.observers&&this.observers[e].publish(t)}}};O();var Qe=class{static createUrl(e,t,i={}){let r=new URL(t,e);return Object.keys(i).forEach(o=>r.searchParams.append(o,i[o])),r.toString()}static validateApiKey(e,t){let i=this.createUrl(e,"/user/checkapikey");return qe(i,"POST",{apiKey:t})}static fetchConfig(e,t){let i=this.createUrl(e,"/immersive-config");return qe(i,"POST",{apiKey:t})}static fetchLimits(e,t){return ue(this,null,function*(){let i=this.createUrl(e,"/user/check_limits_v2");return(yield qe(i,"GET","",{apikey:t})).limits})}static fetchWaterMark(e,t){return ue(this,null,function*(){let i=this.createUrl(e,"/user/watermark"),{message:r}=yield qe(i,"POST",{apiKey:t});return r})}static createAnnotations(e,t,i){return ue(this,null,function*(){let r=this.createUrl(e,"/annotations");return qe(r,"POST",B({},i),{apikey:t})})}static updateComment(e,t,i,r){return ue(this,null,function*(){let o=`/comments/${i}`,a=this.createUrl(e,o);return qe(a,"PUT",{text:r},{apikey:t})})}static createComment(e,t,i){return ue(this,null,function*(){let r=this.createUrl(e,"/comments");return qe(r,"POST",B({},i),{apikey:t})})}static fetchAnnotation(e,t,i){return ue(this,null,function*(){let r=this.createUrl(e,"/annotations",{roomId:i.roomId});return qe(r,"GET",void 0,{apikey:t})})}static resolveAnnotation(e,t,i){return ue(this,null,function*(){let r=`/annotations/resolve/${i}`,o=this.createUrl(e,r);return qe(o,"POST",{},{apikey:t})})}static deleteComment(e,t,i){return ue(this,null,function*(){let r=`/comments/${i}`,o=this.createUrl(e,r);return qe(o,"DELETE",{},{apikey:t})})}static deleteAnnotation(e,t,i){return ue(this,null,function*(){let r=`/annotations/${i}`,o=this.createUrl(e,r);return qe(o,"DELETE",{},{apikey:t})})}static createParticipant(e){return ue(this,null,function*(){let t=Q.get("apiUrl"),i=this.createUrl(t,"/participants");return qe(i,"POST",B({},e),{apikey:Q.get("apiKey")})})}static fetchParticipant(e){return ue(this,null,function*(){let t=Q.get("apiUrl"),i=`/participants/${e}`,r=this.createUrl(t,i);return qe(r,"GET",void 0,{apikey:Q.get("apiKey")})})}static sendActivity(e,t,i,r){return ue(this,null,function*(){let o="/activity",a=Q.get("apiUrl"),u=Q.get("roomId"),c=Q.get("apiKey"),p=this.createUrl(a,o);return qe(p,"POST",{groupId:t,groupName:i,meetingId:u,product:r,userId:e},{apikey:c})})}static fetchParticipantsByGroup(e){return ue(this,null,function*(){let t=`/groups/participants/${e}`,i=Q.get("apiUrl"),r=this.createUrl(i,t,{take:1e4});return qe(r,"GET",void 0,{apikey:Q.get("apiKey")})})}static createMentions(e){return ue(this,null,function*(){let t="/mentions",i=Q.get("apiUrl"),r=this.createUrl(i,t);return qe(r,"POST",e,{apikey:Q.get("apiKey")})})}};O();function FC(e,t){return ue(this,null,function*(){try{return(yield Qe.validateApiKey(e,t))===!0}catch(i){if(i.status===404)return!1;throw new Error("Unable to validate API key")}})}var LC=FC;O();var NC="6.7.1-beta.1",Ta=class{static getRemoteConfig(){return ue(this,arguments,function*(e="prod"){if(e==="local")return(yield Promise.resolve().then(()=>require("./.remote-config-W6AJZY5U-BDD6GdAX.cjs"))).default.remoteConfig;let t={version:NC,environment:e},i=this.createUrl(t);return qe(i,"GET",null)})}static getFeatures(e){return ue(this,null,function*(){return qe(`${this.REMOTE_CONFIG_BASE_URL}/features/${e}`,"GET",void 0)})}static createUrl({version:e,environment:t}){return`${this.REMOTE_CONFIG_BASE_URL}/sdk/${e}?env=${t}`}};Ta.REMOTE_CONFIG_BASE_URL="https://remote-config.superviz.com";O();O();var DC=Object.create,$s=Object.defineProperty,jC=Object.defineProperties,BC=Object.getOwnPropertyDescriptor,UC=Object.getOwnPropertyDescriptors,$C=Object.getOwnPropertyNames,fh=Object.getOwnPropertySymbols,zC=Object.getPrototypeOf,yd=Object.prototype.hasOwnProperty,WC=Object.prototype.propertyIsEnumerable,mh=(e,t,i)=>t in e?$s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,k=(e,t)=>{for(var i in t||(t={}))yd.call(t,i)&&mh(e,i,t[i]);if(fh)for(var i of fh(t))WC.call(t,i)&&mh(e,i,t[i]);return e},ee=(e,t)=>jC(e,UC(t)),ul=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),VC=(e,t)=>{for(var i in t)$s(e,i,{get:t[i],enumerable:!0})},GC=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of $C(t))!yd.call(e,o)&&o!==i&&$s(e,o,{get:()=>t[o],enumerable:!(r=BC(t,o))||r.enumerable});return e},ZC=(e,t,i)=>(i=e!=null?DC(zC(e)):{},GC(!e||!e.__esModule?$s(i,"default",{value:e,enumerable:!0}):i,e)),di=(e,t,i)=>new Promise((r,o)=>{var a=p=>{try{c(i.next(p))}catch(h){o(h)}},u=p=>{try{c(i.throw(p))}catch(h){o(h)}},c=p=>p.done?r(p.value):Promise.resolve(p.value).then(a,u);c((i=i.apply(e,t)).next())}),JC=ul((e,t)=>{var i=1e3,r=i*60,o=r*60,a=o*24,u=a*7,c=a*365.25;t.exports=function(y,g){g=g||{};var _=typeof y;if(_==="string"&&y.length>0)return p(y);if(_==="number"&&isFinite(y))return g.long?f(y):h(y);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(y))};function p(y){if(y=String(y),!(y.length>100)){var g=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);if(g){var _=parseFloat(g[1]),E=(g[2]||"ms").toLowerCase();switch(E){case"years":case"year":case"yrs":case"yr":case"y":return _*c;case"weeks":case"week":case"w":return _*u;case"days":case"day":case"d":return _*a;case"hours":case"hour":case"hrs":case"hr":case"h":return _*o;case"minutes":case"minute":case"mins":case"min":case"m":return _*r;case"seconds":case"second":case"secs":case"sec":case"s":return _*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return _;default:return}}}}function h(y){var g=Math.abs(y);return g>=a?Math.round(y/a)+"d":g>=o?Math.round(y/o)+"h":g>=r?Math.round(y/r)+"m":g>=i?Math.round(y/i)+"s":y+"ms"}function f(y){var g=Math.abs(y);return g>=a?m(y,g,a,"day"):g>=o?m(y,g,o,"hour"):g>=r?m(y,g,r,"minute"):g>=i?m(y,g,i,"second"):y+" ms"}function m(y,g,_,E){var R=g>=_*1.5;return Math.round(y/_)+" "+E+(R?"s":"")}}),qC=ul((e,t)=>{function i(r){a.debug=a,a.default=a,a.coerce=m,a.disable=p,a.enable=c,a.enabled=h,a.humanize=JC(),a.destroy=y,Object.keys(r).forEach(g=>{a[g]=r[g]}),a.names=[],a.skips=[],a.formatters={};function o(g){let _=0;for(let E=0;E<g.length;E++)_=(_<<5)-_+g.charCodeAt(E),_|=0;return a.colors[Math.abs(_)%a.colors.length]}a.selectColor=o;function a(g){let _,E=null,R,N;function j(...U){if(!j.enabled)return;let K=j,ie=Number(new Date),we=ie-(_||ie);K.diff=we,K.prev=_,K.curr=ie,_=ie,U[0]=a.coerce(U[0]),typeof U[0]!="string"&&U.unshift("%O");let pe=0;U[0]=U[0].replace(/%([a-zA-Z%])/g,(Se,Le)=>{if(Se==="%%")return"%";pe++;let Oe=a.formatters[Le];if(typeof Oe=="function"){let xe=U[pe];Se=Oe.call(K,xe),U.splice(pe,1),pe--}return Se}),a.formatArgs.call(K,U),(K.log||a.log).apply(K,U)}return j.namespace=g,j.useColors=a.useColors(),j.color=a.selectColor(g),j.extend=u,j.destroy=a.destroy,Object.defineProperty(j,"enabled",{enumerable:!0,configurable:!1,get:()=>E!==null?E:(R!==a.namespaces&&(R=a.namespaces,N=a.enabled(g)),N),set:U=>{E=U}}),typeof a.init=="function"&&a.init(j),j}function u(g,_){let E=a(this.namespace+(typeof _>"u"?":":_)+g);return E.log=this.log,E}function c(g){a.save(g),a.namespaces=g,a.names=[],a.skips=[];let _,E=(typeof g=="string"?g:"").split(/[\s,]+/),R=E.length;for(_=0;_<R;_++)E[_]&&(g=E[_].replace(/\*/g,".*?"),g[0]==="-"?a.skips.push(new RegExp("^"+g.slice(1)+"$")):a.names.push(new RegExp("^"+g+"$")))}function p(){let g=[...a.names.map(f),...a.skips.map(f).map(_=>"-"+_)].join(",");return a.enable(""),g}function h(g){if(g[g.length-1]==="*")return!0;let _,E;for(_=0,E=a.skips.length;_<E;_++)if(a.skips[_].test(g))return!1;for(_=0,E=a.names.length;_<E;_++)if(a.names[_].test(g))return!0;return!1}function f(g){return g.toString().substring(2,g.toString().length-2).replace(/\.\*\?$/,"*")}function m(g){return g instanceof Error?g.stack||g.message:g}function y(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return a.enable(a.load()),a}t.exports=i}),HC=ul((e,t)=>{e.formatArgs=r,e.save=o,e.load=a,e.useColors=i,e.storage=u(),e.destroy=(()=>{let p=!1;return()=>{p||(p=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function i(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let p;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(p=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(p[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(p){if(p[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+p[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;let h="color: "+this.color;p.splice(1,0,h,"color: inherit");let f=0,m=0;p[0].replace(/%[a-zA-Z%]/g,y=>{y!=="%%"&&(f++,y==="%c"&&(m=f))}),p.splice(m,0,h)}e.log=console.debug||console.log||(()=>{});function o(p){try{p?e.storage.setItem("debug",p):e.storage.removeItem("debug")}catch{}}function a(){let p;try{p=e.storage.getItem("debug")}catch{}return!p&&typeof process<"u"&&"env"in process&&(p=Xa.DEBUG),p}function u(){try{return localStorage}catch{}}t.exports=qC()(e);var{formatters:c}=t.exports;c.j=function(p){try{return JSON.stringify(p)}catch(h){return"[UnexpectedJSONParseError]: "+h.message}}}),KC=(e=>(e.JOIN_ROOM="room.join",e.JOINED_ROOM="room.joined",e.LEAVE_ROOM="room.leave",e.UPDATE="room.update",e.ERROR="room.error",e))(KC||{}),X=(e=>(e.JOINED_ROOM="presence.joined-room",e.LEAVE="presence.leave",e.UPDATE="presence.update",e))(X||{}),bd=(e=>(e.CONNECTED="CONNECTED",e.CONNECTING="CONNECTING",e.DISCONNECTED="DISCONNECTED",e.CONNECTION_ERROR="CONNECTION_ERROR",e.RECONNECTING="RECONNECTING",e.RECONNECT_ERROR="RECONNECT_ERROR",e))(bd||{}),xa=function(e,t){return xa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=r[o])},xa(e,t)};function zs(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");xa(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}function ka(e){var t=typeof Symbol=="function"&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ia(e,t){var i=typeof Symbol=="function"&&e[Symbol.iterator];if(!i)return e;var r=i.call(e),o,a=[],u;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)a.push(o.value)}catch(c){u={error:c}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(u)throw u.error}}return a}function Ma(e,t,i){if(arguments.length===2)for(var r=0,o=t.length,a;r<o;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function ci(e){return typeof e=="function"}function wd(e){var t=function(r){Error.call(r),r.stack=new Error().stack},i=e(t);return i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,i}var va=wd(function(e){return function(t){e(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(i,r){return r+1+") "+i.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function Ra(e,t){if(e){var i=e.indexOf(t);0<=i&&e.splice(i,1)}}var Ws=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,i,r,o,a;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var c=ka(u),p=c.next();!p.done;p=c.next()){var h=p.value;h.remove(this)}}catch(E){t={error:E}}finally{try{p&&!p.done&&(i=c.return)&&i.call(c)}finally{if(t)throw t.error}}else u.remove(this);var f=this.initialTeardown;if(ci(f))try{f()}catch(E){a=E instanceof va?E.errors:[E]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var y=ka(m),g=y.next();!g.done;g=y.next()){var _=g.value;try{vh(_)}catch(E){a=a??[],E instanceof va?a=Ma(Ma([],Ia(a)),Ia(E.errors)):a.push(E)}}}catch(E){r={error:E}}finally{try{g&&!g.done&&(o=y.return)&&o.call(y)}finally{if(r)throw r.error}}}if(a)throw new va(a)}},e.prototype.add=function(t){var i;if(t&&t!==this)if(this.closed)vh(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(i=this._finalizers)!==null&&i!==void 0?i:[]).push(t)}},e.prototype._hasParent=function(t){var i=this._parentage;return i===t||Array.isArray(i)&&i.includes(t)},e.prototype._addParent=function(t){var i=this._parentage;this._parentage=Array.isArray(i)?(i.push(t),i):i?[i,t]:t},e.prototype._removeParent=function(t){var i=this._parentage;i===t?this._parentage=null:Array.isArray(i)&&Ra(i,t)},e.prototype.remove=function(t){var i=this._finalizers;i&&Ra(i,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),_d=Ws.EMPTY;function Cd(e){return e instanceof Ws||e&&"closed"in e&&ci(e.remove)&&ci(e.add)&&ci(e.unsubscribe)}function vh(e){ci(e)?e():e.unsubscribe()}var Ed={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},YC={setTimeout:function(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return setTimeout.apply(void 0,Ma([e,t],Ia(i)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function QC(e){YC.setTimeout(function(){throw e})}function gh(){}function ws(e){e()}var Pd=function(e){zs(t,e);function t(i){var r=e.call(this)||this;return r.isStopped=!1,i?(r.destination=i,Cd(i)&&i.add(r)):r.destination=iE,r}return t.create=function(i,r,o){return new Fa(i,r,o)},t.prototype.next=function(i){this.isStopped?void 0:this._next(i)},t.prototype.error=function(i){this.isStopped?void 0:(this.isStopped=!0,this._error(i))},t.prototype.complete=function(){this.isStopped?void 0:(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(i){this.destination.next(i)},t.prototype._error=function(i){try{this.destination.error(i)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Ws),XC=Function.prototype.bind;function ga(e,t){return XC.call(e,t)}var eE=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var i=this.partialObserver;if(i.next)try{i.next(t)}catch(r){ds(r)}},e.prototype.error=function(t){var i=this.partialObserver;if(i.error)try{i.error(t)}catch(r){ds(r)}else ds(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(i){ds(i)}},e}(),Fa=function(e){zs(t,e);function t(i,r,o){var a=e.call(this)||this,u;if(ci(i)||!i)u={next:i??void 0,error:r??void 0,complete:o??void 0};else{var c;a&&Ed.useDeprecatedNextContext?(c=Object.create(i),c.unsubscribe=function(){return a.unsubscribe()},u={next:i.next&&ga(i.next,c),error:i.error&&ga(i.error,c),complete:i.complete&&ga(i.complete,c)}):u=i}return a.destination=new eE(u),a}return t}(Pd);function ds(e){QC(e)}function tE(e){throw e}var iE={closed:!0,next:gh,error:tE,complete:gh},nE=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function rE(e){return e}function sE(e){return e.length===0?rE:e.length===1?e[0]:function(t){return e.reduce(function(i,r){return r(i)},t)}}var yh=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var i=new e;return i.source=this,i.operator=t,i},e.prototype.subscribe=function(t,i,r){var o=this,a=aE(t)?t:new Fa(t,i,r);return ws(function(){var u=o,c=u.operator,p=u.source;a.add(c?c.call(a,p):p?o._subscribe(a):o._trySubscribe(a))}),a},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(i){t.error(i)}},e.prototype.forEach=function(t,i){var r=this;return i=bh(i),new i(function(o,a){var u=new Fa({next:function(c){try{t(c)}catch(p){a(p),u.unsubscribe()}},error:a,complete:o});r.subscribe(u)})},e.prototype._subscribe=function(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)},e.prototype[nE]=function(){return this},e.prototype.pipe=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return sE(t)(this)},e.prototype.toPromise=function(t){var i=this;return t=bh(t),new t(function(r,o){var a;i.subscribe(function(u){return a=u},function(u){return o(u)},function(){return r(a)})})},e.create=function(t){return new e(t)},e}();function bh(e){var t;return(t=e??Ed.Promise)!==null&&t!==void 0?t:Promise}function oE(e){return e&&ci(e.next)&&ci(e.error)&&ci(e.complete)}function aE(e){return e&&e instanceof Pd||oE(e)&&Cd(e)}var lE=wd(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Jt=function(e){zs(t,e);function t(){var i=e.call(this)||this;return i.closed=!1,i.currentObservers=null,i.observers=[],i.isStopped=!1,i.hasError=!1,i.thrownError=null,i}return t.prototype.lift=function(i){var r=new wh(this,this);return r.operator=i,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new lE},t.prototype.next=function(i){var r=this;ws(function(){var o,a;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var u=ka(r.currentObservers),c=u.next();!c.done;c=u.next()){var p=c.value;p.next(i)}}catch(h){o={error:h}}finally{try{c&&!c.done&&(a=u.return)&&a.call(u)}finally{if(o)throw o.error}}}})},t.prototype.error=function(i){var r=this;ws(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=i;for(var o=r.observers;o.length;)o.shift().error(i)}})},t.prototype.complete=function(){var i=this;ws(function(){if(i._throwIfClosed(),!i.isStopped){i.isStopped=!0;for(var r=i.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var i;return((i=this.observers)===null||i===void 0?void 0:i.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(i){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,i)},t.prototype._subscribe=function(i){return this._throwIfClosed(),this._checkFinalizedStatuses(i),this._innerSubscribe(i)},t.prototype._innerSubscribe=function(i){var r=this,o=this,a=o.hasError,u=o.isStopped,c=o.observers;return a||u?_d:(this.currentObservers=null,c.push(i),new Ws(function(){r.currentObservers=null,Ra(c,i)}))},t.prototype._checkFinalizedStatuses=function(i){var r=this,o=r.hasError,a=r.thrownError,u=r.isStopped;o?i.error(a):u&&i.complete()},t.prototype.asObservable=function(){var i=new yh;return i.source=this,i},t.create=function(i,r){return new wh(i,r)},t}(yh),wh=function(e){zs(t,e);function t(i,r){var o=e.call(this)||this;return o.destination=i,o.source=r,o}return t.prototype.next=function(i){var r,o;(o=(r=this.destination)===null||r===void 0?void 0:r.next)===null||o===void 0||o.call(r,i)},t.prototype.error=function(i){var r,o;(o=(r=this.destination)===null||r===void 0?void 0:r.error)===null||o===void 0||o.call(r,i)},t.prototype.complete=function(){var i,r;(r=(i=this.destination)===null||i===void 0?void 0:i.complete)===null||r===void 0||r.call(i)},t.prototype._subscribe=function(i){var r,o;return(o=(r=this.source)===null||r===void 0?void 0:r.subscribe(i))!==null&&o!==void 0?o:_d},t}(Jt),_h=ZC(HC()),cl=class{constructor(e){this.debug=(0,_h.default)(e),_h.default.enable("*")}log(e,...t){this.debug(e,...t)}},uE=class Ad{constructor(t,i,r){this.io=t,this.presence=i,this.roomId=r,this.presences=new Set,this.observers=new Map,this.onPresenceJoin=o=>{(o==null?void 0:o.roomId)===this.roomId&&(this.logger.log("presence room @ presence join",o),this.presences.add(o),this.observers.get("presence.joined-room").next({connectionId:o.connectionId,data:o.data,id:o.id,name:o.name,timestamp:o.timestamp}))},this.onPresenceLeave=o=>{(o==null?void 0:o.roomId)===this.roomId&&(this.logger.log("presence room @ presence leave",o),this.presences.delete(o),this.observers.get("presence.leave").next(o))},this.onPresenceUpdate=o=>{(o==null?void 0:o.roomId)===this.roomId&&(this.logger.log("presence room @ presence update",o),this.observers.get("presence.update").next({connectionId:o.connectionId,data:o.data,id:o.id,name:o.name,roomId:o==null?void 0:o.roomId,timestamp:o.timestamp}))},this.logger=new cl("@superviz/socket-client/presence"),this.registerSubjects(),this.subscribeToPresenceEvents()}static register(t,i,r){return new Ad(t,i,r)}get(t,i){let r=new Jt;r.subscribe({next:t,error:i});let o=a=>{let u=a.presences.map(c=>({connectionId:c.connectionId,data:c.data,id:c.id,name:c.name,timestamp:c.timestamp}));this.logger.log("presence room @ get",a),this.io.off("presence.get",o),r.next(u),r.complete()};this.io.on("presence.get",o),this.io.emit("presence.get",this.roomId)}update(t){let i={connectionId:this.io.id,data:t,id:this.presence.id,name:this.presence.name,timestamp:Date.now()};this.io.emit("presence.update",this.roomId,i),this.logger.log("presence room @ update",this.roomId,i)}destroy(){this.io.off("presence.joined-room",this.onPresenceJoin),this.io.off("presence.leave",this.onPresenceLeave),this.io.off("presence.update",this.onPresenceUpdate),this.observers.forEach(t=>t.unsubscribe()),this.observers.clear()}registerSubjects(){this.observers.set("presence.joined-room",new Jt),this.observers.set("presence.leave",new Jt),this.observers.set("presence.update",new Jt)}on(t,i,r){this.observers.get(t).subscribe({error:r,next:i})}off(t){this.observers.get(t).unsubscribe(),this.observers.delete(t),this.observers.set(t,new Jt)}subscribeToPresenceEvents(){this.io.on("presence.joined-room",this.onPresenceJoin),this.io.on("presence.leave",this.onPresenceLeave),this.io.on("presence.update",this.onPresenceUpdate)}},Kt=Object.create(null);Kt.open="0";Kt.close="1";Kt.ping="2";Kt.pong="3";Kt.message="4";Kt.upgrade="5";Kt.noop="6";var _s=Object.create(null);Object.keys(Kt).forEach(e=>{_s[Kt[e]]=e});var La={type:"error",data:"parser error"},Sd=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Od=typeof ArrayBuffer=="function",Td=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,hl=({type:e,data:t},i,r)=>Sd&&t instanceof Blob?i?r(t):Ch(t,r):Od&&(t instanceof ArrayBuffer||Td(t))?i?r(t):Ch(new Blob([t]),r):r(Kt[e]+(t||"")),Ch=(e,t)=>{let i=new FileReader;return i.onload=function(){let r=i.result.split(",")[1];t("b"+(r||""))},i.readAsDataURL(e)};function Eh(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}var ya;function cE(e,t){if(Sd&&e.data instanceof Blob)return e.data.arrayBuffer().then(Eh).then(t);if(Od&&(e.data instanceof ArrayBuffer||Td(e.data)))return t(Eh(e.data));hl(e,!1,i=>{ya||(ya=new TextEncoder),t(ya.encode(i))})}var Ph="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zn=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<Ph.length;e++)Zn[Ph.charCodeAt(e)]=e;var hE=e=>{let t=e.length*.75,i=e.length,r,o=0,a,u,c,p;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);let h=new ArrayBuffer(t),f=new Uint8Array(h);for(r=0;r<i;r+=4)a=Zn[e.charCodeAt(r)],u=Zn[e.charCodeAt(r+1)],c=Zn[e.charCodeAt(r+2)],p=Zn[e.charCodeAt(r+3)],f[o++]=a<<2|u>>4,f[o++]=(u&15)<<4|c>>2,f[o++]=(c&3)<<6|p&63;return h},dE=typeof ArrayBuffer=="function",dl=(e,t)=>{if(typeof e!="string")return{type:"message",data:xd(e,t)};let i=e.charAt(0);return i==="b"?{type:"message",data:pE(e.substring(1),t)}:_s[i]?e.length>1?{type:_s[i],data:e.substring(1)}:{type:_s[i]}:La},pE=(e,t)=>{if(dE){let i=hE(e);return xd(i,t)}else return{base64:!0,data:e}},xd=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},kd="",fE=(e,t)=>{let i=e.length,r=new Array(i),o=0;e.forEach((a,u)=>{hl(a,!1,c=>{r[u]=c,++o===i&&t(r.join(kd))})})},mE=(e,t)=>{let i=e.split(kd),r=[];for(let o=0;o<i.length;o++){let a=dl(i[o],t);if(r.push(a),a.type==="error")break}return r};function vE(){return new TransformStream({transform(e,t){cE(e,i=>{let r=i.length,o;if(r<126)o=new Uint8Array(1),new DataView(o.buffer).setUint8(0,r);else if(r<65536){o=new Uint8Array(3);let a=new DataView(o.buffer);a.setUint8(0,126),a.setUint16(1,r)}else{o=new Uint8Array(9);let a=new DataView(o.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(r))}e.data&&typeof e.data!="string"&&(o[0]|=128),t.enqueue(o),t.enqueue(i)})}})}var ba;function ps(e){return e.reduce((t,i)=>t+i.length,0)}function fs(e,t){if(e[0].length===t)return e.shift();let i=new Uint8Array(t),r=0;for(let o=0;o<t;o++)i[o]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),i}function gE(e,t){ba||(ba=new TextDecoder);let i=[],r=0,o=-1,a=!1;return new TransformStream({transform(u,c){for(i.push(u);;){if(r===0){if(ps(i)<1)break;let p=fs(i,1);a=(p[0]&128)===128,o=p[0]&127,o<126?r=3:o===126?r=1:r=2}else if(r===1){if(ps(i)<2)break;let p=fs(i,2);o=new DataView(p.buffer,p.byteOffset,p.length).getUint16(0),r=3}else if(r===2){if(ps(i)<8)break;let p=fs(i,8),h=new DataView(p.buffer,p.byteOffset,p.length),f=h.getUint32(0);if(f>Math.pow(2,21)-1){c.enqueue(La);break}o=f*Math.pow(2,32)+h.getUint32(4),r=3}else{if(ps(i)<o)break;let p=fs(i,o);c.enqueue(dl(a?p:ba.decode(p),t)),r=0}if(o===0||o>e){c.enqueue(La);break}}}})}var Id=4;function ze(e){if(e)return yE(e)}function yE(e){for(var t in ze.prototype)e[t]=ze.prototype[t];return e}ze.prototype.on=ze.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};ze.prototype.once=function(e,t){function i(){this.off(e,i),t.apply(this,arguments)}return i.fn=t,this.on(e,i),this};ze.prototype.off=ze.prototype.removeListener=ze.prototype.removeAllListeners=ze.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var i=this._callbacks["$"+e];if(!i)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var r,o=0;o<i.length;o++)if(r=i[o],r===t||r.fn===t){i.splice(o,1);break}return i.length===0&&delete this._callbacks["$"+e],this};ze.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),i=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(i){i=i.slice(0);for(var r=0,o=i.length;r<o;++r)i[r].apply(this,t)}return this};ze.prototype.emitReserved=ze.prototype.emit;ze.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};ze.prototype.hasListeners=function(e){return!!this.listeners(e).length};var Tt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function Md(e,...t){return t.reduce((i,r)=>(e.hasOwnProperty(r)&&(i[r]=e[r]),i),{})}var bE=Tt.setTimeout,wE=Tt.clearTimeout;function Vs(e,t){t.useNativeTimers?(e.setTimeoutFn=bE.bind(Tt),e.clearTimeoutFn=wE.bind(Tt)):(e.setTimeoutFn=Tt.setTimeout.bind(Tt),e.clearTimeoutFn=Tt.clearTimeout.bind(Tt))}var _E=1.33;function CE(e){return typeof e=="string"?EE(e):Math.ceil((e.byteLength||e.size)*_E)}function EE(e){let t=0,i=0;for(let r=0,o=e.length;r<o;r++)t=e.charCodeAt(r),t<128?i+=1:t<2048?i+=2:t<55296||t>=57344?i+=3:(r++,i+=4);return i}function PE(e){let t="";for(let i in e)e.hasOwnProperty(i)&&(t.length&&(t+="&"),t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t}function AE(e){let t={},i=e.split("&");for(let r=0,o=i.length;r<o;r++){let a=i[r].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}var SE=class extends Error{constructor(e,t,i){super(e),this.description=t,this.context=i,this.type="TransportError"}},pl=class extends ze{constructor(e){super(),this.writable=!1,Vs(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,i){return super.emitReserved("error",new SE(e,t,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let t=dl(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){let e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){let t=PE(e);return t.length?"?"+t:""}},Rd="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Na=64,OE={},Ah=0,ms=0,Sh;function Oh(e){let t="";do t=Rd[e%Na]+t,e=Math.floor(e/Na);while(e>0);return t}function Fd(){let e=Oh(+new Date);return e!==Sh?(Ah=0,Sh=e):e+"."+Oh(Ah++)}for(;ms<Na;ms++)OE[Rd[ms]]=ms;var Ld=!1;try{Ld=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var TE=Ld;function Nd(e){let t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||TE))return new XMLHttpRequest}catch{}if(!t)try{return new Tt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function xE(){}var kE=function(){return new Nd({xdomain:!1}).responseType!=null}(),IE=class extends pl{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){let i=location.protocol==="https:",r=location.port;r||(r=i?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||r!==e.port}let t=e&&e.forceBase64;this.supportsBinary=kE&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let i=0;this.polling&&(i++,this.once("pollComplete",function(){--i||t()})),this.writable||(i++,this.once("drain",function(){--i||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){let t=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};mE(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){let e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,fE(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Fd()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new pn(this.uri(),e)}doWrite(e,t){let i=this.request({method:"POST",data:e});i.on("success",t),i.on("error",(r,o)=>{this.onError("xhr post error",r,o)})}doPoll(){let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,i)=>{this.onError("xhr poll error",t,i)}),this.pollXhr=e}},pn=class Cs extends ze{constructor(t,i){super(),Vs(this,i),this.opts=i,this.method=i.method||"GET",this.uri=t,this.data=i.data!==void 0?i.data:null,this.create()}create(){var t;let i=Md(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");i.xdomain=!!this.opts.xd;let r=this.xhr=new Nd(i);try{r.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let o in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(o)&&r.setRequestHeader(o,this.opts.extraHeaders[o])}}catch{}if(this.method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(t=this.opts.cookieJar)===null||t===void 0||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=()=>{var o;r.readyState===3&&((o=this.opts.cookieJar)===null||o===void 0||o.parseCookies(r)),r.readyState===4&&(r.status===200||r.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof r.status=="number"?r.status:0)},0))},r.send(this.data)}catch(o){this.setTimeoutFn(()=>{this.onError(o)},0);return}typeof document<"u"&&(this.index=Cs.requestsCount++,Cs.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=xE,t)try{this.xhr.abort()}catch{}typeof document<"u"&&delete Cs.requests[this.index],this.xhr=null}}onLoad(){let t=this.xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};pn.requestsCount=0;pn.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Th);else if(typeof addEventListener=="function"){let e="onpagehide"in Tt?"pagehide":"unload";addEventListener(e,Th,!1)}}function Th(){for(let e in pn.requests)pn.requests.hasOwnProperty(e)&&pn.requests[e].abort()}var fl=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),vs=Tt.WebSocket||Tt.MozWebSocket,xh=!0,ME="arraybuffer",kh=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",RE=class extends pl{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),t=this.opts.protocols,i=kh?{}:Md(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=xh&&!kh?t?new vs(e,t):new vs(e):new vs(e,t,i)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let i=e[t],r=t===e.length-1;hl(i,this.supportsBinary,o=>{let a={};try{xh?this.ws.send(o):this.ws.send(o,a)}catch{}r&&fl(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Fd()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!vs}},FE=class extends pl{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{let t=gE(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=e.readable.pipeThrough(t).getReader(),r=vE();r.readable.pipeTo(e.writable),this.writer=r.writable.getWriter();let o=()=>{i.read().then(({done:u,value:c})=>{u||(this.onPacket(c),o())}).catch(u=>{})};o();let a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this.writer.write(a).then(()=>this.onOpen())})}))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let i=e[t],r=t===e.length-1;this.writer.write(i).then(()=>{r&&fl(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this.transport)===null||e===void 0||e.close()}},LE={websocket:RE,webtransport:FE,polling:IE},NE=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,DE=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Da(e){if(e.length>2e3)throw"URI too long";let t=e,i=e.indexOf("["),r=e.indexOf("]");i!=-1&&r!=-1&&(e=e.substring(0,i)+e.substring(i,r).replace(/:/g,";")+e.substring(r,e.length));let o=NE.exec(e||""),a={},u=14;for(;u--;)a[DE[u]]=o[u]||"";return i!=-1&&r!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=jE(a,a.path),a.queryKey=BE(a,a.query),a}function jE(e,t){let i=/\/{2,9}/g,r=t.replace(i,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&r.splice(0,1),t.slice(-1)=="/"&&r.splice(r.length-1,1),r}function BE(e,t){let i={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,o,a){o&&(i[o]=a)}),i}var Dd=class cn extends ze{constructor(t,i={}){super(),this.binaryType=ME,this.writeBuffer=[],t&&typeof t=="object"&&(i=t,t=null),t?(t=Da(t),i.hostname=t.host,i.secure=t.protocol==="https"||t.protocol==="wss",i.port=t.port,t.query&&(i.query=t.query)):i.host&&(i.hostname=Da(i.host).host),Vs(this,i),this.secure=i.secure!=null?i.secure:typeof location<"u"&&location.protocol==="https:",i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.hostname=i.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=i.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=i.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},i),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=AE(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){let i=Object.assign({},this.opts.query);i.EIO=Id,i.transport=t,this.id&&(i.sid=this.id);let r=Object.assign({},this.opts,{query:i,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new LE[t](r)}open(){let t;if(this.opts.rememberUpgrade&&cn.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else t=this.transports[0];this.readyState="opening";try{t=this.createTransport(t)}catch{this.transports.shift(),this.open();return}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",i=>this.onClose("transport close",i))}probe(t){let i=this.createTransport(t),r=!1;cn.priorWebsocketSuccess=!1;let o=()=>{r||(i.send([{type:"ping",data:"probe"}]),i.once("packet",m=>{if(!r)if(m.type==="pong"&&m.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",i),!i)return;cn.priorWebsocketSuccess=i.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(f(),this.setTransport(i),i.send([{type:"upgrade"}]),this.emitReserved("upgrade",i),i=null,this.upgrading=!1,this.flush())})}else{let y=new Error("probe error");y.transport=i.name,this.emitReserved("upgradeError",y)}}))};function a(){r||(r=!0,f(),i.close(),i=null)}let u=m=>{let y=new Error("probe error: "+m);y.transport=i.name,a(),this.emitReserved("upgradeError",y)};function c(){u("transport closed")}function p(){u("socket closed")}function h(m){i&&m.name!==i.name&&a()}let f=()=>{i.removeListener("open",o),i.removeListener("error",u),i.removeListener("close",c),this.off("close",p),this.off("upgrading",h)};i.once("open",o),i.once("error",u),i.once("close",c),this.once("close",p),this.once("upgrading",h),this.upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{r||i.open()},200):i.open()}onOpen(){if(this.readyState="open",cn.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let t=0,i=this.upgrades.length;for(;t<i;t++)this.probe(this.upgrades[t])}}onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),this.resetPingTimeout(),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let i=new Error("server error");i.code=t.data,this.onError(i);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let i=0;i<this.writeBuffer.length;i++){let r=this.writeBuffer[i].data;if(r&&(t+=CE(r)),i>0&&t>this.maxPayload)return this.writeBuffer.slice(0,i);t+=2}return this.writeBuffer}write(t,i,r){return this.sendPacket("message",t,i,r),this}send(t,i,r){return this.sendPacket("message",t,i,r),this}sendPacket(t,i,r,o){if(typeof i=="function"&&(o=i,i=void 0),typeof r=="function"&&(o=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;let a={type:t,data:i,options:r};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),o&&this.once("flush",o),this.flush()}close(){let t=()=>{this.onClose("forced close"),this.transport.close()},i=()=>{this.off("upgrade",i),this.off("upgradeError",i),t()},r=()=>{this.once("upgrade",i),this.once("upgradeError",i)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}onError(t){cn.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,i){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",t,i),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){let i=[],r=0,o=t.length;for(;r<o;r++)~this.transports.indexOf(t[r])&&i.push(t[r]);return i}};Dd.protocol=Id;function UE(e,t="",i){let r=e;i=i||typeof location<"u"&&location,e==null&&(e=i.protocol+"//"+i.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=i.protocol+e:e=i.host+e),/^(https?|wss?):\/\//.test(e)||(typeof i<"u"?e=i.protocol+"//"+e:e="https://"+e),r=Da(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";let o=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port+t,r.href=r.protocol+"://"+o+(i&&i.port===r.port?"":":"+r.port),r}var jd={};VC(jd,{Decoder:()=>KE,Encoder:()=>HE,PacketType:()=>ye,protocol:()=>qE});var $E=typeof ArrayBuffer=="function",zE=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,Bd=Object.prototype.toString,WE=typeof Blob=="function"||typeof Blob<"u"&&Bd.call(Blob)==="[object BlobConstructor]",VE=typeof File=="function"||typeof File<"u"&&Bd.call(File)==="[object FileConstructor]";function ml(e){return $E&&(e instanceof ArrayBuffer||zE(e))||WE&&e instanceof Blob||VE&&e instanceof File}function Es(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let i=0,r=e.length;i<r;i++)if(Es(e[i]))return!0;return!1}if(ml(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return Es(e.toJSON(),!0);for(let i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&Es(e[i]))return!0;return!1}function GE(e){let t=[],i=e.data,r=e;return r.data=ja(i,t),r.attachments=t.length,{packet:r,buffers:t}}function ja(e,t){if(!e)return e;if(ml(e)){let i={_placeholder:!0,num:t.length};return t.push(e),i}else if(Array.isArray(e)){let i=new Array(e.length);for(let r=0;r<e.length;r++)i[r]=ja(e[r],t);return i}else if(typeof e=="object"&&!(e instanceof Date)){let i={};for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=ja(e[r],t));return i}return e}function ZE(e,t){return e.data=Ba(e.data,t),delete e.attachments,e}function Ba(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let i=0;i<e.length;i++)e[i]=Ba(e[i],t);else if(typeof e=="object")for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&(e[i]=Ba(e[i],t));return e}var JE=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],qE=5,ye;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(ye||(ye={}));var HE=class{constructor(e){this.replacer=e}encode(e){return(e.type===ye.EVENT||e.type===ye.ACK)&&Es(e)?this.encodeAsBinary({type:e.type===ye.EVENT?ye.BINARY_EVENT:ye.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===ye.BINARY_EVENT||e.type===ye.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){let t=GE(e),i=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(i),r}};function Ih(e){return Object.prototype.toString.call(e)==="[object Object]"}var KE=class Ud extends ze{constructor(t){super(),this.reviver=t}add(t){let i;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");i=this.decodeString(t);let r=i.type===ye.BINARY_EVENT;r||i.type===ye.BINARY_ACK?(i.type=r?ye.EVENT:ye.ACK,this.reconstructor=new YE(i),i.attachments===0&&super.emitReserved("decoded",i)):super.emitReserved("decoded",i)}else if(ml(t)||t.base64)if(this.reconstructor)i=this.reconstructor.takeBinaryData(t),i&&(this.reconstructor=null,super.emitReserved("decoded",i));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let i=0,r={type:Number(t.charAt(0))};if(ye[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===ye.BINARY_EVENT||r.type===ye.BINARY_ACK){let a=i+1;for(;t.charAt(++i)!=="-"&&i!=t.length;);let u=t.substring(a,i);if(u!=Number(u)||t.charAt(i)!=="-")throw new Error("Illegal attachments");r.attachments=Number(u)}if(t.charAt(i+1)==="/"){let a=i+1;for(;++i&&!(t.charAt(i)===","||i===t.length););r.nsp=t.substring(a,i)}else r.nsp="/";let o=t.charAt(i+1);if(o!==""&&Number(o)==o){let a=i+1;for(;++i;){let u=t.charAt(i);if(u==null||Number(u)!=u){--i;break}if(i===t.length)break}r.id=Number(t.substring(a,i+1))}if(t.charAt(++i)){let a=this.tryParse(t.substr(i));if(Ud.isPayloadValid(r.type,a))r.data=a;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,i){switch(t){case ye.CONNECT:return Ih(i);case ye.DISCONNECT:return i===void 0;case ye.CONNECT_ERROR:return typeof i=="string"||Ih(i);case ye.EVENT:case ye.BINARY_EVENT:return Array.isArray(i)&&(typeof i[0]=="number"||typeof i[0]=="string"&&JE.indexOf(i[0])===-1);case ye.ACK:case ye.BINARY_ACK:return Array.isArray(i)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}},YE=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let t=ZE(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function Bt(e,t,i){return e.on(t,i),function(){e.off(t,i)}}var QE=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),$d=class extends ze{constructor(e,t,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[Bt(e,"open",this.onopen.bind(this)),Bt(e,"packet",this.onpacket.bind(this)),Bt(e,"error",this.onerror.bind(this)),Bt(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(QE.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;let i={type:ye.EVENT,data:t};if(i.options={},i.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){let o=this.ids++,a=t.pop();this._registerAckCallback(o,a),i.id=o}let r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!r||!this.connected)||(this.connected?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(e,t){var i;let r=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}let o=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let u=0;u<this.sendBuffer.length;u++)this.sendBuffer[u].id===e&&this.sendBuffer.splice(u,1);t.call(this,new Error("operation has timed out"))},r),a=(...u)=>{this.io.clearTimeoutFn(o),t.apply(this,u)};a.withError=!0,this.acks[e]=a}emitWithAck(e,...t){return new Promise((i,r)=>{let o=(a,u)=>a?r(a):i(u);o.withError=!0,t.push(o),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());let i={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...o)=>i!==this._queue[0]?void 0:(r!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...o)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;let t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:ye.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){let t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case ye.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ye.EVENT:case ye.BINARY_EVENT:this.onevent(e);break;case ye.ACK:case ye.BINARY_ACK:this.onack(e);break;case ye.DISCONNECT:this.ondisconnect();break;case ye.CONNECT_ERROR:this.destroy();let t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t);break}}onevent(e){let t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let t=this._anyListeners.slice();for(let i of t)i.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){let t=this,i=!1;return function(...r){i||(i=!0,t.packet({type:ye.ACK,id:e,data:r}))}}onack(e){let t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ye.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let t=this._anyOutgoingListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let t=this._anyOutgoingListeners.slice();for(let i of t)i.apply(this,e.data)}}};function Cn(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Cn.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),i=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+i:e-i}return Math.min(e,this.max)|0};Cn.prototype.reset=function(){this.attempts=0};Cn.prototype.setMin=function(e){this.ms=e};Cn.prototype.setMax=function(e){this.max=e};Cn.prototype.setJitter=function(e){this.jitter=e};var ks=class extends ze{constructor(e,t){var i;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Vs(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((i=t.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new Cn({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;let r=t.parser||jd;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Dd(this.uri,this.opts);let t=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;let r=Bt(t,"open",function(){i.onopen(),e&&e()}),o=u=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",u),e?e(u):this.maybeReconnectOnOpen()},a=Bt(t,"error",o);if(this._timeout!==!1){let u=this._timeout,c=this.setTimeoutFn(()=>{r(),o(new Error("timeout")),t.close()},u);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(r),this.subs.push(a),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(Bt(e,"ping",this.onping.bind(this)),Bt(e,"data",this.ondata.bind(this)),Bt(e,"error",this.onerror.bind(this)),Bt(e,"close",this.onclose.bind(this)),Bt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){fl(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let i=this.nsps[e];return i?this._autoConnect&&!i.active&&i.connect():(i=new $d(this,e,t),this.nsps[e]=i),i}_destroy(e){let t=Object.keys(this.nsps);for(let i of t)if(this.nsps[i].active)return;this._close()}_packet(e){let t=this.encoder.encode(e);for(let i=0;i<t.length;i++)this.engine.write(t[i],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();this._reconnecting=!0;let i=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}},Gn={};function wa(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};let i=UE(e,t.path||"/socket.io"),r=i.source,o=i.id,a=i.path,u=Gn[o]&&a in Gn[o].nsps,c=t.forceNew||t["force new connection"]||t.multiplex===!1||u,p;return c?p=new ks(r,t):(Gn[o]||(Gn[o]=new ks(r,t)),p=Gn[o]),i.query&&!t.query&&(t.query=i.queryKey),p.socket(i.path,t)}Object.assign(wa,{Manager:ks,Socket:$d,io:wa,connect:wa});var be;(function(e){e.assertEqual=o=>o;function t(o){}e.assertIs=t;function i(o){throw new Error}e.assertNever=i,e.arrayToEnum=o=>{let a={};for(let u of o)a[u]=u;return a},e.getValidEnumValues=o=>{let a=e.objectKeys(o).filter(c=>typeof o[o[c]]!="number"),u={};for(let c of a)u[c]=o[c];return e.objectValues(u)},e.objectValues=o=>e.objectKeys(o).map(function(a){return o[a]}),e.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{let a=[];for(let u in o)Object.prototype.hasOwnProperty.call(o,u)&&a.push(u);return a},e.find=(o,a)=>{for(let u of o)if(a(u))return u},e.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&isFinite(o)&&Math.floor(o)===o;function r(o,a=" | "){return o.map(u=>typeof u=="string"?`'${u}'`:u).join(a)}e.joinValues=r,e.jsonStringifyReplacer=(o,a)=>typeof a=="bigint"?a.toString():a})(be||(be={}));var Ua;(function(e){e.mergeShapes=(t,i)=>k(k({},t),i)})(Ua||(Ua={}));var z=be.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),xi=e=>{switch(typeof e){case"undefined":return z.undefined;case"string":return z.string;case"number":return isNaN(e)?z.nan:z.number;case"boolean":return z.boolean;case"function":return z.function;case"bigint":return z.bigint;case"symbol":return z.symbol;case"object":return Array.isArray(e)?z.array:e===null?z.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?z.promise:typeof Map<"u"&&e instanceof Map?z.map:typeof Set<"u"&&e instanceof Set?z.set:typeof Date<"u"&&e instanceof Date?z.date:z.object;default:return z.unknown}},L=be.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),XE=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),$t=class zd extends Error{constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};let i=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,i):this.__proto__=i,this.name="ZodError",this.issues=t}get errors(){return this.issues}format(t){let i=t||function(a){return a.message},r={_errors:[]},o=a=>{for(let u of a.issues)if(u.code==="invalid_union")u.unionErrors.map(o);else if(u.code==="invalid_return_type")o(u.returnTypeError);else if(u.code==="invalid_arguments")o(u.argumentsError);else if(u.path.length===0)r._errors.push(i(u));else{let c=r,p=0;for(;p<u.path.length;){let h=u.path[p];p===u.path.length-1?(c[h]=c[h]||{_errors:[]},c[h]._errors.push(i(u))):c[h]=c[h]||{_errors:[]},c=c[h],p++}}};return o(this),r}static assert(t){if(!(t instanceof zd))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,be.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=i=>i.message){let i={},r=[];for(let o of this.issues)o.path.length>0?(i[o.path[0]]=i[o.path[0]]||[],i[o.path[0]].push(t(o))):r.push(t(o));return{formErrors:r,fieldErrors:i}}get formErrors(){return this.flatten()}};$t.create=e=>new $t(e);var vn=(e,t)=>{let i;switch(e.code){case L.invalid_type:e.received===z.undefined?i="Required":i=`Expected ${e.expected}, received ${e.received}`;break;case L.invalid_literal:i=`Invalid literal value, expected ${JSON.stringify(e.expected,be.jsonStringifyReplacer)}`;break;case L.unrecognized_keys:i=`Unrecognized key(s) in object: ${be.joinValues(e.keys,", ")}`;break;case L.invalid_union:i="Invalid input";break;case L.invalid_union_discriminator:i=`Invalid discriminator value. Expected ${be.joinValues(e.options)}`;break;case L.invalid_enum_value:i=`Invalid enum value. Expected ${be.joinValues(e.options)}, received '${e.received}'`;break;case L.invalid_arguments:i="Invalid function arguments";break;case L.invalid_return_type:i="Invalid function return type";break;case L.invalid_date:i="Invalid date";break;case L.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(i=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(i=`${i} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?i=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?i=`Invalid input: must end with "${e.validation.endsWith}"`:be.assertNever(e.validation):e.validation!=="regex"?i=`Invalid ${e.validation}`:i="Invalid";break;case L.too_small:e.type==="array"?i=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?i=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?i=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?i=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:i="Invalid input";break;case L.too_big:e.type==="array"?i=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?i=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?i=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?i=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?i=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:i="Invalid input";break;case L.custom:i="Invalid input";break;case L.invalid_intersection_types:i="Intersection results could not be merged";break;case L.not_multiple_of:i=`Number must be a multiple of ${e.multipleOf}`;break;case L.not_finite:i="Number must be finite";break;default:i=t.defaultError,be.assertNever(e)}return{message:i}},Wd=vn;function eP(e){Wd=e}function Is(){return Wd}var Ms=e=>{let{data:t,path:i,errorMaps:r,issueData:o}=e,a=[...i,...o.path||[]],u=ee(k({},o),{path:a});if(o.message!==void 0)return ee(k({},o),{path:a,message:o.message});let c="",p=r.filter(h=>!!h).slice().reverse();for(let h of p)c=h(u,{data:t,defaultError:c}).message;return ee(k({},o),{path:a,message:c})},tP=[];function $(e,t){let i=Is(),r=Ms({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,i,i===vn?void 0:vn].filter(o=>!!o)});e.common.issues.push(r)}var dt=class Vd{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,i){let r=[];for(let o of i){if(o.status==="aborted")return te;o.status==="dirty"&&t.dirty(),r.push(o.value)}return{status:t.value,value:r}}static mergeObjectAsync(t,i){return di(this,null,function*(){let r=[];for(let o of i){let a=yield o.key,u=yield o.value;r.push({key:a,value:u})}return Vd.mergeObjectSync(t,r)})}static mergeObjectSync(t,i){let r={};for(let o of i){let{key:a,value:u}=o;if(a.status==="aborted"||u.status==="aborted")return te;a.status==="dirty"&&t.dirty(),u.status==="dirty"&&t.dirty(),a.value!=="__proto__"&&(typeof u.value<"u"||o.alwaysSet)&&(r[a.value]=u.value)}return{status:t.value,value:r}}},te=Object.freeze({status:"aborted"}),Rs=e=>({status:"dirty",value:e}),ot=e=>({status:"valid",value:e}),$a=e=>e.status==="aborted",za=e=>e.status==="dirty",Yn=e=>e.status==="valid",Qn=e=>typeof Promise<"u"&&e instanceof Promise;function Fs(e,t,i,r){if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function Gd(e,t,i,r,o){if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,i),i}var Z;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Z||(Z={}));var Jn,qn,Yt=class{constructor(e,t,i,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=i,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Mh=(e,t)=>{if(Yn(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let i=new $t(e.common.issues);return this._error=i,this._error}}};function se(e){if(!e)return{};let{errorMap:t,invalid_type_error:i,required_error:r,description:o}=e;if(t&&(i||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:o}:{errorMap:(a,u)=>{var c,p;let{message:h}=e;return a.code==="invalid_enum_value"?{message:h??u.defaultError}:typeof u.data>"u"?{message:(c=h??r)!==null&&c!==void 0?c:u.defaultError}:a.code!=="invalid_type"?{message:u.defaultError}:{message:(p=h??i)!==null&&p!==void 0?p:u.defaultError}},description:o}}var ce=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return xi(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:xi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new dt,ctx:{common:e.parent.common,data:e.data,parsedType:xi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(Qn(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let i=this.safeParse(e,t);if(i.success)return i.data;throw i.error}safeParse(e,t){var i;let r={common:{issues:[],async:(i=t==null?void 0:t.async)!==null&&i!==void 0?i:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:xi(e)},o=this._parseSync({data:e,path:r.path,parent:r});return Mh(r,o)}parseAsync(e,t){return di(this,null,function*(){let i=yield this.safeParseAsync(e,t);if(i.success)return i.data;throw i.error})}safeParseAsync(e,t){return di(this,null,function*(){let i={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:xi(e)},r=this._parse({data:e,path:i.path,parent:i}),o=yield Qn(r)?r:Promise.resolve(r);return Mh(i,o)})}refine(e,t){let i=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,o)=>{let a=e(r),u=()=>o.addIssue(k({code:L.custom},i(r)));return typeof Promise<"u"&&a instanceof Promise?a.then(c=>c?!0:(u(),!1)):a?!0:(u(),!1)})}refinement(e,t){return this._refinement((i,r)=>e(i)?!0:(r.addIssue(typeof t=="function"?t(i,r):t),!1))}_refinement(e){return new zt({schema:this,typeName:Y.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return qt.create(this,this._def)}nullable(){return Mi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ji.create(this,this._def)}promise(){return bn.create(this,this._def)}or(e){return sr.create([this,e],this._def)}and(e){return or.create(this,e,this._def)}transform(e){return new zt(ee(k({},se(this._def)),{schema:this,typeName:Y.ZodEffects,effect:{type:"transform",transform:e}}))}default(e){let t=typeof e=="function"?e:()=>e;return new cr(ee(k({},se(this._def)),{innerType:this,defaultValue:t,typeName:Y.ZodDefault}))}brand(){return new vl(k({typeName:Y.ZodBranded,type:this},se(this._def)))}catch(e){let t=typeof e=="function"?e:()=>e;return new hr(ee(k({},se(this._def)),{innerType:this,catchValue:t,typeName:Y.ZodCatch}))}describe(e){let t=this.constructor;return new t(ee(k({},this._def),{description:e}))}pipe(e){return gl.create(this,e)}readonly(){return dr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},iP=/^c[^\s-]{8,}$/i,nP=/^[0-9a-z]+$/,rP=/^[0-9A-HJKMNP-TV-Z]{26}$/,sP=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,oP=/^[a-z0-9_-]{21}$/i,aP=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,lP=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,uP="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",_a,cP=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,hP=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,dP=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Zd="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",pP=new RegExp(`^${Zd}$`);function Jd(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function fP(e){return new RegExp(`^${Jd(e)}$`)}function qd(e){let t=`${Zd}T${Jd(e)}`,i=[];return i.push(e.local?"Z?":"Z"),e.offset&&i.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${i.join("|")})`,new RegExp(`^${t}$`)}function mP(e,t){return!!((t==="v4"||!t)&&cP.test(e)||(t==="v6"||!t)&&hP.test(e))}var gn=class Hn extends ce{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==z.string){let o=this._getOrReturnCtx(t);return $(o,{code:L.invalid_type,expected:z.string,received:o.parsedType}),te}let i=new dt,r;for(let o of this._def.checks)if(o.kind==="min")t.data.length<o.value&&(r=this._getOrReturnCtx(t,r),$(r,{code:L.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),i.dirty());else if(o.kind==="max")t.data.length>o.value&&(r=this._getOrReturnCtx(t,r),$(r,{code:L.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),i.dirty());else if(o.kind==="length"){let a=t.data.length>o.value,u=t.data.length<o.value;(a||u)&&(r=this._getOrReturnCtx(t,r),a?$(r,{code:L.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):u&&$(r,{code:L.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),i.dirty())}else if(o.kind==="email")lP.test(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{validation:"email",code:L.invalid_string,message:o.message}),i.dirty());else if(o.kind==="emoji")_a||(_a=new RegExp(uP,"u")),_a.test(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{validation:"emoji",code:L.invalid_string,message:o.message}),i.dirty());else if(o.kind==="uuid")sP.test(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{validation:"uuid",code:L.invalid_string,message:o.message}),i.dirty());else if(o.kind==="nanoid")oP.test(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{validation:"nanoid",code:L.invalid_string,message:o.message}),i.dirty());else if(o.kind==="cuid")iP.test(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{validation:"cuid",code:L.invalid_string,message:o.message}),i.dirty());else if(o.kind==="cuid2")nP.test(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{validation:"cuid2",code:L.invalid_string,message:o.message}),i.dirty());else if(o.kind==="ulid")rP.test(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{validation:"ulid",code:L.invalid_string,message:o.message}),i.dirty());else if(o.kind==="url")try{new URL(t.data)}catch{r=this._getOrReturnCtx(t,r),$(r,{validation:"url",code:L.invalid_string,message:o.message}),i.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{validation:"regex",code:L.invalid_string,message:o.message}),i.dirty())):o.kind==="trim"?t.data=t.data.trim():o.kind==="includes"?t.data.includes(o.value,o.position)||(r=this._getOrReturnCtx(t,r),$(r,{code:L.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),i.dirty()):o.kind==="toLowerCase"?t.data=t.data.toLowerCase():o.kind==="toUpperCase"?t.data=t.data.toUpperCase():o.kind==="startsWith"?t.data.startsWith(o.value)||(r=this._getOrReturnCtx(t,r),$(r,{code:L.invalid_string,validation:{startsWith:o.value},message:o.message}),i.dirty()):o.kind==="endsWith"?t.data.endsWith(o.value)||(r=this._getOrReturnCtx(t,r),$(r,{code:L.invalid_string,validation:{endsWith:o.value},message:o.message}),i.dirty()):o.kind==="datetime"?qd(o).test(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{code:L.invalid_string,validation:"datetime",message:o.message}),i.dirty()):o.kind==="date"?pP.test(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{code:L.invalid_string,validation:"date",message:o.message}),i.dirty()):o.kind==="time"?fP(o).test(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{code:L.invalid_string,validation:"time",message:o.message}),i.dirty()):o.kind==="duration"?aP.test(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{validation:"duration",code:L.invalid_string,message:o.message}),i.dirty()):o.kind==="ip"?mP(t.data,o.version)||(r=this._getOrReturnCtx(t,r),$(r,{validation:"ip",code:L.invalid_string,message:o.message}),i.dirty()):o.kind==="base64"?dP.test(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{validation:"base64",code:L.invalid_string,message:o.message}),i.dirty()):be.assertNever(o);return{status:i.value,value:t.data}}_regex(t,i,r){return this.refinement(o=>t.test(o),k({validation:i,code:L.invalid_string},Z.errToObj(r)))}_addCheck(t){return new Hn(ee(k({},this._def),{checks:[...this._def.checks,t]}))}email(t){return this._addCheck(k({kind:"email"},Z.errToObj(t)))}url(t){return this._addCheck(k({kind:"url"},Z.errToObj(t)))}emoji(t){return this._addCheck(k({kind:"emoji"},Z.errToObj(t)))}uuid(t){return this._addCheck(k({kind:"uuid"},Z.errToObj(t)))}nanoid(t){return this._addCheck(k({kind:"nanoid"},Z.errToObj(t)))}cuid(t){return this._addCheck(k({kind:"cuid"},Z.errToObj(t)))}cuid2(t){return this._addCheck(k({kind:"cuid2"},Z.errToObj(t)))}ulid(t){return this._addCheck(k({kind:"ulid"},Z.errToObj(t)))}base64(t){return this._addCheck(k({kind:"base64"},Z.errToObj(t)))}ip(t){return this._addCheck(k({kind:"ip"},Z.errToObj(t)))}datetime(t){var i,r;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck(k({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(i=t==null?void 0:t.offset)!==null&&i!==void 0?i:!1,local:(r=t==null?void 0:t.local)!==null&&r!==void 0?r:!1},Z.errToObj(t==null?void 0:t.message)))}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck(k({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision},Z.errToObj(t==null?void 0:t.message)))}duration(t){return this._addCheck(k({kind:"duration"},Z.errToObj(t)))}regex(t,i){return this._addCheck(k({kind:"regex",regex:t},Z.errToObj(i)))}includes(t,i){return this._addCheck(k({kind:"includes",value:t,position:i==null?void 0:i.position},Z.errToObj(i==null?void 0:i.message)))}startsWith(t,i){return this._addCheck(k({kind:"startsWith",value:t},Z.errToObj(i)))}endsWith(t,i){return this._addCheck(k({kind:"endsWith",value:t},Z.errToObj(i)))}min(t,i){return this._addCheck(k({kind:"min",value:t},Z.errToObj(i)))}max(t,i){return this._addCheck(k({kind:"max",value:t},Z.errToObj(i)))}length(t,i){return this._addCheck(k({kind:"length",value:t},Z.errToObj(i)))}nonempty(t){return this.min(1,Z.errToObj(t))}trim(){return new Hn(ee(k({},this._def),{checks:[...this._def.checks,{kind:"trim"}]}))}toLowerCase(){return new Hn(ee(k({},this._def),{checks:[...this._def.checks,{kind:"toLowerCase"}]}))}toUpperCase(){return new Hn(ee(k({},this._def),{checks:[...this._def.checks,{kind:"toUpperCase"}]}))}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get minLength(){let t=null;for(let i of this._def.checks)i.kind==="min"&&(t===null||i.value>t)&&(t=i.value);return t}get maxLength(){let t=null;for(let i of this._def.checks)i.kind==="max"&&(t===null||i.value<t)&&(t=i.value);return t}};gn.create=e=>{var t;return new gn(k({checks:[],typeName:Y.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1},se(e)))};function vP(e,t){let i=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,o=i>r?i:r,a=parseInt(e.toFixed(o).replace(".","")),u=parseInt(t.toFixed(o).replace(".",""));return a%u/Math.pow(10,o)}var Xn=class Wa extends ce{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==z.number){let o=this._getOrReturnCtx(t);return $(o,{code:L.invalid_type,expected:z.number,received:o.parsedType}),te}let i,r=new dt;for(let o of this._def.checks)o.kind==="int"?be.isInteger(t.data)||(i=this._getOrReturnCtx(t,i),$(i,{code:L.invalid_type,expected:"integer",received:"float",message:o.message}),r.dirty()):o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(i=this._getOrReturnCtx(t,i),$(i,{code:L.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),r.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(i=this._getOrReturnCtx(t,i),$(i,{code:L.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),r.dirty()):o.kind==="multipleOf"?vP(t.data,o.value)!==0&&(i=this._getOrReturnCtx(t,i),$(i,{code:L.not_multiple_of,multipleOf:o.value,message:o.message}),r.dirty()):o.kind==="finite"?Number.isFinite(t.data)||(i=this._getOrReturnCtx(t,i),$(i,{code:L.not_finite,message:o.message}),r.dirty()):be.assertNever(o);return{status:r.value,value:t.data}}gte(t,i){return this.setLimit("min",t,!0,Z.toString(i))}gt(t,i){return this.setLimit("min",t,!1,Z.toString(i))}lte(t,i){return this.setLimit("max",t,!0,Z.toString(i))}lt(t,i){return this.setLimit("max",t,!1,Z.toString(i))}setLimit(t,i,r,o){return new Wa(ee(k({},this._def),{checks:[...this._def.checks,{kind:t,value:i,inclusive:r,message:Z.toString(o)}]}))}_addCheck(t){return new Wa(ee(k({},this._def),{checks:[...this._def.checks,t]}))}int(t){return this._addCheck({kind:"int",message:Z.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Z.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Z.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Z.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Z.toString(t)})}multipleOf(t,i){return this._addCheck({kind:"multipleOf",value:t,message:Z.toString(i)})}finite(t){return this._addCheck({kind:"finite",message:Z.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Z.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Z.toString(t)})}get minValue(){let t=null;for(let i of this._def.checks)i.kind==="min"&&(t===null||i.value>t)&&(t=i.value);return t}get maxValue(){let t=null;for(let i of this._def.checks)i.kind==="max"&&(t===null||i.value<t)&&(t=i.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&be.isInteger(t.value))}get isFinite(){let t=null,i=null;for(let r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(i===null||r.value>i)&&(i=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(i)&&Number.isFinite(t)}};Xn.create=e=>new Xn(k({checks:[],typeName:Y.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1},se(e)));var er=class Va extends ce{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce&&(t.data=BigInt(t.data)),this._getType(t)!==z.bigint){let o=this._getOrReturnCtx(t);return $(o,{code:L.invalid_type,expected:z.bigint,received:o.parsedType}),te}let i,r=new dt;for(let o of this._def.checks)o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(i=this._getOrReturnCtx(t,i),$(i,{code:L.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),r.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(i=this._getOrReturnCtx(t,i),$(i,{code:L.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),r.dirty()):o.kind==="multipleOf"?t.data%o.value!==BigInt(0)&&(i=this._getOrReturnCtx(t,i),$(i,{code:L.not_multiple_of,multipleOf:o.value,message:o.message}),r.dirty()):be.assertNever(o);return{status:r.value,value:t.data}}gte(t,i){return this.setLimit("min",t,!0,Z.toString(i))}gt(t,i){return this.setLimit("min",t,!1,Z.toString(i))}lte(t,i){return this.setLimit("max",t,!0,Z.toString(i))}lt(t,i){return this.setLimit("max",t,!1,Z.toString(i))}setLimit(t,i,r,o){return new Va(ee(k({},this._def),{checks:[...this._def.checks,{kind:t,value:i,inclusive:r,message:Z.toString(o)}]}))}_addCheck(t){return new Va(ee(k({},this._def),{checks:[...this._def.checks,t]}))}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Z.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Z.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Z.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Z.toString(t)})}multipleOf(t,i){return this._addCheck({kind:"multipleOf",value:t,message:Z.toString(i)})}get minValue(){let t=null;for(let i of this._def.checks)i.kind==="min"&&(t===null||i.value>t)&&(t=i.value);return t}get maxValue(){let t=null;for(let i of this._def.checks)i.kind==="max"&&(t===null||i.value<t)&&(t=i.value);return t}};er.create=e=>{var t;return new er(k({checks:[],typeName:Y.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1},se(e)))};var tr=class extends ce{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==z.boolean){let t=this._getOrReturnCtx(e);return $(t,{code:L.invalid_type,expected:z.boolean,received:t.parsedType}),te}return ot(e.data)}};tr.create=e=>new tr(k({typeName:Y.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1},se(e)));var ir=class Hd extends ce{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==z.date){let o=this._getOrReturnCtx(t);return $(o,{code:L.invalid_type,expected:z.date,received:o.parsedType}),te}if(isNaN(t.data.getTime())){let o=this._getOrReturnCtx(t);return $(o,{code:L.invalid_date}),te}let i=new dt,r;for(let o of this._def.checks)o.kind==="min"?t.data.getTime()<o.value&&(r=this._getOrReturnCtx(t,r),$(r,{code:L.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),i.dirty()):o.kind==="max"?t.data.getTime()>o.value&&(r=this._getOrReturnCtx(t,r),$(r,{code:L.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),i.dirty()):be.assertNever(o);return{status:i.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Hd(ee(k({},this._def),{checks:[...this._def.checks,t]}))}min(t,i){return this._addCheck({kind:"min",value:t.getTime(),message:Z.toString(i)})}max(t,i){return this._addCheck({kind:"max",value:t.getTime(),message:Z.toString(i)})}get minDate(){let t=null;for(let i of this._def.checks)i.kind==="min"&&(t===null||i.value>t)&&(t=i.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(let i of this._def.checks)i.kind==="max"&&(t===null||i.value<t)&&(t=i.value);return t!=null?new Date(t):null}};ir.create=e=>new ir(k({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Y.ZodDate},se(e)));var Ls=class extends ce{_parse(e){if(this._getType(e)!==z.symbol){let t=this._getOrReturnCtx(e);return $(t,{code:L.invalid_type,expected:z.symbol,received:t.parsedType}),te}return ot(e.data)}};Ls.create=e=>new Ls(k({typeName:Y.ZodSymbol},se(e)));var nr=class extends ce{_parse(e){if(this._getType(e)!==z.undefined){let t=this._getOrReturnCtx(e);return $(t,{code:L.invalid_type,expected:z.undefined,received:t.parsedType}),te}return ot(e.data)}};nr.create=e=>new nr(k({typeName:Y.ZodUndefined},se(e)));var rr=class extends ce{_parse(e){if(this._getType(e)!==z.null){let t=this._getOrReturnCtx(e);return $(t,{code:L.invalid_type,expected:z.null,received:t.parsedType}),te}return ot(e.data)}};rr.create=e=>new rr(k({typeName:Y.ZodNull},se(e)));var yn=class extends ce{constructor(){super(...arguments),this._any=!0}_parse(e){return ot(e.data)}};yn.create=e=>new yn(k({typeName:Y.ZodAny},se(e)));var Vi=class extends ce{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ot(e.data)}};Vi.create=e=>new Vi(k({typeName:Y.ZodUnknown},se(e)));var pi=class extends ce{_parse(e){let t=this._getOrReturnCtx(e);return $(t,{code:L.invalid_type,expected:z.never,received:t.parsedType}),te}};pi.create=e=>new pi(k({typeName:Y.ZodNever},se(e)));var Ns=class extends ce{_parse(e){if(this._getType(e)!==z.undefined){let t=this._getOrReturnCtx(e);return $(t,{code:L.invalid_type,expected:z.void,received:t.parsedType}),te}return ot(e.data)}};Ns.create=e=>new Ns(k({typeName:Y.ZodVoid},se(e)));var Ji=class Ps extends ce{_parse(t){let{ctx:i,status:r}=this._processInputParams(t),o=this._def;if(i.parsedType!==z.array)return $(i,{code:L.invalid_type,expected:z.array,received:i.parsedType}),te;if(o.exactLength!==null){let u=i.data.length>o.exactLength.value,c=i.data.length<o.exactLength.value;(u||c)&&($(i,{code:u?L.too_big:L.too_small,minimum:c?o.exactLength.value:void 0,maximum:u?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),r.dirty())}if(o.minLength!==null&&i.data.length<o.minLength.value&&($(i,{code:L.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),r.dirty()),o.maxLength!==null&&i.data.length>o.maxLength.value&&($(i,{code:L.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),r.dirty()),i.common.async)return Promise.all([...i.data].map((u,c)=>o.type._parseAsync(new Yt(i,u,i.path,c)))).then(u=>dt.mergeArray(r,u));let a=[...i.data].map((u,c)=>o.type._parseSync(new Yt(i,u,i.path,c)));return dt.mergeArray(r,a)}get element(){return this._def.type}min(t,i){return new Ps(ee(k({},this._def),{minLength:{value:t,message:Z.toString(i)}}))}max(t,i){return new Ps(ee(k({},this._def),{maxLength:{value:t,message:Z.toString(i)}}))}length(t,i){return new Ps(ee(k({},this._def),{exactLength:{value:t,message:Z.toString(i)}}))}nonempty(t){return this.min(1,t)}};Ji.create=(e,t)=>new Ji(k({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Y.ZodArray},se(t)));function hn(e){if(e instanceof xt){let t={};for(let i in e.shape){let r=e.shape[i];t[i]=qt.create(hn(r))}return new xt(ee(k({},e._def),{shape:()=>t}))}else return e instanceof Ji?new Ji(ee(k({},e._def),{type:hn(e.element)})):e instanceof qt?qt.create(hn(e.unwrap())):e instanceof Mi?Mi.create(hn(e.unwrap())):e instanceof Ii?Ii.create(e.items.map(t=>hn(t))):e}var xt=class Dt extends ce{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let t=this._def.shape(),i=be.objectKeys(t);return this._cached={shape:t,keys:i}}_parse(t){if(this._getType(t)!==z.object){let p=this._getOrReturnCtx(t);return $(p,{code:L.invalid_type,expected:z.object,received:p.parsedType}),te}let{status:i,ctx:r}=this._processInputParams(t),{shape:o,keys:a}=this._getCached(),u=[];if(!(this._def.catchall instanceof pi&&this._def.unknownKeys==="strip"))for(let p in r.data)a.includes(p)||u.push(p);let c=[];for(let p of a){let h=o[p],f=r.data[p];c.push({key:{status:"valid",value:p},value:h._parse(new Yt(r,f,r.path,p)),alwaysSet:p in r.data})}if(this._def.catchall instanceof pi){let p=this._def.unknownKeys;if(p==="passthrough")for(let h of u)c.push({key:{status:"valid",value:h},value:{status:"valid",value:r.data[h]}});else if(p==="strict")u.length>0&&($(r,{code:L.unrecognized_keys,keys:u}),i.dirty());else if(p!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let p=this._def.catchall;for(let h of u){let f=r.data[h];c.push({key:{status:"valid",value:h},value:p._parse(new Yt(r,f,r.path,h)),alwaysSet:h in r.data})}}return r.common.async?Promise.resolve().then(()=>di(this,null,function*(){let p=[];for(let h of c){let f=yield h.key,m=yield h.value;p.push({key:f,value:m,alwaysSet:h.alwaysSet})}return p})).then(p=>dt.mergeObjectSync(i,p)):dt.mergeObjectSync(i,c)}get shape(){return this._def.shape()}strict(t){return Z.errToObj,new Dt(k(ee(k({},this._def),{unknownKeys:"strict"}),t!==void 0?{errorMap:(i,r)=>{var o,a,u,c;let p=(u=(a=(o=this._def).errorMap)===null||a===void 0?void 0:a.call(o,i,r).message)!==null&&u!==void 0?u:r.defaultError;return i.code==="unrecognized_keys"?{message:(c=Z.errToObj(t).message)!==null&&c!==void 0?c:p}:{message:p}}}:{}))}strip(){return new Dt(ee(k({},this._def),{unknownKeys:"strip"}))}passthrough(){return new Dt(ee(k({},this._def),{unknownKeys:"passthrough"}))}extend(t){return new Dt(ee(k({},this._def),{shape:()=>k(k({},this._def.shape()),t)}))}merge(t){return new Dt({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>k(k({},this._def.shape()),t._def.shape()),typeName:Y.ZodObject})}setKey(t,i){return this.augment({[t]:i})}catchall(t){return new Dt(ee(k({},this._def),{catchall:t}))}pick(t){let i={};return be.objectKeys(t).forEach(r=>{t[r]&&this.shape[r]&&(i[r]=this.shape[r])}),new Dt(ee(k({},this._def),{shape:()=>i}))}omit(t){let i={};return be.objectKeys(this.shape).forEach(r=>{t[r]||(i[r]=this.shape[r])}),new Dt(ee(k({},this._def),{shape:()=>i}))}deepPartial(){return hn(this)}partial(t){let i={};return be.objectKeys(this.shape).forEach(r=>{let o=this.shape[r];t&&!t[r]?i[r]=o:i[r]=o.optional()}),new Dt(ee(k({},this._def),{shape:()=>i}))}required(t){let i={};return be.objectKeys(this.shape).forEach(r=>{if(t&&!t[r])i[r]=this.shape[r];else{let o=this.shape[r];for(;o instanceof qt;)o=o._def.innerType;i[r]=o}}),new Dt(ee(k({},this._def),{shape:()=>i}))}keyof(){return tp(be.objectKeys(this.shape))}};xt.create=(e,t)=>new xt(k({shape:()=>e,unknownKeys:"strip",catchall:pi.create(),typeName:Y.ZodObject},se(t)));xt.strictCreate=(e,t)=>new xt(k({shape:()=>e,unknownKeys:"strict",catchall:pi.create(),typeName:Y.ZodObject},se(t)));xt.lazycreate=(e,t)=>new xt(k({shape:e,unknownKeys:"strip",catchall:pi.create(),typeName:Y.ZodObject},se(t)));var sr=class extends ce{_parse(e){let{ctx:t}=this._processInputParams(e),i=this._def.options;function r(o){for(let u of o)if(u.result.status==="valid")return u.result;for(let u of o)if(u.result.status==="dirty")return t.common.issues.push(...u.ctx.common.issues),u.result;let a=o.map(u=>new $t(u.ctx.common.issues));return $(t,{code:L.invalid_union,unionErrors:a}),te}if(t.common.async)return Promise.all(i.map(o=>di(this,null,function*(){let a=ee(k({},t),{common:ee(k({},t.common),{issues:[]}),parent:null});return{result:yield o._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}}))).then(r);{let o,a=[];for(let c of i){let p=ee(k({},t),{common:ee(k({},t.common),{issues:[]}),parent:null}),h=c._parseSync({data:t.data,path:t.path,parent:p});if(h.status==="valid")return h;h.status==="dirty"&&!o&&(o={result:h,ctx:p}),p.common.issues.length&&a.push(p.common.issues)}if(o)return t.common.issues.push(...o.ctx.common.issues),o.result;let u=a.map(c=>new $t(c));return $(t,{code:L.invalid_union,unionErrors:u}),te}}get options(){return this._def.options}};sr.create=(e,t)=>new sr(k({options:e,typeName:Y.ZodUnion},se(t)));var Ti=e=>e instanceof ar?Ti(e.schema):e instanceof zt?Ti(e.innerType()):e instanceof lr?[e.value]:e instanceof gr?e.options:e instanceof ur?be.objectValues(e.enum):e instanceof cr?Ti(e._def.innerType):e instanceof nr?[void 0]:e instanceof rr?[null]:e instanceof qt?[void 0,...Ti(e.unwrap())]:e instanceof Mi?[null,...Ti(e.unwrap())]:e instanceof vl||e instanceof dr?Ti(e.unwrap()):e instanceof hr?Ti(e._def.innerType):[],Kd=class Yd extends ce{_parse(t){let{ctx:i}=this._processInputParams(t);if(i.parsedType!==z.object)return $(i,{code:L.invalid_type,expected:z.object,received:i.parsedType}),te;let r=this.discriminator,o=i.data[r],a=this.optionsMap.get(o);return a?i.common.async?a._parseAsync({data:i.data,path:i.path,parent:i}):a._parseSync({data:i.data,path:i.path,parent:i}):($(i,{code:L.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),te)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,i,r){let o=new Map;for(let a of i){let u=Ti(a.shape[t]);if(!u.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(let c of u){if(o.has(c))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(c)}`);o.set(c,a)}}return new Yd(k({typeName:Y.ZodDiscriminatedUnion,discriminator:t,options:i,optionsMap:o},se(r)))}};function Ga(e,t){let i=xi(e),r=xi(t);if(e===t)return{valid:!0,data:e};if(i===z.object&&r===z.object){let o=be.objectKeys(t),a=be.objectKeys(e).filter(c=>o.indexOf(c)!==-1),u=k(k({},e),t);for(let c of a){let p=Ga(e[c],t[c]);if(!p.valid)return{valid:!1};u[c]=p.data}return{valid:!0,data:u}}else if(i===z.array&&r===z.array){if(e.length!==t.length)return{valid:!1};let o=[];for(let a=0;a<e.length;a++){let u=e[a],c=t[a],p=Ga(u,c);if(!p.valid)return{valid:!1};o.push(p.data)}return{valid:!0,data:o}}else return i===z.date&&r===z.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}var or=class extends ce{_parse(e){let{status:t,ctx:i}=this._processInputParams(e),r=(o,a)=>{if($a(o)||$a(a))return te;let u=Ga(o.value,a.value);return u.valid?((za(o)||za(a))&&t.dirty(),{status:t.value,value:u.data}):($(i,{code:L.invalid_intersection_types}),te)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([o,a])=>r(o,a)):r(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}};or.create=(e,t,i)=>new or(k({left:e,right:t,typeName:Y.ZodIntersection},se(i)));var Ii=class Qd extends ce{_parse(t){let{status:i,ctx:r}=this._processInputParams(t);if(r.parsedType!==z.array)return $(r,{code:L.invalid_type,expected:z.array,received:r.parsedType}),te;if(r.data.length<this._def.items.length)return $(r,{code:L.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),te;!this._def.rest&&r.data.length>this._def.items.length&&($(r,{code:L.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),i.dirty());let o=[...r.data].map((a,u)=>{let c=this._def.items[u]||this._def.rest;return c?c._parse(new Yt(r,a,r.path,u)):null}).filter(a=>!!a);return r.common.async?Promise.all(o).then(a=>dt.mergeArray(i,a)):dt.mergeArray(i,o)}get items(){return this._def.items}rest(t){return new Qd(ee(k({},this._def),{rest:t}))}};Ii.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ii(k({items:e,typeName:Y.ZodTuple,rest:null},se(t)))};var Xd=class Za extends ce{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:i,ctx:r}=this._processInputParams(t);if(r.parsedType!==z.object)return $(r,{code:L.invalid_type,expected:z.object,received:r.parsedType}),te;let o=[],a=this._def.keyType,u=this._def.valueType;for(let c in r.data)o.push({key:a._parse(new Yt(r,c,r.path,c)),value:u._parse(new Yt(r,r.data[c],r.path,c)),alwaysSet:c in r.data});return r.common.async?dt.mergeObjectAsync(i,o):dt.mergeObjectSync(i,o)}get element(){return this._def.valueType}static create(t,i,r){return i instanceof ce?new Za(k({keyType:t,valueType:i,typeName:Y.ZodRecord},se(r))):new Za(k({keyType:gn.create(),valueType:t,typeName:Y.ZodRecord},se(i)))}},Ds=class extends ce{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:i}=this._processInputParams(e);if(i.parsedType!==z.map)return $(i,{code:L.invalid_type,expected:z.map,received:i.parsedType}),te;let r=this._def.keyType,o=this._def.valueType,a=[...i.data.entries()].map(([u,c],p)=>({key:r._parse(new Yt(i,u,i.path,[p,"key"])),value:o._parse(new Yt(i,c,i.path,[p,"value"]))}));if(i.common.async){let u=new Map;return Promise.resolve().then(()=>di(this,null,function*(){for(let c of a){let p=yield c.key,h=yield c.value;if(p.status==="aborted"||h.status==="aborted")return te;(p.status==="dirty"||h.status==="dirty")&&t.dirty(),u.set(p.value,h.value)}return{status:t.value,value:u}}))}else{let u=new Map;for(let c of a){let p=c.key,h=c.value;if(p.status==="aborted"||h.status==="aborted")return te;(p.status==="dirty"||h.status==="dirty")&&t.dirty(),u.set(p.value,h.value)}return{status:t.value,value:u}}}};Ds.create=(e,t,i)=>new Ds(k({valueType:t,keyType:e,typeName:Y.ZodMap},se(i)));var js=class Ja extends ce{_parse(t){let{status:i,ctx:r}=this._processInputParams(t);if(r.parsedType!==z.set)return $(r,{code:L.invalid_type,expected:z.set,received:r.parsedType}),te;let o=this._def;o.minSize!==null&&r.data.size<o.minSize.value&&($(r,{code:L.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),i.dirty()),o.maxSize!==null&&r.data.size>o.maxSize.value&&($(r,{code:L.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),i.dirty());let a=this._def.valueType;function u(p){let h=new Set;for(let f of p){if(f.status==="aborted")return te;f.status==="dirty"&&i.dirty(),h.add(f.value)}return{status:i.value,value:h}}let c=[...r.data.values()].map((p,h)=>a._parse(new Yt(r,p,r.path,h)));return r.common.async?Promise.all(c).then(p=>u(p)):u(c)}min(t,i){return new Ja(ee(k({},this._def),{minSize:{value:t,message:Z.toString(i)}}))}max(t,i){return new Ja(ee(k({},this._def),{maxSize:{value:t,message:Z.toString(i)}}))}size(t,i){return this.min(t,i).max(t,i)}nonempty(t){return this.min(1,t)}};js.create=(e,t)=>new js(k({valueType:e,minSize:null,maxSize:null,typeName:Y.ZodSet},se(t)));var ep=class As extends ce{constructor(){super(...arguments),this.validate=this.implement}_parse(t){let{ctx:i}=this._processInputParams(t);if(i.parsedType!==z.function)return $(i,{code:L.invalid_type,expected:z.function,received:i.parsedType}),te;function r(c,p){return Ms({data:c,path:i.path,errorMaps:[i.common.contextualErrorMap,i.schemaErrorMap,Is(),vn].filter(h=>!!h),issueData:{code:L.invalid_arguments,argumentsError:p}})}function o(c,p){return Ms({data:c,path:i.path,errorMaps:[i.common.contextualErrorMap,i.schemaErrorMap,Is(),vn].filter(h=>!!h),issueData:{code:L.invalid_return_type,returnTypeError:p}})}let a={errorMap:i.common.contextualErrorMap},u=i.data;if(this._def.returns instanceof bn){let c=this;return ot(function(...p){return di(this,null,function*(){let h=new $t([]),f=yield c._def.args.parseAsync(p,a).catch(y=>{throw h.addIssue(r(p,y)),h}),m=yield Reflect.apply(u,this,f);return yield c._def.returns._def.type.parseAsync(m,a).catch(y=>{throw h.addIssue(o(m,y)),h})})})}else{let c=this;return ot(function(...p){let h=c._def.args.safeParse(p,a);if(!h.success)throw new $t([r(p,h.error)]);let f=Reflect.apply(u,this,h.data),m=c._def.returns.safeParse(f,a);if(!m.success)throw new $t([o(f,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new As(ee(k({},this._def),{args:Ii.create(t).rest(Vi.create())}))}returns(t){return new As(ee(k({},this._def),{returns:t}))}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,i,r){return new As(k({args:t||Ii.create([]).rest(Vi.create()),returns:i||Vi.create(),typeName:Y.ZodFunction},se(r)))}},ar=class extends ce{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};ar.create=(e,t)=>new ar(k({getter:e,typeName:Y.ZodLazy},se(t)));var lr=class extends ce{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return $(t,{received:t.data,code:L.invalid_literal,expected:this._def.value}),te}return{status:"valid",value:e.data}}get value(){return this._def.value}};lr.create=(e,t)=>new lr(k({value:e,typeName:Y.ZodLiteral},se(t)));function tp(e,t){return new gr(k({values:e,typeName:Y.ZodEnum},se(t)))}var gr=class qa extends ce{constructor(){super(...arguments),Jn.set(this,void 0)}_parse(t){if(typeof t.data!="string"){let i=this._getOrReturnCtx(t),r=this._def.values;return $(i,{expected:be.joinValues(r),received:i.parsedType,code:L.invalid_type}),te}if(Fs(this,Jn)||Gd(this,Jn,new Set(this._def.values)),!Fs(this,Jn).has(t.data)){let i=this._getOrReturnCtx(t),r=this._def.values;return $(i,{received:i.data,code:L.invalid_enum_value,options:r}),te}return ot(t.data)}get options(){return this._def.values}get enum(){let t={};for(let i of this._def.values)t[i]=i;return t}get Values(){let t={};for(let i of this._def.values)t[i]=i;return t}get Enum(){let t={};for(let i of this._def.values)t[i]=i;return t}extract(t,i=this._def){return qa.create(t,k(k({},this._def),i))}exclude(t,i=this._def){return qa.create(this.options.filter(r=>!t.includes(r)),k(k({},this._def),i))}};Jn=new WeakMap;gr.create=tp;var ur=class extends ce{constructor(){super(...arguments),qn.set(this,void 0)}_parse(e){let t=be.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==z.string&&i.parsedType!==z.number){let r=be.objectValues(t);return $(i,{expected:be.joinValues(r),received:i.parsedType,code:L.invalid_type}),te}if(Fs(this,qn)||Gd(this,qn,new Set(be.getValidEnumValues(this._def.values))),!Fs(this,qn).has(e.data)){let r=be.objectValues(t);return $(i,{received:i.data,code:L.invalid_enum_value,options:r}),te}return ot(e.data)}get enum(){return this._def.values}};qn=new WeakMap;ur.create=(e,t)=>new ur(k({values:e,typeName:Y.ZodNativeEnum},se(t)));var bn=class extends ce{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==z.promise&&t.common.async===!1)return $(t,{code:L.invalid_type,expected:z.promise,received:t.parsedType}),te;let i=t.parsedType===z.promise?t.data:Promise.resolve(t.data);return ot(i.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}};bn.create=(e,t)=>new bn(k({type:e,typeName:Y.ZodPromise},se(t)));var zt=class extends ce{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Y.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:i}=this._processInputParams(e),r=this._def.effect||null,o={addIssue:a=>{$(i,a),a.fatal?t.abort():t.dirty()},get path(){return i.path}};if(o.addIssue=o.addIssue.bind(o),r.type==="preprocess"){let a=r.transform(i.data,o);if(i.common.async)return Promise.resolve(a).then(u=>di(this,null,function*(){if(t.value==="aborted")return te;let c=yield this._def.schema._parseAsync({data:u,path:i.path,parent:i});return c.status==="aborted"?te:c.status==="dirty"||t.value==="dirty"?Rs(c.value):c}));{if(t.value==="aborted")return te;let u=this._def.schema._parseSync({data:a,path:i.path,parent:i});return u.status==="aborted"?te:u.status==="dirty"||t.value==="dirty"?Rs(u.value):u}}if(r.type==="refinement"){let a=u=>{let c=r.refinement(u,o);if(i.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(i.common.async===!1){let u=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return u.status==="aborted"?te:(u.status==="dirty"&&t.dirty(),a(u.value),{status:t.value,value:u.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(u=>u.status==="aborted"?te:(u.status==="dirty"&&t.dirty(),a(u.value).then(()=>({status:t.value,value:u.value}))))}if(r.type==="transform")if(i.common.async===!1){let a=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!Yn(a))return a;let u=r.transform(a.value,o);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:u}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(a=>Yn(a)?Promise.resolve(r.transform(a.value,o)).then(u=>({status:t.value,value:u})):a);be.assertNever(r)}};zt.create=(e,t,i)=>new zt(k({schema:e,typeName:Y.ZodEffects,effect:t},se(i)));zt.createWithPreprocess=(e,t,i)=>new zt(k({schema:t,effect:{type:"preprocess",transform:e},typeName:Y.ZodEffects},se(i)));var qt=class extends ce{_parse(e){return this._getType(e)===z.undefined?ot(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};qt.create=(e,t)=>new qt(k({innerType:e,typeName:Y.ZodOptional},se(t)));var Mi=class extends ce{_parse(e){return this._getType(e)===z.null?ot(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Mi.create=(e,t)=>new Mi(k({innerType:e,typeName:Y.ZodNullable},se(t)));var cr=class extends ce{_parse(e){let{ctx:t}=this._processInputParams(e),i=t.data;return t.parsedType===z.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};cr.create=(e,t)=>new cr(k({innerType:e,typeName:Y.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default},se(t)));var hr=class extends ce{_parse(e){let{ctx:t}=this._processInputParams(e),i=ee(k({},t),{common:ee(k({},t.common),{issues:[]})}),r=this._def.innerType._parse({data:i.data,path:i.path,parent:k({},i)});return Qn(r)?r.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new $t(i.common.issues)},input:i.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new $t(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}};hr.create=(e,t)=>new hr(k({innerType:e,typeName:Y.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch},se(t)));var Bs=class extends ce{_parse(e){if(this._getType(e)!==z.nan){let t=this._getOrReturnCtx(e);return $(t,{code:L.invalid_type,expected:z.nan,received:t.parsedType}),te}return{status:"valid",value:e.data}}};Bs.create=e=>new Bs(k({typeName:Y.ZodNaN},se(e)));var gP=Symbol("zod_brand"),vl=class extends ce{_parse(e){let{ctx:t}=this._processInputParams(e),i=t.data;return this._def.type._parse({data:i,path:t.path,parent:t})}unwrap(){return this._def.type}},gl=class ip extends ce{_parse(t){let{status:i,ctx:r}=this._processInputParams(t);if(r.common.async)return di(this,null,function*(){let o=yield this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?te:o.status==="dirty"?(i.dirty(),Rs(o.value)):this._def.out._parseAsync({data:o.value,path:r.path,parent:r})});{let o=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?te:o.status==="dirty"?(i.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:r.path,parent:r})}}static create(t,i){return new ip({in:t,out:i,typeName:Y.ZodPipeline})}},dr=class extends ce{_parse(e){let t=this._def.innerType._parse(e),i=r=>(Yn(r)&&(r.value=Object.freeze(r.value)),r);return Qn(t)?t.then(r=>i(r)):i(t)}unwrap(){return this._def.innerType}};dr.create=(e,t)=>new dr(k({innerType:e,typeName:Y.ZodReadonly},se(t)));function np(e,t={},i){return e?yn.create().superRefine((r,o)=>{var a,u;if(!e(r)){let c=typeof t=="function"?t(r):typeof t=="string"?{message:t}:t,p=(u=(a=c.fatal)!==null&&a!==void 0?a:i)!==null&&u!==void 0?u:!0,h=typeof c=="string"?{message:c}:c;o.addIssue(ee(k({code:"custom"},h),{fatal:p}))}}):yn.create()}var yP={object:xt.lazycreate},Y;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Y||(Y={}));var bP=(e,t={message:`Input not instance of ${e.name}`})=>np(i=>i instanceof e,t),rp=gn.create,sp=Xn.create,wP=Bs.create,_P=er.create,op=tr.create,CP=ir.create,EP=Ls.create,PP=nr.create,AP=rr.create,SP=yn.create,OP=Vi.create,TP=pi.create,xP=Ns.create,kP=Ji.create,IP=xt.create,MP=xt.strictCreate,RP=sr.create,FP=Kd.create,LP=or.create,NP=Ii.create,DP=Xd.create,jP=Ds.create,BP=js.create,UP=ep.create,$P=ar.create,zP=lr.create,WP=gr.create,VP=ur.create,GP=bn.create,Rh=zt.create,ZP=qt.create,JP=Mi.create,qP=zt.createWithPreprocess,HP=gl.create,KP=()=>rp().optional(),YP=()=>sp().optional(),QP=()=>op().optional(),XP={string:e=>gn.create(ee(k({},e),{coerce:!0})),number:e=>Xn.create(ee(k({},e),{coerce:!0})),boolean:e=>tr.create(ee(k({},e),{coerce:!0})),bigint:e=>er.create(ee(k({},e),{coerce:!0})),date:e=>ir.create(ee(k({},e),{coerce:!0}))},eA=te,jt=Object.freeze({__proto__:null,defaultErrorMap:vn,setErrorMap:eP,getErrorMap:Is,makeIssue:Ms,EMPTY_PATH:tP,addIssueToContext:$,ParseStatus:dt,INVALID:te,DIRTY:Rs,OK:ot,isAborted:$a,isDirty:za,isValid:Yn,isAsync:Qn,get util(){return be},get objectUtil(){return Ua},ZodParsedType:z,getParsedType:xi,ZodType:ce,datetimeRegex:qd,ZodString:gn,ZodNumber:Xn,ZodBigInt:er,ZodBoolean:tr,ZodDate:ir,ZodSymbol:Ls,ZodUndefined:nr,ZodNull:rr,ZodAny:yn,ZodUnknown:Vi,ZodNever:pi,ZodVoid:Ns,ZodArray:Ji,ZodObject:xt,ZodUnion:sr,ZodDiscriminatedUnion:Kd,ZodIntersection:or,ZodTuple:Ii,ZodRecord:Xd,ZodMap:Ds,ZodSet:js,ZodFunction:ep,ZodLazy:ar,ZodLiteral:lr,ZodEnum:gr,ZodNativeEnum:ur,ZodPromise:bn,ZodEffects:zt,ZodTransformer:zt,ZodOptional:qt,ZodNullable:Mi,ZodDefault:cr,ZodCatch:hr,ZodNaN:Bs,BRAND:gP,ZodBranded:vl,ZodPipeline:gl,ZodReadonly:dr,custom:np,Schema:ce,ZodSchema:ce,late:yP,get ZodFirstPartyTypeKind(){return Y},coerce:XP,any:SP,array:kP,bigint:_P,boolean:op,date:CP,discriminatedUnion:FP,effect:Rh,enum:WP,function:UP,instanceof:bP,intersection:LP,lazy:$P,literal:zP,map:jP,nan:wP,nativeEnum:VP,never:TP,null:AP,nullable:JP,number:sp,object:IP,oboolean:QP,onumber:YP,optional:ZP,ostring:KP,pipeline:HP,preprocess:qP,promise:GP,record:DP,set:BP,strictObject:MP,string:rp,symbol:EP,transformer:Rh,tuple:NP,undefined:PP,union:RP,unknown:OP,void:xP,NEVER:eA,ZodIssueCode:L,quotelessJson:XE,ZodError:$t}),tA=jt.object({serverUrl:jt.string()}),iA=tA.parse({serverUrl:"https://io.superviz.com"}),nA=class{constructor(e){this.socket=e,this.onConnect=()=>{this.logger.log("connection @ on connect","Connected to the socket"),this.changeState("CONNECTED")},this.onDisconnect=t=>{this.logger.log("connection @ on disconnect","Disconnected from the socket"),this.changeState("DISCONNECTED",t)},this.onConnectError=t=>{this.logger.log("connection @ on connect error","Connection error",t),this.changeState("CONNECTION_ERROR",t.message)},this.onConnectionError=t=>{this.logger.log("connection @ on connection error","Connection error",t),this.changeState("CONNECTION_ERROR",t.message)},this.onReconnect=()=>{this.logger.log("connection @ on reconnect","Reconnected to the socket"),this.changeState("CONNECTED")},this.onReconnectError=t=>{this.logger.log("connection @ on reconnect error","Reconnect error",t),this.changeState("RECONNECT_ERROR",t.message)},this.onReconnectFailed=()=>{this.logger.log("connection @ on reconnect failed","Failed to reconnect to the socket"),this.changeState("RECONNECT_ERROR")},this.onReconnecAttempt=t=>{this.logger.log("connection @ on reconnect attempt",`Reconnect attempt #${t}`),this.changeState("RECONNECTING",`Reconnect attempt #${t}`)},this.onCustomError=t=>{t.needsToDisconnect&&(this.socket.disconnect(),this.changeState("DISCONNECTED",t.errorType));let i=`[SuperViz] 
    - Error: ${t.errorType}
    - Message: ${t.message}
    `;if(t.level==="error"){console.error(i);return}console.warn(i)},this.logger=new cl("@superviz/socket-client/connection"),this.subscribeToManagerEvents(),this.stateObserver=new Jt}on(e,t){this.stateObserver.closed&&(this.stateObserver=new Jt),this.stateObserver.subscribe({next:e,error:t})}off(){this.stateObserver.closed||this.stateObserver.unsubscribe()}subscribeToManagerEvents(){this.socket.on("connect",this.onConnect),this.socket.on("disconnect",this.onDisconnect),this.socket.on("connect_error",this.onConnectError),this.socket.io.on("error",this.onConnectionError),this.socket.io.on("reconnect",this.onReconnect),this.socket.io.on("reconnect_attempt",this.onReconnecAttempt),this.socket.io.on("reconnect_error",this.onReconnectError),this.socket.io.on("reconnect_failed",this.onReconnectFailed),this.socket.on("socket-event.error",this.onCustomError)}changeState(e,t){this.state=e,!this.stateObserver.closed&&this.stateObserver.next({state:e,reason:t})}},rA=class ap{constructor(t,i,r,o,a=100){this.io=t,this.user=i,this.roomId=r,this.apiKey=o,this.maxConnections=a,this.isJoined=!1,this.subscriptions=new Map,this.observers=new Map,this.onJoinedRoom=c=>{var p;this.roomId===((p=c==null?void 0:c.data)==null?void 0:p.name)&&(this.isJoined=!0,this.io.emit("room.joined",this.roomId,c.data),this.logger.log("room @ joined",c))},this.onHttpEvent=c=>{this.publishEventToClient(c.name,c)},this.logger=new cl("@superviz/socket-client/room");let u={name:r,user:i,maxConnections:a};this.presence=uE.register(t,i,r),this.io.emit("room.join",u),this.subscribeToRoomEvents()}static register(t,i,r,o,a){return new ap(t,i,r,o,a)}on(t,i){this.logger.log("room @ on",t);let r=this.observers.get(t);r||(r=new Jt,this.observers.set(t,r),this.io.on(t,o=>{this.publishEventToClient(t,o)})),this.subscriptions.set(i,r.subscribe(i))}off(t,i){var r;if(this.logger.log("room @ off",t),!i){this.observers.delete(t),this.io.off(t);return}(r=this.subscriptions.get(i))==null||r.unsubscribe()}emit(t,i){if(!this.isJoined){this.logger.log("Cannot emit event. Not joined to room");return}let r={name:t,roomId:this.roomId,presence:this.user,connectionId:this.io.id,data:i,timestamp:Date.now()};this.io.emit("room.update",this.roomId,r),this.logger.log("room @ emit",t,i)}history(t,i){let r=new Jt;r.subscribe({next:t,error:i});let o=a=>{this.logger.log("room @ history",a),this.io.off("room.get",o),r.next(a),r.complete(),r.unsubscribe()};this.io.on("room.get",o),this.io.emit("room.get",this.roomId)}disconnect(){this.logger.log("room @ disconnect","Leaving room...",this.roomId),this.io.emit("room.leave",this.roomId),this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions.clear(),this.observers.forEach(t=>t.unsubscribe()),this.observers.clear(),this.presence.destroy()}publishEventToClient(t,i){let r=this.observers.get(t);!r||i.roomId!==this.roomId||r.next(i)}subscribeToRoomEvents(){this.io.on("room.joined",this.onJoinedRoom),this.io.on("room.error",t=>{this.logger.log("Error:",t.data)}),this.io.on(`http:${this.roomId}:${this.apiKey}`,this.onHttpEvent)}},sA=class{constructor(e,t,i,r,o){this.apiKey=e,this.environment=t,this.presence=i,this.secret=r,this.clientId=o,this.manager=new ks(iA.serverUrl,{addTrailingSlash:!1,secure:!0,withCredentials:!0,reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:5,extraHeaders:{"sv-api-key":this.apiKey}});let a;typeof window<"u"&&(a=window.location.origin),this.socket=this.manager.socket(`/${t}`,{auth:{apiKey:this.apiKey,origin:a,envirioment:this.environment,secret:this.secret,clientId:this.clientId}}),this.connection=new nA(this.socket)}get state(){return this.connection.state}connect(e,t){return rA.register(this.socket,this.presence,e,this.apiKey,t)}destroy(){this.socket.disconnect(),this.connection.off()}};jt.object({name:jt.string(),user:jt.object({id:jt.string(),name:jt.string().nullable()}),maxConnections:jt.union([jt.number(),jt.literal("unlimited"),jt.undefined()])});var oA=Wt(wn());O();var Fh=class{constructor(){this.observers=new Map,this.subscribe=(e,t)=>{this.logger.log("event bus service @ subscribe",{event:e,callback:t}),this.observers.has(e)||this.observers.set(e,new $e),this.observers.get(e).subscribe(t)},this.unsubscribe=(e,t)=>{this.logger.log("event bus service @ unsubscribe",{event:e,callback:t}),this.observers.has(e)&&(this.observers.get(e).reset(),this.observers.delete(e))},this.publish=(e,t)=>{this.logger.log("event bus service @ publish",{event:e,data:t}),this.observers.has(e)&&this.observers.get(e).publish(t)},this.destroy=()=>{this.logger.log("event bus service @ destroy"),this.observers.forEach(e=>{e.reset(),e.destroy()}),this.observers.clear()},this.logger=new He("@superviz/sdk/event-bus"),this.logger.log("event bus created")}};O();O();var aA=class{constructor(e){this.participant=e,this.stateSubject=new vr,this.handleConnectionState=t=>{if(t.reason==="Unauthorized connection"){console.error("[Superviz] Unauthorized connection. Please check your API key and if your domain is white listed."),this.state={state:bd.DISCONNECTED,reason:"Unauthorized connection"},this.stateSubject.next("AUTH_ERROR");return}if(t.reason==="user-already-in-room"){this.state=t,this.stateSubject.next("SAME_ACCOUNT_ERROR");return}this.state=t,this.stateSubject.next(t.state)},this.createClient()}destroy(){this.stateSubject.complete(),this.client.destroy()}subscribeToDefaultEvents(){this.client.connection.on(this.handleConnectionState)}createClient(){let e=Q.get("environment");e=["dev","prod"].includes(e)?e:"dev",this.client=new sA(Q.get("apiKey"),e,{id:this.participant.id,name:this.participant.name}),this.subscribeToDefaultEvents()}createRoom(e,t=50){let i=Q.get("roomId");return this.client.connect(`${i}:${e}`,t)}};O();O();var lp=(e=>(e.comments="presence",e.presence3dMatterport="presence",e.presence3dAutodesk="presence",e.presence3dThreejs="presence",e.whoIsOnline="presence",e.formElements="presence",e.yjsProvider="presence",e))(lp||{}),Lh=class{static checkComponentLimit(e){var t,i;let r=Q.get("limits"),o=(t=lp[e])!=null?t:e;return(i=r==null?void 0:r[o])!=null?i:{canUse:!1,maxParticipants:50}}};O();var lA=Wt(wn());O();var uA=1e3,cA=class{constructor(e,t){this.participants3DObservers=[],this.initializeParticipantsList=()=>{this.room.presence.get(r=>{r.forEach(o=>{this.unthrottledUpdatePresence3D(o.data)})})},this.onLocalParticipantJoined=r=>{var o;if(!r.slot||((o=r.slot)==null?void 0:o.index)===null){setTimeout(()=>{this.onLocalParticipantJoined(this.localParticipant)},2e3);return}if(!this.room.isJoined){setTimeout(()=>{this.onLocalParticipantJoined(r)},2e3);return}let{hasJoined3D:a}=this.useStore("presence-3d-store");a.publish(!0),this.room.emit("participant-joined",r),this.room.presence.update(r),this.initializeParticipantsList()},this.subscribeToRoomEvents=()=>{this.room.on("participant-joined",this.onJoinedRoom),this.room.presence.on(X.LEAVE,this.onLeaveRoom),this.room.presence.on(X.UPDATE,this.onParticipantUpdate),this.room.presence.on(X.JOINED_ROOM,this.onJoinedPresence)},this.unsubscribeFromRoomEvents=()=>{this.room.off("participant-joined",this.onJoinedRoom),this.room.presence.off(X.LEAVE),this.room.presence.off(X.UPDATE),this.room.presence.off(X.JOINED_ROOM)},this.onJoinedRoom=r=>{let{participants:o}=this.useStore("presence-3d-store"),a=o.value.find(u=>u.id===r.data.id);o.publish([...o.value.filter(u=>u.id!==r.data.id),B(B({},a),r.data)])},this.onLeaveRoom=r=>{if(r.id===this.localParticipant.id){this.unsubscribeFromRoomEvents(),this.useStore("presence-3d-store").destroy();return}let{participants:o}=this.useStore("presence-3d-store"),a=o.value.filter(u=>u.id!==r.id);o.publish(a)},this.unthrottledUpdatePresence3D=r=>{if(!(r!=null&&r.id))return;let{participants:o,hasJoined3D:a}=this.useStore("presence-3d-store"),u=B(B({},o.value.find(c=>c.id===r.id)),r);o.publish([...o.value.filter(c=>c.id!==r.id),u]),!(!a.value||u.id!==this.localParticipant.id)&&this.room.presence.update(u)},this.onJoinedPresence=r=>{r.id===this.localParticipant.id&&(this.logger.log("participant joined 3D room",r.id,this.localParticipant),this.onLocalParticipantJoined(this.localParticipant))},this.updatePresence3D=(0,lA.throttle)(r=>{this.unthrottledUpdatePresence3D(r)},uA),this.onParticipantUpdate=r=>{if(r.id===this.localParticipant.id)return;let{participants:o}=this.useStore("presence-3d-store"),a=B(B({},o.value.filter(c=>c.id===r.id)[0]),r.data),u=o.value.map(c=>c.id===r.id?a:c);o.publish(u),this.participants3DObservers[r.id]&&this.participants3DObservers[r.id].publish(a)},this.setParticipantData=r=>{this.updatePresence3D(r)},this.room=e,this.logger=new He("@superviz/sdk/presence3D-manager"),this.useStore=t,this.subscribeToRoomEvents();let{localParticipant:i}=this.useStore("global-store");i.subscribe(r=>{this.room.presence.update(r);let{participants:o}=this.useStore("presence-3d-store"),a=B(B({},o.value.find(u=>u.id===r.id)),r);o.publish([...o.value.filter(u=>u.id!==r.id),a]),this.localParticipant=a})}subscribeToUpdates(e,t){this.participants3DObservers[e]||(this.participants3DObservers[e]=new $e({logger:this.logger})),this.participants3DObservers[e].subscribe(t)}unsubscribeFromUpdates(e,t){this.participants3DObservers[e]&&this.participants3DObservers[e].unsubscribe(t)}get getParticipants(){return this.useStore("presence-3d-store").participants.value}};O();O();var up=(e=>(e.HOST="host",e.GUEST="guest",e.AUDIENCE="audience",e))(up||{}),hA=class{constructor(e,t){this.room=e,this.useStore=t,this.isAssigningSlot=!1,this.slot={index:null,color:Ut.gray,textColor:"#fff",colorName:"gray",timestamp:Date.now()},this.onPresenceUpdate=i=>ue(this,null,function*(){var r,o,a;let{localParticipant:u}=this.useStore("global-store");if(i.id===u.value.id){let c=yield this.validateSlotType(i.data);u.publish(de(B({},u.value),{slot:c}));return}if(!(((r=i.data.slot)==null?void 0:r.index)===null||this.slot.index===null)&&((o=i.data.slot)==null?void 0:o.index)===((a=this.slot)==null?void 0:a.index)){let c=yield this.assignSlot();u.publish(de(B({},u.value),{slot:c})),console.debug(`[SuperViz] - Slot reassigned to ${u.value.id}, slot: ${c.colorName}`)}}),this.participantNeedsSlot=i=>{var r;let o=["formElements","whoIsOnline","presence","presence3dAutodesk","presence3dMatterport","presence3dThreejs","yjsProvider"].some(u=>{var c;return(c=i==null?void 0:i.activeComponents)==null?void 0:c.includes(u)}),a=((r=i==null?void 0:i.activeComponents)==null?void 0:r.includes("videoConference"))&&i.type!=="audience";return o||a},this.validateSlotType=i=>ue(this,null,function*(){var r,o;if(this.isAssigningSlot)return this.slot;let a=this.participantNeedsSlot(i);if(((r=i.slot)==null?void 0:r.index)===null&&a){let u=yield this.assignSlot();this.slot=u}return((o=i.slot)==null?void 0:o.index)!==null&&!a&&this.setDefaultSlot(),this.slot}),this.room=e,this.room.presence.on(X.UPDATE,this.onPresenceUpdate)}assignSlot(){return ue(this,null,function*(){if(this.isAssigningSlot)return this.slot;this.isAssigningSlot=!0;let e=Array.from({length:50},(o,a)=>a),t=Math.floor(Math.random()*50),{localParticipant:i,participants:r}=tt("global-store");try{yield new Promise((u,c)=>{this.room.presence.get(p=>{if((!p||!p.length)&&u(!0),p.length>=50){e=[],c(new Error("[SuperViz] - No more slots available"));return}p.forEach(h=>{h.id!==i.value.id&&(e=e.filter(f=>{var m,y;return f!==((y=(m=h.data)==null?void 0:m.slot)==null?void 0:y.index)}))}),u(!0)})}),!e.includes(t)&&(t=e.shift());let o=Object.keys(Ut)[t],a={index:t,color:Ut[o],textColor:Sw.includes(o)?"#fff":"#000",colorName:o,timestamp:Date.now()};return this.slot=a,i.publish(de(B({},i.value),{slot:a})),r.publish(de(B({},r.value),{[i.value.id]:de(B({},r.value[i.value.id]),{slot:a})})),this.room.presence.update({slot:a}),this.isAssigningSlot=!1,a}catch(o){return console.error(o),null}})}setDefaultSlot(){let{localParticipant:e,participants:t}=tt("global-store"),i={index:null,color:Ut.gray,textColor:"#fff",colorName:"gray",timestamp:Date.now()};this.slot=i,e.publish(de(B({},e.value),{slot:i})),t.publish(de(B({},t.value),{[e.value.id]:de(B({},t.value[e.value.id]),{slot:i})})),this.room.presence.update({slot:i})}};O();var dA=class extends ll{constructor({participant:e,group:t}){super(),this.isDestroyed=!1,this.activeComponents=[],this.componentsToAttachAfterJoin=[],this.activeComponentsInstances=[],this.eventBus=new Fh,this.useStore=tt.bind(this),this.addComponent=c=>ue(this,null,function*(){if(!this.canAddComponent(c))return;let{hasJoinedRoom:p,group:h,localParticipant:f}=tt("global-store");if(!p.value){this.logger.log("launcher service @ addComponent - not joined yet"),this.componentsToAttachAfterJoin.push(c);return}let m=Lh.checkComponentLimit(c.name);c.attach({ioc:this.ioc,config:Q.configuration,eventBus:this.eventBus,useStore:tt,Presence3DManagerService:cA,connectionLimit:m.maxParticipants}),this.activeComponents.push(c.name),this.activeComponentsInstances.some(y=>y.name===c.name)?this.activeComponentsInstances=this.activeComponentsInstances.map(y=>y.name===c.name?c:y):this.activeComponentsInstances.push(c),f.publish(de(B({},f.value),{activeComponents:this.activeComponents})),this.room.presence.update(de(B({},f.value),{slot:this.slotService.slot,activeComponents:this.activeComponents})),Qe.sendActivity(this.participant.id,h.value.id,h.value.name,c.name)}),this.attachComponentsAfterJoin=()=>{this.logger.log("launcher service @ attachComponentsAfterJoin"),this.componentsToAttachAfterJoin.forEach(c=>{this.logger.log("launcher service @ attachComponentsAfterJoin - attaching component",c.name),this.addComponent(c)}),this.componentsToAttachAfterJoin=[]},this.removeComponent=c=>{if(!this.activeComponents.includes(c.name)){let p=`[SuperViz] Component ${c.name} is not initialized yet.`;this.logger.log(p),console.error(p);return}c.detach(),this.activeComponentsInstances=this.activeComponentsInstances.filter(p=>p.name!==c.name),this.activeComponents.splice(this.activeComponents.indexOf(c.name),1),this.room.presence.update(de(B({},this.participant),{activeComponents:this.activeComponents}))},this.destroy=()=>{var c,p,h,f,m,y;this.logger.log("launcher service @ destroy"),this.activeComponentsInstances.forEach(g=>{this.logger.log("launcher service @ destroy - removing component",g.name),this.removeComponent(g)}),this.activeComponents=[],this.activeComponentsInstances=[],(c=ol())==null||c.destroy(),(p=this.eventBus)==null||p.destroy(),this.eventBus=void 0,(h=this.room)==null||h.presence.off(X.JOINED_ROOM),(f=this.room)==null||f.presence.off(X.LEAVE),(m=this.room)==null||m.presence.off(X.UPDATE),(y=this.ioc)==null||y.destroy(),this.isDestroyed=!0,typeof window<"u"&&(window.SUPERVIZ=void 0)},this.canAddComponent=c=>{var p;let h=Q.get(`features.${c.name}`),f=Lh.checkComponentLimit(c.name),m=(p=this.activeComponents)==null?void 0:p.includes(c.name),y=[{isValid:h,message:`[SuperViz] Component ${c.name} is not enabled in the room`},{isValid:!this.isDestroyed,message:"[SuperViz] Component can not be added because the superviz room is destroyed. Initialize a new room to add and use components."},{isValid:!m,message:`[SuperViz] Component ${c.name} is already active. Please remove it first`},{isValid:f.canUse,message:`[SuperViz] You reached the limit usage of ${c.name}`}];for(let g=0;g<y.length;g++){let{isValid:_,message:E}=y[g];if(!_)return this.logger.log(E),console.error(E),!1}return!0},this.onAuthentication=c=>{c||(this.destroy(),console.error("[SuperViz] Room cannot be initialized because this website's domain is not whitelisted. If you are the developer, please add your domain in https://dashboard.superviz.com/developer"))},this.onLocalParticipantUpdateOnStore=c=>{this.participant=c,this.activeComponents=c.activeComponents||[]},this.onLocalParticipantUpdateOnCore=c=>{this.room&&this.room.presence.update(c)},this.onParticipantsListUpdateOnCore=c=>{let{participants:p}=this.useStore("global-store");p.publish(c)},this.onSameAccount=()=>{this.publish("participant.same-account-error"),this.destroy()},this.startIOC=()=>{this.logger.log("launcher service @ startIOC");let{participants:c}=tt("global-store");this.ioc.stateSubject.subscribe(this.onConnectionStateChange),this.room.presence.get(p=>{let h={};p.forEach(f=>{h[f.id]=de(B({},f.data),{name:f.name,id:f.id,timestamp:f.timestamp})}),h[this.participant.id]=B(B({},h[this.participant.id]),this.participant),c.publish(h)}),this.room.presence.on(X.JOINED_ROOM,this.onParticipantJoinedIOC),this.room.presence.on(X.LEAVE,this.onParticipantLeaveIOC),this.room.presence.on(X.UPDATE,this.onParticipantUpdatedIOC)},this.onConnectionStateChange=c=>{if(c==="AUTH_ERROR"){this.onAuthentication(!1);return}c==="SAME_ACCOUNT_ERROR"&&this.onSameAccount()},this.onParticipantJoinedIOC=c=>ue(this,null,function*(){if(c.id!==this.participant.id)return;this.room.presence.update(this.participant),this.logger.log("launcher service @ onParticipantJoined - local participant joined");let{hasJoinedRoom:p}=tt("global-store");p.publish(!0),this.attachComponentsAfterJoin(),this.publish("participant.local-joined",this.participant),this.publish("participant.joined",this.participant)}),this.onParticipantLeaveIOC=c=>{let{participants:p,localParticipant:h}=tt("global-store"),f=B({},p.value);delete f[c.id],p.publish(f),c.id===h.value.id&&(this.logger.log("launcher service @ onParticipantLeave - local participant left"),this.publish("participant.local-left",c.data)),this.logger.log("launcher service @ onParticipantLeave - participant left",c.data),this.publish("participant.left",c.data),this.publish("participant.list-updated",Object.values(f))},this.onParticipantUpdatedIOC=c=>{let{localParticipant:p}=tt("global-store");if(p.value&&c.id===p.value.id){let g=B(B({},p.value),c.data);p.publish(de(B({},g),{timestamp:c.timestamp})),this.publish("participant.updated",g),this.logger.log("Publishing ParticipantEvent.UPDATED",c.data)}let{participants:h}=tt("global-store"),f=B({id:c.id,name:c.name,timestamp:c.timestamp},c.data);h.value[c.id]||this.publish("participant.joined",f);let m=Object.assign({},h.value);if(m[c.id]=f,(0,oA.isEqual)(m,h.value))return;h.publish(m);let y=Object.values(h.value);this.logger.log("Publishing ParticipantEvent.LIST_UPDATED",h.value),this.publish("participant.list-updated",y)},this.logger=new He("@superviz/sdk/launcher");let{localParticipant:i,group:r,isDomainWhitelisted:o}=this.useStore("global-store"),{localParticipant:a,participants:u}=this.useStore("core-store");i.publish(B({},e)),o.subscribe(this.onAuthentication),i.subscribe(this.onLocalParticipantUpdateOnStore),a.subscribe(this.onLocalParticipantUpdateOnCore),u.subscribe(this.onParticipantsListUpdateOnCore),r.publish(t),this.ioc=new aA(i.value),this.room=this.ioc.createRoom("launcher","unlimited"),this.slotService=new hA(this.room,this.useStore),i.publish(de(B({},i.value),{slot:this.slotService.slot,activeComponents:[]})),this.participant=i.value,this.eventBus=new Fh,this.logger.log("launcher created"),this.startIOC()}},pA=e=>{if(typeof window<"u"&&window.SUPERVIZ)return console.warn("[SUPERVIZ] Room already initialized"),{destroy:window.SUPERVIZ.destroy,subscribe:window.SUPERVIZ.subscribe,unsubscribe:window.SUPERVIZ.unsubscribe,addComponent:window.SUPERVIZ.addComponent,removeComponent:window.SUPERVIZ.removeComponent};let t=new dA(e);return typeof window<"u"&&(window.SUPERVIZ=t),{destroy:t.destroy,subscribe:t.subscribe,unsubscribe:t.unsubscribe,addComponent:t.addComponent,removeComponent:t.removeComponent}};function Nh(e){let t=/^.{2,64}$/,i=/^[-_&@+=,(){}\[\]\/«».:|'"#a-zA-Z0-9À-ÿ\s]*$/;return!(!t.test(e)||!i.test(e))}function fA(e){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e)}var mA=({group:e,participant:t,roomId:i,customColors:r})=>{if(r&&vA(r),!e||!e.name||!e.id)throw new Error("[SuperViz] Group fields is required");if(!t||!t.id)throw new Error("[SuperViz] Participant id is required");if(!i)throw new Error("[SuperViz] Room id is required");if(!Nh(i))throw new Error(`[SuperViz] Room id is invalid, it should be between 2 and 64 characters and only accept letters, numbers and special characters: -_&@+=,(){}[]/«».:|'"`);if(!Nh(t.id))throw new Error(`[SuperViz] Participant id is invalid, it should be between 2 and 64 characters and only accept letters, numbers and special characters: -_&@+=,(){}[]/«».:|'"`);if(t.email&&!fA(t.email))throw new Error("[SuperViz] Participant email is invalid")},vA=e=>{Object.entries(e).forEach(([t,i])=>{if(!Object.values(gd).includes(t))throw new Error(`[SuperViz] Color ${t} is not a valid color variable name. Please check the documentation for more information.`);if(!/^(\d{1,3}\s){2}\d{1,3}$/.test(i))throw new Error(`[SuperViz] Color ${t} is not a valid color variable value. Please check the documentation for more information.`)})},gA=e=>{e&&Object.entries(e).forEach(([t,i])=>{let r=i.replace(/\s/g,", ");document.documentElement.style.setProperty(`--${t}`,r)})},yA=(e,t)=>ue(void 0,null,function*(){var i,r,o,a,u;if(!(e&&e.trim()))throw new Error("API key is required");if(!t)throw new Error("Options is required");mA(t),t.debug?ph.debug.enable("*"):ph.debug.disable();let[{apiUrl:c,conferenceLayerUrl:p},h]=yield Promise.all([Ta.getRemoteConfig(t.environment),Ta.getFeatures(e)]);if(!(yield LC(c,e)))throw new Error("Failed to validate API key");let[f,m]=yield Promise.all([Qe.fetchWaterMark(c,e),Qe.fetchLimits(c,e)]).catch(()=>{throw new Error("[SuperViz] Failed to load configuration from server")}),{participant:y,roomId:g,customColors:_}=t;Q.setConfig({apiUrl:c,apiKey:e,conferenceLayerUrl:p,environment:(i=t.environment)!=null?i:"prod",roomId:g,debug:t.debug,limits:m,waterMark:f,colors:_,features:h}),gA(_);let E=yield Qe.fetchParticipant(y.id).catch(()=>null);if(!E&&!y.name)throw new Error("[SuperViz] - Participant does not exist, create the user in the API or add the name in the initialization to initialize the SuperViz room.");return E||(yield Qe.createParticipant({participantId:y.id,name:y==null?void 0:y.name,avatar:(r=y.avatar)==null?void 0:r.imageUrl,email:y==null?void 0:y.email})),pA(de(B({},t),{participant:{id:y.id,name:(o=y.name)!=null?o:E==null?void 0:E.name,avatar:(a=y.avatar)!=null?a:E==null?void 0:E.avatar,email:(u=y.email)!=null?u:E==null?void 0:E.email}}))}),cp=yA;O();typeof window<"u"&&typeof HTMLElement<"u"&&(Promise.resolve().then(()=>require("./icon-3HSZY4BG-D7_NHxue.cjs")),Promise.resolve().then(()=>require("./dropdown-OIZAL2LO-Cr7JV16W.cjs")),Promise.resolve().then(()=>require("./tooltip-JQUVL2QH-Nwd00W2w.cjs")),Promise.resolve().then(()=>require("./modal-YJCZEQ42-CCyKqq9x.cjs")),Promise.resolve().then(()=>require("./comments-MGTDGIFZ-Cw8VHDQW.cjs")),Promise.resolve().then(()=>require("./topbar-ZPQKL3NR-CBrKxD8o.cjs")),Promise.resolve().then(()=>require("./content-BR3JBVI3-D5WOHZOH.cjs")),Promise.resolve().then(()=>require("./comment-item-7VNMGU4V-CH-6bNk5.cjs")),Promise.resolve().then(()=>require("./comment-input-VDWSGSQW-B2t57h4a.cjs")),Promise.resolve().then(()=>require("./annotation-pin-K67PIXO5-DaINgBlk.cjs")),Promise.resolve().then(()=>require("./annotation-item-VHKOJQVW-lv14tRJF.cjs")),Promise.resolve().then(()=>require("./delete-comment-modal-JX3K2H44-I6GCUVbj.cjs")),Promise.resolve().then(()=>require("./annotation-resolved-6VJKFGWE-CONkaA32.cjs")),Promise.resolve().then(()=>require("./annotation-filter-E7SCYW2G-BgUQj-Wp.cjs")),Promise.resolve().then(()=>require("./float-button-X32X4R7I-kr4NMMV6.cjs")),Promise.resolve().then(()=>require("./mention-list-PEJOF3VQ-DMMI2-Kx.cjs")),Promise.resolve().then(()=>require("./who-is-online-4MQU4252-eujsIBCf.cjs")),Promise.resolve().then(()=>require("./hello-world-DBOTV35Y-BSbnt6AP.cjs")));O();O();function bA(e){if(typeof document<"u"){let t=document.createElement("style");t.id="superviz-style";let i=document.createTextNode(e);t.appendChild(i),document.head.appendChild(t)}}var wA=`@import"https://unpkg.com/@superviz/sv-icons@0.8.13/css/style.css";@import"https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap";:root{--sv-primary: 98, 16, 204}html,body{width:100%;height:100%;overflow:hidden}#sv-video-wrapper iframe{position:fixed;border:none;margin:0;padding:0;overflow:hidden;z-index:1000}#sv-video-wrapper iframe.sv-video-frame--right{top:var(--superviz-offset-top);right:var(--superviz-offset-right)}#sv-video-wrapper iframe.sv-video-frame--left{top:var(--superviz-offset-top);left:var(--superviz-offset-left)}#sv-video-wrapper iframe.sv-video-frame--bottom{bottom:var(--superviz-offset-bottom);right:var(--superviz-offset-right);width:100%}#sv-video-wrapper iframe.sv-video-frame--top{top:var(--superviz-offset-top);right:var(--superviz-offset-right);width:100%}#sv-video-wrapper iframe.sv-video-frame--no-overlay{display:none}.pointer-mouse{display:flex;height:15px;width:16px;background-image:url(https://production.cdn.superviz.com/static/pointers/0.svg);background-repeat:no-repeat}.mouse-user-name{display:block;position:absolute;border-radius:30px;padding:2px 8px;font-weight:700;font-size:14px;font-family:Roboto,sans-serif;line-height:22px;margin-left:10px;margin-top:-6px;background:#ff0;white-space:nowrap}.mouse-follower{position:absolute;display:block;z-index:2}
`;bA(wA);O();var hp=(e=>(e.RIGHT="right",e.CENTER="center",e.LEFT="left",e))(hp||{}),dp=(e=>(e.GRID="grid",e.LIST="list",e))(dp||{}),pp=(e=>(e.RIGHT="right",e.LEFT="left",e.TOP="top",e.BOTTOM="bottom",e))(pp||{});O();var yl=(e=>(e.STARTED="STARTED",e.STOPPED="STOPPED",e))(yl||{}),bl=(e=>(e.REALTIME_STATE_CHANGED="realtime-component.state-changed",e))(bl||{});O();var fp=(e=>(e.BLUR="field.blur",e.FOCUS="field.focus",e.CONTENT_CHANGE="field.content-change",e.INTERACTION="field.interaction",e))(fp||{});O();O();O();var qi=class extends ll{constructor(){super(...arguments),this.isAttached=!1,this.unsubscribeFrom=[],this.useStore=tt.bind(this),this.attach=e=>{var t;if(Object.values(e).includes(null)||Object.values(e).includes(void 0)){let c=`${this.name} @ attach - params are required`;throw this.logger.log(c),new Error(c)}let{config:i,eventBus:r,ioc:o}=e,{isDomainWhitelisted:a,hasJoinedRoom:u}=this.useStore("global-store");if(!a.value){let c=`Component ${this.name} can't be used because this website's domain is not whitelisted. Please add your domain in https://dashboard.superviz.com/developer`;this.logger.log(c);return}if(Q.setConfig(i),this.eventBus=r,this.isAttached=!0,this.ioc=o,this.connectionLimit=(t=e.connectionLimit)!=null?t:50,this.room=o.createRoom(this.name,this.connectionLimit),!u.value){this.logger.log(`${this.name} @ attach - not joined yet`),setTimeout(()=>{this.logger.log(`${this.name} @ attach - retrying`),this.attach(e)},1e3);return}this.logger.log(`${this.name} @ attached`),this.observers={},this.start(),this.publish("mount")},this.detach=()=>{if(!this.isAttached){this.logger.log(`${this.name} @ detach - component is not attached`);return}this.logger.log("detached"),this.publish("unmount"),this.destroy(),this.room.disconnect(),this.room=void 0,this.unsubscribeFrom.forEach(e=>e(this)),Object.values(this.observers).forEach(e=>{e.reset(),e.destroy()}),this.observers=void 0,this.isAttached=!1}}},mp=class extends qi{constructor(e,t){var i,r,o;super(),this.sidebarOpen=!1,this.layoutOptions={},this.openThreads=()=>{var c;this.sidebarOpen||((c=this.element)==null||c.setAttribute("open",""),this.sidebarOpen=!0,document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar",{detail:{open:this.sidebarOpen},composed:!0,bubbles:!0})))},this.closeThreads=()=>{var c;this.sidebarOpen&&((c=this.element)==null||c.removeAttribute("open"),this.sidebarOpen=!1,document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar",{detail:{open:this.sidebarOpen},composed:!0,bubbles:!0})))},this.togglePinActive=()=>{if(this.pinActive){this.disable();return}this.enable()},this.onPinFixed=c=>{this.coordinates=c},this.toggleAnnotationSidebar=()=>{this.element.toggleAttribute("open"),this.sidebarOpen=this.element.hasAttribute("open"),document.body.dispatchEvent(new CustomEvent("prepare-to-create-annotation",{detail:void 0,composed:!0,bubbles:!0})),document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar",{detail:{open:this.sidebarOpen},composed:!0,bubbles:!0}))},this.onSelectAnnotation=c=>{this.sidebarOpen||this.toggleAnnotationSidebar()},this.positionFloatingButton=()=>{var c,p;this.button=document.createElement("superviz-comments-button");let h=(c=this.layoutOptions)==null?void 0:c.buttonLocation,f=(p=this.layoutOptions)==null?void 0:p.position;if(!h){document.body.appendChild(this.button),this.button.commentsPosition=f;return}let m="",y=Object.values(Kh),g=!1,_=!y.includes(h.toLocaleLowerCase());if(_){let E=window.document.body.querySelector(`#${h}`);E?(E.appendChild(this.button),m="position: relative"):(g=!0,h="top-left")}if(!_||g){document.body.appendChild(this.button);let[E,R]=h.split("-");m=`${E}: 20px; ${R}: 20px;`}this.button.positionStyles=m,this.button.commentsPosition=f},this.positionComments=()=>{var c;this.element=document.createElement("superviz-comments"),this.element.setAttribute("comments",JSON.stringify([])),this.element.side="left",this.element.offset=this.offset,document.body.appendChild(this.element);let p=(c=this.layoutOptions)==null?void 0:c.position;if(!p)return;let h=p.toUpperCase();Pa[h]&&(this.element.side=Pa[h])},this.createAnnotation=c=>ue(this,[c],function*({detail:p}){try{let{text:h,mentions:f}=p,m=B({},this.coordinates),y=yield Qe.createAnnotations(Q.get("apiUrl"),Q.get("apiKey"),{roomId:Q.get("roomId"),position:JSON.stringify(m),userId:this.localParticipantId}),g=yield this.createComment(y.uuid,h,f);this.addAnnotation(de(B({},y),{comments:[g]})),this.pinAdapter.removeAnnotationPin("temporary-pin"),document.body.dispatchEvent(new CustomEvent("select-annotation",{detail:{uuid:y.uuid,haltGoToPin:!0,newPin:!0},composed:!0,bubbles:!0}))}catch(h){this.logger.log("error when creating annotation",h)}}),this.deleteAnnotation=c=>ue(this,[c],function*({detail:p}){try{let{uuid:h}=p;yield Qe.deleteAnnotation(Q.get("apiUrl"),Q.get("apiKey"),h);let f=this.annotations.filter(m=>m.uuid!==h);this.updateAnnotationList(f),this.pinAdapter.removeAnnotationPin(h),this.element.updateAnnotations(this.annotations)}catch(h){this.logger.log("error when deleting annotation",h)}}),this.updateComment=c=>ue(this,[c],function*({detail:p}){try{let{uuid:h,text:f,mentions:m}=p,y=yield Qe.updateComment(Q.get("apiUrl"),Q.get("apiKey"),h,f);yield Qe.createMentions({commentsId:y.uuid,participants:m.map(_=>({id:_.userId}))});let g=this.annotations.map(_=>Object.assign({},_,{comments:_.comments.map(E=>E.uuid===h?Object.assign({},E,{text:f,mentions:m}):E)}));this.updateAnnotationList(g)}catch(h){this.logger.log("error when updating comment",h)}}),this.resolveAnnotation=c=>ue(this,[c],function*({detail:p}){try{let{uuid:h}=p,{resolved:f}=yield Qe.resolveAnnotation(Q.get("apiUrl"),Q.get("apiKey"),h),m=this.annotations.map(y=>y.uuid===h?Object.assign({},y,{resolved:f}):y);if(this.updateAnnotationList(m),f){this.pinAdapter.removeAnnotationPin(h);return}this.pinAdapter.updateAnnotations(this.annotations)}catch(h){this.logger.log("error when resolve annotation",h)}}),this.deleteComment=c=>ue(this,[c],function*({detail:p}){try{let{uuid:h,annotationId:f}=p;if(!h||!f)return;yield Qe.deleteComment(Q.get("apiUrl"),Q.get("apiKey"),h);let m=this.annotations.find(g=>g.uuid===f);m.comments=m.comments.filter(g=>g.uuid!==h);let y=this.annotations.map(g=>g.uuid===f?m:g);this.element.updateAnnotations(y),this.updateAnnotationList(y)}catch(h){this.logger.log("error when deleting comment",h)}}),this.onAnnotationListUpdate=c=>{let{data:p,clientId:h}=c;this.localParticipantId!==h&&(this.annotations=p,this.element.updateAnnotations(this.annotations),this.pinAdapter.updateAnnotations(this.annotations))},this.name="comments",this.logger=new He("@superviz/sdk/comments-component"),this.annotations=[],this.layoutOptions={buttonLocation:(i=t==null?void 0:t.buttonLocation)!=null?i:"top-left",position:(r=t==null?void 0:t.position)!=null?r:"left"},this.hideDefaultButton=(o=t==null?void 0:t.hideDefaultButton)!=null?o:!1,this.setStyles(t==null?void 0:t.styles),this.offset=t==null?void 0:t.offset,setTimeout(()=>{var c,p;e.setCommentsMetadata((p=(c=this.layoutOptions)==null?void 0:c.position)!=null?p:"left")}),this.pinAdapter=e;let{group:a,localParticipant:u}=this.useStore("global-store");a.subscribe(),u.subscribe(c=>{this.localParticipantId=c.id})}enable(){this.pinAdapter.setActive(!0),this.pinActive=!0,this.publish("pin-mode.active"),document.body.dispatchEvent(new CustomEvent("toggle-pin-active",{detail:{isActive:!0}}))}disable(){this.pinAdapter.setActive(!1),this.pinActive=!1,this.publish("pin-mode.inactive"),document.body.dispatchEvent(new CustomEvent("toggle-pin-active",{detail:{isActive:!1}}))}start(){typeof window<"u"&&(this.clientUrl=window.location.href,this.positionComments(),this.hideDefaultButton||this.positionFloatingButton(),this.fetchAnnotations(),this.waterMarkState(),this.participantsList(),this.addListeners(),this.pinAdapter.setPinsVisibility(!0))}destroy(){var e;this.logger.log("comments component @ destroy"),this.destroyListeners(),(e=this.button)==null||e.remove(),this.element.remove(),this.element=void 0,this.pinAdapter.destroy()}addListeners(){var e;(e=this.button)==null||e.addEventListener("toggle",this.togglePinActive),this.element.addEventListener("close-threads",this.closeThreads),document.body.addEventListener("create-annotation",this.createAnnotation),this.element.addEventListener("resolve-annotation",this.resolveAnnotation),this.element.addEventListener("delete-annotation",this.deleteAnnotation),this.element.addEventListener("create-comment",({detail:t})=>{this.createComment(t.uuid,t.text,t.mentions,!0)}),this.element.addEventListener("update-comment",this.updateComment),this.element.addEventListener("delete-comment",this.deleteComment),document.body.addEventListener("select-annotation",this.onSelectAnnotation),this.room.on("update-comments",this.onAnnotationListUpdate),this.pinAdapter.onPinFixedObserver.subscribe(this.onPinFixed)}destroyListeners(){var e;(e=this.button)==null||e.removeEventListener("toggle",this.togglePinActive),this.element.removeEventListener("close-threads",this.closeThreads),this.element.removeEventListener("resolve-annotation",this.resolveAnnotation),this.element.removeEventListener("create-comment",({detail:t})=>{this.createComment(t.uuid,t.text,t.mentions,!0)}),this.element.removeEventListener("update-comment",this.updateComment),this.element.removeEventListener("delete-comment",this.deleteComment),document.body.removeEventListener("select-annotation",this.onSelectAnnotation),document.body.removeEventListener("create-annotation",this.createAnnotation),this.room.off("update-comments",this.onAnnotationListUpdate),this.pinAdapter.onPinFixedObserver.unsubscribe(this.onPinFixed)}setStyles(e=""){if(!e)return;let t=document.createElement("style");t.textContent=e,t.id="superviz-comments-styles",document.head.appendChild(t)}createComment(e,t){return ue(this,arguments,function*(i,r,o=[],a=!1){try{let u=yield Qe.createComment(Q.get("apiUrl"),Q.get("apiKey"),{annotationId:i,userId:this.localParticipantId,text:r});return yield Qe.createMentions({commentsId:u.uuid,participants:o.map(c=>({id:c.userId,readed:0}))}),u.mentions=o,a&&this.addComment(i,u),u}catch(u){this.logger.log("error when creating comment",u)}})}addAnnotation(e){let t=[e,...this.annotations];this.element.updateAnnotations(t),this.pinAdapter.updateAnnotations(t),this.updateAnnotationList(t)}updateAnnotationList(e){this.annotations=e,this.room.emit("update-comments",e)}addComment(e,t){let i=this.annotations.find(o=>o.uuid===e);i.comments.push(t);let r=this.annotations.map(o=>o.uuid===e?i:o);this.updateAnnotationList(r),this.element.updateAnnotations(r)}fetchAnnotations(){return ue(this,null,function*(){try{let e=yield Qe.fetchAnnotation(Q.get("apiUrl"),Q.get("apiKey"),{roomId:Q.get("roomId")});this.annotations=e,this.element.updateAnnotations(this.annotations),this.pinAdapter.updateAnnotations(this.annotations)}catch(e){this.logger.log("error when fetching annotations",e)}})}waterMarkState(){return ue(this,null,function*(){try{let e=yield Qe.fetchWaterMark(Q.get("apiUrl"),Q.get("apiKey"));this.element.waterMarkStatus(e)}catch(e){this.logger.log("error when fetching waterMark",e)}})}participantsList(){return ue(this,null,function*(){try{let e=(yield Qe.fetchParticipantsByGroup(this.group.id)).data;this.pinAdapter.participantsList=e,this.element.participantsList=e}catch(e){this.logger.log("error when fetching participantsList",e)}})}};O();var vp=class{constructor(e,t){if(this.isPinsVisible=!0,this.selectedPin=null,this.temporaryPinCoordinates=null,this.commentsSide="left",this.setCommentsMetadata=i=>{this.commentsSide=i},this.resetPins=i=>{i&&(i==null?void 0:i.key)!=="Escape"||(this.resetSelectedPin(),this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates=null)},this.animate=()=>{(this.isActive||this.isPinsVisible)&&(this.renderAnnotationsPins(),this.divWrapper=this.renderDivWrapper()),this.temporaryPinCoordinates&&this.renderTemporaryPin(),this.animateFrame=requestAnimationFrame(this.animate)},this.setMouseDownCoordinates=({x:i,y:r})=>{this.mouseDownCoordinates={x:i,y:r}},this.annotationSelected=({detail:{uuid:i,haltGoToPin:r,newPin:o}})=>{var a,u;if(!i)return;o&&this.pins.get(i).setAttribute("newPin","");let c=JSON.parse((u=(a=this.selectedPin)==null?void 0:a.getAttribute("annotation"))!=null?u:"{}");if(this.resetPins(),(c==null?void 0:c.uuid)===i)return;document.body.dispatchEvent(new CustomEvent("close-temporary-annotation"));let p=this.pins.get(i);p&&(p.setAttribute("active",""),this.selectedPin=p,!r&&this.goToPin(i))},this.onClick=i=>{if(!this.isActive)return;let r=this.canvas.getBoundingClientRect(),{x:o,y:a}=this.mouseDownCoordinates,u=o-r.x,c=a-r.y,p=i.clientX-r.left,h=i.clientY-r.top;if(Math.hypot(p-u,h-c)>10)return;let f=this.canvas.getContext("2d").getTransform().inverse(),m=new DOMPoint(p,h-31).matrixTransform(f);this.onPinFixedObserver.publish({x:m.x,y:m.y,type:"canvas"}),this.resetSelectedPin(),this.temporaryPinCoordinates={x:m.x,y:m.y},this.renderTemporaryPin();let y=document.getElementById("superviz-temporary-pin");this.movedTemporaryPin=!this.movedTemporaryPin,y.setAttribute("movedPosition",String(this.movedTemporaryPin)),!this.selectedPin&&document.body.dispatchEvent(new CustomEvent("unselect-annotation"))},this.onToggleAnnotationSidebar=({detail:i})=>{let{open:r}=i;r||(this.pins.forEach(o=>{o.removeAttribute("active")}),this.pins.has("temporary-pin")&&this.removeAnnotationPin("temporary-pin"))},this.hideTemporaryPin=i=>{var r;let o=i.target,a=o.contains(this.canvas),{x:u,y:c}=i,{left:p,top:h,right:f,bottom:m}=this.canvas.getBoundingClientRect(),y=u>p&&u<f&&c>h&&c<m;this.canvas.contains(o)||(r=this.pins.get("temporary-pin"))!=null&&r.contains(o)||a&&y||(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates=null)},this.logger=new He("@superviz/sdk/comments-component/canvas-pin-adapter"),this.canvas=document.getElementById(e),this.isActive=!1,this.pins=new Map,this.goToPinCallback=t==null?void 0:t.onGoToPin,!this.canvas){let i=`Canvas with id ${e} not found`;throw this.logger.log(i),new Error(i)}this.canvasSides=this.canvas.getBoundingClientRect(),document.body.style.position="relative",this.onPinFixedObserver=new $e({logger:this.logger}),this.divWrapper=this.renderDivWrapper(),this.annotations=[],this.renderAnnotationsPins(),this.animateFrame=requestAnimationFrame(this.animate),document.body.addEventListener("select-annotation",this.annotationSelected),document.body.addEventListener("keyup",this.resetPins)}destroy(){this.isActive=!1,this.removeListeners(),this.removeAnnotationsPins(),this.pins=new Map,this.divWrapper.remove(),this.divWrapper=null,this.onPinFixedObserver.destroy(),this.onPinFixedObserver=null,this.canvas.style.cursor="default",this.annotations=[],cancelAnimationFrame(this.animateFrame),document.body.removeEventListener("select-annotation",this.annotationSelected),document.body.removeEventListener("keyup",this.resetPins)}setPinsVisibility(e){if(this.isPinsVisible=e,this.isPinsVisible){this.renderAnnotationsPins();return}this.removeAnnotationsPins()}setActive(e){if(this.isActive!==e){if(this.isActive=e,this.isActive){this.originalCanvasCursor=this.canvas.style.cursor,this.canvas.style.cursor='url("https://production.cdn.superviz.com/static/pin-html.png") 0 100, pointer',this.addListeners();return}this.resetPins(),this.removeListeners(),this.canvas.style.cursor=this.originalCanvasCursor}}updateAnnotations(e){this.logger.log("updateAnnotations",e),this.annotations=e,!(!this.isActive&&!this.isPinsVisible)&&(this.removeAnnotationsPins(),this.renderAnnotationsPins())}removeAnnotationPin(e){let t=this.pins.get(e);t&&(t.remove(),this.pins.delete(e),e!=="temporary-pin"&&(this.annotations=this.annotations.filter(i=>i.uuid!==e)))}renderTemporaryPin(){let e=document.getElementById("superviz-temporary-pin");e||(e=document.createElement("superviz-comments-annotation-pin"),e.id="superviz-temporary-pin",e.setAttribute("type","add"),e.setAttribute("showInput",""),e.setAttribute("containerSides",JSON.stringify(this.canvasSides)),e.setAttribute("commentsSide",this.commentsSide),e.setAttribute("position",JSON.stringify(this.temporaryPinCoordinates)),e.setAttribute("annotation",JSON.stringify({})),e.setAttribute("participantsList",JSON.stringify(this.participants)),e.setAttributeNode(document.createAttribute("active")),this.divWrapper.appendChild(e));let{x:t,y:i}=this.temporaryPinCoordinates,r=this.canvas.getContext("2d").getTransform(),o=r.e,a=r.f,u=r.a,c=r.d,p=t*u+o,h=i*c+a;e.setAttribute("position",JSON.stringify({x:p,y:h})),this.pins.set("temporary-pin",e)}addListeners(){this.canvas.addEventListener("click",this.onClick),this.canvas.addEventListener("mousedown",this.setMouseDownCoordinates),document.body.addEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),document.body.addEventListener("click",this.hideTemporaryPin)}removeListeners(){this.canvas.removeEventListener("click",this.onClick),this.canvas.removeEventListener("mousedown",this.setMouseDownCoordinates),document.body.removeEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),document.body.addEventListener("click",this.hideTemporaryPin)}resetSelectedPin(){this.selectedPin&&(this.selectedPin.removeAttribute("active"),this.selectedPin=null)}renderDivWrapper(){let e=this.canvas.getBoundingClientRect(),t=this.divWrapper;return t||(t=document.createElement("div"),t.id="superviz-canvas-wrapper",["","static"].includes(this.canvas.parentElement.style.position)&&(this.canvas.parentElement.style.position="relative")),t.style.position="absolute",t.style.top=`${this.canvas.offsetTop}px`,t.style.left=`${this.canvas.offsetLeft}px`,t.style.width=`${e.width}px`,t.style.height=`${e.height}px`,t.style.pointerEvents="none",t.style.overflow="hidden",document.getElementById("superviz-canvas-wrapper")||this.canvas.parentElement.appendChild(t),t}renderAnnotationsPins(){if((!this.annotations.length||this.canvas.style.display==="none")&&!this.pins.get("temporary-pin")){this.removeAnnotationsPins();return}this.annotations.forEach(e=>{if(e.resolved)return;let t=JSON.parse(e.position);if((t==null?void 0:t.type)!=="canvas")return;let{x:i,y:r}=t,o=this.canvas.getContext("2d").getTransform(),a=o.e,u=o.f,c=o.a,p=o.d,h=i*c+a,f=r*p+u;if(this.pins.has(e.uuid)){let y=this.pins.get(e.uuid);if(this.divWrapper.clientWidth>h&&this.divWrapper.clientHeight>f){y.setAttribute("style","opacity: 1"),this.pins.get(e.uuid).setAttribute("position",JSON.stringify({x:h,y:f}));return}y.setAttribute("style","opacity: 0");return}let m=document.createElement("superviz-comments-annotation-pin");m.setAttribute("type","show"),m.setAttribute("participantsList",JSON.stringify(this.participants)),m.setAttribute("annotation",JSON.stringify(e)),m.setAttribute("position",JSON.stringify({x:h,y:f})),m.id=e.uuid,this.divWrapper.appendChild(m),this.pins.set(e.uuid,m)})}removeAnnotationsPins(){this.pins.forEach(e=>{e.remove()}),this.pins.clear()}set participantsList(e){this.participants=e}goToPin(e){let t=this.annotations.find(y=>y.uuid===e);if(!t)return;let i=JSON.parse(t.position);if((i==null?void 0:i.type)!=="canvas")return;let r=this.canvas.getBoundingClientRect(),{width:o,height:a}=r,{x:u,y:c}=i,p=o/2,h=a/2,f=p-u,m=h-c;this.goToPinCallback&&this.goToPinCallback({x:f,y:m})}};O();var _A=Wt(wn()),gp=class{constructor(e,t={}){if(this.isPinsVisible=!0,this.selectedPin=null,this.dataAttribute="data-superviz-id",this.commentsSide="left",this.temporaryPinCoordinates={},this.elementsWithDataId={},this.divWrappers=new Map,this.voidElementsWrappers=new Map,this.VOID_ELEMENTS=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr","svg","rect","ellipse"],this.animate=()=>{this.voidElementsWrappers&&(this.updatePinsPositions(),this.animateFrame=requestAnimationFrame(this.animate))},this.setCommentsMetadata=o=>{this.commentsSide=o},this.hideTemporaryPin=o=>{var a;let u=o.target,c=this.divWrappers.get(this.temporaryPinCoordinates.elementId);if(!c)return;let p=c.contains(u),h=(a=this.pins.get("temporary-pin"))==null?void 0:a.contains(u);p||h||(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates={})},this.resetPins=o=>{o&&(o==null?void 0:o.key)!=="Escape"||(this.resetSelectedPin(),this.resetHoveredWrapper(),this.temporaryPinCoordinates.elementId&&(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates={}))},this.annotationSelected=({detail:{uuid:o,newPin:a}})=>{if(!o)return;a&&this.pins.get(o).setAttribute("newPin","");let u=this.annotations.find(h=>{var f;return h.uuid===((f=this.selectedPin)==null?void 0:f.id)});if(this.resetPins(),(u==null?void 0:u.uuid)===o)return;document.body.dispatchEvent(new CustomEvent("close-temporary-annotation"));let c=this.pins.get(o);if(!c)return;c.setAttribute("active",""),this.selectedPin=c;let p=this.annotations.find(h=>h.uuid===o);this.selectedPin.setAttribute("elementId",JSON.parse(p.position).elementId)},this.onClick=o=>{if(!this.isActive||o.target===this.pins.get("temporary-pin"))return;let a=o.target,u=o.currentTarget;if(a!==u&&this.pins.has(a.id))return;let c=u.getAttribute("data-wrapper-id"),p=u.getBoundingClientRect(),{x:h,y:f}=this.mouseDownCoordinates,m=o.clientX-p.left,y=o.clientY-p.top,g=h-p.x,_=f-p.y;if(Math.hypot(m-g,y-_)>10)return;let{width:E,height:R}=u.getBoundingClientRect(),N=32,j=u.getBoundingClientRect().width/u.offsetWidth||1;m=m*100/E,y=(y-N*j)*100/R,this.onPinFixedObserver.publish({x:m,y,type:"html",elementId:c}),this.resetSelectedPin(),this.temporaryPinCoordinates=de(B({},this.temporaryPinCoordinates),{x:m,y}),this.renderTemporaryPin(c);let U=this.pins.get("temporary-pin");this.movedTemporaryPin=!this.movedTemporaryPin,U.setAttribute("movedPosition",String(this.movedTemporaryPin)),document.body.dispatchEvent(new CustomEvent("unselect-annotation"))},this.onMouseDown=({x:o,y:a})=>{this.mouseDownCoordinates={x:o,y:a}},this.handleMutationObserverChanges=o=>{o.forEach(a=>{var u;let{target:c,oldValue:p}=a,h=c.getAttribute(this.dataAttribute);if(!h&&!p||h===p)return;let f=this.dataAttributeValueFilters.some(y=>p.match(y));if(!h&&p&&!f){this.removeAnnotationPin("temporary-pin"),this.clearElement(p),((u=this.selectedPin)==null?void 0:u.getAttribute("elementId"))===p&&(document.body.dispatchEvent(new CustomEvent("unselect-annotation")),this.selectedPin=null);return}let m=this.dataAttributeValueFilters.some(y=>h.match(y));(p&&this.elementsWithDataId[p]||m)&&this.clearElement(p),!m&&(this.setElementReadyToPin(c,h),this.renderAnnotationsPins())})},this.onToggleAnnotationSidebar=({detail:o})=>{let{open:a}=o;a||(this.resetSelectedPin(),this.pins.has("temporary-pin")&&(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates.elementId=void 0))},this.onMouseEnter=o=>{var a;let u=o.target;if(this.hoveredWrapper=u,!((a=u.getAttribute("data-wrapper-type"))!=null&&a.includes("ellipse"))){this.hoveredWrapper.style.setProperty("outline","1px solid rgb(var(--sv-primary))");return}let c=u.querySelector("ellipse");c.setAttribute("stroke","rgb(var(--sv-primary))"),c.setAttribute("stroke-width","1")},this.onMouseLeave=o=>{var a;let u=o.target;if(this.hoveredWrapper=u,!((a=u.getAttribute("data-wrapper-type"))!=null&&a.includes("ellipse"))){this.hoveredWrapper.style.setProperty("outline","");return}let c=u.querySelector("ellipse");c.removeAttribute("stroke"),c.removeAttribute("stroke-width")},this.logger=new He("@superviz/sdk/comments-component/container-pin-adapter"),this.container=document.getElementById(e),!this.container){let o=`Element with id ${e} not found`;throw this.logger.log(o),new Error(o)}if(typeof t!="object")throw new Error("Second argument of the HTMLPin constructor must be an object");let{dataAttributeName:i,dataAttributeValueFilters:r}=t;if(i==="")throw new Error("dataAttributeName must be a non-empty string");if(i===null)throw new Error("dataAttributeName cannot be null");if(i!==void 0&&typeof i!="string")throw new Error("dataAttributeName must be a non-empty string");this.dataAttribute=i||this.dataAttribute,this.dataAttributeValueFilters=r||[],this.isActive=!1,this.prepareElements(),this.mutationObserver=new MutationObserver(this.handleMutationObserverChanges),this.observeContainer(),this.pins=new Map,this.onPinFixedObserver=new $e({logger:this.logger}),this.annotations=[],document.body.addEventListener("select-annotation",this.annotationSelected),document.body.addEventListener("keyup",this.resetPins),this.voidElementsWrappers.size&&(this.animateFrame=requestAnimationFrame(this.animate))}destroy(){var e;this.logger.log("Destroying HTML Pin Adapter for Comments"),this.removeListeners(),this.removeObservers(),this.divWrappers.forEach(t=>t.remove()),this.divWrappers.clear(),this.pins.forEach(t=>t.remove()),this.pins.clear(),this.divWrappers=void 0,this.pins=void 0,this.elementsWithDataId=void 0,this.logger=void 0,this.onPinFixedObserver.destroy(),this.onPinFixedObserver=void 0,this.container=void 0,this.voidElementsWrappers.clear(),this.voidElementsWrappers=void 0,this.annotations=[],(e=this.svgWrappers)==null||e.remove(),this.svgWrappers=void 0,document.body.removeEventListener("select-annotation",this.annotationSelected),document.body.removeEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),cancelAnimationFrame(this.animateFrame)}addElementListeners(e){this.divWrappers.get(e).addEventListener("click",this.onClick,!0),this.divWrappers.get(e).addEventListener("mousedown",this.onMouseDown),this.divWrappers.get(e).addEventListener("mouseenter",this.onMouseEnter),this.divWrappers.get(e).addEventListener("mouseleave",this.onMouseLeave)}removeElementListeners(e){this.divWrappers.get(e).removeEventListener("click",this.onClick,!0),this.divWrappers.get(e).removeEventListener("mousedown",this.onMouseDown),this.divWrappers.get(e).removeEventListener("mouseenter",this.onMouseEnter),this.divWrappers.get(e).removeEventListener("mouseleave",this.onMouseLeave)}set participantsList(e){this.participants=e}removeObservers(){this.mutationObserver.disconnect(),this.mutationObserver=void 0}addListeners(){this.divWrappers.forEach((e,t)=>this.addElementListeners(t)),document.body.addEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),document.body.addEventListener("click",this.hideTemporaryPin)}removeListeners(){this.divWrappers.forEach((e,t)=>this.removeElementListeners(t)),document.body.removeEventListener("keyup",this.resetPins),document.body.removeEventListener("click",this.hideTemporaryPin)}observeContainer(){this.mutationObserver.observe(this.container,{subtree:!0,attributes:!0,attributeFilter:[this.dataAttribute],attributeOldValue:!0})}prepareElements(){this.container.querySelectorAll(`[${this.dataAttribute}]`).forEach(e=>{let t=e.getAttribute(this.dataAttribute);this.dataAttributeValueFilters.some(i=>t.match(i))||this.setElementReadyToPin(e,t)})}addAllCursors(){this.divWrappers.forEach((e,t)=>{this.addCursor(e,t)})}removeAddCursor(){this.divWrappers.forEach((e,t)=>{let i=e,r=e.getAttribute("data-wrapper-type");if(r){let o=r.split("-")[1];i=this.divWrappers.get(t).querySelector(o)}i.style.setProperty("cursor","default"),i.style.setProperty("pointer-events","none")})}setPinsVisibility(e){this.isPinsVisible=e,this.isPinsVisible&&this.renderAnnotationsPins(),this.removeAnnotationsPins()}removeAnnotationPin(e){let t=this.pins.get(e);!t&&e==="temporary-pin"||(t&&(t.remove(),this.pins.delete(e)),e!=="temporary-pin"&&(this.annotations=this.annotations.filter(i=>i.uuid!==e)))}updateAnnotations(e){this.logger.log("updateAnnotations",e),this.annotations=e,this.isPinsVisible&&(this.removeAnnotationsPins(),this.renderAnnotationsPins())}setActive(e){if(this.isActive!==e){if(this.isActive=e,this.isActive){this.addListeners(),this.addAllCursors(),this.prepareElements();return}this.resetPins(),this.removeListeners(),this.removeAddCursor()}}renderTemporaryPin(e){var t,i;(t=this.temporaryPinCoordinates).elementId||(t.elementId=e);let r=this.pins.get("temporary-pin");if(e&&e!==this.temporaryPinCoordinates.elementId&&(this.pins.get("temporary-pin").remove(),this.pins.delete("temporary-pin"),this.temporaryPinCoordinates.elementId=e,r=null),!r){let u=(i=this.elementsWithDataId[e])==null?void 0:i.getBoundingClientRect();r=document.createElement("superviz-comments-annotation-pin"),r.id="superviz-temporary-pin",r.setAttribute("type","add"),r.setAttribute("showInput",""),r.setAttribute("containerSides",JSON.stringify(u)),r.setAttribute("commentsSide",this.commentsSide),r.setAttribute("position",JSON.stringify(this.temporaryPinCoordinates)),r.setAttribute("annotation",JSON.stringify({})),r.setAttribute("participantsList",JSON.stringify(this.participants)),r.setAttribute("keepPositionRatio",""),r.setAttributeNode(document.createAttribute("active")),this.addTemporaryPinToElement(e,r)}let{x:o,y:a}=this.temporaryPinCoordinates;r.setAttribute("position",JSON.stringify({x:o,y:a})),this.pins.set("temporary-pin",r)}renderAnnotationsPins(){if(!this.annotations.length){this.removeAnnotationsPins();return}this.annotations.forEach(e=>{if(e.resolved)return;let{x:t,y:i,elementId:r,type:o}=JSON.parse(e.position);if(o!=="html"||this.pins.has(e.uuid)||!this.elementsWithDataId[r])return;let a=this.divWrappers.get(r);if(!a)return;let u=this.createPin(e,t,i);a.appendChild(u),this.pins.set(e.uuid,u)})}updatePinsPositions(){this.voidElementsWrappers.forEach((e,t)=>{let i=JSON.stringify(e.getBoundingClientRect()),r=this.elementsWithDataId[t].getBoundingClientRect();this.elementsWithDataId[t].tagName.toLowerCase()==="ellipse"&&(r=this.elementsWithDataId[t].viewportElement.getBoundingClientRect()),!(0,_A.isEqual)(JSON.stringify(r),i)&&(e.style.setProperty("top",`${r.top}px`),e.style.setProperty("left",`${r.left}px`),e.style.setProperty("width",`${r.width}px`),e.style.setProperty("height",`${r.height}px`))})}clearElement(e){if(!this.elementsWithDataId[e])return;let t=this.divWrappers.get(e);if(t){let i=t.children,{length:r}=i;for(let o=0;o<r;++o){let a=i.item(o);this.pins.delete(a.id)}t.remove()}this.voidElementsWrappers.delete(e),this.removeElementListeners(e),this.divWrappers.delete(e),this.elementsWithDataId[e]=void 0,this.voidElementsWrappers.size||(cancelAnimationFrame(this.animateFrame),this.animateFrame=void 0)}resetSelectedPin(){this.selectedPin&&(this.selectedPin.removeAttribute("active"),this.selectedPin=null)}resetHoveredWrapper(){this.hoveredWrapper&&this.onMouseLeave({target:this.hoveredWrapper})}removeAnnotationsPins(){this.pins.forEach(e=>{e.remove()}),this.pins.clear()}setElementReadyToPin(e,t){if(!this.elementsWithDataId[t]){if(this.elementsWithDataId[t]=e,!this.divWrappers.get(t)){let i=this.createWrapper(e,t);this.divWrappers.set(t,i)}!this.isActive||!this.isPinsVisible||(this.addCursor(this.divWrappers.get(t),t),this.addElementListeners(t))}}handleSvgElement(e,t){let i=e.viewportElement;if(i===void 0)return;if(e.tagName.toLowerCase()==="svg"){let y=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return y.setAttribute("height","100%"),y.setAttribute("width","100%"),y.style.setProperty("overflow","visible"),y.appendChild(t),e.appendChild(y),e.style.setProperty("overflow","visible"),t}let r=e.tagName.toLowerCase(),o=r==="ellipse",a=r==="rect";if(!o&&!a)return;let u=document.createElementNS("http://www.w3.org/2000/svg","svg"),c=document.createElementNS("http://www.w3.org/2000/svg",r),p,h,f,m;if(a){let y=e;y.getAttribute("x"),y.getAttribute("y"),p=y.getAttribute("width"),h=y.getAttribute("height"),f=y.getAttribute("rx"),m=y.getAttribute("ry"),c.setAttribute("fill","transparent"),c.setAttribute("stroke","transparent"),c.setAttribute("x","0"),c.setAttribute("y","0"),c.setAttribute("rx",f),c.setAttribute("ry",m)}if(o){let y=e.getAttribute("cx"),g=e.getAttribute("cy");f=e.getAttribute("rx"),m=e.getAttribute("ry");let{width:_,height:E}=i.getBoundingClientRect();p=`${_}px`,h=`${E}px`,c.setAttribute("fill","transparent"),c.setAttribute("stroke","transparent"),c.setAttribute("cx",y),c.setAttribute("cy",g),c.setAttribute("rx",f),c.setAttribute("ry",m)}return c.setAttribute("height",h),c.setAttribute("width",p),u.setAttribute("height",h),u.setAttribute("width",p),u.appendChild(c),t.appendChild(u),e.style.setProperty("overflow","visible"),t.setAttribute("data-wrapper-type",`svg-${r}`),t}addTemporaryPinToElement(e,t){if(!this.elementsWithDataId[e])return;let i=this.divWrappers.get(e);i&&i.appendChild(t)}createPin(e,t,i){let r=document.createElement("superviz-comments-annotation-pin");return r.setAttribute("type","show"),r.setAttribute("annotation",JSON.stringify(e)),r.setAttribute("position",JSON.stringify({x:t,y:i})),r.setAttribute("keepPositionRatio",""),r.setAttribute("participantsList",JSON.stringify(this.participants)),r.id=e.uuid,r}addCursor(e,t){let i=e,r=e.getAttribute("data-wrapper-type");if(r){let o=r.split("-")[1];i=this.divWrappers.get(t).querySelector(o)}i.style.setProperty("cursor",'url("https://production.cdn.superviz.com/static/pin-html.png") 0 100, pointer'),i.style.setProperty("pointer-events","auto")}createWrapper(e,t){var i;let r=`superviz-id-${t}`;if(this.divWrappers.get(t))return;let o=e.getBoundingClientRect(),a=document.createElement("div");a.setAttribute("data-wrapper-id",t),a.id=r,a.style.position="absolute",a.style.pointerEvents="none",a.style.transform="translateX(0) translateY(0) scale(1)",a.style.cursor="default",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="100%",a.style.pointerEvents="none";let u=window.getComputedStyle(e).getPropertyValue("border-radius");if(a.style.borderRadius=u,!this.VOID_ELEMENTS.includes(this.elementsWithDataId[t].tagName.toLowerCase()))return this.elementsWithDataId[t].appendChild(a),this.setPositionNotStatic(this.elementsWithDataId[t]),a;a=(i=this.handleSvgElement(e,a))!=null?i:a,a.style.position="fixed",a.style.top=`${o.top}px`,a.style.left=`${o.left}px`,a.style.width=`${o.width}px`,a.style.height=`${o.height}px`;let c=this.elementsWithDataId[t].parentElement;return(!c||e.viewportElement)&&(c=document.body),this.setPositionNotStatic(c),c.appendChild(a),this.voidElementsWrappers.set(t,a),this.animateFrame||(this.animateFrame=requestAnimationFrame(this.animate)),a}setPositionNotStatic(e){let{position:t}=window.getComputedStyle(e);t==="static"&&e.style.setProperty("position","relative")}};O();O();var ui=Wt(IC()),CA=class{constructor(){this.browser=ui.default.getParser(navigator.userAgent)}get clientStats(){return this.browser.getResult()}get isFirefox(){return this.browser.isBrowser(ui.default.BROWSER_MAP.firefox)}get isSafari(){return this.browser.isBrowser(ui.default.BROWSER_MAP.safari)}get isChrome(){return this.browser.isBrowser(ui.default.BROWSER_MAP.chrome)}get isIE(){return this.browser.isBrowser(ui.default.BROWSER_MAP.ie)}get isEdge(){return this.browser.isBrowser(ui.default.BROWSER_MAP.edge)}get isMobileDevice(){return(this.browser.is(ui.default.PLATFORMS_MAP.mobile)||this.browser.is(ui.default.PLATFORMS_MAP.tablet))&&!navigator.userAgent.match(/iPad/i)}get isTabletDevice(){return this.browser.is(ui.default.PLATFORMS_MAP.tablet)}get isAndroid(){return this.isMobileDevice&&!!navigator.userAgent.match(/Android/i)}get isIpad(){return!!navigator.userAgent.match(/iPad/i)}get isIphone(){return this.isMobileDevice&&!!navigator.userAgent.match(/iPhone/i)}get isAppleMobileDevice(){return this.isIpad||this.isIphone}};O();var EA=class{constructor(){this.updateMeetingConnectionStatus=e=>{this.oldConnectionStatus=this.connectionStatus,this.connectionStatus=e,this.connectionStatusObserver.publish(e),this.logger.log("CONNECTION STATUS CHANGE",e)},this.onUpdateBrowserOnlineStatus=e=>{let{type:t}=e;if(t==="online"){this.updateMeetingConnectionStatus(1);return}this.updateMeetingConnectionStatus(4)},this.logger=new He("@superviz/sdk/connection-service"),this.connectionStatus=0,this.connectionStatusObserver=new $e({logger:this.logger})}addListeners(){typeof window<"u"&&(window.addEventListener("online",this.onUpdateBrowserOnlineStatus),window.addEventListener("offline",this.onUpdateBrowserOnlineStatus))}removeListeners(){typeof window<"u"&&(window.removeEventListener("online",this.onUpdateBrowserOnlineStatus),window.removeEventListener("offline",this.onUpdateBrowserOnlineStatus))}};O();O();var PA=class{constructor(e,t,i){this.myParticipant={},this.localRoomProperties=null,this.drawingData=null,this.state=0,this.MESSAGE_SIZE_LIMIT=6e4,this.useStore=tt.bind(this),this.join=()=>{this.room.presence.on(X.LEAVE,this.onParticipantLeave),this.room.presence.on(X.JOINED_ROOM,this.onPresenceEnter),this.enableSync&&(this.room.on("update",this.updateLocalRoomState),this.drawingRoom.presence.on(X.UPDATE,this.updateDrawing))},this.updateMyProperties=a=>{let u=a??{};this.isMessageTooBig(u)||this.left||!this.enableSync||this.isSyncFrozen||(u.avatar===void 0&&delete u.avatar,this.myParticipant=B(B({},this.myParticipant),u),this.room.presence.update(this.myParticipant),this.logger.log("REALTIME","updating my properties",this.myParticipant))},this.isMessageTooBig=(a,u=this.MESSAGE_SIZE_LIMIT)=>{let c=JSON.stringify(a);return new TextEncoder().encode(c).length>u?(this.logger.log("Message too long, the message limit size is 60kb."),!0):!1},this.updateRoomProperties=a=>{if(this.isMessageTooBig(a)||this.isSyncFrozen||this.left)return;let u=B(B({},this.localRoomProperties),a);this.localRoomProperties=u,this.room.emit("update",u)},this.updateDrawingProperties=a=>{this.isMessageTooBig(a)||this.isSyncFrozen||this.left||(this.drawingData=B(B({},this.drawingData),a),this.drawingRoom.presence.update(this.drawingData))},this.setHost=a=>{this.updateRoomProperties({hostClientId:a})},this.setKickParticipant=a=>{if(!a)return;let{participants:u}=tt("global-store"),c=u.value[a];this.updateRoomProperties({kickParticipant:c})},this.initializeRoomProperties=()=>{let a={isGridModeEnabled:!1,hostClientId:null,followParticipantId:null,gather:!1,transcript:"transcript.stop",kickParticipant:null};this.localRoomProperties=a,this.updateRoomProperties(a)},this.onParticipantLeave=a=>{var u;a.id===this.myParticipant.id&&(this.left=!0),a.id===((u=this.localRoomProperties)==null?void 0:u.followParticipantId)&&this.setFollowParticipant()},this.start=()=>ue(this,null,function*(){this.started||(this.started=!0,this.room.isJoined||(this.logger.log("room state service - not joined room yet"),setTimeout(()=>{this.logger.log("room state service - retrying"),this.start()},2e3)),this.localRoomProperties=yield this.fetchRoomProperties(),this.localRoomProperties?this.updateLocalRoomState({data:this.localRoomProperties}):this.initializeRoomProperties(),this.publishStateUpdate(4),this.logger.log("REALTIME","Joined realtime room"))}),this.onPresenceEnter=()=>{this.updateMyProperties()},this.updateLocalRoomState=a=>ue(this,[a],function*({data:u}){this.logger.log("REALTIME","Room update received",u),this.localRoomProperties=Object.assign({},this.localRoomProperties,u);let{followParticipantId:c,gather:p,hostId:h,isGridModeEnabled:f,transcript:m}=this.useStore("video-store");c.publish(u.followParticipantId),p.publish(u.gather),h.publish(u.hostClientId),f.publish(u.isGridModeEnabled),m.publish(u.transcript),u.kickParticipant&&u.kickParticipant.id===this.myParticipant.id&&(this.updateRoomProperties({kickParticipant:null}),this.kickParticipantObserver.publish(this.myParticipant.id))}),this.updateDrawing=a=>{if(a.id===this.myParticipant.id)return;let{drawing:u}=this.useStore("video-store");u.publish(a.data)},this.freezeSync=a=>{if(this.isSyncFrozen=a,a){this.destroy();return}this.join()},this.room=e,this.drawingRoom=t,this.logger=i,this.kickParticipantObserver=new $e({logger:this.logger});let{localParticipant:r,participants:o}=this.useStore("global-store");r.subscribe(a=>{this.enableSync=a.type!=="audience",this.myParticipant=B(B({},this.myParticipant),a)}),o.subscribe(),this.join()}setGridMode(e){this.updateRoomProperties({isGridModeEnabled:e})}setDrawing(e){this.updateDrawingProperties(e)}setTranscript(e){this.updateRoomProperties({transcript:e})}fetchRoomProperties(){return ue(this,null,function*(){if((yield new Promise(r=>{this.room.presence.get(o=>{o||r(0),r(o.length)})}))<=1)return null;let e=yield new Promise((r,o)=>{this.room.history(a=>{a||o(a),a.events.length||r(null);let u=a.events.pop();r(u)})}),t=1e3*60*60,i=(e==null?void 0:e.timestamp)<Date.now()-t;return!(e!=null&&e.data)||i?null:e.data})}publishStateUpdate(e){if(this.state===e)return;this.state=e,this.logger.log("REALTIME",`Realtime state did change. New state: ${dd[this.state]}`);let{meetingState:t}=this.useStore("video-store");t.publish(this.state)}setFollowParticipant(e){this.updateRoomProperties({followParticipantId:e})}setGather(e){this.updateRoomProperties({gather:e})}destroy(){this.room.presence.off(X.LEAVE),this.room.presence.off(X.JOINED_ROOM),this.drawingRoom.presence.off(X.UPDATE),this.room.off("update",this.updateLocalRoomState)}};O();O();var AA=class{build(e,t,i,r={},o={}){let a=document.querySelector(`#${e}`),u=new URL(t);if(this.wrapperId||this.element)throw new Error("Tried to initialize two frames with the same FrameBricklayer instance");this.element=document.createElement("iframe"),Object.entries(r).forEach(([c,p])=>{u.searchParams.set(c,p)}),Object.entries(o).forEach(([c,p])=>{this.element.setAttribute(c,p)}),this.element.src=u.toString(),this.element.id=i,a.appendChild(this.element),this.wrapperId=e}destroy(){if(!this.wrapperId)throw new Error("Tried to destroy a frame before it was initialized");let e=document.querySelector(`#${this.wrapperId}`);e&&e.querySelector(`#${this.element.id}`)&&e.removeChild(this.element),this.wrapperId=null,this.element=null}};O();var SA=class{constructor(e){this.observers={},this.sourceBlockList=["vue-devtools-proxy","vue-devtools-backend"],this.originBlockList=["https://sketchfab.com"],this.publish=(u,c={})=>{this.logger.log("MessageBridge","Posting message to frame",u,c),this.contentWindow.postMessage({type:u,data:c},this.allowedOrigins)},this.listen=(u,c)=>{this.observers[u]||(this.observers[u]=new $e({logger:this.logger})),this.observers[u].subscribe(c)},this.onReceiveMessage=u=>{let{type:c,data:p,source:h}=u.data;if(this.sourceBlockList.includes(h)||this.originBlockList.includes(u.origin))return;let f=!!c,m=!this.domains.length||this.domains.includes(u.origin),y=this.observers.hasOwnProperty(c);if(this.logger.log("MessageBridge",`Message received -
        TYPE: ${u.type}
        ORIGIN: ${u.origin}
        DATA: ${JSON.stringify(u.data)} `),!f||!m||!y){this.logger.log("MessageBridge","Message discarded");return}this.observers[c].publish(p)};let{contentWindow:t,domains:i=[],allowedOrigins:r="*",sourceBlockList:o=[],logger:a}=e;if(this.logger=a,this.domains=i,this.allowedOrigins=r,this.sourceBlockList.push(...o),typeof window>"u")throw new Error("MessageBridge: window is undefined");this.contentWindow=t,window.addEventListener("message",this.onReceiveMessage)}destroy(){Object.entries(this.observers).forEach(([e,t])=>{t.reset(),delete this.observers[e]}),typeof window<"u"&&window.removeEventListener("message",this.onReceiveMessage),delete this.logger,delete this.allowedOrigins,delete this.contentWindow,delete this.domains,delete this.observers,delete this.sourceBlockList}},Dh="sv-video-frame",OA=class{constructor(e){this.logger=new He("@superviz/sdk/video-conference-manager"),this.frameStateObserver=new $e({logger:this.logger}),this.frameSizeObserver=new $e({logger:this.logger}),this.waitingForHostObserver=new $e({logger:this.logger}),this.realtimeEventsObserver=new $e({logger:this.logger}),this.sameAccountErrorObserver=new $e({logger:this.logger}),this.devicesObserver=new $e({logger:this.logger}),this.meetingStateObserver=new $e({logger:this.logger}),this.meetingConnectionObserver=new $e({logger:this.logger}),this.participantJoinedObserver=new $e({logger:this.logger}),this.participantLeftObserver=new $e({logger:this.logger}),this.participantListObserver=new $e({logger:this.logger}),this.frameState=0,this.layoutModalsAndCamerasConfig=(V,ve)=>{let oe=V,Ne=ve,Ke=["left","right","bottom","top"].includes(Ne),Re=["left","right","center"].includes(oe);return Ke||(Ne="right"),Re||(oe="right"),this.browserService.isMobileDevice?(Ne="bottom",{layoutPosition:oe,camerasPosition:Ne}):(oe==="left"&&Ne==="right"&&(oe="right"),oe==="right"&&Ne==="left"&&(oe="left"),{layoutPosition:oe,camerasPosition:Ne})},this.onFrameLoad=()=>{this.messageBridge=new SA({logger:this.logger,contentWindow:this.bricklayer.element.contentWindow}),this.addMessagesListeners(),this.updateFrameState(2),this.updateFrameLocale(),this.updateMeetingAvatars(),this.onWindowResize(),this.setCustomColors(),this.setCallbacks()},this.setFrameOffset=V=>{let ve=V??{};["top","bottom","left","right"].forEach(oe=>{Object.keys(ve).includes(oe)||(ve[oe]=0)}),this.frameOffset=ve},this.setCustomColors=()=>{this.customColors&&this.messageBridge.publish("frame.color-list-update",this.customColors),this.styles&&this.messageBridge.publish("frame.styles-update",this.styles)},this.setCallbacks=()=>{if(!this.callbacks)return;let V={onToggleMicrophone:!!this.callbacks.onToggleMicrophone,onToggleCam:!!this.callbacks.onToggleCam,onToggleRecording:!!this.callbacks.onToggleRecording,onToggleChat:!!this.callbacks.onToggleChat,onToggleScreenShare:!!this.callbacks.onToggleScreenShare,onClickHangup:!!this.callbacks.onClickHangup,onToggleMeetingSetup:!!this.callbacks.onToggleMeetingSetup};this.messageBridge.listen("callback-called",ve=>{var oe,Ne;(Ne=(oe=this.callbacks)[ve])==null||Ne.call(oe)}),this.messageBridge.publish("frame.callbacks-update",JSON.stringify(V))},this.setFrameStyle=V=>{let ve=document.createElement("style"),{bottom:oe,left:Ne,right:Ke,top:Re}=this.frameOffset;if(ve.innerHTML=`
      :root {
        --superviz-offset-top: ${Re}px;
        --superviz-offset-right: ${Ke}px;
        --superviz-offset-left: ${Ne}px;
        --superviz-offset-bottom: ${oe}px;
      }     
    `,document.head.appendChild(ve),this.browserService.isMobileDevice){this.bricklayer.element.classList.add("sv-video-frame--bottom");return}this.bricklayer.element.classList.add(`sv-video-frame--${V}`)},this.onFrameDimensionsUpdate=({width:V,height:ve})=>{if(typeof window>"u")return;let oe=document.getElementById(Dh),{bottom:Ne,right:Ke,left:Re,top:mi}=this.frameOffset,vi=this.isWaterMarkEnabled?40:0,Ri=`${V}px`,kt=`${ve+vi}px`;(V>=window.innerWidth||this.isHorizontalCameraEnabled)&&(Ri=`calc(100% - ${Ke}px - ${Re}px)`),ve>=window.innerHeight&&(kt=`calc(100% - ${mi}px - ${Ne}px)`),oe.style.width=Ri,oe.style.height=kt,this.frameSizeObserver.publish({width:oe.offsetWidth,height:oe.offsetHeight})},this.onWindowResize=()=>{let{top:V,bottom:ve,right:oe,left:Ne}=this.frameOffset,{innerHeight:Ke,innerWidth:Re}=window,mi=Ke-V-ve,vi=Re-oe-Ne;this.messageBridge&&this.messageBridge.publish("frame.parent-window-size-update",{height:mi,width:vi})},this.updateFrameLocale=()=>{var V,ve;if(!this.frameLocale||!((V=this.frameLocale)!=null&&V.language)&&(ve=this.frameLocale)!=null&&ve.locales)return;let{language:oe,locales:Ne}=this.frameLocale,Ke=["en",...Ne.map(Re=>Re==null?void 0:Re.language)];if(oe&&!Ke.includes(oe))throw new Error("The default language is not available in the language listing.");this.messageBridge.publish("frame.locales-update",this.frameLocale)},this.updateMeetingAvatars=()=>{this.messageBridge.publish("frame.avatar-list-update",this.meetingAvatars)},this.onParticipantJoined=V=>{this.participantJoinedObserver.publish(V)},this.onParticipantLeft=V=>{this.participantLeftObserver.publish(V)},this.onMeetingHostChange=V=>{this.realtimeEventsObserver.publish({event:"realtime.host-change",data:V})},this.onMeetingKickParticipant=V=>{this.realtimeEventsObserver.publish({event:"meeting.kick-participant",data:V})},this.onFollowParticipantDidChange=V=>{this.realtimeEventsObserver.publish({event:"realtime.follow-participant",data:V})},this.onGoToDidChange=V=>{this.realtimeEventsObserver.publish({event:"realtime.go-to-participant",data:V})},this.onGather=()=>{this.realtimeEventsObserver.publish({event:"realtime.gather",data:!0})},this.onGridModeChange=V=>{this.realtimeEventsObserver.publish({event:"realtime.grid-mode-change",data:V})},this.onDrawingChange=V=>{this.realtimeEventsObserver.publish({event:"realtime.drawing-change",data:V})},this.onTranscriptChange=V=>{this.realtimeEventsObserver.publish({event:"realtime.transcript-change",data:V})},this.onSameAccountError=V=>{this.sameAccountErrorObserver.publish(V)},this.onDevicesChange=V=>{this.devicesObserver.publish(V)},this.meetingStateUpdate=V=>{this.meetingStateObserver.publish(V)},this.onConnectionStatusChange=V=>{this.meetingConnectionObserver.publish(V)},this.onWaitingForHostDidChange=V=>{this.waitingForHostObserver.publish(V)},this.onParticipantListUpdate=V=>{this.participantListObserver.publish(V)};var t,i,r,o;let{language:a,canUseCams:u,canUseChat:c,canUseScreenshare:p,canUseDefaultAvatars:h,canUseFollow:f,canUseGoTo:m,canUseGather:y,canShowAudienceList:g,canUseDefaultToolbar:_,canUseRecording:E,browserService:R,offset:N,locales:j,avatars:U,customColors:K,styles:ie,waterMark:we,layoutPosition:pe,camerasPosition:Se,skipMeetingSettings:Le,devices:Oe,layoutMode:xe,collaborationMode:it,callbacks:fi}=e;this.browserService=R;let pt=this.layoutModalsAndCamerasConfig(pe,Se),Ee=document.createElement("div");this.frameConfig={apiKey:Q.get("apiKey"),apiUrl:Q.get("apiUrl"),debug:Q.get("debug"),roomId:Q.get("roomId"),limits:Q.get("limits"),collaborationMode:it,canUseFollow:f,canUseGoTo:m,canUseCams:u,canUseChat:c,canUseGather:y,canUseScreenshare:p,canUseDefaultAvatars:h,canUseRecording:E,canShowAudienceList:g,camerasPosition:(t=pt.camerasPosition)!=null?t:"right",canUseDefaultToolbar:_,devices:{audioInput:(i=Oe==null?void 0:Oe.audioInput)!=null?i:!0,audioOutput:(r=Oe==null?void 0:Oe.audioOutput)!=null?r:!0,videoInput:(o=Oe==null?void 0:Oe.videoInput)!=null?o:!0},waterMark:we,layoutMode:xe,skipMeetingSettings:Le,layoutPosition:pt.layoutPosition,transcriptLangs:Q.get("features.transcriptLangs")},this.customColors=K,this.callbacks=fi,this.styles=ie,Ee.classList.add("sv_video_wrapper"),Ee.id="sv-video-wrapper",document.body.appendChild(Ee),this.updateFrameState(1),this.bricklayer=new AA,this.bricklayer.build(Ee.id,Q.get("conferenceLayerUrl"),Dh,void 0,{allow:"camera *;microphone *; display-capture *;"}),this.setFrameOffset(N),this.setFrameStyle(pt.camerasPosition),this.bricklayer.element.addEventListener("load",this.onFrameLoad),this.frameLocale={language:a,locales:j},this.meetingAvatars=U,typeof window<"u"&&(window.addEventListener("resize",this.onWindowResize),window.addEventListener("orientationchange",this.onWindowResize))}get isWaterMarkEnabled(){return this.browserService.isMobileDevice?!1:this.frameConfig.waterMark}get isHorizontalCameraEnabled(){return this.browserService.isMobileDevice?!1:["top","bottom"].includes(this.frameConfig.camerasPosition)}addMessagesListeners(){this.messageBridge.listen("meeting.waiting-for-host",this.onWaitingForHostDidChange),this.messageBridge.listen("meeting.participant-joined",this.onParticipantJoined),this.messageBridge.listen("meeting.participant-list-update",this.onParticipantListUpdate),this.messageBridge.listen("meeting.participant-left",this.onParticipantLeft),this.messageBridge.listen("meeting.host-change",this.onMeetingHostChange),this.messageBridge.listen("meeting.kick-participant",this.onMeetingKickParticipant),this.messageBridge.listen("meeting.same-participant-error",this.onSameAccountError),this.messageBridge.listen("meeting.state-update",this.meetingStateUpdate),this.messageBridge.listen("meeting.connection-status-change",this.onConnectionStatusChange),this.messageBridge.listen("meeting.devices-change",this.onDevicesChange),this.messageBridge.listen("realtime.grid-mode-change",this.onGridModeChange),this.messageBridge.listen("realtime.drawing-change",this.onDrawingChange),this.messageBridge.listen("realtime.transcript-change",this.onTranscriptChange),this.messageBridge.listen("frame.dimensions-update",this.onFrameDimensionsUpdate),this.messageBridge.listen("realtime.follow-participant",this.onFollowParticipantDidChange),this.messageBridge.listen("realtime.go-to-participant",this.onGoToDidChange),this.messageBridge.listen("realtime.gather",this.onGather)}updateFrameState(e){e!==this.frameState&&(this.frameState=e,this.frameStateObserver.publish(this.frameState));let t={1:6,2:7,0:8};this.meetingStateUpdate(t[e])}start(e){this.messageBridge.publish("meeting.start",de(B({},e),{config:this.frameConfig}))}leave(){this.messageBridge.publish("meeting.leave"),this.destroy()}destroy(){var e,t,i,r,o,a,u,c,p,h;(e=this.messageBridge)==null||e.destroy(),(t=this.bricklayer)==null||t.destroy(),(i=this.frameSizeObserver)==null||i.destroy(),(r=this.realtimeEventsObserver)==null||r.destroy(),(o=this.sameAccountErrorObserver)==null||o.destroy(),(a=this.devicesObserver)==null||a.destroy(),(u=this.meetingStateObserver)==null||u.destroy(),(c=this.meetingConnectionObserver)==null||c.destroy(),(p=this.participantJoinedObserver)==null||p.destroy(),(h=this.participantLeftObserver)==null||h.destroy(),this.bricklayer=null,this.frameState=null,typeof window<"u"&&(window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("orientationchange",this.onWindowResize))}publishMessageToFrame(e,t){this.messageBridge&&this.messageBridge.publish(e,t)}};O();var TA=class{constructor(){this.logger=new He("@superviz/sdk/core-bridge"),this.logger.log("CoreBridge initialized")}updateLocalParticipant(e){this.logger.log("updateLocalParticipant",e);let{localParticipant:t}=tt("core-store");t.publish(e)}updateParticipantsList(e){this.logger.log("updateParticipantsList",e);let{participants:t}=tt("core-store");t.publish(e)}},gs=new TA,xA=1e3*60,Oi=null,yp=class extends qi{constructor(e){var t,i;super(),this.participantsOnMeeting=[],this.kickParticipantsOnHostLeave=!1,this.startVideo=()=>{var r,o,a,u,c,p,h,f,m,y,g,_,E,R,N,j,U,K,ie,we,pe,Se,Le,Oe,xe,it,fi,pt,Ee,V,ve,oe,Ne,Ke,Re,mi,vi,Ri;let kt=((r=this.params)==null?void 0:r.userType)!=="audience"&&((o=this.params)==null?void 0:o.defaultAvatars)===!0;this.videoConfig={language:(a=this.params)==null?void 0:a.language,canUseRecording:!!((u=this.params)!=null&&u.enableRecording),canShowAudienceList:(p=(c=this.params)==null?void 0:c.showAudienceList)!=null?p:!0,canUseChat:!((h=this.params)!=null&&h.chatOff),canUseCams:!((f=this.params)!=null&&f.camsOff),canUseScreenshare:!((m=this.params)!=null&&m.screenshareOff),canUseDefaultAvatars:kt&&!((g=(y=this.localParticipant)==null?void 0:y.avatar)!=null&&g.model3DUrl),canUseGather:!!((_=this.params)!=null&&_.enableGather),canUseFollow:!!((E=this.params)!=null&&E.enableFollow),canUseGoTo:!!((R=this.params)!=null&&R.enableGoTo),canUseDefaultToolbar:(j=(N=this.params)==null?void 0:N.defaultToolbar)!=null?j:!0,camerasPosition:(K=(U=this.params)==null?void 0:U.collaborationMode)==null?void 0:K.position,devices:(ie=this.params)==null?void 0:ie.devices,skipMeetingSettings:(we=this.params)==null?void 0:we.skipMeetingSettings,browserService:this.browserService,offset:(pe=this.params)==null?void 0:pe.offset,locales:(Le=(Se=this.params)==null?void 0:Se.locales)!=null?Le:[],avatars:(xe=(Oe=this.params)==null?void 0:Oe.avatars)!=null?xe:[],customColors:Q.get("colors"),waterMark:Q.get("waterMark"),styles:(it=this.params)==null?void 0:it.styles,collaborationMode:(Ee=(pt=(fi=this.params)==null?void 0:fi.collaborationMode)==null?void 0:pt.enabled)!=null?Ee:!0,layoutPosition:((ve=(V=this.params)==null?void 0:V.collaborationMode)==null?void 0:ve.enabled)===!1?"center":(Ke=(Ne=(oe=this.params)==null?void 0:oe.collaborationMode)==null?void 0:Ne.modalPosition)!=null?Ke:"center",layoutMode:(vi=(mi=(Re=this.params)==null?void 0:Re.collaborationMode)==null?void 0:mi.initialView)!=null?vi:"list",callbacks:(Ri=this.params)==null?void 0:Ri.callbacks},this.logger.log("video conference @ start video",this.videoConfig),this.videoManager=new OA(this.videoConfig),this.subscribeToVideoEvents()},this.subscribeToVideoEvents=()=>{this.logger.log("video conference @ subscribe to video events"),this.videoManager.meetingConnectionObserver.subscribe(this.connectionService.updateMeetingConnectionStatus),this.videoManager.participantListObserver.subscribe(this.onParticipantListUpdate),this.videoManager.waitingForHostObserver.subscribe(this.onWaitingForHost),this.videoManager.frameSizeObserver.subscribe(this.onFrameSizeDidChange),this.videoManager.meetingStateObserver.subscribe(this.onMeetingStateChange),this.videoManager.frameStateObserver.subscribe(this.onFrameStateChange),this.videoManager.realtimeEventsObserver.subscribe(this.onRealtimeEventFromFrame),this.videoManager.participantJoinedObserver.subscribe(this.onParticipantJoined),this.videoManager.participantLeftObserver.subscribe(this.onParticipantLeft),this.videoManager.sameAccountErrorObserver.subscribe(this.onSameAccountError),this.videoManager.devicesObserver.subscribe(this.onDevicesChange)},this.unsubscribeFromVideoEvents=()=>{this.videoManager&&(this.logger.log("video conference @ unsubscribe from video events"),this.videoManager.meetingConnectionObserver.unsubscribe(this.connectionService.updateMeetingConnectionStatus),this.videoManager.participantListObserver.unsubscribe(this.onParticipantListUpdate),this.videoManager.waitingForHostObserver.unsubscribe(this.onWaitingForHost),this.videoManager.frameSizeObserver.unsubscribe(this.onFrameSizeDidChange),this.videoManager.meetingStateObserver.unsubscribe(this.onMeetingStateChange),this.videoManager.frameStateObserver.unsubscribe(this.onFrameStateChange),this.videoManager.realtimeEventsObserver.unsubscribe(this.onRealtimeEventFromFrame),this.videoManager.participantJoinedObserver.unsubscribe(this.onParticipantJoined),this.videoManager.participantLeftObserver.unsubscribe(this.onParticipantLeft),this.videoManager.sameAccountErrorObserver.unsubscribe(this.onSameAccountError),this.videoManager.devicesObserver.unsubscribe(this.onDevicesChange))},this.suscribeToRealtimeEvents=()=>{this.logger.log("video conference @ subscribe to realtime events"),this.room.presence.on(X.UPDATE,this.onParticipantUpdateOnRealtime),this.room.presence.on(X.JOINED_ROOM,this.onParticipantJoinedOnRealtime),this.room.presence.on(X.LEAVE,this.onParticipantLeftOnRealtime)},this.unsubscribeFromRealtimeEvents=()=>{var r;this.logger.log("video conference @ unsubscribe from realtime events"),this.room.presence.off(X.UPDATE),this.room.presence.off(X.LEAVE),this.room.presence.off(X.JOINED_ROOM),(r=this.roomState)==null||r.kickParticipantObserver.unsubscribe(this.onKickLocalParticipant)},this.subscribeToStoreUpdates=()=>{let{localParticipant:r,group:o,participants:a}=this.useStore("global-store");a.subscribe(y=>{let g=Object.values(y);this.onRealtimeParticipantsDidChange(g)});let{drawing:u,hostId:c,isGridModeEnabled:p,transcript:h,followParticipantId:f,gather:m}=this.useStore("video-store");r.subscribe(y=>{this.localParticipant=de(B(B({},this.localParticipant),y),{type:this.params.userType})}),u.subscribe(this.setDrawing),c.subscribe(this.setHost),p.subscribe(this.setGridMode),h.subscribe(this.setTranscript),f.subscribe(this.setFollowParticipant),m.subscribe(this.setGather),o.subscribe()},this.createParticipantFromPresence=r=>{var o;return{participantId:r.id,id:r.id,color:((o=r.data.slot)==null?void 0:o.color)||Ut.gray,avatar:r.data.avatar,type:r.data.type,name:r.data.name,isHost:r.data.isHost,timestamp:r.timestamp,slot:r.data.slot}},this.onFrameSizeDidChange=r=>{this.publish("frame.dimensions-update",r)},this.onWaitingForHost=r=>{this.publish("meeting.waiting-for-host",r)},this.onConnectionStatusChange=r=>{this.logger.log("video conference @ on connection status change",r);let o=[2,4,3,6];o.includes(r)&&this.roomState.freezeSync(!0),o.includes(this.connectionService.oldConnectionStatus)&&!o.includes(r)&&this.roomState.freezeSync(!1),this.publish("meeting.connection-status-change",r)},this.onMeetingStateChange=r=>{this.logger.log("video conference @ on meeting state change",r),this.publish("meeting.state-update",r)},this.onSameAccountError=r=>{this.publish("meeting.same-participant-error",r),this.detach()},this.onDevicesChange=r=>{this.publish("meeting.devices-change",r)},this.onFrameStateChange=r=>{this.logger.log("video conference @ on frame state change",r),r===2&&(this.roomState=new PA(this.room,this.drawingRoom,this.logger),this.roomState.kickParticipantObserver.subscribe(this.onKickLocalParticipant),this.roomState.start(),this.params.userType!=="guest"&&(this.localParticipant=Object.assign(this.localParticipant,{type:this.params.userType}),this.roomState.updateMyProperties(B({},this.localParticipant))),this.videoManager.start({group:this.group,participant:this.localParticipant,roomId:Q.get("roomId")}),this.publish("meeting.start"))},this.onRealtimeEventFromFrame=({event:r,data:o})=>{this.logger.log("video conference @ on realtime event from frame",r,o),{"realtime.host-change":a=>this.roomState.setHost(a),"realtime.gather":a=>this.roomState.setGather(a),"realtime.grid-mode-change":a=>this.roomState.setGridMode(a),"realtime.drawing-change":a=>{this.roomState.setDrawing(a)},"realtime.follow-participant":a=>{this.roomState.setFollowParticipant(a)},"meeting.kick-participant":a=>{this.roomState.setKickParticipant(a)},"realtime.transcript-change":a=>{this.roomState.setTranscript(a)},"realtime.go-to-participant":a=>{this.eventBus.publish("realtime.go-to-participant",a)}}[r](o),this.publish(r,o)},this.onParticipantJoined=r=>{var o;this.logger.log("video conference @ on participant joined",r),this.publish("meeting.participant-joined",r),this.publish("my-participant.joined",r),this.kickParticipantsOnHostLeave=!((o=this.params)!=null&&o.allowGuests);let{localParticipant:a,participants:u}=this.useStore("global-store"),c=r.name.trim();if(this.videoConfig.canUseDefaultAvatars){this.roomState.updateMyProperties({avatar:r.avatar,name:r.name,type:r.type,joinedMeeting:!0}),gs.updateLocalParticipant(de(B({},a.value),{avatar:r.avatar,name:r.name,type:this.params.userType})),gs.updateParticipantsList(de(B({},u.value),{[r.id]:de(B({},u.value[r.id]),{avatar:r.avatar,name:r.name})}));return}gs.updateLocalParticipant(de(B({},a.value),{name:c,type:this.params.userType})),gs.updateParticipantsList(de(B({},u.value),{[r.id]:de(B({},u.value[r.id]),{name:c,type:this.params.userType})})),this.roomState.updateMyProperties({name:r.name,type:r.type,joinedMeeting:!0})},this.onParticipantLeft=r=>{var o,a;this.logger.log("video conference @ on participant left",this.localParticipant);let{localParticipant:u,participants:c}=this.useStore("global-store");u.publish(de(B({},u.value),{activeComponents:(o=u.value.activeComponents)==null?void 0:o.filter(p=>p!=="videoConference")})),c.publish(de(B({},c.value),{[this.localParticipant.id]:de(B({},u.value),{activeComponents:(a=u.value.activeComponents)==null?void 0:a.filter(p=>p!=="videoConference")})})),this.connectionService.removeListeners(),this.publish("my-participant.left",this.localParticipant),this.unsubscribeFromVideoEvents(),this.videoManager.leave(),this.videoManager=void 0,this.connectionService=void 0,this.detach()},this.onParticipantListUpdate=r=>{this.logger.log("video conference @ on participant list update",r);let o=Object.values(r).map(a=>{var u,c;return{id:a.id,slot:a.slot,avatar:a.avatar,name:a.name,type:a.type,isHost:(u=a.isHost)!=null?u:!1,timestamp:a.timestamp,color:((c=a.slot)==null?void 0:c.color)||Ut.gray}});this.publish("meeting.participant-list-update",o),this.participantsOnMeeting.length!==o.length&&this.publish("meeting.amount-of-participants-update",o.length),this.participantsOnMeeting=o,this.validateIfInTheRoomHasHost()},this.onKickLocalParticipant=()=>{this.logger.log("video conference @ on kick local participant"),this.publish("meeting.kick-participant",this.localParticipant),this.detach()},this.setDrawing=r=>{var o;(o=this.videoManager)==null||o.publishMessageToFrame("realtime.drawing-change",r)},this.setHost=r=>{var o;(o=this.videoManager)==null||o.publishMessageToFrame("realtime.host-change",r),this.onHostParticipantDidChange(r)},this.setGridMode=r=>{var o;(o=this.videoManager)==null||o.publishMessageToFrame("realtime.grid-mode-change",r)},this.setTranscript=r=>{var o;(o=this.videoManager)==null||o.publishMessageToFrame("realtime.transcript-change",r)},this.setFollowParticipant=r=>{var o;(o=this.videoManager)==null||o.publishMessageToFrame("realtime.follow-participant",r),this.eventBus.publish("realtime.follow-participant",r)},this.setGather=r=>{if(!this.videoManager||!r)return;let{hostId:o,gather:a}=this.useStore("video-store");if(a.publish(!1),o.value!==this.localParticipant.id){this.eventBus.publish("realtime.go-to-participant",o.value);return}this.videoManager.publishMessageToFrame("realtime.gather",r)},this.onRealtimeParticipantsDidChange=r=>{var o;this.logger.log("video conference @ on participants did change",r);let a=r.map(u=>{var c,p;return{id:u.id,timestamp:u.timestamp,participantId:u.id,color:((c=u.slot)==null?void 0:c.color)||Ut.gray,name:u.name,isHost:(p=u.isHost)!=null?p:!1,avatar:u.avatar,type:u.type,slot:u.slot}});(o=this.videoManager)==null||o.publishMessageToFrame("realtime.participant-list-update",a)},this.onHostParticipantDidChange=r=>{var o,a;this.logger.log("video conference @ on host participant did change",r),(o=this.videoManager)==null||o.publishMessageToFrame("realtime.host-change",r);let{participants:u}=this.useStore("global-store"),c=Object.values(u.value).find(h=>h.id===r),p=c?{id:c.id,color:((a=c.slot)==null?void 0:a.color)||Ut.gray,avatar:c.avatar,type:c.type,name:c.name,isHost:c.id===r}:null;Oi&&p&&(this.logger.log("video conference @ on host participant did change - clear kick all participants timeout"),clearTimeout(Oi),Oi=null),this.publish("meeting.host-change",p)},this.onHostAvailabilityChange=r=>{if(this.logger.log("launcher service @ onHostAvailabilityChange"),r){this.publish("meeting.host-available");return}this.publish("meeting.no-host-available")},this.onParticipantJoinedOnRealtime=r=>{this.logger.log("video conference @ on participant joined on realtime",r),this.publish("meeting.participant-joined",this.createParticipantFromPresence(r)),r.id===this.localParticipant.id&&this.room.presence.update(this.localParticipant)},this.onParticipantLeftOnRealtime=r=>{this.logger.log("video conference @ on participant left on realtime",r),this.publish("meeting.participant-left",this.createParticipantFromPresence(r))},this.onParticipantUpdateOnRealtime=r=>{this.logger.log("video conference @ on participant update on realtime",r);let{localParticipant:o,participants:a}=this.useStore("global-store");r.data.id===this.localParticipant.id&&this.publish("my-participant.update",this.createParticipantFromPresence(r)),a.publish(de(B({},a.value),{[r.data.id]:B(B({},o.value),r.data)}))},this.validateIfInTheRoomHasHost=()=>{var r,o;if(!this.roomState)return;let{hostId:a}=this.useStore("video-store"),{participants:u}=this.useStore("global-store"),c=Object.values(u.value),p=c.filter(m=>m.type==="host"&&this.participantsOnMeeting.some(y=>y.id===m.id));!p.length&&this.kickParticipantsOnHostLeave&&((r=this.localParticipant)==null?void 0:r.type)!=="host"&&!Oi&&(this.logger.log("video conference @ validate if in the room has host - init kick all participants timeout"),Oi=setTimeout(()=>{this.logger.log("video conference @ validate if in the room has host - kick all participants"),this.onKickLocalParticipant()},xA)),p.length&&Oi&&(this.logger.log("video conference @ validade if in the room has host - clear kick all participants timeout"),clearTimeout(Oi),Oi=null),this.onHostAvailabilityChange(!!p.length);let h=c.find(m=>(m==null?void 0:m.id)===(a==null?void 0:a.value));if(!p.length||h)return;let f=p.reduce((m,y)=>(this.logger.log("video conference @ validate if in the room has host - reducing participants",{previous:m,current:y}),!m||(y==null?void 0:y.id)===a.value?y:(y==null?void 0:y.timestamp)>m.timestamp?m:y),null);this.room.presence.update(de(B({},this.localParticipant),{isHost:f.id===this.localParticipant.id})),!(!f||f.id!==((o=this.localParticipant)==null?void 0:o.id))&&(this.logger.log("video conference @ validate if in the room has host - set host",f),a.publish(f.id),this.roomState.setHost(f.id))},this.params=de(B({},e),{userType:(i=(t=e==null?void 0:e.participantType)!=null?t:e==null?void 0:e.userType)!=null?i:"guest"}),this.name="videoConference",this.logger=new He("@superviz/sdk/videoConference"),this.browserService=new CA,this.connectionService=new EA,this.connectionService.addListeners(),this.connectionService.connectionStatusObserver.subscribe(this.onConnectionStatusChange)}toggleMeetingSetup(){var e;return(e=this.videoManager)==null?void 0:e.publishMessageToFrame("meeting-controls.toggle-setup")}toggleMicrophone(){var e;if(this.localParticipant.type==="audience"){console.warn("[SuperViz] Audience cannot toggle microphone");return}return(e=this.videoManager)==null?void 0:e.publishMessageToFrame("meeting-controls.toggle-microphone")}toggleCam(){var e;if(this.localParticipant.type==="audience"){console.warn("[SuperViz] Audience cannot toggle camera");return}(e=this.videoManager)==null||e.publishMessageToFrame("meeting-controls.toggle-cam")}toggleScreenShare(){var e;if(this.localParticipant.type==="audience"){console.warn("[SuperViz] Audience cannot toggle screen share");return}return(e=this.videoManager)==null?void 0:e.publishMessageToFrame("meeting-controls.toggle-screenshare")}toggleChat(){var e;return(e=this.videoManager)==null?void 0:e.publishMessageToFrame("meeting-controls.toggle-chat")}toggleRecording(){var e;if(this.localParticipant.isHost){console.warn("[SuperViz] Only host can toggle recording");return}return(e=this.videoManager)==null?void 0:e.publishMessageToFrame("meeting-controls.toggle-recording")}hangUp(){var e;(e=this.videoManager)==null||e.publishMessageToFrame("hang-up")}start(){this.logger.log("video conference @ start"),this.drawingRoom=this.ioc.createRoom("drawing"),this.subscribeToStoreUpdates(),this.suscribeToRealtimeEvents(),this.startVideo()}destroy(){var e,t,i;this.logger.log("video conference @ destroy");let{destroy:r}=this.useStore("video-store");r(),(e=this.roomState)==null||e.destroy(),this.drawingRoom.disconnect(),this.kickParticipantsOnHostLeave=!1,this.publish("destroy"),this.unsubscribeFromRealtimeEvents(),this.unsubscribeFromVideoEvents(),(t=this.videoManager)==null||t.leave(),(i=this.connectionService)==null||i.removeListeners()}};O();O();var kA=Wt(wn()),IA=class extends qi{constructor(e,t){var i;if(super(),this.camera={x:0,y:0,screen:{width:0,height:0},scale:1},this.subscribeToRealtimeEvents=()=>{this.logger.log("presence-mouse component @ subscribe to realtime events"),this.room.presence.on(X.JOINED_ROOM,this.onPresenceJoinedRoom),this.room.presence.on(X.LEAVE,this.onPresenceLeftRoom),this.room.presence.on(X.UPDATE,this.onPresenceUpdate)},this.unsubscribeFromRealtimeEvents=()=>{this.logger.log("presence-mouse component @ unsubscribe from realtime events"),this.room.presence.off(X.JOINED_ROOM),this.room.presence.off(X.LEAVE),this.room.presence.off(X.UPDATE)},this.setParticipantPrivate=o=>{this.isPrivate=o,this.room.presence.update({visible:!o})},this.onPresenceJoinedRoom=o=>{o.id===this.localParticipant.id&&this.room.presence.update(this.localParticipant)},this.onPresenceLeftRoom=o=>{this.removePresenceMouseParticipant(o.id)},this.onPresenceUpdate=o=>{if(this.following&&this.presences.get(this.following)&&this.goToMouse(this.following),o.id===this.localParticipant.id)return;let a=o.data;if(this.following&&a.id!==this.following&&this.presences.has(a.id)){this.removePresenceMouseParticipant(a.id);return}this.presences.set(a.id,a)},this.animate=()=>{this.getCamera(),this.renderDivWrapper(),this.updateParticipantsMouses(),requestAnimationFrame(this.animate)},this.goToMouse=o=>{let a=this.presences.get(o);if(!(a!=null&&a.camera))return;let u=a.camera.x,c=a.camera.y,p=this.divWrapper.clientHeight/a.camera.screen.height,h=Math.min(p,1),f=this.divWrapper.clientWidth/a.camera.screen.width,m=Math.min(f,1);this.goToMouseCallback&&this.goToMouseCallback({x:u,y:c,scaleX:h,scaleY:m})},this.onMyParticipantMouseMove=(0,kA.throttle)(o=>{let a=this.canvas.getContext("2d"),u=this.canvas.getBoundingClientRect(),c=o.x-u.left,p=o.y-u.top,h=(a==null?void 0:a.getTransform()).inverse(),f=new DOMPoint(c,p).matrixTransform(h),m={x:f.x,y:f.y};this.room.presence.update(de(B(B({},this.localParticipant),m),{visible:!this.isPrivate,camera:this.camera}))},30),this.onMyParticipantMouseOut=o=>{let{x:a,y:u,width:c,height:p}=this.canvas.getBoundingClientRect();o.x>0&&o.y>0&&o.x<a+c&&o.y<u+p||this.room.presence.update({visible:!1})},this.updateParticipantsMouses=()=>{this.presences.forEach(o=>{if(!(o!=null&&o.visible)||this.following&&this.following!==o.id){this.removePresenceMouseParticipant(o.id);return}this.renderPresenceMouses(o)})},this.getCamera=()=>{var o;let a=(o=this.canvas)==null?void 0:o.getContext("2d"),u=a==null?void 0:a.getTransform(),c=u==null?void 0:u.e,p=u==null?void 0:u.f,h=u==null?void 0:u.a;this.camera={screen:{width:this.divWrapper.clientHeight,height:this.divWrapper.clientWidth},x:c,y:p,scale:h}},this.renderPresenceMouses=o=>{var a,u,c,p,h;let f=document.getElementById(`mouse-${o.id}`);f||(f=this.createMouseElement(o));let m=document.getElementById(`mouse-${o.id}`),y=document.getElementById(`mouse-${o.id}`);if(!m||!y)return;let g=m.getElementsByClassName("mouse-user-name")[0],_=y.getElementsByClassName("pointer-mouse")[0];_&&(_.style.backgroundImage=`url(https://production.cdn.superviz.com/static/mouse-pointers/${(a=o.slot)==null?void 0:a.colorName}.svg)`),g&&(g.style.color=(c=(u=o.slot)==null?void 0:u.textColor)!=null?c:"#fff",g.style.backgroundColor=(h=(p=o.slot)==null?void 0:p.color)!=null?h:Ut.gray,g.innerHTML=o.name);let{x:E,y:R}=o,N=this.canvas.getContext("2d"),j=N==null?void 0:N.getTransform(),U=j==null?void 0:j.e,K=j==null?void 0:j.f,ie=j.a,we=j.d,pe=E*ie+U,Se=R*we+K,Le=this.divWrapper.clientWidth>pe&&this.divWrapper.clientHeight>Se&&o.visible;f.style.opacity=Le?"1":"0",f.style.left=`${pe}px`,f.style.top=`${Se}px`},this.followMouse=o=>{this.following=o,this.goToMouse(o)},this.name="presence",this.logger=new He("@superviz/sdk/presence"),this.canvas=document.getElementById(e),this.presences=new Map,!this.canvas){let o=`Canvas with id ${e} not found`;throw this.logger.log(o),new Error(o)}this.divWrapper=this.renderDivWrapper(),this.animateFrame=requestAnimationFrame(this.animate),this.goToMouseCallback=(i=t==null?void 0:t.callbacks)==null?void 0:i.onGoToPresence;let{localParticipant:r}=this.useStore("global-store");r.subscribe(),this.getCamera()}start(){this.logger.log("presence-mouse component @ start"),this.canvas.addEventListener("mousemove",this.onMyParticipantMouseMove),this.canvas.addEventListener("mouseout",this.onMyParticipantMouseOut),this.eventBus.subscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.subscribe("realtime.local-follow-participant",this.followMouse),this.eventBus.subscribe("realtime.private-mode",this.setParticipantPrivate),this.subscribeToRealtimeEvents()}destroy(){this.logger.log("presence-mouse component @ destroy"),this.eventBus.unsubscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.unsubscribe("realtime.local-follow-participant",this.followMouse),this.eventBus.unsubscribe("realtime.private-mode",this.setParticipantPrivate),this.unsubscribeFromRealtimeEvents(),cancelAnimationFrame(this.animateFrame),this.canvas.removeEventListener("mousemove",this.onMyParticipantMouseMove),this.canvas.removeEventListener("mouseout",this.onMyParticipantMouseOut),this.divWrapper.remove()}renderDivWrapper(){let e=this.canvas.getBoundingClientRect(),t=document.getElementById("superviz-presence-mouse-wrapper");return t||(t=document.createElement("div"),t.id="superviz-presence-mouse-wrapper",this.canvas.parentElement.style.position="relative",this.canvas.parentElement.appendChild(t)),t.style.position="fixed",t.style.top=`${e.top}px`,t.style.left=`${e.left}px`,t.style.width=`${e.width}px`,t.style.height=`${e.height}px`,t.style.pointerEvents="none",t.style.overflow="hidden",t.style.zIndex="2",t}removePresenceMouseParticipant(e){let t=document.getElementById(`mouse-${e}`);t&&(t.remove(),this.presences.delete(e))}createMouseElement(e){let t=document.createElement("div");t.setAttribute("id",`mouse-${e.id}`),t.setAttribute("class","mouse-follower");let i=document.createElement("div");i.setAttribute("class","pointer-mouse");let r=document.createElement("div");return r.setAttribute("class","mouse-user-name"),r.innerHTML=e.name,t.appendChild(i),t.appendChild(r),t.style.left="0px",t.style.top="0px",this.divWrapper.appendChild(t),t}transform(e){console.warn("[SuperViz] - transform method not available when container is a canvas element.")}};O();var MA=Wt(wn());O();var Ha=(e=>(e.AREA="area",e.BASE="base",e.BR="br",e.COL="col",e.EMBED="embed",e.HR="hr",e.IMG="img",e.INPUT="input",e.LINK="link",e.META="meta",e.PARAM="param",e.SOURCE="source",e.TRACK="track",e.WBR="wbr",e))(Ha||{}),Ka=(e=>(e.RECT="rect",e.ELLIPSE="ellipse",e.SVG="svg",e))(Ka||{}),RA=class extends qi{constructor(e,t){var i;if(super(),this.presences=new Map,this.mouses=new Map,this.transformation={translate:{x:0,y:0},scale:1},this.onMyParticipantMouseMove=o=>{if(this.isPrivate)return;let a=o.currentTarget,{left:u,top:c}=a.getBoundingClientRect(),p=(o.x-u-this.transformation.translate.x)/this.transformation.scale,h=(o.y-c-this.transformation.translate.y)/this.transformation.scale;this.room.presence.update(de(B({},this.localParticipant),{x:p,y:h,visible:!0,camera:this.camera}))},this.onMyParticipantMouseLeave=o=>{if(typeof window>"u")return;let{left:a,top:u,right:c,bottom:p}=this.container.getBoundingClientRect(),h=o.x>a&&o.y>u&&o.x<c&&o.y<p,f=o.x>0&&o.y>0&&o.x<window.innerWidth&&o.y<window.innerHeight;h&&f||this.room.presence.update({visible:!1})},this.goToMouse=o=>{let a=this.mouses.get(o),u=this.presences.get(o);if(u){if(this.goToPresenceCallback){let c=this.camera.screen.width/u.camera.screen.width,p=this.camera.screen.height/u.camera.screen.height,h=u.camera.x*c,f=u.camera.y*p,m=u.camera.scale*c,y=u.camera.scale*p;this.goToPresenceCallback({x:h,y:f,scaleX:m,scaleY:y});return}a&&a.scrollIntoView({block:"center",inline:"center",behavior:"smooth"})}},this.followMouse=o=>{this.userBeingFollowedId=o,this.goToMouse(o)},this.setParticipantPrivate=o=>{this.isPrivate=o,this.room.presence.update({visible:!o})},this.onPresenceJoinedRoom=o=>{o.id===this.localParticipant.id&&this.room.presence.update(this.localParticipant)},this.onPresenceLeftRoom=o=>{this.removePresenceMouseParticipant(o.id)},this.onPresenceUpdate=o=>{if(o.id===this.localParticipant.id)return;let a=o.data;if(this.userBeingFollowedId&&a.id!==this.userBeingFollowedId&&this.presences.has(a.id)){this.removePresenceMouseParticipant(a.id);return}this.presences.set(a.id,a),this.animate(),this.updateParticipantsMouses()},this.animate=()=>{Ha[this.containerTagname]&&this.updateVoidElementWrapper(),Ka[this.containerTagname]&&this.updateSVGElementWrapper(),this.animationFrame=requestAnimationFrame(this.animate)},this.updateParticipantsMouses=o=>{this.presences.forEach(a=>{if(a.id!==this.localParticipant.id){if(!(a!=null&&a.visible)){this.removePresenceMouseParticipant(a.id);return}this.renderPresenceMouses(a)}}),!o&&this.presences.has(this.userBeingFollowedId)&&this.goToMouse(this.userBeingFollowedId)},this.renderPresenceMouses=o=>{var a,u,c,p,h;if(o.id===this.localParticipant.id)return;let f=document.getElementById(`mouse-${o.id}`);if(f||(f=this.createMouseElement(o)),!f)return;let m=f.getElementsByClassName("mouse-user-name")[0],y=f.getElementsByClassName("pointer-mouse")[0];y&&(y.style.backgroundImage=`url(https://production.cdn.superviz.com/static/mouse-pointers/${(a=o.slot)==null?void 0:a.colorName}.svg)`),m&&(m.style.color=(c=(u=o.slot)==null?void 0:u.textColor)!=null?c:Ut.gray,m.style.backgroundColor=(h=(p=o.slot)==null?void 0:p.color)!=null?h:"#fff",m.innerHTML=o.name);let{x:g,y:_}=o,{translate:{x:E,y:R},scale:N}=this.transformation;f.style.left=`${E+g*N}px`,f.style.top=`${R+_*N}px`},this.renderVoidElementWrapper=()=>{let o=document.createElement("div"),{width:a,height:u,left:c,top:p}=this.container.getBoundingClientRect();o.style.position="absolute",o.style.width=`${a}px`,o.style.height=`${u}px`,o.style.top=`${p}px`,o.style.left=`${c}px`,o.style.overflow="visible",o.style.pointerEvents="none",this.container.parentElement.appendChild(o),this.wrapper=o},this.renderSVGElementWrapper=()=>{let o=this.containerTagname.toLowerCase();if(o==="svg"){this.createSVGWrapper();return}if(o==="rect"){this.createRectWrapper();return}o==="ellipse"&&this.createEllipseWrapper()},this.container=document.getElementById(e),this.logger=new He("@superviz/sdk/presence"),!this.container){let o=`Element with id ${e} not found`;throw this.logger.log(o),new Error(o)}this.camera={x:0,y:0,scale:1,screen:{width:this.container.clientWidth,height:this.container.clientHeight}},this.name="presence";let{localParticipant:r}=this.useStore("global-store");r.subscribe(),this.containerTagname=this.container.tagName.toUpperCase(),this.goToPresenceCallback=(i=t==null?void 0:t.callbacks)==null?void 0:i.onGoToPresence}start(){this.logger.log("presence-mouse component @ start"),this.renderWrapper(),this.addListeners(),this.subscribeToRealtimeEvents(),this.eventBus.subscribe("realtime.private-mode",this.setParticipantPrivate),this.animationFrame=requestAnimationFrame(this.animate),this.eventBus.subscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.subscribe("realtime.local-follow-participant",this.followMouse)}destroy(){cancelAnimationFrame(this.animationFrame),this.logger.log("presence-mouse component @ destroy"),this.removeListeners(),this.wrapper.remove(),this.presences.clear(),this.presences=void 0,this.container=void 0,this.wrapper=void 0,this.unsubscribeFromRealtimeEvents(),this.eventBus.unsubscribe("realtime.private-mode",this.setParticipantPrivate),this.eventBus.unsubscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.unsubscribe("realtime.local-follow-participant",this.followMouse),this.logger=void 0}subscribeToRealtimeEvents(){this.logger.log("presence-mouse component @ subscribe to realtime events"),this.room.presence.on(X.JOINED_ROOM,this.onPresenceJoinedRoom),this.room.presence.on(X.LEAVE,this.onPresenceLeftRoom),this.room.presence.on(X.UPDATE,this.onPresenceUpdate)}unsubscribeFromRealtimeEvents(){this.logger.log("presence-mouse component @ unsubscribe from realtime events"),this.room.presence.off(X.JOINED_ROOM),this.room.presence.off(X.LEAVE),this.room.presence.off(X.UPDATE)}addListeners(){this.pointerMoveObserver=Oa(this.container,"pointermove").pipe(S_(30)).subscribe(this.onMyParticipantMouseMove),this.container.addEventListener("pointerleave",this.onMyParticipantMouseLeave)}removeListeners(){var e;(e=this.pointerMoveObserver)==null||e.unsubscribe(),this.container.removeEventListener("pointerleave",this.onMyParticipantMouseLeave)}setPositionNotStatic(){let{position:e}=window.getComputedStyle(this.container);e==="static"&&this.container.style.setProperty("position","relative")}createMouseElement(e){if(!this.wrapper)return;let t=document.createElement("div");t.setAttribute("id",`mouse-${e.id}`),t.setAttribute("class","mouse-follower");let i=document.createElement("div");i.setAttribute("class","pointer-mouse");let r=document.createElement("div");return r.setAttribute("class","mouse-user-name"),r.innerHTML=e.name,t.appendChild(i),t.appendChild(r),t.style.left="0px",t.style.top="0px",this.wrapper.appendChild(t),this.mouses.set(e.id,t),t}updateSVGPosition(){let e=this.container.parentElement.getBoundingClientRect(),t=this.container.getBoundingClientRect(),i=t.left-e.left,r=t.top-e.top,{width:o,height:a}=this.container.getBoundingClientRect();this.wrapper.style.setProperty("width",`${o}px`),this.wrapper.style.setProperty("height",`${a}px`),this.wrapper.style.setProperty("top",`${r}px`),this.wrapper.style.setProperty("left",`${i}px`)}createSVGWrapper(){let e=document.createElement("div"),t=this.container.parentElement.getBoundingClientRect(),i=this.container.getBoundingClientRect(),r=i.left-t.left,o=i.top-t.top,{width:a,height:u}=this.container.getBoundingClientRect();e.style.position="fixed",e.style.width=`${a}px`,e.style.height=`${u}px`,e.style.top=`${o}px`,e.style.left=`${r}px`,e.style.overflow="visible",e.style.pointerEvents="none",e.id="superviz-svg-wrapper",this.container.parentElement.appendChild(e),this.wrapper=e}createRectWrapper(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","rect"),i=document.createElement("div"),r=this.container.getAttribute("width"),o=this.container.getAttribute("height"),a=this.container.getAttribute("rx"),u=this.container.getAttribute("ry");t.setAttribute("fill","transparent"),t.setAttribute("stroke","transparent"),t.setAttribute("x","0"),t.setAttribute("y","0"),t.setAttribute("rx",a),t.setAttribute("ry",u),t.setAttribute("height",o),t.setAttribute("width",r),e.setAttribute("height",o),e.setAttribute("width",r),e.appendChild(t),i.appendChild(e);let c=this.container.getBoundingClientRect();i.style.position="fixed",i.style.top=`${c.top}px`,i.style.left=`${c.left}px`,i.style.width=`${c.width}px`,i.style.height=`${c.height}px`,i.style.overflow="visible",i.style.pointerEvents="none",i.id="superviz-rect-wrapper";let p=this.container.viewportElement;for(;p.viewportElement;)p=p.viewportElement;p.parentElement.appendChild(i),this.wrapper=i}createEllipseWrapper(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),i=document.createElement("div"),r=this.container.getAttribute("cx"),o=this.container.getAttribute("cy"),a=this.container.getAttribute("rx"),u=this.container.getAttribute("ry"),c=Number(r)-Number(a),p=Number(o)-Number(u),h=String(2*Number(r)),f=String(2*Number(o));t.setAttribute("fill","transparent"),t.setAttribute("stroke","transparent"),t.setAttribute("x","0"),t.setAttribute("y","0"),t.setAttribute("rx",a),t.setAttribute("ry",u),t.setAttribute("cx",`${Number(r)-c}`),t.setAttribute("cy",`${Number(o)-p}`),t.setAttribute("height",f),t.setAttribute("width",h),e.setAttribute("height",f),e.setAttribute("width",h),e.appendChild(t),i.appendChild(e);let m=this.container.getBoundingClientRect();i.style.position="fixed",i.style.top=`${m.top}px`,i.style.left=`${m.left}px`,i.style.width=`${m.width}px`,i.style.height=`${m.height}px`,i.style.overflow="visible",i.style.pointerEvents="none",i.id="superviz-ellipse-wrapper";let y=this.container.viewportElement;for(;y.viewportElement;)y=y.viewportElement;y.parentElement.appendChild(i),this.wrapper=i}transform(e){var t,i;this.transformation=e,this.camera={x:e.translate.x,y:e.translate.y,scale:e.scale,screen:{width:((t=this.wrapper)==null?void 0:t.clientWidth)||1,height:((i=this.wrapper)==null?void 0:i.clientHeight)||1}},this.updateParticipantsMouses(!0)}updateVoidElementWrapper(){let e=this.container.getBoundingClientRect(),t=this.wrapper.getBoundingClientRect(),i=this.container;if((0,MA.isEqual)(e,t))return;let r=i.offsetLeft,o=i.offsetTop;this.wrapper.style.setProperty("width",`${e.width}px`),this.wrapper.style.setProperty("height",`${e.height}px`),this.wrapper.style.setProperty("top",`${o}px`),this.wrapper.style.setProperty("left",`${r}px`),this.wrapper.id="superviz-void-wrapper"}updateSVGElementWrapper(){let{left:e,top:t,width:i,height:r}=this.container.getBoundingClientRect(),{left:o,top:a,width:u,height:c}=this.wrapper.getBoundingClientRect();if(!(e===o&&t===a&&i===u&&r===c)){if(this.containerTagname.toLowerCase()==="svg"){this.updateSVGPosition();return}this.wrapper.style.setProperty("width",`${i}px`),this.wrapper.style.setProperty("height",`${r}px`),this.wrapper.style.setProperty("top",`${t}px`),this.wrapper.style.setProperty("left",`${e}px`)}}renderWrapper(){if(!this.wrapper){if(Ha[this.containerTagname]){this.renderVoidElementWrapper();return}if(Ka[this.containerTagname]){this.renderSVGElementWrapper();return}this.renderElementWrapper()}}removePresenceMouseParticipant(e){let t=document.getElementById(`mouse-${e}`);t&&(t.remove(),this.presences.delete(e),this.mouses.delete(e))}renderElementWrapper(){let e=document.createElement("div");e.style.position="absolute",e.style.width="100%",e.style.height="100%",e.style.top="0",e.style.left="0",e.style.overflow="visible",e.style.pointerEvents="none",this.setPositionNotStatic(),this.container.appendChild(e),this.wrapper=e}},bp=class{constructor(e,t){let i=document.getElementById(e);if(!i)throw new Error(`[Superviz] Container with id ${e} not found`);return i.tagName.toLowerCase()==="canvas"?new IA(e,t):new RA(e,t)}transform(e){}};O();O();var FA=Wt(vd());O();var LA=class{constructor(e){this.room=e,this.logger=new He("@superviz/sdk/realtime-presence")}update(e){this.logger.log("Realtime Presence @ update presence",e),this.room.presence.update(e)}subscribe(e,t){this.logger.log("Realtime Presence @ subscribe",e),this.room.presence.on(e,t)}unsubscribe(e){this.logger.log("Realtime Presence @ unsubscribe",e),this.room.presence.off(e)}getAll(){return ue(this,null,function*(){return this.logger.log("Realtime Presence @ get all"),new Promise((e,t)=>{this.room.presence.get(i=>e(i),i=>{let r=`[SuperViz] ${i.name} - ${i.message}`;this.logger.log(i),console.error(r),t(i)})})})}},jh=class extends ll{constructor(e,t,i,r){super(),this.state="DISCONNECTED",this.callbacksToSubscribeWhenJoined=[],this.publish=(0,FA.default)((o,a)=>{if(this.state!=="CONNECTED"){let u=`Realtime channel ${this.name} is not started yet. You can't publish event ${o} before start`;this.logger.log(u),console.warn(`[SuperViz] ${u}`);return}this.channel.emit(`message:${this.name}`,{name:o,payload:a})},30),this.subscribe=(o,a)=>{if(this.state!=="CONNECTED"){this.callbacksToSubscribeWhenJoined.push({event:o,callback:a});return}this.observers[o]||(this.observers[o]=new $e),this.observers[o].subscribe(a)},this.unsubscribe=(o,a)=>{var u;(u=this.observers[o])==null||u.unsubscribe(a)},this.fetchHistory=o=>ue(this,null,function*(){if(this.state!=="CONNECTED"){let a="Realtime component is not started yet. You can't retrieve history before start";return this.logger.log(a),console.warn(`[SuperViz] ${a}`),null}return yield new Promise((a,u)=>{let c=p=>{var h;(h=p.events)!=null&&h.length||a(null);let f=p.events.reduce((m,y)=>{var g;return m[y.data.name]||(m[y.data.name]=[]),m[y.data.name].push({data:y.data.payload,connectionId:y.connectionId,name:y.data.name,participantId:(g=y.presence)==null?void 0:g.id,timestamp:y.timestamp}),m},{});o&&!f[o]&&u(new Error(`Event ${o} not found in the history`)),o&&a(f[o]),a(f)};this.channel.history(c)})}),this.publishEventToClient=(o,a)=>{var u;this.logger.log("realtime channel @ publishEventToClient",{event:o,data:a}),(u=this.observers[o])==null||u.publish(a)},this.name=e,this.ioc=t,this.logger=new He("@superviz/sdk/realtime-channel"),this.channel=this.ioc.createRoom(`realtime:${this.name}`,r),this.localParticipant=i,this.subscribeToRealtimeEvents(),this.logger.log("started"),this.participant=new LA(this.channel)}disconnect(){return ue(this,null,function*(){if(this.state==="DISCONNECTED"){this.logger.log("Realtime channel is already disconnected");return}this.logger.log("destroyed"),this.changeState("DISCONNECTED"),this.channel.disconnect()})}changeState(e){this.logger.log("realtime component @ changeState - state changed",e),this.state=e,this.publishEventToClient("realtime-channel.state-changed",this.state)}subscribeToRealtimeEvents(){this.channel.presence.on(X.JOINED_ROOM,e=>{e.id===this.localParticipant.id&&(this.changeState("CONNECTED"),this.callbacksToSubscribeWhenJoined.forEach(({event:t,callback:i})=>{this.subscribe(t,i)}),this.logger.log("joined room"),this.changeState("CONNECTED"))}),this.channel.on(`message:${this.name}`,e=>{var t,i;this.logger.log("message received",e),this.publishEventToClient(e.data.name,{data:e.data.payload,participantId:(i=(t=e==null?void 0:e.presence)==null?void 0:t.id)!=null?i:null,name:e.data.name,timestamp:e.timestamp,connectionId:e.connectionId})})}},wp=class extends qi{constructor(){super(),this.state="STOPPED",this.channels=new Map,this.callbacksToSubscribeWhenJoined=[],this.subscribe=(t,i)=>{if(!this.channel){this.callbacksToSubscribeWhenJoined.push({event:t,callback:i});return}this.channel.subscribe(t,i)},this.publish=(t,i)=>{var r;if(Us[t.toUpperCase()]){this.channel.publishEventToClient(t,i);return}(r=this.channel)==null||r.publish(t,i)},this.unsubscribe=(t,i)=>{var r;(r=this.channel)==null||r.unsubscribe(t,i)},this.name="realtime",this.logger=new He("@superviz/sdk/realtime-component");let{localParticipant:e}=this.useStore("global-store");e.subscribe()}connect(e){if(!this.channel)return new Promise(i=>{let{localParticipant:r}=ol();r.subscribe("connect-after-init",o=>{o.activeComponents.includes("realtime")&&(r.unsubscribe("connect-after-init"),i(this.connect(e)))})});let t=this.channels.get(e);return t||(t=new jh(e,this.ioc,this.localParticipant,this.connectionLimit),this.channels.set(e,t),this.state==="STARTED")?t:new Promise(i=>{this.subscribe("realtime-component.state-changed",r=>{r==="STARTED"&&i(t)})})}start(){this.logger.log("started"),this.channel=new jh("default",this.ioc,this.localParticipant,this.connectionLimit),this.channel.subscribe("realtime-channel.state-changed",e=>{e==="CONNECTED"&&(this.callbacksToSubscribeWhenJoined.forEach(({event:t,callback:i})=>{this.channel.subscribe(t,i)}),this.changeState("STARTED"),this.callbacksToSubscribeWhenJoined=[],this.channel.unsubscribe("realtime-channel.state-changed"),this.participant=this.channel.participant,this.channels.set("default",this.channel))})}destroy(){this.logger.log("destroyed"),this.changeState("STOPPED"),this.disconnectFromAllChannels()}disconnectFromAllChannels(){this.channels.forEach(e=>e.disconnect())}changeState(e){var t;this.logger.log("realtime component @ changeState - state changed",e),this.state=e,(t=this.channel)==null||t.publishEventToClient("realtime-component.state-changed",this.state)}};O();var _p=class extends qi{constructor(e){var t;super(),this.onParticipantListUpdate=h=>{if(this.localParticipantId===void 0||this.localParticipantId==="")return;if(!this.initialized){this.initialized=!0,this.initializeList();return}let f=de(B({},h.data),{tooltip:this.getTooltipData(h.data),controls:this.getControls(h.data)}),{participants:m,extras:y}=this.useStore("who-is-online-store");if(m.value.some(({id:g})=>g===h.data.id)){this.updateParticipant(f);return}if(y.value.some(({id:g})=>g===h.data.id)){this.updateExtra(f);return}if(m.value.length<4){m.publish([...m.value,f]);return}y.publish([...y.value,f])},this.onParticipantLeave=h=>{let{participants:f,extras:m}=this.useStore("who-is-online-store");if(f.value.findIndex(g=>g.id===h.id)===-1){let g=m.value.filter(_=>_.id!==h.id);m.publish(g);return}let y=f.value.filter(g=>g.id!==h.id);if(m.value.length){y.push(m.value[0]);let g=m.value.slice(1);m.publish(g)}f.publish(y)},this.updateParticipant=h=>{let{participants:f,extras:m}=this.useStore("who-is-online-store");if(h.isPrivate&&h.id!==this.localParticipantId){let g=f.value.filter(({id:E})=>E!==h.id),_=m.value.splice(0,1);f.publish([...g,..._]),m.publish([...m.value]);return}let y=f.value.map(g=>g.id===h.id?h:g);f.publish(y)},this.updateExtra=h=>{let{extras:f}=this.useStore("who-is-online-store");if(h.isPrivate&&h.id!==this.localParticipantId){let y=f.value.filter(({id:g})=>g!==h.id);f.publish(y);return}let m=f.value.map(y=>y.id===h.id?h:y);f.publish(m)},this.subscribeToLocalParticipantUpdates=h=>{if(!h.slot)return;this.localParticipantId=h.id;let{privateMode:f,joinedPresence:m}=this.useStore("who-is-online-store"),y=this.isInPresence(h.activeComponents);m.publish(y);let g=this.getParticipant(h);this.room.presence.update(de(B({},g),{isPrivate:f.value}))},this.goToMousePointer=h=>{var f,m,y;let g=(y=(f=h.presence)==null?void 0:f.id)!=null?y:(m=h.detail)==null?void 0:m.id;g!==this.localParticipantId&&(this.eventBus.publish("realtime.go-to-participant",g),this.publish("who-is-online.go-to-participant",g))},this.followMousePointer=({detail:h})=>{this.eventBus.publish("realtime.local-follow-participant",h.id),this.following&&this.publish("who-is-online.start-following-participant",this.following),this.following||this.publish("who-is-online.stop-following-participant"),h.source==="extras"&&this.highlightParticipantBeingFollowed(),this.updateParticipantsControls(h.id)},this.setPrivate=({detail:{isPrivate:h,id:f}})=>{let{privateMode:m,participants:y}=this.useStore("who-is-online-store"),g=y.value.find(_=>_.id===f);m.publish(h),this.eventBus.publish("realtime.private-mode",h),this.room.presence.update(de(B({},g),{isPrivate:h})),h&&this.publish("who-is-online.enter-private-mode"),h||this.publish("who-is-online.leave-private-mode")},this.setFollow=h=>{let{id:f}=h.presence;if(f===this.localParticipantId)return;let{data:m}=h,{following:y}=this.useStore("who-is-online-store");y.publish(m),this.followMousePointer({detail:{id:m}})},this.follow=({detail:h})=>{let{everyoneFollowsMe:f}=this.useStore("who-is-online-store");f.publish(!!(h!=null&&h.id)),this.room.emit("who-is-online.start-follow-me",h),this.following&&this.publish("who-is-online.start-follow-me",this.following),this.following||this.publish("who-is-online.stop-follow-me"),this.updateParticipantsControls(h==null?void 0:h.id)},this.stopFollowing=h=>{var f;if(h.id!==((f=this.following)==null?void 0:f.id))return;let{following:m}=this.useStore("who-is-online-store");m.publish(void 0),this.eventBus.publish("realtime.local-follow-participant",void 0),this.publish("who-is-online.stop-following-participant")},this.gather=h=>{this.room.emit("who-is-online.gather-all",h.detail.id),this.publish("who-is-online.gather-all",h.detail.id)},this.onJoinedRoom=h=>{if(h.id!==this.localParticipantId)return;let{localParticipant:f}=this.useStore("global-store");f.subscribe(this.subscribeToLocalParticipantUpdates)},this.name="whoIsOnline",this.logger=new He("@superviz/sdk/who-is-online-component");let{disablePresenceControls:i,disableGoToParticipant:r,disableFollowParticipant:o,disablePrivateMode:a,disableGatherAll:u,disableFollowMe:c,following:p}=this.useStore("who-is-online-store");if(p.subscribe(),typeof e!="object"){this.position=e??"top-right";return}typeof e=="object"&&(this.position=(t=e.position)!=null?t:"top-right",this.setStyles(e.styles),i.publish(e.disablePresenceControls),r.publish(e.disableGoToParticipant),o.publish(e.disableFollowParticipant),a.publish(e.disablePrivateMode),u.publish(e.disableGatherAll),c.publish(e.disableFollowMe))}start(){let{localParticipant:e}=this.useStore("global-store");this.localParticipantId=e.value.id,this.subscribeToRealtimeEvents(),this.positionWhoIsOnline(),this.addListeners()}destroy(){this.unsubscribeFromRealtimeEvents(),this.removeListeners(),this.element.remove(),this.element=null,this.initialized=!1;let{destroy:e}=this.useStore("who-is-online-store");e()}addListeners(){this.element.addEventListener("realtime.local-follow-participant",this.followMousePointer),this.element.addEventListener("realtime.go-to-participant",this.goToMousePointer),this.element.addEventListener("realtime.private-mode",this.setPrivate),this.element.addEventListener("realtime.follow-participant",this.follow),this.element.addEventListener("realtime.gather",this.gather)}removeListeners(){this.element.removeEventListener("realtime.local-follow-participant",this.followMousePointer),this.element.removeEventListener("realtime.go-to-participant",this.goToMousePointer),this.element.removeEventListener("realtime.private-mode",this.setPrivate),this.element.removeEventListener("realtime.follow-participant",this.follow),this.element.removeEventListener("realtime.gather",this.gather)}subscribeToRealtimeEvents(){this.room.presence.on(X.UPDATE,this.onParticipantListUpdate),this.room.presence.on(X.LEAVE,this.onParticipantLeave),this.room.presence.on(X.LEAVE,this.stopFollowing),this.room.presence.on(X.JOINED_ROOM,this.onJoinedRoom),this.room.on("who-is-online.gather-all",this.goToMousePointer),this.room.on("who-is-online.start-follow-me",this.setFollow)}unsubscribeFromRealtimeEvents(){this.room.presence.off(X.UPDATE),this.room.presence.off(X.LEAVE),this.room.presence.off(X.JOINED_ROOM),this.room.off("who-is-online.gather-all",this.goToMousePointer),this.room.off("who-is-online.start-follow-me",this.setFollow)}initializeList(){let{participants:e,extras:t}=this.useStore("who-is-online-store");this.room.presence.get(i=>{let r=i.filter(c=>c.data.id).map(({data:c})=>{let p=c.avatar;p||(p=this.getAvatar({avatar:c.avatar,color:c.slot.color,name:c.name,letterColor:c.slot.textColor}));let h=this.getTooltipData(c),f=this.getControls(c);return de(B({},c),{tooltip:h,controls:f,avatar:p,isLocalParticipant:c.id===this.localParticipantId})});if(!r.length)return;let o=r.findIndex(c=>c.id===this.localParticipantId),a=r.splice(o,1)[0],u=r.splice(0,3);e.publish([a,...u]),t.publish(r)})}setStyles(e=""){if(!e)return;let t=document.createElement("style");t.textContent=e,t.id="superviz-who-is-online-styles",document.head.appendChild(t)}positionWhoIsOnline(){if(this.element=document.createElement("superviz-who-is-online"),Object.values(Hh).includes(this.position.toLowerCase())){document.body.appendChild(this.element);let[t,i]=this.position.split("-");this.element.position=`${t}: 20px; ${i}: 40px;`;return}let e=document.getElementById(this.position);if(!e){this.element.position="top: 20px; right: 40px;",document.body.appendChild(this.element);return}e.appendChild(this.element),this.element.position="position: relative;"}getParticipant(e){let{avatar:t,activeComponents:i,id:r,name:o,slot:{color:a,textColor:u}}=e,c=this.shouldDisableDropdown({activeComponents:i,participantId:r}),p=this.getAvatar({avatar:t,color:a,name:o,letterColor:u});return{id:r,name:o,avatar:p,disableDropdown:c,activeComponents:i,isPrivate:!1}}shouldDisableDropdown({activeComponents:e,participantId:t}){let{joinedPresence:{value:i},disablePresenceControls:{value:r},disableFollowMe:{value:o},disableFollowParticipant:{value:a},disableGoToParticipant:{value:u},disableGatherAll:{value:c},disablePrivateMode:{value:p}}=this.useStore("who-is-online-store");return i===!1||r===!0||t===this.localParticipantId&&o&&p&&c||t!==this.localParticipantId&&a&&u?!0:!(e!=null&&e.some(h=>h.toLowerCase().includes("presence")))}getTooltipData(e){let{name:t,disableDropdown:i,id:r}=e,o=r===this.localParticipantId,a={name:t};return o&&(a.name+=" (You)"),!i&&!o&&(a.info="Click to follow"),a}getAvatar({avatar:e,color:t,name:i,letterColor:r}){var o,a;let u=e==null?void 0:e.imageUrl,c=(a=(o=i==null?void 0:i.at(0))==null?void 0:o.toUpperCase())!=null?a:"A";return{imageUrl:u,firstLetter:c,color:t,letterColor:r}}getControls(e){let{disablePresenceControls:t}=this.useStore("who-is-online-store"),{disableDropdown:i,id:r}=e;return t.value||i?[]:r===this.localParticipantId?this.getLocalParticipantControls():this.getOtherParticipantsControls(r)}getOtherParticipantsControls(e){var t;let{disableGoToParticipant:i,disableFollowParticipant:r,following:o}=this.useStore("who-is-online-store"),a=[];if(i.value||a.push({label:"go to",icon:"place"}),!r.value){let u=((t=o.value)==null?void 0:t.id)===e,c=u?"unfollow":"follow",p=u?"send-off":"send";a.push({label:c,icon:p})}return a}getLocalParticipantControls(){let{disableFollowMe:{value:e},disableGatherAll:{value:t},disablePrivateMode:{value:i},everyoneFollowsMe:{value:r},privateMode:{value:o}}=this.useStore("who-is-online-store"),a=[];if(t||a.push({label:"gather all",icon:"gather"}),!e){let u=r?"send-off":"send",c=r?"stop followers":"everyone follows me";a.push({label:c,icon:u})}if(!i){let u=o?"eye_inative":"eye",c=o?"leave private mode":"private mode";a.push({label:c,icon:u})}return a}updateParticipantsControls(e){let{participants:t}=this.useStore("who-is-online-store"),i=t.value.map(r=>{if(e&&r.id!==e)return r;let o=this.getControls(r);return de(B({},r),{controls:o})});t.publish(i)}highlightParticipantBeingFollowed(){let{extras:e,participants:t,following:{value:i}}=this.useStore("who-is-online-store"),r=t.value[0],o=e.value.findIndex(c=>c.id===i.id),a=e.value.splice(o,1)[0];t.value.unshift(r),t.value[1]=a;let u=t.value.pop();e.value.push(u),e.publish(e.value),t.publish(t.value)}isInPresence(e){return e==null?void 0:e.some(t=>t.includes("presence"))}};O();var Cp=class extends qi{constructor(e={}){super(),this.fields={},this.fieldsOriginalOutline={},this.focusList={},this.enabledOutlineFields={},this.enabledRealtimeSyncFields={},this.flags={},this.allowedTagNames=["input","textarea"],this.allowedInputTypes=["text","email","date","color","datetime-local","month","number","password","range","search","tel","time","url","week","checkbox","radio"],this.throwError={onInvalidFieldsProp:o=>{throw new Error(`"Fields" property must be either a string or an array of strings. Received type: ${o}`)},onFieldNotFound:o=>{throw new Error(`You must pass the id of an existing element. Element with id ${o} not found`)},onInvalidTagName:o=>{throw new Error(`You can't register an element with tag ${o}. Only the tags "${this.allowedTagNames.join(", ")}" are allowed`)},onInvalidInputType:o=>{throw new Error(`You can't register an input element of type ${o}. Only the types "${this.allowedInputTypes.join(", ")}" are allowed`)},onDeregisterInvalidField:o=>{throw new Error(`You can't deregister field of id ${o}. No field was registered with id ${o} `)}},this.sync=o=>{var a,u;let c=this.fields[o],p=this.hasCheckedProperty(c),h={value:p?c.checked:c.value,color:this.localParticipant.slot.color,fieldId:o,showOutline:this.canUpdateColor(o),syncContent:this.canSyncContent(o),attribute:p?"checked":"value"};(a=this.room)==null||a.emit("field.content-change"+o,h),(u=this.room)==null||u.emit("field.interaction"+o,h)},this.handleInput=o=>{var a,u,c,p;let h=o.target;(u=this.room)==null||u.emit("field.interaction"+h.id,{fieldId:h.id,color:(a=this.localParticipant.slot)==null?void 0:a.color});let f=this.canSyncContent(h.id);if(!f)return;let m={value:h.value,color:(c=this.localParticipant.slot)==null?void 0:c.color,fieldId:h.id,showOutline:this.canUpdateColor(h.id),syncContent:f,attribute:"value"};(p=this.room)==null||p.emit("field.content-change"+h.id,m)},this.handleChange=o=>{var a;let u=o.target;if(!this.canSyncContent(u.id))return;let c={fieldId:u.id,value:u.checked,color:this.localParticipant.slot.color,showOutline:this.canUpdateColor(u.id),syncContent:this.canSyncContent(u.id),attribute:"checked"};(a=this.room)==null||a.emit("field.content-change"+u.id,c)},this.handleFocus=o=>{var a;let u=o.target,c={color:this.localParticipant.slot.color,fieldId:u.id};(a=this.room)==null||a.emit("field.focus"+u.id,c)},this.handleBlur=o=>{var a;let u=o.target,c={fieldId:u.id};(a=this.room)==null||a.emit("field.blur"+u.id,c)},this.removeFieldColor=({presence:o,data:{fieldId:a}})=>{var u,c;((u=this.focusList[a])==null?void 0:u.id)!==o.id||!this.fields[a]||(this.fields[a].style.outline=(c=this.fieldsOriginalOutline[a])!=null?c:"",delete this.fieldsOriginalOutline[a],delete this.focusList[a])},this.updateFieldColor=({presence:o,data:{color:a,fieldId:u},timestamp:c})=>{var p;let h=(p=this.focusList[u])!=null?p:{},f=!h.id,m=o.id===this.localParticipant.id;if(f&&m){this.focusList[u]={id:o.id,color:a,firstInteraction:c,lastInteraction:c};return}if(h.id===o.id){this.focusList[u].lastInteraction=c;return}let y=c-h.lastInteraction>=3e3,g=c-h.firstInteraction>=1e4;if(!(y||g||f))return;this.focusList[u]={id:o.id,color:a,firstInteraction:c,lastInteraction:c};let _=m?this.fieldsOriginalOutline[u]:`1px solid ${a}`;this.fields[u].style.outline=_},this.updateFieldContent=o=>{var a=o,{presence:u,data:{value:c,fieldId:p,color:h,showOutline:f,syncContent:m,attribute:y},timestamp:g}=a,_=Ea(a,["presence","data","timestamp"]);this.publish("field.content-change",{value:c,fieldId:p,attribute:y,userId:u.id,userName:u.name,timestamp:g}),m&&this.canSyncContent(p)&&u.id!==this.localParticipant.id&&(this.fields[p][y]=c),f&&this.canUpdateColor(p)&&this.updateFieldColor(B({presence:u,data:{color:h,fieldId:p},timestamp:g},_))},this.publishTypedEvent=({presence:o,data:{fieldId:a,color:u}})=>{this.publish("field.interaction",{fieldId:a,userId:o.id,userName:o.name,color:u})},this.canSyncContent=o=>!this.flags.disableRealtimeSync&&this.enabledRealtimeSyncFields[o]!==!1||!!this.enabledRealtimeSyncFields[o],this.name="formElements",this.logger=new He("@superviz/sdk/presence-input-component");let t=e,{fields:i}=t,r=Ea(t,["fields"]);if(this.flags=r??{},typeof i=="string"){this.validateField(i),this.fields[i]=null;return}if(Array.isArray(i)){i.forEach(o=>{this.validateField(o),this.fields[o]=null});return}i!==void 0&&this.throwError.onInvalidFieldsProp(typeof i)}enableOutline(e){let t=this.fields[e];t&&(this.enabledOutlineFields[e]=!0,this.fieldsOriginalOutline[e]=t.style.outline,t.addEventListener("focus",this.handleFocus),t.addEventListener("blur",this.handleBlur),this.room.on("field.focus"+e,this.updateFieldColor),this.room.on("field.blur"+e,this.removeFieldColor))}disableOutline(e){var t,i;let r=this.fields[e];r&&(this.enabledOutlineFields[e]=!1,r.style.outline=(t=this.fieldsOriginalOutline[e])!=null?t:"",r.removeEventListener("focus",this.handleFocus),r.removeEventListener("blur",this.handleBlur),this.room.off("field.focus"+e,this.updateFieldColor),this.room.off("field.blur"+e,this.removeFieldColor),(i=this.room)==null||i.emit("field.blur"+e,{fieldId:e}))}enableRealtimeSync(e){this.enabledRealtimeSyncFields[e]=!0}disableRealtimeSync(e){this.enabledRealtimeSyncFields[e]=!1}registerField(e){this.validateField(e);let t=document.getElementById(e);this.fields[e]=t,this.addListenersToField(t),this.addRealtimeListenersToField(e),this.fieldsOriginalOutline[e]=t.style.outline}deregisterField(e){var t;this.fields[e]||this.throwError.onDeregisterInvalidField(e),this.removeListenersFromField(this.fields[e]),this.removeRealtimeListenersFromField(e),this.fields[e].style.outline=this.fieldsOriginalOutline[e],this.fields[e]=void 0,delete this.enabledOutlineFields[e],delete this.enabledRealtimeSyncFields[e],delete this.fieldsOriginalOutline[e],delete this.focusList[e],(t=this.room)==null||t.emit("field.blur"+e,{fieldId:e})}start(){let{localParticipant:e}=this.useStore("global-store");e.subscribe(),Object.entries(this.fields).forEach(([t])=>{this.registerField(t)})}destroy(){this.restoreOutlines(),this.deregisterAllFields(),this.fieldsOriginalOutline=void 0,this.focusList=void 0}addListenersToField(e){this.hasCheckedProperty(e)?e.addEventListener("change",this.handleChange):e.addEventListener("input",this.handleInput),!this.flags.disableOutline&&(e.addEventListener("focus",this.handleFocus),e.addEventListener("blur",this.handleBlur))}addRealtimeListenersToField(e){this.room&&(this.room.on("field.content-change"+e,this.updateFieldContent),this.room.on("field.interaction"+e,this.publishTypedEvent),!this.flags.disableOutline&&(this.room.on("field.focus"+e,this.updateFieldColor),this.room.on("field.blur"+e,this.removeFieldColor)))}removeListenersFromField(e){this.hasCheckedProperty(e)?e.removeEventListener("change",this.handleChange):e.removeEventListener("input",this.handleInput),!this.flags.disableOutline&&(e.removeEventListener("focus",this.handleFocus),e.removeEventListener("blur",this.handleBlur))}removeRealtimeListenersFromField(e){this.room&&(this.room.off("field.content-change"+e,this.updateFieldContent),this.room.off("field.interaction"+e,this.publishTypedEvent),!this.flags.disableOutline&&(this.room.off("field.focus"+e,this.updateFieldColor),this.room.off("field.blur"+e,this.removeFieldColor)))}deregisterAllFields(){Object.keys(this.fields).forEach(e=>{this.deregisterField(e)}),this.fields=void 0}validateField(e){this.validateFieldId(e);let t=document.getElementById(e);this.validateFieldTagName(t),this.validateFieldType(t)}validateFieldTagName(e){let t=e.tagName.toLowerCase();this.allowedTagNames.includes(t)||(this.logger.log("invalid element tagname"),this.throwError.onInvalidTagName(t))}validateFieldType(e){if(e.tagName.toLowerCase()!=="input")return;let t=e.getAttribute("type"),i=this.allowedInputTypes.includes(t);t&&!i&&(this.logger.log("invalid input type"),this.throwError.onInvalidInputType(t))}validateFieldId(e){document.getElementById(e)||this.throwError.onFieldNotFound(e)}restoreOutlines(){Object.entries(this.fields).forEach(([e])=>{this.fields[e].style.outline=this.fieldsOriginalOutline[e]})}hasCheckedProperty(e){let t=e.tagName.toLowerCase(),i=e.getAttribute("type");return t==="input"&&(i==="radio"||i==="checkbox")}canUpdateColor(e){return!this.flags.disableOutline&&this.enabledOutlineFields[e]!==!1||this.enabledOutlineFields[e]}};typeof window<"u"&&(window.SuperVizRoom={init:cp,CommentEvent:Jh,MeetingEvent:el,DeviceEvent:Zh,RealtimeEvent:Wh,MeetingState:Vh,MeetingConnectionStatus:Gh,MeetingControlsEvent:zh,ParticipantEvent:il,FrameEvent:tl,LayoutMode:dp,VideoConference:yp,MousePointers:bp,Realtime:wp,Comments:mp,CanvasPin:vp,HTMLPin:gp,WhoIsOnline:_p,FormElements:Cp,ParticipantType:up,LayoutPosition:hp,CamerasPosition:pp,RealtimeComponentState:yl,RealtimeComponentEvent:bl,ComponentLifeCycleEvent:Us,WhoIsOnlineEvent:qh,StoreType:Qh,PresenceEvents:X,FieldEvents:fp,PinMode:Yh,Comment});var NA=cp,DA=Object.create,wl=Object.defineProperty,jA=Object.defineProperties,BA=Object.getOwnPropertyDescriptor,UA=Object.getOwnPropertyDescriptors,Ep=Object.getOwnPropertyNames,Bh=Object.getOwnPropertySymbols,$A=Object.getPrototypeOf,Pp=Object.prototype.hasOwnProperty,zA=Object.prototype.propertyIsEnumerable,Uh=(e,t,i)=>t in e?wl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Wi=(e,t)=>{for(var i in t||(t={}))Pp.call(t,i)&&Uh(e,i,t[i]);if(Bh)for(var i of Bh(t))zA.call(t,i)&&Uh(e,i,t[i]);return e},ys=(e,t)=>jA(e,UA(t)),_l=(e,t)=>function(){return t||(0,e[Ep(e)[0]])((t={exports:{}}).exports,t),t.exports},WA=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Ep(t))!Pp.call(e,o)&&o!==i&&wl(e,o,{get:()=>t[o],enumerable:!(r=BA(t,o))||r.enumerable});return e},VA=(e,t,i)=>(i=e!=null?DA($A(e)):{},WA(wl(i,"default",{value:e,enumerable:!0}),e)),Ap=(e,t,i)=>new Promise((r,o)=>{var a=p=>{try{c(i.next(p))}catch(h){o(h)}},u=p=>{try{c(i.throw(p))}catch(h){o(h)}},c=p=>p.done?r(p.value):Promise.resolve(p.value).then(a,u);c((i=i.apply(e,t)).next())}),GA=_l({"../../node_modules/.pnpm/ms@2.1.3/node_modules/ms/index.js"(e,t){var i=1e3,r=i*60,o=r*60,a=o*24,u=a*7,c=a*365.25;t.exports=function(y,g){g=g||{};var _=typeof y;if(_==="string"&&y.length>0)return p(y);if(_==="number"&&isFinite(y))return g.long?f(y):h(y);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(y))};function p(y){if(y=String(y),!(y.length>100)){var g=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);if(g){var _=parseFloat(g[1]),E=(g[2]||"ms").toLowerCase();switch(E){case"years":case"year":case"yrs":case"yr":case"y":return _*c;case"weeks":case"week":case"w":return _*u;case"days":case"day":case"d":return _*a;case"hours":case"hour":case"hrs":case"hr":case"h":return _*o;case"minutes":case"minute":case"mins":case"min":case"m":return _*r;case"seconds":case"second":case"secs":case"sec":case"s":return _*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return _;default:return}}}}function h(y){var g=Math.abs(y);return g>=a?Math.round(y/a)+"d":g>=o?Math.round(y/o)+"h":g>=r?Math.round(y/r)+"m":g>=i?Math.round(y/i)+"s":y+"ms"}function f(y){var g=Math.abs(y);return g>=a?m(y,g,a,"day"):g>=o?m(y,g,o,"hour"):g>=r?m(y,g,r,"minute"):g>=i?m(y,g,i,"second"):y+" ms"}function m(y,g,_,E){var R=g>=_*1.5;return Math.round(y/_)+" "+E+(R?"s":"")}}}),ZA=_l({"../../node_modules/.pnpm/debug@4.3.7/node_modules/debug/src/common.js"(e,t){function i(r){a.debug=a,a.default=a,a.coerce=m,a.disable=p,a.enable=c,a.enabled=h,a.humanize=GA(),a.destroy=y,Object.keys(r).forEach(g=>{a[g]=r[g]}),a.names=[],a.skips=[],a.formatters={};function o(g){let _=0;for(let E=0;E<g.length;E++)_=(_<<5)-_+g.charCodeAt(E),_|=0;return a.colors[Math.abs(_)%a.colors.length]}a.selectColor=o;function a(g){let _,E=null,R,N;function j(...U){if(!j.enabled)return;const K=j,ie=Number(new Date),we=ie-(_||ie);K.diff=we,K.prev=_,K.curr=ie,_=ie,U[0]=a.coerce(U[0]),typeof U[0]!="string"&&U.unshift("%O");let pe=0;U[0]=U[0].replace(/%([a-zA-Z%])/g,(Le,Oe)=>{if(Le==="%%")return"%";pe++;const xe=a.formatters[Oe];if(typeof xe=="function"){const it=U[pe];Le=xe.call(K,it),U.splice(pe,1),pe--}return Le}),a.formatArgs.call(K,U),(K.log||a.log).apply(K,U)}return j.namespace=g,j.useColors=a.useColors(),j.color=a.selectColor(g),j.extend=u,j.destroy=a.destroy,Object.defineProperty(j,"enabled",{enumerable:!0,configurable:!1,get:()=>E!==null?E:(R!==a.namespaces&&(R=a.namespaces,N=a.enabled(g)),N),set:U=>{E=U}}),typeof a.init=="function"&&a.init(j),j}function u(g,_){const E=a(this.namespace+(typeof _>"u"?":":_)+g);return E.log=this.log,E}function c(g){a.save(g),a.namespaces=g,a.names=[],a.skips=[];let _;const E=(typeof g=="string"?g:"").split(/[\s,]+/),R=E.length;for(_=0;_<R;_++)E[_]&&(g=E[_].replace(/\*/g,".*?"),g[0]==="-"?a.skips.push(new RegExp("^"+g.slice(1)+"$")):a.names.push(new RegExp("^"+g+"$")))}function p(){const g=[...a.names.map(f),...a.skips.map(f).map(_=>"-"+_)].join(",");return a.enable(""),g}function h(g){if(g[g.length-1]==="*")return!0;let _,E;for(_=0,E=a.skips.length;_<E;_++)if(a.skips[_].test(g))return!1;for(_=0,E=a.names.length;_<E;_++)if(a.names[_].test(g))return!0;return!1}function f(g){return g.toString().substring(2,g.toString().length-2).replace(/\.\*\?$/,"*")}function m(g){return g instanceof Error?g.stack||g.message:g}function y(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return a.enable(a.load()),a}t.exports=i}}),JA=_l({"../../node_modules/.pnpm/debug@4.3.7/node_modules/debug/src/browser.js"(e,t){e.formatArgs=r,e.save=o,e.load=a,e.useColors=i,e.storage=u(),e.destroy=(()=>{let p=!1;return()=>{p||(p=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function i(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let p;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(p=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(p[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(p){if(p[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+p[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const h="color: "+this.color;p.splice(1,0,h,"color: inherit");let f=0,m=0;p[0].replace(/%[a-zA-Z%]/g,y=>{y!=="%%"&&(f++,y==="%c"&&(m=f))}),p.splice(m,0,h)}e.log=console.debug||console.log||(()=>{});function o(p){try{p?e.storage.setItem("debug",p):e.storage.removeItem("debug")}catch{}}function a(){let p;try{p=e.storage.getItem("debug")}catch{}return!p&&typeof process<"u"&&"env"in process&&(p=process.env.DEBUG),p}function u(){try{return localStorage}catch{}}t.exports=ZA()(e);var{formatters:c}=t.exports;c.j=function(p){try{return JSON.stringify(p)}catch(h){return"[UnexpectedJSONParseError]: "+h.message}}}}),Ca=()=>new Map,qA=(e,t,i)=>{let r=e.get(t);return r===void 0&&e.set(t,r=i()),r},HA=()=>new Set,KA=Array.from,Sp=class{constructor(){this._observers=Ca()}on(e,t){return qA(this._observers,e,HA).add(t),t}once(e,t){const i=(...r)=>{this.off(e,i),t(...r)};this.on(e,i)}off(e,t){const i=this._observers.get(e);i!==void 0&&(i.delete(t),i.size===0&&this._observers.delete(e))}emit(e,t){return KA((this._observers.get(e)||Ca()).values()).forEach(i=>i(...t))}destroy(){this._observers=Ca()}},YA=class extends Sp{constructor(e,t){super(),this.doc=e,this.logger=t,this.clientID=0,this.states=new Map,this._checkInterval=null,this.meta=new Map,this.participantIdToClientId=new Map,this.room=null,this.TIMEOUT_TIMER_MS=3e4,this.YJS_STATE="__yjs",this.previousState=null,this.participantId="",this.setLocalState=i=>{var r,o;if(this.logger.log("[SuperViz | Awareness] - Set local state",i),i===null){if(!this.states.has(this.clientID))return;this.states.delete(this.clientID),(r=this.room)==null||r.presence.update(ys(Wi({},this.states.get(this.clientID)),{[this.YJS_STATE]:null,origin:"set local state null"}));const p={added:[],updated:[],removed:[this.clientID]};this.emit("change",[p,"local"]);return}const a={added:[],updated:[],removed:[]};let u=this.states.get(this.clientID);u?a.updated.push(this.clientID):(u={[this.YJS_STATE]:{},clientID:this.clientID},a.added.push(this.clientID));const c=ys(Wi({},u),{[this.YJS_STATE]:i,origin:"set local state"});this.states.set(this.clientID,c),(o=this.room)==null||o.presence.update(c),this.emit("change",[a,"local"])},this.onLeave=i=>{const r=this.participantIdToClientId.get(i.id);if(this.logger.log("[SuperViz | Awareness] - Participant left",{participant:i,clientID:r}),!r)return;if(r===this.clientID){const a=Array.from(this.states.keys());this.removeAwarenessStates(a,"presence");return}const o={added:[],updated:[],removed:[r]};this.participantIdToClientId.delete(i.id),this.states.delete(r),this.emit("update",[o,"presence"]),this.emit("change",[o,"presence"])},this.onUpdate=i=>{if(i.id===this.participantId)return;if(this.logger.log("[SuperViz | Awareness] - Participant updated",i),i.data[this.YJS_STATE]===null){this.removeAwarenessStates([i.data.clientID],"presence");return}const r=[],o=[];let a=this.participantIdToClientId.get(i.id);a?o.push(i.data.clientID):(this.participantIdToClientId.set(i.id,i.data.clientID),a=i.data.clientID,r.push(i.data.clientID)),this.states.set(a,Wi(Wi({},this.states.get(a)||{}),i.data)),this.emit("update",[{added:r,updated:o,removed:[]},"presence"]),this.emit("change",[{added:r,updated:o,removed:[]},"presence"])},this.onVisibilityChange=()=>{if(document.visibilityState==="visible"){clearTimeout(this.visibilityTimeout),this.previousState&&(this.setLocalState(this.previousState),this.previousState=null);return}this.visibilityTimeout=setTimeout(()=>{this.previousState=this.getLocalState(),this.setLocalState(null)},this.TIMEOUT_TIMER_MS)},this.clientID=this.doc.clientID}connect(e,t){this.logger.log("[SuperViz | Awareness] - Connect awareness to room"),this.participantId=e,this.room=t,this.addRoomListeners(),this.addDocumentListeners(),this.initializePresences()}destroy(){this.logger.log("[SuperViz | Awareness] - Destroy awareness"),this.setLocalState(null),this.removeAwarenessStates(Array.from(this.states.keys()),"local"),clearTimeout(this.visibilityTimeout),this.visibilityTimeout=void 0,this.removeDocumentListeners(),this.removeRoomListeners(),this.room=null,this.states.clear(),this.participantIdToClientId.clear(),this.onLeave({id:this.participantId})}getLocalState(){var e;this.logger.log("[SuperViz | Awareness] - Get local state",(e=this.states.get(this.clientID))==null?void 0:e[this.YJS_STATE]);const t=this.states.get(this.clientID);return!t||!t[this.YJS_STATE]?null:t[this.YJS_STATE]}getStates(){const e=new Map;return this.states.forEach((t,i)=>{e.set(i,t[this.YJS_STATE])}),this.logger.log("[SuperViz | Awareness] - Get states",e),e}setLocalStateField(e,t){this.logger.log("[SuperViz | Awareness] - Set local state field",{field:e,value:t});const i=this.getLocalState();this.setLocalState(ys(Wi({},i||{}),{[e]:t}))}addRoomListeners(){this.room.presence.on("presence.update",this.onUpdate),this.room.presence.on("presence.leave",this.onLeave)}removeRoomListeners(){this.room.presence.off("presence.update"),this.room.presence.off("presence.leave")}addDocumentListeners(){document.addEventListener("visibilitychange",this.onVisibilityChange)}removeDocumentListeners(){document.removeEventListener("visibilitychange",this.onVisibilityChange)}initializePresences(){this.room.presence.get(e=>{const t=[];e.forEach(o=>{const{clientID:a}=o.data;a&&(t.push(a),this.participantIdToClientId.set(o.id,a),this.states.set(a,Wi({},o.data)))});const{clientID:i}=this.doc;this.room.presence.update(ys(Wi({clientID:i,[this.YJS_STATE]:{}},this.states.get(i)||{}),{origin:"on connect"}));const r={added:t,updated:[],removed:[]};this.emit("change",[r,"presence"])})}removeAwarenessStates(e,t){this.logger.log("[SuperViz | Awareness] - Remove awareness states",{removed:e,origin:t});const i={added:[],updated:[],removed:[]};e.forEach(r=>{this.states.get(r)&&(this.states.delete(r),i.removed.push(r))}),this.emit("change",[i,t])}},QA=VA(JA()),XA=class{constructor(e,t){this.prefix=t,this.debug=(0,QA.default)(e)}log(e,...t){this.debug(`${this.prefix} -`,e,...t)}};function e1(e,t){return Ap(this,null,function*(){try{const i=yield fetch(`https://io.superviz.com/yjs/${e}:yjs-provider`,{headers:{"sv-api-key":t}});return i.status!==200?[]:(yield i.json()).events.map(o=>new Uint8Array(o.update.data))}catch{return[]}})}var t1={GLOBAL:"global-store"},Op=class extends Sp{constructor(e,t){super(),this.doc=e,this.name="yjsProvider",this._synced=!1,this.state="provider.disconnected",this.isAttached=!1,this.localParticipant=null,this.room=null,this.ioc=null,this.fetch=()=>Ap(this,null,function*(){this.logger.log("Fetching the document"),this._synced=!1;const i=yield e1(this.roomId,this.ioc.client.apiKey);this._synced=!0,i.length&&cs.applyUpdateV2(this.doc,cs.mergeUpdatesV2(i))}),this.updateDocument=i=>{this.logger.log("Applying remote update",i),cs.applyUpdateV2(this.doc,i,this)},this.onDocUpdate=i=>{this.logger.log("Local document update",i),this.beforeSendRealtimeMessage("provider.update",{update:i}),this.room.emit("provider.update",{update:i})},this.onLocalJoinRoom=i=>{var r;if(this.state==="provider.connected"||i.id!==this.localParticipant.id)return;this.logger.log("Joined the room",i),(r=this.awareness)==null||r.connect(this.localParticipant.id,this.room),this.changeState("provider.connected"),this.emit("connect",[]);const o=cs.encodeStateAsUpdateV2(this.doc);this.beforeSendRealtimeMessage("provider.update",{update:o}),this.room.emit("provider.update",{update:o}),this.fetch()},this.onConnectionChange=i=>{i.state==="DISCONNECTED"&&(this.logger.log("Disconnected from the room"),this.emit("disconnect",[]))},this.onRemoteDocUpdate=i=>{var r;if(((r=i.presence)==null?void 0:r.id)===this.localParticipant.id)return;this.logger.log("Received remote document update",i);const o=new Uint8Array(i.data.update);this.onReceiveRealtimeMessage("provider.update",{update:o}),this.updateDocument(o)},this.onReceiveRealtimeMessage=(i,r)=>{this.logger.log("Received message from room",{name:i,data:r}),this.emit("message",[{name:i,data:r}])},this.beforeSendRealtimeMessage=(i,r)=>{this.logger.log("Sending message to room",{name:i,data:r}),this.emit("outgoingMessage",[{name:i,data:r}])},this.document=e,this.logger=new XA("SuperVizYjsProvider","[SuperViz | YjsProvider] - "),(t==null?void 0:t.awareness)!==!1&&(this.awareness=new YA(this.doc,this.logger))}attach(e){if(Object.values(e).includes(null)||Object.values(e).includes(void 0)){const c=`${this.name} @ attach - params are required`;throw this.logger.log(c),new Error(c)}const{useStore:t,ioc:i,config:r}=e,{isDomainWhitelisted:o,hasJoinedRoom:a,localParticipant:u}=t(t1.GLOBAL);if(!o.value){const c=`Component ${this.name} can't be used because this website's domain is not whitelisted. Please add your domain in https://dashboard.superviz.com/developer`;this.logger.log(c);return}if(!a.value){a.subscribe(()=>this.attach(e));return}this.roomId=r.roomId,this.ioc=i,this.localParticipant=u.value,this.isAttached=!0,this.connect(),this.emit("mount",[])}detach(){if(!this.isAttached){this.logger.log(`${this.name} @ detach - component is not attached`);return}this.logger.log("detached"),this.destroyProvider(),super.destroy(),this.emit("unmount",[])}connect(){this.state==="provider.disconnected"&&(this.logger.log("Connecting to the room"),this.changeState("provider.connecting"),this.doc.on("updateV2",this.onDocUpdate),this.startRealtime())}destroyProvider(){var e;if(this.state==="provider.disconnected"){this.logger.log("Can't destroy. Provider disconnected");return}this.logger.log("Destroying the provider"),this.emit("destroy",[]),this._synced=!1,(e=this.awareness)==null||e.destroy(),this.doc.off("updateV2",this.onDocUpdate),this.removeRoomListeners(),this.room&&(this.room.disconnect(),this.room=null),this.changeState("provider.disconnected")}get synced(){return this._synced}createRoom(){this.logger.log("Creating room"),this.room=this.ioc.createRoom("yjs-provider")}addRoomListeners(){this.logger.log("Adding room listeners"),this.room.on("provider.update",this.onRemoteDocUpdate),this.room.presence.on("presence.joined-room",this.onLocalJoinRoom),this.ioc.client.connection.on(this.onConnectionChange)}removeRoomListeners(){var e;this.logger.log("Removing room listeners"),this.room&&(this.room.off("provider.update",this.onRemoteDocUpdate),this.room.presence.off("presence.joined-room")),(e=this.ioc)==null||e.client.connection.off()}startRealtime(){this.createRoom(),this.addRoomListeners()}changeState(e){this.logger.log("Changing state",e),this.emit("state",[e]),this.state=e}};typeof window<"u"&&(window.SuperVizYjsProvider=Op);exports.A=B;exports.B=de;exports.Bt=wp;exports.C=Ea;exports.F=Aw;exports.Ft=bp;exports.G=ue;exports.Lt=vp;exports.Mi=bl;exports.Mt=mp;exports.N=el;exports.Nt=yp;exports.R=il;exports.Rt=gp;exports.Si=yl;exports.SuperVizYjsProvider=Op;exports.Ut=_p;exports._=X;exports.d_=Q;exports.i=Ut;exports.jt=Cp;exports.lw=tt;exports.m=Us;exports.p=tl;exports.ub=NA;exports.y=O;exports.z=Cw;
