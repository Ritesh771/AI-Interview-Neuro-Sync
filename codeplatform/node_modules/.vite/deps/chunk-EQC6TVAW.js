import {
  applyUpdateV2,
  encodeStateAsUpdateV2,
  mergeUpdatesV2
} from "./chunk-IW2W7CGS.js";

// node_modules/@superviz/react-sdk/dist/index-CtPfqlcy.js
var sw = Object.create;
var qa = Object.defineProperty;
var ow = Object.defineProperties;
var aw = Object.getOwnPropertyDescriptor;
var lw = Object.getOwnPropertyDescriptors;
var uw = Object.getOwnPropertyNames;
var Ss = Object.getOwnPropertySymbols;
var cw = Object.getPrototypeOf;
var Ka = Object.prototype.hasOwnProperty;
var Nh = Object.prototype.propertyIsEnumerable;
var YA = Math.pow;
var Jc = (e, t, i) => t in e ? qa(e, t, { enumerable: true, configurable: true, writable: true, value: i }) : e[t] = i;
var $ = (e, t) => {
  for (var i in t || (t = {})) Ka.call(t, i) && Jc(e, i, t[i]);
  if (Ss) for (var i of Ss(t)) Nh.call(t, i) && Jc(e, i, t[i]);
  return e;
};
var de = (e, t) => ow(e, lw(t));
var Hc = (e, t) => {
  var i = {};
  for (var r in e) Ka.call(e, r) && t.indexOf(r) < 0 && (i[r] = e[r]);
  if (e != null && Ss) for (var r of Ss(e)) t.indexOf(r) < 0 && Nh.call(e, r) && (i[r] = e[r]);
  return i;
};
var hw = (e, t) => () => (e && (t = e(e = 0)), t);
var We = (e, t) => () => (t || e((t = { exports: {} }).exports, t), t.exports);
var dw = (e, t, i, r) => {
  if (t && typeof t == "object" || typeof t == "function") for (let o of uw(t)) !Ka.call(e, o) && o !== i && qa(e, o, { get: () => t[o], enumerable: !(r = aw(t, o)) || r.enumerable });
  return e;
};
var zt = (e, t, i) => (i = e != null ? sw(cw(e)) : {}, dw(!e || !e.__esModule ? qa(i, "default", { value: e, enumerable: true }) : i, e));
var QA = (e, t, i, r) => {
  for (var o = t, a = e.length - 1, u; a >= 0; a--) (u = e[a]) && (o = u(o) || o);
  return o;
};
var he = (e, t, i) => new Promise((r, o) => {
  var a = (p) => {
    try {
      c(i.next(p));
    } catch (h) {
      o(h);
    }
  }, u = (p) => {
    try {
      c(i.throw(p));
    } catch (h) {
      o(h);
    }
  }, c = (p) => p.done ? r(p.value) : Promise.resolve(p.value).then(a, u);
  c((i = i.apply(e, t)).next());
});
var Ya;
var O = hw(() => {
  Ya = {};
});
O();
var Dh = ((e) => (e.MEETING_START = "meeting.start", e.MEETING_LEAVE = "meeting.leave", e.MEETING_PARTICIPANT_AMOUNT_UPDATE = "meeting.amount-of-participants-update", e.MEETING_PARTICIPANT_LIST_UPDATE = "meeting.participant-list-update", e.MEETING_PARTICIPANT_JOINED = "meeting.participant-joined", e.MEETING_PARTICIPANT_LEFT = "meeting.participant-left", e.MEETING_JOIN = "meeting.join", e.MEETING_PARTICIPANT_PROPERTIES = "meeting.participant-properties", e.MEETING_HOST_CHANGE = "meeting.host-change", e.MEETING_HOST_AVAILABLE = "meeting.host-available", e.MEETING_NO_HOST_AVAILABLE = "meeting.no-host-available", e.MEETING_SAME_PARTICIPANT_ERROR = "meeting.same-participant-error", e.MEETING_DEVICES_CHANGE = "meeting.devices-change", e.MEETING_KICK_PARTICIPANTS = "meeting.kick-all-participants", e.MEETING_STATE_UPDATE = "meeting.state-update", e.MEETING_CONNECTION_STATUS_CHANGE = "meeting.connection-status-change", e.MEETING_WAITING_FOR_HOST = "meeting.waiting-for-host", e.MY_PARTICIPANT_UPDATED = "my-participant.update", e.MY_PARTICIPANT_LEFT = "my-participant.left", e.MY_PARTICIPANT_JOINED = "my-participant.joined", e.MEETING_KICK_PARTICIPANT = "meeting.kick-participant", e.DESTROY = "destroy", e))(Dh || {});
var jh = ((e) => (e.FRAME_LOAD = "frame.load", e.FRAME_DIMENSIONS_UPDATE = "frame.dimensions-update", e.FRAME_PARENT_SIZE_UPDATE = "frame.parent-window-size-update", e.FRAME_LOCALE_UPDATE = "frame.locales-update", e.FRAME_AVATAR_LIST_UPDATE = "frame.avatar-list-update", e.FRAME_COLOR_LIST_UPDATE = "frame.color-list-update", e.FRAME_STYLES_UPDATE = "frame.styles-update", e.FRAME_CALLBACKS_UPDATE = "frame.callbacks-update", e))(jh || {});
var Bh = ((e) => (e.TOGGLE_MEETING_CHAT = "meeting-controls.toggle-chat", e.TOGGLE_MEETING_SETUP = "meeting-controls.toggle-setup", e.TOGGLE_MICROPHONE = "meeting-controls.toggle-microphone", e.TOGGLE_CAM = "meeting-controls.toggle-cam", e.TOGGLE_SCREENSHARE = "meeting-controls.toggle-screenshare", e.TOGGLE_RECORDING = "meeting-controls.toggle-recording", e.HANG_UP = "hang-up", e.CALLBACK_CALLED = "callback-called", e))(Bh || {});
var Uh = ((e) => (e.REALTIME_PARTICIPANT_LIST_UPDATE = "realtime.participant-list-update", e.REALTIME_HOST_CHANGE = "realtime.host-change", e.REALTIME_GRID_MODE_CHANGE = "realtime.grid-mode-change", e.REALTIME_WAIT_FOR_HOST = "realtime.wait-for-host", e.REALTIME_AUTHENTICATION_FAILED = "realtime.authentication-failed", e.REALTIME_GO_TO_PARTICIPANT = "realtime.go-to-participant", e.REALTIME_GATHER = "realtime.gather", e.REALTIME_FOLLOW_PARTICIPANT = "realtime.follow-participant", e.REALTIME_LOCAL_FOLLOW_PARTICIPANT = "realtime.local-follow-participant", e.REALTIME_SET_AVATAR = "realtime.set-avatar", e.REALTIME_DRAWING_CHANGE = "realtime.drawing-change", e.REALTIME_TRANSCRIPT_CHANGE = "realtime.transcript-change", e.REALTIME_PRIVATE_MODE = "realtime.private-mode", e))(Uh || {});
var $h = ((e) => (e[e.MEETING_FAILED = -1] = "MEETING_FAILED", e[e.MEETING_DISCONNECTED = 0] = "MEETING_DISCONNECTED", e[e.MEETING_INITIALIZING = 1] = "MEETING_INITIALIZING", e[e.MEETING_READY_TO_JOIN = 2] = "MEETING_READY_TO_JOIN", e[e.MEETING_CONNECTING = 3] = "MEETING_CONNECTING", e[e.MEETING_CONNECTED = 4] = "MEETING_CONNECTED", e[e.MEETING_RECONNECT = 5] = "MEETING_RECONNECT", e[e.FRAME_INITIALIZING = 6] = "FRAME_INITIALIZING", e[e.FRAME_INITIALIZED = 7] = "FRAME_INITIALIZED", e[e.FRAME_UNINITIALIZED = 8] = "FRAME_UNINITIALIZED", e))($h || {});
var zh = ((e) => (e.JOINED = "participant.joined", e.LOCAL_JOINED = "participant.local-joined", e.LEFT = "participant.left", e.LOCAL_LEFT = "participant.local-left", e.LOCAL_UPDATED = "participant.updated", e.LIST_UPDATED = "participant.list-updated", e.SAME_ACCOUNT_ERROR = "participant.same-account-error", e))(zh || {});
var Wh = ((e) => (e[e.NOT_AVAILABLE = 0] = "NOT_AVAILABLE", e[e.GOOD = 1] = "GOOD", e[e.BAD = 2] = "BAD", e[e.POOR = 3] = "POOR", e[e.DISCONNECTED = 4] = "DISCONNECTED", e[e.RECONNECTING = 5] = "RECONNECTING", e[e.LOST_CONNECTION = 6] = "LOST_CONNECTION", e))(Wh || {});
var Vh = ((e) => (e.NO_CAM = "devices.no-cam", e.NO_DEVICES = "devices.no-devices", e.DEVICES_BLOCKED = "devices.blocked", e.DEVICES_CAM_BLOCKED = "devices.cam-blocked", e.DEVICES_INITIALIZATION_ERROR = "devices.inititalization-error", e.DEVICES_UNKNOWN_ERROR = "devices.unknown-error", e.DEVICES_ALLOWED = "devices.allowed", e))(Vh || {});
var Gh = ((e) => (e.PIN_ACTIVE = "pin-mode.active", e.PIN_INACTIVE = "pin-mode.inactive", e))(Gh || {});
var Qa = ((e) => (e.MOUNT = "mount", e.UNMOUNT = "unmount", e))(Qa || {});
var Zh = ((e) => (e.START_FOLLOWING_PARTICIPANT = "who-is-online.start-following-participant", e.STOP_FOLLOWING_PARTICIPANT = "who-is-online.stop-following-participant", e.ENTER_PRIVATE_MODE = "who-is-online.enter-private-mode", e.LEAVE_PRIVATE_MODE = "who-is-online.leave-private-mode", e.GATHER_ALL = "who-is-online.gather-all", e.GO_TO_PARTICIPANT = "who-is-online.go-to-participant", e.START_FOLLOW_ME = "who-is-online.start-follow-me", e.STOP_FOLLOW_ME = "who-is-online.stop-follow-me", e))(Zh || {});
O();
var pw = ["rosybrown", "red", "saddlebrown", "coral", "orange", "brown", "goldenrod", "olivegreen", "darkolivegreen", "seagreen", "lightsea", "teal", "cadetblue", "pastelblue", "mediumslateblue", "bluedark", "navy", "rebeccapurple", "purple", "vividorchid", "darkmagenta", "deepmagenta", "fuchsia", "violetred", "pink", "vibrantpink", "paleredviolet", "carmine", "wine"];
var Jt = { turquoise: "#31E0B0", orange: "#FF5E10", blue: "#00ABF7", pink: "#FF00BB", purple: "#9C29FF", green: "#6FDD00", red: "#E30000", bluedark: "#304AFF", pinklight: "#FF89C4", purplelight: "#D597FF", greenlight: "#C6EC5C", orangelight: "#FFA115", bluelight: "#75DEFE", redlight: "#FAA291", brown: "#BB813F", yellow: "#FFEF33", olivegreen: "#93A000", lightyellow: "#FAE391", violetred: "#C03FA3", rosybrown: "#B58787", cadetblue: "#2095BB", lightsteelblue: "#ABB5FF", seagreen: "#04B45F", palegreen: "#8DE990", saddlebrown: "#964C42", pastelblue: "#77A1CC", palesilver: "#D2BABA", coral: "#DF6B6B", bisque: "#FFD9C4", goldenrod: "#DAA520", tan: "#D2BD93", darkolivegreen: "#536C27", mint: "#ADE6DF", lightsea: "#45AFAA", teal: "#036E6E", wine: "#760040", cyan: "#00FFFF", mediumslateblue: "#6674D7", navy: "#0013BB", rebeccapurple: "#663399", vividorchid: "#D429FF", darkmagenta: "#810E81", deepmagenta: "#C303C6", fuchsia: "#FA00FF", lavendermagenta: "#EE82EE", thistle: "#EEB4DD", vibrantpink: "#FF007A", cottoncandy: "#FFC0DE", paleredviolet: "#D96598", carmine: "#B50A52", gray: "#878291" };
O();
var Jh = ((e) => (e.TOP_LEFT = "top-left", e.TOP_RIGHT = "top-right", e.BOTTOM_LEFT = "bottom-left", e.BOTTOM_RIGHT = "bottom-right", e))(Jh || {});
O();
var Ca = ((e) => (e.LEFT = "left", e.RIGHT = "right", e))(Ca || {});
var Hh = ((e) => (e.TOP_LEFT = "top-left", e.TOP_RIGHT = "top-right", e.BOTTOM_LEFT = "bottom-left", e.BOTTOM_RIGHT = "bottom-right", e))(Hh || {});
O();
var qh = ((e) => (e.ADD = "add", e.SHOW = "show", e))(qh || {});
var wn = We((e, t) => {
  O(), (function() {
    var i, r = "4.17.21", o = 200, a = "Unsupported core-js use. Try https://npms.io/search?q=ponyfill.", u = "Expected a function", c = "Invalid `variable` option passed into `_.template`", p = "__lodash_hash_undefined__", h = 500, f = "__lodash_placeholder__", m = 1, y = 2, g = 4, _ = 1, E = 2, R = 1, N = 2, j = 4, B = 8, K = 16, ie = 32, we = 64, pe = 128, Se = 256, Le = 512, Oe = 30, xe = "...", tt = 800, fi = 16, pt = 1, Ee = 2, V = 3, ve = 1 / 0, oe = 9007199254740991, Ne = 17976931348623157e292, Ke = NaN, Re = 4294967295, mi = Re - 1, vi = Re >>> 1, Ri = [["ary", pe], ["bind", R], ["bindKey", N], ["curry", B], ["curryRight", K], ["flip", Le], ["partial", ie], ["partialRight", we], ["rearg", Se]], kt = "[object Arguments]", yr = "[object Array]", bp = "[object AsyncFunction]", En = "[object Boolean]", Pn = "[object Date]", wp = "[object DOMException]", br = "[object Error]", wr = "[object Function]", vl = "[object GeneratorFunction]", It = "[object Map]", An = "[object Number]", _p = "[object Null]", Xt = "[object Object]", gl = "[object Promise]", Cp = "[object Proxy]", Sn = "[object RegExp]", Mt = "[object Set]", On = "[object String]", _r = "[object Symbol]", Ep = "[object Undefined]", Tn = "[object WeakMap]", Pp = "[object WeakSet]", xn = "[object ArrayBuffer]", qi = "[object DataView]", Vs = "[object Float32Array]", Gs = "[object Float64Array]", Zs = "[object Int8Array]", Js = "[object Int16Array]", Hs = "[object Int32Array]", qs = "[object Uint8Array]", Ks = "[object Uint8ClampedArray]", Ys = "[object Uint16Array]", Qs = "[object Uint32Array]", Ap = /\b__p \+= '';/g, Sp = /\b(__p \+=) '' \+/g, Op = /(__e\(.*?\)|\b__t\)) \+\n'';/g, yl = /&(?:amp|lt|gt|quot|#39);/g, bl = /[&<>"']/g, Tp = RegExp(yl.source), xp = RegExp(bl.source), kp = /<%-([\s\S]+?)%>/g, Ip = /<%([\s\S]+?)%>/g, wl = /<%=([\s\S]+?)%>/g, Mp = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, Rp = /^\w*$/, Fp = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, Xs = /[\\^$.*+?()[\]{}|]/g, Lp = RegExp(Xs.source), eo = /^\s+/, Np = /\s/, Dp = /\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/, jp = /\{\n\/\* \[wrapped with (.+)\] \*/, Bp = /,? & /, Up = /[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g, $p = /[()=,{}\[\]\/\s]/, zp = /\\(\\)?/g, Wp = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g, _l = /\w*$/, Vp = /^[-+]0x[0-9a-f]+$/i, Gp = /^0b[01]+$/i, Zp = /^\[object .+?Constructor\]$/, Jp = /^0o[0-7]+$/i, Hp = /^(?:0|[1-9]\d*)$/, qp = /[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g, Cr = /($^)/, Kp = /['\n\r\u2028\u2029\\]/g, Er = "\\ud800-\\udfff", Yp = "\\u0300-\\u036f", Qp = "\\ufe20-\\ufe2f", Xp = "\\u20d0-\\u20ff", Cl = Yp + Qp + Xp, El = "\\u2700-\\u27bf", Pl = "a-z\\xdf-\\xf6\\xf8-\\xff", ef = "\\xac\\xb1\\xd7\\xf7", tf = "\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf", nf = "\\u2000-\\u206f", rf = " \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000", Al = "A-Z\\xc0-\\xd6\\xd8-\\xde", Sl = "\\ufe0e\\ufe0f", Ol = ef + tf + nf + rf, to = "['’]", sf = "[" + Er + "]", Tl = "[" + Ol + "]", Pr = "[" + Cl + "]", xl = "\\d+", of = "[" + El + "]", kl = "[" + Pl + "]", Il = "[^" + Er + Ol + xl + El + Pl + Al + "]", io = "\\ud83c[\\udffb-\\udfff]", af = "(?:" + Pr + "|" + io + ")", Ml = "[^" + Er + "]", no = "(?:\\ud83c[\\udde6-\\uddff]){2}", ro = "[\\ud800-\\udbff][\\udc00-\\udfff]", Ki = "[" + Al + "]", Rl = "\\u200d", Fl = "(?:" + kl + "|" + Il + ")", lf = "(?:" + Ki + "|" + Il + ")", Ll = "(?:" + to + "(?:d|ll|m|re|s|t|ve))?", Nl = "(?:" + to + "(?:D|LL|M|RE|S|T|VE))?", Dl = af + "?", jl = "[" + Sl + "]?", uf = "(?:" + Rl + "(?:" + [Ml, no, ro].join("|") + ")" + jl + Dl + ")*", cf = "\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])", hf = "\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])", Bl = jl + Dl + uf, df = "(?:" + [of, no, ro].join("|") + ")" + Bl, pf = "(?:" + [Ml + Pr + "?", Pr, no, ro, sf].join("|") + ")", ff = RegExp(to, "g"), mf = RegExp(Pr, "g"), so = RegExp(io + "(?=" + io + ")|" + pf + Bl, "g"), vf = RegExp([Ki + "?" + kl + "+" + Ll + "(?=" + [Tl, Ki, "$"].join("|") + ")", lf + "+" + Nl + "(?=" + [Tl, Ki + Fl, "$"].join("|") + ")", Ki + "?" + Fl + "+" + Ll, Ki + "+" + Nl, hf, cf, xl, df].join("|"), "g"), gf = RegExp("[" + Rl + Er + Cl + Sl + "]"), yf = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/, bf = ["Array", "Buffer", "DataView", "Date", "Error", "Float32Array", "Float64Array", "Function", "Int8Array", "Int16Array", "Int32Array", "Map", "Math", "Object", "Promise", "RegExp", "Set", "String", "Symbol", "TypeError", "Uint8Array", "Uint8ClampedArray", "Uint16Array", "Uint32Array", "WeakMap", "_", "clearTimeout", "isFinite", "parseInt", "setTimeout"], wf = -1, Ie = {};
    Ie[Vs] = Ie[Gs] = Ie[Zs] = Ie[Js] = Ie[Hs] = Ie[qs] = Ie[Ks] = Ie[Ys] = Ie[Qs] = true, Ie[kt] = Ie[yr] = Ie[xn] = Ie[En] = Ie[qi] = Ie[Pn] = Ie[br] = Ie[wr] = Ie[It] = Ie[An] = Ie[Xt] = Ie[Sn] = Ie[Mt] = Ie[On] = Ie[Tn] = false;
    var ke = {};
    ke[kt] = ke[yr] = ke[xn] = ke[qi] = ke[En] = ke[Pn] = ke[Vs] = ke[Gs] = ke[Zs] = ke[Js] = ke[Hs] = ke[It] = ke[An] = ke[Xt] = ke[Sn] = ke[Mt] = ke[On] = ke[_r] = ke[qs] = ke[Ks] = ke[Ys] = ke[Qs] = true, ke[br] = ke[wr] = ke[Tn] = false;
    var _f = { À: "A", Á: "A", Â: "A", Ã: "A", Ä: "A", Å: "A", à: "a", á: "a", â: "a", ã: "a", ä: "a", å: "a", Ç: "C", ç: "c", Ð: "D", ð: "d", È: "E", É: "E", Ê: "E", Ë: "E", è: "e", é: "e", ê: "e", ë: "e", Ì: "I", Í: "I", Î: "I", Ï: "I", ì: "i", í: "i", î: "i", ï: "i", Ñ: "N", ñ: "n", Ò: "O", Ó: "O", Ô: "O", Õ: "O", Ö: "O", Ø: "O", ò: "o", ó: "o", ô: "o", õ: "o", ö: "o", ø: "o", Ù: "U", Ú: "U", Û: "U", Ü: "U", ù: "u", ú: "u", û: "u", ü: "u", Ý: "Y", ý: "y", ÿ: "y", Æ: "Ae", æ: "ae", Þ: "Th", þ: "th", ß: "ss", Ā: "A", Ă: "A", Ą: "A", ā: "a", ă: "a", ą: "a", Ć: "C", Ĉ: "C", Ċ: "C", Č: "C", ć: "c", ĉ: "c", ċ: "c", č: "c", Ď: "D", Đ: "D", ď: "d", đ: "d", Ē: "E", Ĕ: "E", Ė: "E", Ę: "E", Ě: "E", ē: "e", ĕ: "e", ė: "e", ę: "e", ě: "e", Ĝ: "G", Ğ: "G", Ġ: "G", Ģ: "G", ĝ: "g", ğ: "g", ġ: "g", ģ: "g", Ĥ: "H", Ħ: "H", ĥ: "h", ħ: "h", Ĩ: "I", Ī: "I", Ĭ: "I", Į: "I", İ: "I", ĩ: "i", ī: "i", ĭ: "i", į: "i", ı: "i", Ĵ: "J", ĵ: "j", Ķ: "K", ķ: "k", ĸ: "k", Ĺ: "L", Ļ: "L", Ľ: "L", Ŀ: "L", Ł: "L", ĺ: "l", ļ: "l", ľ: "l", ŀ: "l", ł: "l", Ń: "N", Ņ: "N", Ň: "N", Ŋ: "N", ń: "n", ņ: "n", ň: "n", ŋ: "n", Ō: "O", Ŏ: "O", Ő: "O", ō: "o", ŏ: "o", ő: "o", Ŕ: "R", Ŗ: "R", Ř: "R", ŕ: "r", ŗ: "r", ř: "r", Ś: "S", Ŝ: "S", Ş: "S", Š: "S", ś: "s", ŝ: "s", ş: "s", š: "s", Ţ: "T", Ť: "T", Ŧ: "T", ţ: "t", ť: "t", ŧ: "t", Ũ: "U", Ū: "U", Ŭ: "U", Ů: "U", Ű: "U", Ų: "U", ũ: "u", ū: "u", ŭ: "u", ů: "u", ű: "u", ų: "u", Ŵ: "W", ŵ: "w", Ŷ: "Y", ŷ: "y", Ÿ: "Y", Ź: "Z", Ż: "Z", Ž: "Z", ź: "z", ż: "z", ž: "z", Ĳ: "IJ", ĳ: "ij", Œ: "Oe", œ: "oe", ŉ: "'n", ſ: "s" }, Cf = { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;" }, Ef = { "&amp;": "&", "&lt;": "<", "&gt;": ">", "&quot;": '"', "&#39;": "'" }, Pf = { "\\": "\\", "'": "'", "\n": "n", "\r": "r", "\u2028": "u2028", "\u2029": "u2029" }, Af = parseFloat, Sf = parseInt, Ul = typeof window == "object" && window && window.Object === Object && window, Of = typeof self == "object" && self && self.Object === Object && self, Ze = Ul || Of || Function("return this")(), oo = typeof e == "object" && e && !e.nodeType && e, Fi = oo && typeof t == "object" && t && !t.nodeType && t, $l = Fi && Fi.exports === oo, ao = $l && Ul.process, wt = function() {
      try {
        var A = Fi && Fi.require && Fi.require("util").types;
        return A || ao && ao.binding && ao.binding("util");
      } catch {
      }
    }(), zl = wt && wt.isArrayBuffer, Wl = wt && wt.isDate, Vl = wt && wt.isMap, Gl = wt && wt.isRegExp, Zl = wt && wt.isSet, Jl = wt && wt.isTypedArray;
    function ft(A, x, T) {
      switch (T.length) {
        case 0:
          return A.call(x);
        case 1:
          return A.call(x, T[0]);
        case 2:
          return A.call(x, T[0], T[1]);
        case 3:
          return A.call(x, T[0], T[1], T[2]);
      }
      return A.apply(x, T);
    }
    function Tf(A, x, T, W) {
      for (var ne = -1, _e = A == null ? 0 : A.length; ++ne < _e; ) {
        var Ve = A[ne];
        x(W, Ve, T(Ve), A);
      }
      return W;
    }
    function _t(A, x) {
      for (var T = -1, W = A == null ? 0 : A.length; ++T < W && x(A[T], T, A) !== false; ) ;
      return A;
    }
    function xf(A, x) {
      for (var T = A == null ? 0 : A.length; T-- && x(A[T], T, A) !== false; ) ;
      return A;
    }
    function Hl(A, x) {
      for (var T = -1, W = A == null ? 0 : A.length; ++T < W; ) if (!x(A[T], T, A)) return false;
      return true;
    }
    function gi(A, x) {
      for (var T = -1, W = A == null ? 0 : A.length, ne = 0, _e = []; ++T < W; ) {
        var Ve = A[T];
        x(Ve, T, A) && (_e[ne++] = Ve);
      }
      return _e;
    }
    function Ar(A, x) {
      var T = A == null ? 0 : A.length;
      return !!T && Yi(A, x, 0) > -1;
    }
    function lo(A, x, T) {
      for (var W = -1, ne = A == null ? 0 : A.length; ++W < ne; ) if (T(x, A[W])) return true;
      return false;
    }
    function Fe(A, x) {
      for (var T = -1, W = A == null ? 0 : A.length, ne = Array(W); ++T < W; ) ne[T] = x(A[T], T, A);
      return ne;
    }
    function yi(A, x) {
      for (var T = -1, W = x.length, ne = A.length; ++T < W; ) A[ne + T] = x[T];
      return A;
    }
    function uo(A, x, T, W) {
      var ne = -1, _e = A == null ? 0 : A.length;
      for (W && _e && (T = A[++ne]); ++ne < _e; ) T = x(T, A[ne], ne, A);
      return T;
    }
    function kf(A, x, T, W) {
      var ne = A == null ? 0 : A.length;
      for (W && ne && (T = A[--ne]); ne--; ) T = x(T, A[ne], ne, A);
      return T;
    }
    function co(A, x) {
      for (var T = -1, W = A == null ? 0 : A.length; ++T < W; ) if (x(A[T], T, A)) return true;
      return false;
    }
    var If = ho("length");
    function Mf(A) {
      return A.split("");
    }
    function Rf(A) {
      return A.match(Up) || [];
    }
    function ql(A, x, T) {
      var W;
      return T(A, function(ne, _e, Ve) {
        if (x(ne, _e, Ve)) return W = _e, false;
      }), W;
    }
    function Sr(A, x, T, W) {
      for (var ne = A.length, _e = T + (W ? 1 : -1); W ? _e-- : ++_e < ne; ) if (x(A[_e], _e, A)) return _e;
      return -1;
    }
    function Yi(A, x, T) {
      return x === x ? Gf(A, x, T) : Sr(A, Kl, T);
    }
    function Ff(A, x, T, W) {
      for (var ne = T - 1, _e = A.length; ++ne < _e; ) if (W(A[ne], x)) return ne;
      return -1;
    }
    function Kl(A) {
      return A !== A;
    }
    function Yl(A, x) {
      var T = A == null ? 0 : A.length;
      return T ? fo(A, x) / T : Ke;
    }
    function ho(A) {
      return function(x) {
        return x == null ? i : x[A];
      };
    }
    function po(A) {
      return function(x) {
        return A == null ? i : A[x];
      };
    }
    function Ql(A, x, T, W, ne) {
      return ne(A, function(_e, Ve, Te) {
        T = W ? (W = false, _e) : x(T, _e, Ve, Te);
      }), T;
    }
    function Lf(A, x) {
      var T = A.length;
      for (A.sort(x); T--; ) A[T] = A[T].value;
      return A;
    }
    function fo(A, x) {
      for (var T, W = -1, ne = A.length; ++W < ne; ) {
        var _e = x(A[W]);
        _e !== i && (T = T === i ? _e : T + _e);
      }
      return T;
    }
    function mo(A, x) {
      for (var T = -1, W = Array(A); ++T < A; ) W[T] = x(T);
      return W;
    }
    function Nf(A, x) {
      return Fe(x, function(T) {
        return [T, A[T]];
      });
    }
    function Xl(A) {
      return A && A.slice(0, nu(A) + 1).replace(eo, "");
    }
    function mt(A) {
      return function(x) {
        return A(x);
      };
    }
    function vo(A, x) {
      return Fe(x, function(T) {
        return A[T];
      });
    }
    function kn(A, x) {
      return A.has(x);
    }
    function eu(A, x) {
      for (var T = -1, W = A.length; ++T < W && Yi(x, A[T], 0) > -1; ) ;
      return T;
    }
    function tu(A, x) {
      for (var T = A.length; T-- && Yi(x, A[T], 0) > -1; ) ;
      return T;
    }
    function Df(A, x) {
      for (var T = A.length, W = 0; T--; ) A[T] === x && ++W;
      return W;
    }
    var jf = po(_f), Bf = po(Cf);
    function Uf(A) {
      return "\\" + Pf[A];
    }
    function $f(A, x) {
      return A == null ? i : A[x];
    }
    function Qi(A) {
      return gf.test(A);
    }
    function zf(A) {
      return yf.test(A);
    }
    function Wf(A) {
      for (var x, T = []; !(x = A.next()).done; ) T.push(x.value);
      return T;
    }
    function go(A) {
      var x = -1, T = Array(A.size);
      return A.forEach(function(W, ne) {
        T[++x] = [ne, W];
      }), T;
    }
    function iu(A, x) {
      return function(T) {
        return A(x(T));
      };
    }
    function bi(A, x) {
      for (var T = -1, W = A.length, ne = 0, _e = []; ++T < W; ) {
        var Ve = A[T];
        (Ve === x || Ve === f) && (A[T] = f, _e[ne++] = T);
      }
      return _e;
    }
    function Or(A) {
      var x = -1, T = Array(A.size);
      return A.forEach(function(W) {
        T[++x] = W;
      }), T;
    }
    function Vf(A) {
      var x = -1, T = Array(A.size);
      return A.forEach(function(W) {
        T[++x] = [W, W];
      }), T;
    }
    function Gf(A, x, T) {
      for (var W = T - 1, ne = A.length; ++W < ne; ) if (A[W] === x) return W;
      return -1;
    }
    function Zf(A, x, T) {
      for (var W = T + 1; W--; ) if (A[W] === x) return W;
      return W;
    }
    function Xi(A) {
      return Qi(A) ? Hf(A) : If(A);
    }
    function Rt(A) {
      return Qi(A) ? qf(A) : Mf(A);
    }
    function nu(A) {
      for (var x = A.length; x-- && Np.test(A.charAt(x)); ) ;
      return x;
    }
    var Jf = po(Ef);
    function Hf(A) {
      for (var x = so.lastIndex = 0; so.test(A); ) ++x;
      return x;
    }
    function qf(A) {
      return A.match(so) || [];
    }
    function Kf(A) {
      return A.match(vf) || [];
    }
    var Yf = function A(x) {
      x = x == null ? Ze : wi.defaults(Ze.Object(), x, wi.pick(Ze, bf));
      var T = x.Array, W = x.Date, ne = x.Error, _e = x.Function, Ve = x.Math, Te = x.Object, yo = x.RegExp, Qf = x.String, Ct = x.TypeError, Tr = T.prototype, Xf = _e.prototype, en = Te.prototype, xr = x["__core-js_shared__"], kr = Xf.toString, Pe = en.hasOwnProperty, em = 0, ru = function() {
        var n = /[^.]+$/.exec(xr && xr.keys && xr.keys.IE_PROTO || "");
        return n ? "Symbol(src)_1." + n : "";
      }(), Ir = en.toString, tm = kr.call(Te), im = Ze._, nm = yo("^" + kr.call(Pe).replace(Xs, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"), Mr = $l ? x.Buffer : i, _i = x.Symbol, Rr = x.Uint8Array, su = Mr ? Mr.allocUnsafe : i, Fr = iu(Te.getPrototypeOf, Te), ou = Te.create, au = en.propertyIsEnumerable, Lr = Tr.splice, lu = _i ? _i.isConcatSpreadable : i, In = _i ? _i.iterator : i, Li = _i ? _i.toStringTag : i, Nr = function() {
        try {
          var n = Ui(Te, "defineProperty");
          return n({}, "", {}), n;
        } catch {
        }
      }(), rm = x.clearTimeout !== Ze.clearTimeout && x.clearTimeout, sm = W && W.now !== Ze.Date.now && W.now, om = x.setTimeout !== Ze.setTimeout && x.setTimeout, Dr = Ve.ceil, jr = Ve.floor, bo = Te.getOwnPropertySymbols, am = Mr ? Mr.isBuffer : i, uu = x.isFinite, lm = Tr.join, um = iu(Te.keys, Te), Ge = Ve.max, Xe = Ve.min, cm = W.now, hm = x.parseInt, cu = Ve.random, dm = Tr.reverse, wo = Ui(x, "DataView"), Mn = Ui(x, "Map"), _o = Ui(x, "Promise"), tn = Ui(x, "Set"), Rn = Ui(x, "WeakMap"), Fn = Ui(Te, "create"), Br = Rn && new Rn(), nn = {}, pm = $i(wo), fm = $i(Mn), mm = $i(_o), vm = $i(tn), gm = $i(Rn), Ur = _i ? _i.prototype : i, Ln = Ur ? Ur.valueOf : i, hu = Ur ? Ur.toString : i;
      function b(n) {
        if (je(n) && !re(n) && !(n instanceof me)) {
          if (n instanceof Et) return n;
          if (Pe.call(n, "__wrapped__")) return dc(n);
        }
        return new Et(n);
      }
      var rn = /* @__PURE__ */ function() {
        function n() {
        }
        return function(s) {
          if (!De(s)) return {};
          if (ou) return ou(s);
          n.prototype = s;
          var l = new n();
          return n.prototype = i, l;
        };
      }();
      function $r() {
      }
      function Et(n, s) {
        this.__wrapped__ = n, this.__actions__ = [], this.__chain__ = !!s, this.__index__ = 0, this.__values__ = i;
      }
      b.templateSettings = { escape: kp, evaluate: Ip, interpolate: wl, variable: "", imports: { _: b } }, b.prototype = $r.prototype, b.prototype.constructor = b, Et.prototype = rn($r.prototype), Et.prototype.constructor = Et;
      function me(n) {
        this.__wrapped__ = n, this.__actions__ = [], this.__dir__ = 1, this.__filtered__ = false, this.__iteratees__ = [], this.__takeCount__ = Re, this.__views__ = [];
      }
      function ym() {
        var n = new me(this.__wrapped__);
        return n.__actions__ = at(this.__actions__), n.__dir__ = this.__dir__, n.__filtered__ = this.__filtered__, n.__iteratees__ = at(this.__iteratees__), n.__takeCount__ = this.__takeCount__, n.__views__ = at(this.__views__), n;
      }
      function bm() {
        if (this.__filtered__) {
          var n = new me(this);
          n.__dir__ = -1, n.__filtered__ = true;
        } else n = this.clone(), n.__dir__ *= -1;
        return n;
      }
      function wm() {
        var n = this.__wrapped__.value(), s = this.__dir__, l = re(n), d = s < 0, v = l ? n.length : 0, w = Mv(0, v, this.__views__), C = w.start, P = w.end, S = P - C, I = d ? P : C - 1, M = this.__iteratees__, F = M.length, D = 0, G = Xe(S, this.__takeCount__);
        if (!l || !d && v == S && G == S) return Lu(n, this.__actions__);
        var H = [];
        e: for (; S-- && D < G; ) {
          I += s;
          for (var le = -1, q = n[I]; ++le < F; ) {
            var fe = M[le], ge = fe.iteratee, yt = fe.type, rt = ge(q);
            if (yt == Ee) q = rt;
            else if (!rt) {
              if (yt == pt) continue e;
              break e;
            }
          }
          H[D++] = q;
        }
        return H;
      }
      me.prototype = rn($r.prototype), me.prototype.constructor = me;
      function Ni(n) {
        var s = -1, l = n == null ? 0 : n.length;
        for (this.clear(); ++s < l; ) {
          var d = n[s];
          this.set(d[0], d[1]);
        }
      }
      function _m() {
        this.__data__ = Fn ? Fn(null) : {}, this.size = 0;
      }
      function Cm(n) {
        var s = this.has(n) && delete this.__data__[n];
        return this.size -= s ? 1 : 0, s;
      }
      function Em(n) {
        var s = this.__data__;
        if (Fn) {
          var l = s[n];
          return l === p ? i : l;
        }
        return Pe.call(s, n) ? s[n] : i;
      }
      function Pm(n) {
        var s = this.__data__;
        return Fn ? s[n] !== i : Pe.call(s, n);
      }
      function Am(n, s) {
        var l = this.__data__;
        return this.size += this.has(n) ? 0 : 1, l[n] = Fn && s === i ? p : s, this;
      }
      Ni.prototype.clear = _m, Ni.prototype.delete = Cm, Ni.prototype.get = Em, Ni.prototype.has = Pm, Ni.prototype.set = Am;
      function ei(n) {
        var s = -1, l = n == null ? 0 : n.length;
        for (this.clear(); ++s < l; ) {
          var d = n[s];
          this.set(d[0], d[1]);
        }
      }
      function Sm() {
        this.__data__ = [], this.size = 0;
      }
      function Om(n) {
        var s = this.__data__, l = zr(s, n);
        if (l < 0) return false;
        var d = s.length - 1;
        return l == d ? s.pop() : Lr.call(s, l, 1), --this.size, true;
      }
      function Tm(n) {
        var s = this.__data__, l = zr(s, n);
        return l < 0 ? i : s[l][1];
      }
      function xm(n) {
        return zr(this.__data__, n) > -1;
      }
      function km(n, s) {
        var l = this.__data__, d = zr(l, n);
        return d < 0 ? (++this.size, l.push([n, s])) : l[d][1] = s, this;
      }
      ei.prototype.clear = Sm, ei.prototype.delete = Om, ei.prototype.get = Tm, ei.prototype.has = xm, ei.prototype.set = km;
      function ti(n) {
        var s = -1, l = n == null ? 0 : n.length;
        for (this.clear(); ++s < l; ) {
          var d = n[s];
          this.set(d[0], d[1]);
        }
      }
      function Im() {
        this.size = 0, this.__data__ = { hash: new Ni(), map: new (Mn || ei)(), string: new Ni() };
      }
      function Mm(n) {
        var s = es(this, n).delete(n);
        return this.size -= s ? 1 : 0, s;
      }
      function Rm(n) {
        return es(this, n).get(n);
      }
      function Fm(n) {
        return es(this, n).has(n);
      }
      function Lm(n, s) {
        var l = es(this, n), d = l.size;
        return l.set(n, s), this.size += l.size == d ? 0 : 1, this;
      }
      ti.prototype.clear = Im, ti.prototype.delete = Mm, ti.prototype.get = Rm, ti.prototype.has = Fm, ti.prototype.set = Lm;
      function Di(n) {
        var s = -1, l = n == null ? 0 : n.length;
        for (this.__data__ = new ti(); ++s < l; ) this.add(n[s]);
      }
      function Nm(n) {
        return this.__data__.set(n, p), this;
      }
      function Dm(n) {
        return this.__data__.has(n);
      }
      Di.prototype.add = Di.prototype.push = Nm, Di.prototype.has = Dm;
      function Ft(n) {
        var s = this.__data__ = new ei(n);
        this.size = s.size;
      }
      function jm() {
        this.__data__ = new ei(), this.size = 0;
      }
      function Bm(n) {
        var s = this.__data__, l = s.delete(n);
        return this.size = s.size, l;
      }
      function Um(n) {
        return this.__data__.get(n);
      }
      function $m(n) {
        return this.__data__.has(n);
      }
      function zm(n, s) {
        var l = this.__data__;
        if (l instanceof ei) {
          var d = l.__data__;
          if (!Mn || d.length < o - 1) return d.push([n, s]), this.size = ++l.size, this;
          l = this.__data__ = new ti(d);
        }
        return l.set(n, s), this.size = l.size, this;
      }
      Ft.prototype.clear = jm, Ft.prototype.delete = Bm, Ft.prototype.get = Um, Ft.prototype.has = $m, Ft.prototype.set = zm;
      function du(n, s) {
        var l = re(n), d = !l && zi(n), v = !l && !d && Si(n), w = !l && !d && !v && ln(n), C = l || d || v || w, P = C ? mo(n.length, Qf) : [], S = P.length;
        for (var I in n) (s || Pe.call(n, I)) && !(C && (I == "length" || v && (I == "offset" || I == "parent") || w && (I == "buffer" || I == "byteLength" || I == "byteOffset") || si(I, S))) && P.push(I);
        return P;
      }
      function pu(n) {
        var s = n.length;
        return s ? n[Mo(0, s - 1)] : i;
      }
      function Wm(n, s) {
        return ts(at(n), ji(s, 0, n.length));
      }
      function Vm(n) {
        return ts(at(n));
      }
      function Co(n, s, l) {
        (l !== i && !Lt(n[s], l) || l === i && !(s in n)) && ii(n, s, l);
      }
      function Nn(n, s, l) {
        var d = n[s];
        (!(Pe.call(n, s) && Lt(d, l)) || l === i && !(s in n)) && ii(n, s, l);
      }
      function zr(n, s) {
        for (var l = n.length; l--; ) if (Lt(n[l][0], s)) return l;
        return -1;
      }
      function Gm(n, s, l, d) {
        return Ci(n, function(v, w, C) {
          s(d, v, l(v), C);
        }), d;
      }
      function fu(n, s) {
        return n && Vt(s, Je(s), n);
      }
      function Zm(n, s) {
        return n && Vt(s, ut(s), n);
      }
      function ii(n, s, l) {
        s == "__proto__" && Nr ? Nr(n, s, { configurable: true, enumerable: true, value: l, writable: true }) : n[s] = l;
      }
      function Eo(n, s) {
        for (var l = -1, d = s.length, v = T(d), w = n == null; ++l < d; ) v[l] = w ? i : na(n, s[l]);
        return v;
      }
      function ji(n, s, l) {
        return n === n && (l !== i && (n = n <= l ? n : l), s !== i && (n = n >= s ? n : s)), n;
      }
      function Pt(n, s, l, d, v, w) {
        var C, P = s & m, S = s & y, I = s & g;
        if (l && (C = v ? l(n, d, v, w) : l(n)), C !== i) return C;
        if (!De(n)) return n;
        var M = re(n);
        if (M) {
          if (C = Fv(n), !P) return at(n, C);
        } else {
          var F = et(n), D = F == wr || F == vl;
          if (Si(n)) return ju(n, P);
          if (F == Xt || F == kt || D && !v) {
            if (C = S || D ? {} : nc(n), !P) return S ? Ev(n, Zm(C, n)) : Cv(n, fu(C, n));
          } else {
            if (!ke[F]) return v ? n : {};
            C = Lv(n, F, P);
          }
        }
        w || (w = new Ft());
        var G = w.get(n);
        if (G) return G;
        w.set(n, C), Mc(n) ? n.forEach(function(q) {
          C.add(Pt(q, s, l, q, n, w));
        }) : kc(n) && n.forEach(function(q, fe) {
          C.set(fe, Pt(q, s, l, fe, n, w));
        });
        var H = I ? S ? Wo : zo : S ? ut : Je, le = M ? i : H(n);
        return _t(le || n, function(q, fe) {
          le && (fe = q, q = n[fe]), Nn(C, fe, Pt(q, s, l, fe, n, w));
        }), C;
      }
      function Jm(n) {
        var s = Je(n);
        return function(l) {
          return mu(l, n, s);
        };
      }
      function mu(n, s, l) {
        var d = l.length;
        if (n == null) return !d;
        for (n = Te(n); d--; ) {
          var v = l[d], w = s[v], C = n[v];
          if (C === i && !(v in n) || !w(C)) return false;
        }
        return true;
      }
      function vu(n, s, l) {
        if (typeof n != "function") throw new Ct(u);
        return Wn(function() {
          n.apply(i, l);
        }, s);
      }
      function Dn(n, s, l, d) {
        var v = -1, w = Ar, C = true, P = n.length, S = [], I = s.length;
        if (!P) return S;
        l && (s = Fe(s, mt(l))), d ? (w = lo, C = false) : s.length >= o && (w = kn, C = false, s = new Di(s));
        e: for (; ++v < P; ) {
          var M = n[v], F = l == null ? M : l(M);
          if (M = d || M !== 0 ? M : 0, C && F === F) {
            for (var D = I; D--; ) if (s[D] === F) continue e;
            S.push(M);
          } else w(s, F, d) || S.push(M);
        }
        return S;
      }
      var Ci = Wu(Wt), gu = Wu(Ao, true);
      function Hm(n, s) {
        var l = true;
        return Ci(n, function(d, v, w) {
          return l = !!s(d, v, w), l;
        }), l;
      }
      function Wr(n, s, l) {
        for (var d = -1, v = n.length; ++d < v; ) {
          var w = n[d], C = s(w);
          if (C != null && (P === i ? C === C && !gt(C) : l(C, P))) var P = C, S = w;
        }
        return S;
      }
      function qm(n, s, l, d) {
        var v = n.length;
        for (l = ae(l), l < 0 && (l = -l > v ? 0 : v + l), d = d === i || d > v ? v : ae(d), d < 0 && (d += v), d = l > d ? 0 : Fc(d); l < d; ) n[l++] = s;
        return n;
      }
      function yu(n, s) {
        var l = [];
        return Ci(n, function(d, v, w) {
          s(d, v, w) && l.push(d);
        }), l;
      }
      function Ye(n, s, l, d, v) {
        var w = -1, C = n.length;
        for (l || (l = Dv), v || (v = []); ++w < C; ) {
          var P = n[w];
          s > 0 && l(P) ? s > 1 ? Ye(P, s - 1, l, d, v) : yi(v, P) : d || (v[v.length] = P);
        }
        return v;
      }
      var Po = Vu(), bu = Vu(true);
      function Wt(n, s) {
        return n && Po(n, s, Je);
      }
      function Ao(n, s) {
        return n && bu(n, s, Je);
      }
      function Vr(n, s) {
        return gi(s, function(l) {
          return oi(n[l]);
        });
      }
      function Bi(n, s) {
        s = Pi(s, n);
        for (var l = 0, d = s.length; n != null && l < d; ) n = n[Gt(s[l++])];
        return l && l == d ? n : i;
      }
      function wu(n, s, l) {
        var d = s(n);
        return re(n) ? d : yi(d, l(n));
      }
      function it(n) {
        return n == null ? n === i ? Ep : _p : Li && Li in Te(n) ? Iv(n) : Vv(n);
      }
      function So(n, s) {
        return n > s;
      }
      function Km(n, s) {
        return n != null && Pe.call(n, s);
      }
      function Ym(n, s) {
        return n != null && s in Te(n);
      }
      function Qm(n, s, l) {
        return n >= Xe(s, l) && n < Ge(s, l);
      }
      function Oo(n, s, l) {
        for (var d = l ? lo : Ar, v = n[0].length, w = n.length, C = w, P = T(w), S = 1 / 0, I = []; C--; ) {
          var M = n[C];
          C && s && (M = Fe(M, mt(s))), S = Xe(M.length, S), P[C] = !l && (s || v >= 120 && M.length >= 120) ? new Di(C && M) : i;
        }
        M = n[0];
        var F = -1, D = P[0];
        e: for (; ++F < v && I.length < S; ) {
          var G = M[F], H = s ? s(G) : G;
          if (G = l || G !== 0 ? G : 0, !(D ? kn(D, H) : d(I, H, l))) {
            for (C = w; --C; ) {
              var le = P[C];
              if (!(le ? kn(le, H) : d(n[C], H, l))) continue e;
            }
            D && D.push(H), I.push(G);
          }
        }
        return I;
      }
      function Xm(n, s, l, d) {
        return Wt(n, function(v, w, C) {
          s(d, l(v), w, C);
        }), d;
      }
      function jn(n, s, l) {
        s = Pi(s, n), n = ac(n, s);
        var d = n == null ? n : n[Gt(St(s))];
        return d == null ? i : ft(d, n, l);
      }
      function _u(n) {
        return je(n) && it(n) == kt;
      }
      function ev(n) {
        return je(n) && it(n) == xn;
      }
      function tv(n) {
        return je(n) && it(n) == Pn;
      }
      function Bn(n, s, l, d, v) {
        return n === s ? true : n == null || s == null || !je(n) && !je(s) ? n !== n && s !== s : iv(n, s, l, d, Bn, v);
      }
      function iv(n, s, l, d, v, w) {
        var C = re(n), P = re(s), S = C ? yr : et(n), I = P ? yr : et(s);
        S = S == kt ? Xt : S, I = I == kt ? Xt : I;
        var M = S == Xt, F = I == Xt, D = S == I;
        if (D && Si(n)) {
          if (!Si(s)) return false;
          C = true, M = false;
        }
        if (D && !M) return w || (w = new Ft()), C || ln(n) ? ec(n, s, l, d, v, w) : xv(n, s, S, l, d, v, w);
        if (!(l & _)) {
          var G = M && Pe.call(n, "__wrapped__"), H = F && Pe.call(s, "__wrapped__");
          if (G || H) {
            var le = G ? n.value() : n, q = H ? s.value() : s;
            return w || (w = new Ft()), v(le, q, l, d, w);
          }
        }
        return D ? (w || (w = new Ft()), kv(n, s, l, d, v, w)) : false;
      }
      function nv(n) {
        return je(n) && et(n) == It;
      }
      function To(n, s, l, d) {
        var v = l.length, w = v, C = !d;
        if (n == null) return !w;
        for (n = Te(n); v--; ) {
          var P = l[v];
          if (C && P[2] ? P[1] !== n[P[0]] : !(P[0] in n)) return false;
        }
        for (; ++v < w; ) {
          P = l[v];
          var S = P[0], I = n[S], M = P[1];
          if (C && P[2]) {
            if (I === i && !(S in n)) return false;
          } else {
            var F = new Ft();
            if (d) var D = d(I, M, S, n, s, F);
            if (!(D === i ? Bn(M, I, _ | E, d, F) : D)) return false;
          }
        }
        return true;
      }
      function Cu(n) {
        if (!De(n) || Bv(n)) return false;
        var s = oi(n) ? nm : Zp;
        return s.test($i(n));
      }
      function rv(n) {
        return je(n) && it(n) == Sn;
      }
      function sv(n) {
        return je(n) && et(n) == Mt;
      }
      function ov(n) {
        return je(n) && as(n.length) && !!Ie[it(n)];
      }
      function Eu(n) {
        return typeof n == "function" ? n : n == null ? ct : typeof n == "object" ? re(n) ? Su(n[0], n[1]) : Au(n) : Gc(n);
      }
      function xo(n) {
        if (!zn(n)) return um(n);
        var s = [];
        for (var l in Te(n)) Pe.call(n, l) && l != "constructor" && s.push(l);
        return s;
      }
      function av(n) {
        if (!De(n)) return Wv(n);
        var s = zn(n), l = [];
        for (var d in n) d == "constructor" && (s || !Pe.call(n, d)) || l.push(d);
        return l;
      }
      function ko(n, s) {
        return n < s;
      }
      function Pu(n, s) {
        var l = -1, d = lt(n) ? T(n.length) : [];
        return Ci(n, function(v, w, C) {
          d[++l] = s(v, w, C);
        }), d;
      }
      function Au(n) {
        var s = Go(n);
        return s.length == 1 && s[0][2] ? sc(s[0][0], s[0][1]) : function(l) {
          return l === n || To(l, n, s);
        };
      }
      function Su(n, s) {
        return Jo(n) && rc(s) ? sc(Gt(n), s) : function(l) {
          var d = na(l, n);
          return d === i && d === s ? ra(l, n) : Bn(s, d, _ | E);
        };
      }
      function Gr(n, s, l, d, v) {
        n !== s && Po(s, function(w, C) {
          if (v || (v = new Ft()), De(w)) lv(n, s, C, l, Gr, d, v);
          else {
            var P = d ? d(qo(n, C), w, C + "", n, s, v) : i;
            P === i && (P = w), Co(n, C, P);
          }
        }, ut);
      }
      function lv(n, s, l, d, v, w, C) {
        var P = qo(n, l), S = qo(s, l), I = C.get(S);
        if (I) {
          Co(n, l, I);
          return;
        }
        var M = w ? w(P, S, l + "", n, s, C) : i, F = M === i;
        if (F) {
          var D = re(S), G = !D && Si(S), H = !D && !G && ln(S);
          M = S, D || G || H ? re(P) ? M = P : Be(P) ? M = at(P) : G ? (F = false, M = ju(S, true)) : H ? (F = false, M = Bu(S, true)) : M = [] : Vn(S) || zi(S) ? (M = P, zi(P) ? M = Lc(P) : (!De(P) || oi(P)) && (M = nc(S))) : F = false;
        }
        F && (C.set(S, M), v(M, S, d, w, C), C.delete(S)), Co(n, l, M);
      }
      function Ou(n, s) {
        var l = n.length;
        if (l) return s += s < 0 ? l : 0, si(s, l) ? n[s] : i;
      }
      function Tu(n, s, l) {
        s.length ? s = Fe(s, function(w) {
          return re(w) ? function(C) {
            return Bi(C, w.length === 1 ? w[0] : w);
          } : w;
        }) : s = [ct];
        var d = -1;
        s = Fe(s, mt(J()));
        var v = Pu(n, function(w, C, P) {
          var S = Fe(s, function(I) {
            return I(w);
          });
          return { criteria: S, index: ++d, value: w };
        });
        return Lf(v, function(w, C) {
          return _v(w, C, l);
        });
      }
      function uv(n, s) {
        return xu(n, s, function(l, d) {
          return ra(n, d);
        });
      }
      function xu(n, s, l) {
        for (var d = -1, v = s.length, w = {}; ++d < v; ) {
          var C = s[d], P = Bi(n, C);
          l(P, C) && Un(w, Pi(C, n), P);
        }
        return w;
      }
      function cv(n) {
        return function(s) {
          return Bi(s, n);
        };
      }
      function Io(n, s, l, d) {
        var v = d ? Ff : Yi, w = -1, C = s.length, P = n;
        for (n === s && (s = at(s)), l && (P = Fe(n, mt(l))); ++w < C; ) for (var S = 0, I = s[w], M = l ? l(I) : I; (S = v(P, M, S, d)) > -1; ) P !== n && Lr.call(P, S, 1), Lr.call(n, S, 1);
        return n;
      }
      function ku(n, s) {
        for (var l = n ? s.length : 0, d = l - 1; l--; ) {
          var v = s[l];
          if (l == d || v !== w) {
            var w = v;
            si(v) ? Lr.call(n, v, 1) : Lo(n, v);
          }
        }
        return n;
      }
      function Mo(n, s) {
        return n + jr(cu() * (s - n + 1));
      }
      function hv(n, s, l, d) {
        for (var v = -1, w = Ge(Dr((s - n) / (l || 1)), 0), C = T(w); w--; ) C[d ? w : ++v] = n, n += l;
        return C;
      }
      function Ro(n, s) {
        var l = "";
        if (!n || s < 1 || s > oe) return l;
        do
          s % 2 && (l += n), s = jr(s / 2), s && (n += n);
        while (s);
        return l;
      }
      function ce(n, s) {
        return Ko(oc(n, s, ct), n + "");
      }
      function dv(n) {
        return pu(un(n));
      }
      function pv(n, s) {
        var l = un(n);
        return ts(l, ji(s, 0, l.length));
      }
      function Un(n, s, l, d) {
        if (!De(n)) return n;
        s = Pi(s, n);
        for (var v = -1, w = s.length, C = w - 1, P = n; P != null && ++v < w; ) {
          var S = Gt(s[v]), I = l;
          if (S === "__proto__" || S === "constructor" || S === "prototype") return n;
          if (v != C) {
            var M = P[S];
            I = d ? d(M, S, P) : i, I === i && (I = De(M) ? M : si(s[v + 1]) ? [] : {});
          }
          Nn(P, S, I), P = P[S];
        }
        return n;
      }
      var Iu = Br ? function(n, s) {
        return Br.set(n, s), n;
      } : ct, fv = Nr ? function(n, s) {
        return Nr(n, "toString", { configurable: true, enumerable: false, value: oa(s), writable: true });
      } : ct;
      function mv(n) {
        return ts(un(n));
      }
      function At(n, s, l) {
        var d = -1, v = n.length;
        s < 0 && (s = -s > v ? 0 : v + s), l = l > v ? v : l, l < 0 && (l += v), v = s > l ? 0 : l - s >>> 0, s >>>= 0;
        for (var w = T(v); ++d < v; ) w[d] = n[d + s];
        return w;
      }
      function vv(n, s) {
        var l;
        return Ci(n, function(d, v, w) {
          return l = s(d, v, w), !l;
        }), !!l;
      }
      function Zr(n, s, l) {
        var d = 0, v = n == null ? d : n.length;
        if (typeof s == "number" && s === s && v <= vi) {
          for (; d < v; ) {
            var w = d + v >>> 1, C = n[w];
            C !== null && !gt(C) && (l ? C <= s : C < s) ? d = w + 1 : v = w;
          }
          return v;
        }
        return Fo(n, s, ct, l);
      }
      function Fo(n, s, l, d) {
        var v = 0, w = n == null ? 0 : n.length;
        if (w === 0) return 0;
        s = l(s);
        for (var C = s !== s, P = s === null, S = gt(s), I = s === i; v < w; ) {
          var M = jr((v + w) / 2), F = l(n[M]), D = F !== i, G = F === null, H = F === F, le = gt(F);
          if (C) var q = d || H;
          else I ? q = H && (d || D) : P ? q = H && D && (d || !G) : S ? q = H && D && !G && (d || !le) : G || le ? q = false : q = d ? F <= s : F < s;
          q ? v = M + 1 : w = M;
        }
        return Xe(w, mi);
      }
      function Mu(n, s) {
        for (var l = -1, d = n.length, v = 0, w = []; ++l < d; ) {
          var C = n[l], P = s ? s(C) : C;
          if (!l || !Lt(P, S)) {
            var S = P;
            w[v++] = C === 0 ? 0 : C;
          }
        }
        return w;
      }
      function Ru(n) {
        return typeof n == "number" ? n : gt(n) ? Ke : +n;
      }
      function vt(n) {
        if (typeof n == "string") return n;
        if (re(n)) return Fe(n, vt) + "";
        if (gt(n)) return hu ? hu.call(n) : "";
        var s = n + "";
        return s == "0" && 1 / n == -ve ? "-0" : s;
      }
      function Ei(n, s, l) {
        var d = -1, v = Ar, w = n.length, C = true, P = [], S = P;
        if (l) C = false, v = lo;
        else if (w >= o) {
          var I = s ? null : Ov(n);
          if (I) return Or(I);
          C = false, v = kn, S = new Di();
        } else S = s ? [] : P;
        e: for (; ++d < w; ) {
          var M = n[d], F = s ? s(M) : M;
          if (M = l || M !== 0 ? M : 0, C && F === F) {
            for (var D = S.length; D--; ) if (S[D] === F) continue e;
            s && S.push(F), P.push(M);
          } else v(S, F, l) || (S !== P && S.push(F), P.push(M));
        }
        return P;
      }
      function Lo(n, s) {
        return s = Pi(s, n), n = ac(n, s), n == null || delete n[Gt(St(s))];
      }
      function Fu(n, s, l, d) {
        return Un(n, s, l(Bi(n, s)), d);
      }
      function Jr(n, s, l, d) {
        for (var v = n.length, w = d ? v : -1; (d ? w-- : ++w < v) && s(n[w], w, n); ) ;
        return l ? At(n, d ? 0 : w, d ? w + 1 : v) : At(n, d ? w + 1 : 0, d ? v : w);
      }
      function Lu(n, s) {
        var l = n;
        return l instanceof me && (l = l.value()), uo(s, function(d, v) {
          return v.func.apply(v.thisArg, yi([d], v.args));
        }, l);
      }
      function No(n, s, l) {
        var d = n.length;
        if (d < 2) return d ? Ei(n[0]) : [];
        for (var v = -1, w = T(d); ++v < d; ) for (var C = n[v], P = -1; ++P < d; ) P != v && (w[v] = Dn(w[v] || C, n[P], s, l));
        return Ei(Ye(w, 1), s, l);
      }
      function Nu(n, s, l) {
        for (var d = -1, v = n.length, w = s.length, C = {}; ++d < v; ) {
          var P = d < w ? s[d] : i;
          l(C, n[d], P);
        }
        return C;
      }
      function Do(n) {
        return Be(n) ? n : [];
      }
      function jo(n) {
        return typeof n == "function" ? n : ct;
      }
      function Pi(n, s) {
        return re(n) ? n : Jo(n, s) ? [n] : hc(Ce(n));
      }
      var gv = ce;
      function Ai(n, s, l) {
        var d = n.length;
        return l = l === i ? d : l, !s && l >= d ? n : At(n, s, l);
      }
      var Du = rm || function(n) {
        return Ze.clearTimeout(n);
      };
      function ju(n, s) {
        if (s) return n.slice();
        var l = n.length, d = su ? su(l) : new n.constructor(l);
        return n.copy(d), d;
      }
      function Bo(n) {
        var s = new n.constructor(n.byteLength);
        return new Rr(s).set(new Rr(n)), s;
      }
      function yv(n, s) {
        var l = s ? Bo(n.buffer) : n.buffer;
        return new n.constructor(l, n.byteOffset, n.byteLength);
      }
      function bv(n) {
        var s = new n.constructor(n.source, _l.exec(n));
        return s.lastIndex = n.lastIndex, s;
      }
      function wv(n) {
        return Ln ? Te(Ln.call(n)) : {};
      }
      function Bu(n, s) {
        var l = s ? Bo(n.buffer) : n.buffer;
        return new n.constructor(l, n.byteOffset, n.length);
      }
      function Uu(n, s) {
        if (n !== s) {
          var l = n !== i, d = n === null, v = n === n, w = gt(n), C = s !== i, P = s === null, S = s === s, I = gt(s);
          if (!P && !I && !w && n > s || w && C && S && !P && !I || d && C && S || !l && S || !v) return 1;
          if (!d && !w && !I && n < s || I && l && v && !d && !w || P && l && v || !C && v || !S) return -1;
        }
        return 0;
      }
      function _v(n, s, l) {
        for (var d = -1, v = n.criteria, w = s.criteria, C = v.length, P = l.length; ++d < C; ) {
          var S = Uu(v[d], w[d]);
          if (S) {
            if (d >= P) return S;
            var I = l[d];
            return S * (I == "desc" ? -1 : 1);
          }
        }
        return n.index - s.index;
      }
      function $u(n, s, l, d) {
        for (var v = -1, w = n.length, C = l.length, P = -1, S = s.length, I = Ge(w - C, 0), M = T(S + I), F = !d; ++P < S; ) M[P] = s[P];
        for (; ++v < C; ) (F || v < w) && (M[l[v]] = n[v]);
        for (; I--; ) M[P++] = n[v++];
        return M;
      }
      function zu(n, s, l, d) {
        for (var v = -1, w = n.length, C = -1, P = l.length, S = -1, I = s.length, M = Ge(w - P, 0), F = T(M + I), D = !d; ++v < M; ) F[v] = n[v];
        for (var G = v; ++S < I; ) F[G + S] = s[S];
        for (; ++C < P; ) (D || v < w) && (F[G + l[C]] = n[v++]);
        return F;
      }
      function at(n, s) {
        var l = -1, d = n.length;
        for (s || (s = T(d)); ++l < d; ) s[l] = n[l];
        return s;
      }
      function Vt(n, s, l, d) {
        var v = !l;
        l || (l = {});
        for (var w = -1, C = s.length; ++w < C; ) {
          var P = s[w], S = d ? d(l[P], n[P], P, l, n) : i;
          S === i && (S = n[P]), v ? ii(l, P, S) : Nn(l, P, S);
        }
        return l;
      }
      function Cv(n, s) {
        return Vt(n, Zo(n), s);
      }
      function Ev(n, s) {
        return Vt(n, tc(n), s);
      }
      function Hr(n, s) {
        return function(l, d) {
          var v = re(l) ? Tf : Gm, w = s ? s() : {};
          return v(l, n, J(d, 2), w);
        };
      }
      function sn(n) {
        return ce(function(s, l) {
          var d = -1, v = l.length, w = v > 1 ? l[v - 1] : i, C = v > 2 ? l[2] : i;
          for (w = n.length > 3 && typeof w == "function" ? (v--, w) : i, C && nt(l[0], l[1], C) && (w = v < 3 ? i : w, v = 1), s = Te(s); ++d < v; ) {
            var P = l[d];
            P && n(s, P, d, w);
          }
          return s;
        });
      }
      function Wu(n, s) {
        return function(l, d) {
          if (l == null) return l;
          if (!lt(l)) return n(l, d);
          for (var v = l.length, w = s ? v : -1, C = Te(l); (s ? w-- : ++w < v) && d(C[w], w, C) !== false; ) ;
          return l;
        };
      }
      function Vu(n) {
        return function(s, l, d) {
          for (var v = -1, w = Te(s), C = d(s), P = C.length; P--; ) {
            var S = C[n ? P : ++v];
            if (l(w[S], S, w) === false) break;
          }
          return s;
        };
      }
      function Pv(n, s, l) {
        var d = s & R, v = $n(n);
        function w() {
          var C = this && this !== Ze && this instanceof w ? v : n;
          return C.apply(d ? l : this, arguments);
        }
        return w;
      }
      function Gu(n) {
        return function(s) {
          s = Ce(s);
          var l = Qi(s) ? Rt(s) : i, d = l ? l[0] : s.charAt(0), v = l ? Ai(l, 1).join("") : s.slice(1);
          return d[n]() + v;
        };
      }
      function on(n) {
        return function(s) {
          return uo(Wc(zc(s).replace(ff, "")), n, "");
        };
      }
      function $n(n) {
        return function() {
          var s = arguments;
          switch (s.length) {
            case 0:
              return new n();
            case 1:
              return new n(s[0]);
            case 2:
              return new n(s[0], s[1]);
            case 3:
              return new n(s[0], s[1], s[2]);
            case 4:
              return new n(s[0], s[1], s[2], s[3]);
            case 5:
              return new n(s[0], s[1], s[2], s[3], s[4]);
            case 6:
              return new n(s[0], s[1], s[2], s[3], s[4], s[5]);
            case 7:
              return new n(s[0], s[1], s[2], s[3], s[4], s[5], s[6]);
          }
          var l = rn(n.prototype), d = n.apply(l, s);
          return De(d) ? d : l;
        };
      }
      function Av(n, s, l) {
        var d = $n(n);
        function v() {
          for (var w = arguments.length, C = T(w), P = w, S = an(v); P--; ) C[P] = arguments[P];
          var I = w < 3 && C[0] !== S && C[w - 1] !== S ? [] : bi(C, S);
          if (w -= I.length, w < l) return Ku(n, s, qr, v.placeholder, i, C, I, i, i, l - w);
          var M = this && this !== Ze && this instanceof v ? d : n;
          return ft(M, this, C);
        }
        return v;
      }
      function Zu(n) {
        return function(s, l, d) {
          var v = Te(s);
          if (!lt(s)) {
            var w = J(l, 3);
            s = Je(s), l = function(P) {
              return w(v[P], P, v);
            };
          }
          var C = n(s, l, d);
          return C > -1 ? v[w ? s[C] : C] : i;
        };
      }
      function Ju(n) {
        return ri(function(s) {
          var l = s.length, d = l, v = Et.prototype.thru;
          for (n && s.reverse(); d--; ) {
            var w = s[d];
            if (typeof w != "function") throw new Ct(u);
            if (v && !C && Xr(w) == "wrapper") var C = new Et([], true);
          }
          for (d = C ? d : l; ++d < l; ) {
            w = s[d];
            var P = Xr(w), S = P == "wrapper" ? Vo(w) : i;
            S && Ho(S[0]) && S[1] == (pe | B | ie | Se) && !S[4].length && S[9] == 1 ? C = C[Xr(S[0])].apply(C, S[3]) : C = w.length == 1 && Ho(w) ? C[P]() : C.thru(w);
          }
          return function() {
            var I = arguments, M = I[0];
            if (C && I.length == 1 && re(M)) return C.plant(M).value();
            for (var F = 0, D = l ? s[F].apply(this, I) : M; ++F < l; ) D = s[F].call(this, D);
            return D;
          };
        });
      }
      function qr(n, s, l, d, v, w, C, P, S, I) {
        var M = s & pe, F = s & R, D = s & N, G = s & (B | K), H = s & Le, le = D ? i : $n(n);
        function q() {
          for (var fe = arguments.length, ge = T(fe), yt = fe; yt--; ) ge[yt] = arguments[yt];
          if (G) var rt = an(q), bt = Df(ge, rt);
          if (d && (ge = $u(ge, d, v, G)), w && (ge = zu(ge, w, C, G)), fe -= bt, G && fe < I) {
            var Ue = bi(ge, rt);
            return Ku(n, s, qr, q.placeholder, l, ge, Ue, P, S, I - fe);
          }
          var Nt = F ? l : this, li = D ? Nt[n] : n;
          return fe = ge.length, P ? ge = Gv(ge, P) : H && fe > 1 && ge.reverse(), M && S < fe && (ge.length = S), this && this !== Ze && this instanceof q && (li = le || $n(li)), li.apply(Nt, ge);
        }
        return q;
      }
      function Hu(n, s) {
        return function(l, d) {
          return Xm(l, n, s(d), {});
        };
      }
      function Kr(n, s) {
        return function(l, d) {
          var v;
          if (l === i && d === i) return s;
          if (l !== i && (v = l), d !== i) {
            if (v === i) return d;
            typeof l == "string" || typeof d == "string" ? (l = vt(l), d = vt(d)) : (l = Ru(l), d = Ru(d)), v = n(l, d);
          }
          return v;
        };
      }
      function Uo(n) {
        return ri(function(s) {
          return s = Fe(s, mt(J())), ce(function(l) {
            var d = this;
            return n(s, function(v) {
              return ft(v, d, l);
            });
          });
        });
      }
      function Yr(n, s) {
        s = s === i ? " " : vt(s);
        var l = s.length;
        if (l < 2) return l ? Ro(s, n) : s;
        var d = Ro(s, Dr(n / Xi(s)));
        return Qi(s) ? Ai(Rt(d), 0, n).join("") : d.slice(0, n);
      }
      function Sv(n, s, l, d) {
        var v = s & R, w = $n(n);
        function C() {
          for (var P = -1, S = arguments.length, I = -1, M = d.length, F = T(M + S), D = this && this !== Ze && this instanceof C ? w : n; ++I < M; ) F[I] = d[I];
          for (; S--; ) F[I++] = arguments[++P];
          return ft(D, v ? l : this, F);
        }
        return C;
      }
      function qu(n) {
        return function(s, l, d) {
          return d && typeof d != "number" && nt(s, l, d) && (l = d = i), s = ai(s), l === i ? (l = s, s = 0) : l = ai(l), d = d === i ? s < l ? 1 : -1 : ai(d), hv(s, l, d, n);
        };
      }
      function Qr(n) {
        return function(s, l) {
          return typeof s == "string" && typeof l == "string" || (s = Ot(s), l = Ot(l)), n(s, l);
        };
      }
      function Ku(n, s, l, d, v, w, C, P, S, I) {
        var M = s & B, F = M ? C : i, D = M ? i : C, G = M ? w : i, H = M ? i : w;
        s |= M ? ie : we, s &= ~(M ? we : ie), s & j || (s &= ~(R | N));
        var le = [n, s, v, G, F, H, D, P, S, I], q = l.apply(i, le);
        return Ho(n) && lc(q, le), q.placeholder = d, uc(q, n, s);
      }
      function $o(n) {
        var s = Ve[n];
        return function(l, d) {
          if (l = Ot(l), d = d == null ? 0 : Xe(ae(d), 292), d && uu(l)) {
            var v = (Ce(l) + "e").split("e"), w = s(v[0] + "e" + (+v[1] + d));
            return v = (Ce(w) + "e").split("e"), +(v[0] + "e" + (+v[1] - d));
          }
          return s(l);
        };
      }
      var Ov = tn && 1 / Or(new tn([, -0]))[1] == ve ? function(n) {
        return new tn(n);
      } : ua;
      function Yu(n) {
        return function(s) {
          var l = et(s);
          return l == It ? go(s) : l == Mt ? Vf(s) : Nf(s, n(s));
        };
      }
      function ni(n, s, l, d, v, w, C, P) {
        var S = s & N;
        if (!S && typeof n != "function") throw new Ct(u);
        var I = d ? d.length : 0;
        if (I || (s &= ~(ie | we), d = v = i), C = C === i ? C : Ge(ae(C), 0), P = P === i ? P : ae(P), I -= v ? v.length : 0, s & we) {
          var M = d, F = v;
          d = v = i;
        }
        var D = S ? i : Vo(n), G = [n, s, l, d, v, M, F, w, C, P];
        if (D && zv(G, D), n = G[0], s = G[1], l = G[2], d = G[3], v = G[4], P = G[9] = G[9] === i ? S ? 0 : n.length : Ge(G[9] - I, 0), !P && s & (B | K) && (s &= ~(B | K)), !s || s == R) var H = Pv(n, s, l);
        else s == B || s == K ? H = Av(n, s, P) : (s == ie || s == (R | ie)) && !v.length ? H = Sv(n, s, l, d) : H = qr.apply(i, G);
        var le = D ? Iu : lc;
        return uc(le(H, G), n, s);
      }
      function Qu(n, s, l, d) {
        return n === i || Lt(n, en[l]) && !Pe.call(d, l) ? s : n;
      }
      function Xu(n, s, l, d, v, w) {
        return De(n) && De(s) && (w.set(s, n), Gr(n, s, i, Xu, w), w.delete(s)), n;
      }
      function Tv(n) {
        return Vn(n) ? i : n;
      }
      function ec(n, s, l, d, v, w) {
        var C = l & _, P = n.length, S = s.length;
        if (P != S && !(C && S > P)) return false;
        var I = w.get(n), M = w.get(s);
        if (I && M) return I == s && M == n;
        var F = -1, D = true, G = l & E ? new Di() : i;
        for (w.set(n, s), w.set(s, n); ++F < P; ) {
          var H = n[F], le = s[F];
          if (d) var q = C ? d(le, H, F, s, n, w) : d(H, le, F, n, s, w);
          if (q !== i) {
            if (q) continue;
            D = false;
            break;
          }
          if (G) {
            if (!co(s, function(fe, ge) {
              if (!kn(G, ge) && (H === fe || v(H, fe, l, d, w))) return G.push(ge);
            })) {
              D = false;
              break;
            }
          } else if (!(H === le || v(H, le, l, d, w))) {
            D = false;
            break;
          }
        }
        return w.delete(n), w.delete(s), D;
      }
      function xv(n, s, l, d, v, w, C) {
        switch (l) {
          case qi:
            if (n.byteLength != s.byteLength || n.byteOffset != s.byteOffset) return false;
            n = n.buffer, s = s.buffer;
          case xn:
            return !(n.byteLength != s.byteLength || !w(new Rr(n), new Rr(s)));
          case En:
          case Pn:
          case An:
            return Lt(+n, +s);
          case br:
            return n.name == s.name && n.message == s.message;
          case Sn:
          case On:
            return n == s + "";
          case It:
            var P = go;
          case Mt:
            var S = d & _;
            if (P || (P = Or), n.size != s.size && !S) return false;
            var I = C.get(n);
            if (I) return I == s;
            d |= E, C.set(n, s);
            var M = ec(P(n), P(s), d, v, w, C);
            return C.delete(n), M;
          case _r:
            if (Ln) return Ln.call(n) == Ln.call(s);
        }
        return false;
      }
      function kv(n, s, l, d, v, w) {
        var C = l & _, P = zo(n), S = P.length, I = zo(s), M = I.length;
        if (S != M && !C) return false;
        for (var F = S; F--; ) {
          var D = P[F];
          if (!(C ? D in s : Pe.call(s, D))) return false;
        }
        var G = w.get(n), H = w.get(s);
        if (G && H) return G == s && H == n;
        var le = true;
        w.set(n, s), w.set(s, n);
        for (var q = C; ++F < S; ) {
          D = P[F];
          var fe = n[D], ge = s[D];
          if (d) var yt = C ? d(ge, fe, D, s, n, w) : d(fe, ge, D, n, s, w);
          if (!(yt === i ? fe === ge || v(fe, ge, l, d, w) : yt)) {
            le = false;
            break;
          }
          q || (q = D == "constructor");
        }
        if (le && !q) {
          var rt = n.constructor, bt = s.constructor;
          rt != bt && "constructor" in n && "constructor" in s && !(typeof rt == "function" && rt instanceof rt && typeof bt == "function" && bt instanceof bt) && (le = false);
        }
        return w.delete(n), w.delete(s), le;
      }
      function ri(n) {
        return Ko(oc(n, i, mc), n + "");
      }
      function zo(n) {
        return wu(n, Je, Zo);
      }
      function Wo(n) {
        return wu(n, ut, tc);
      }
      var Vo = Br ? function(n) {
        return Br.get(n);
      } : ua;
      function Xr(n) {
        for (var s = n.name + "", l = nn[s], d = Pe.call(nn, s) ? l.length : 0; d--; ) {
          var v = l[d], w = v.func;
          if (w == null || w == n) return v.name;
        }
        return s;
      }
      function an(n) {
        var s = Pe.call(b, "placeholder") ? b : n;
        return s.placeholder;
      }
      function J() {
        var n = b.iteratee || aa;
        return n = n === aa ? Eu : n, arguments.length ? n(arguments[0], arguments[1]) : n;
      }
      function es(n, s) {
        var l = n.__data__;
        return jv(s) ? l[typeof s == "string" ? "string" : "hash"] : l.map;
      }
      function Go(n) {
        for (var s = Je(n), l = s.length; l--; ) {
          var d = s[l], v = n[d];
          s[l] = [d, v, rc(v)];
        }
        return s;
      }
      function Ui(n, s) {
        var l = $f(n, s);
        return Cu(l) ? l : i;
      }
      function Iv(n) {
        var s = Pe.call(n, Li), l = n[Li];
        try {
          n[Li] = i;
          var d = true;
        } catch {
        }
        var v = Ir.call(n);
        return d && (s ? n[Li] = l : delete n[Li]), v;
      }
      var Zo = bo ? function(n) {
        return n == null ? [] : (n = Te(n), gi(bo(n), function(s) {
          return au.call(n, s);
        }));
      } : ca, tc = bo ? function(n) {
        for (var s = []; n; ) yi(s, Zo(n)), n = Fr(n);
        return s;
      } : ca, et = it;
      (wo && et(new wo(new ArrayBuffer(1))) != qi || Mn && et(new Mn()) != It || _o && et(_o.resolve()) != gl || tn && et(new tn()) != Mt || Rn && et(new Rn()) != Tn) && (et = function(n) {
        var s = it(n), l = s == Xt ? n.constructor : i, d = l ? $i(l) : "";
        if (d) switch (d) {
          case pm:
            return qi;
          case fm:
            return It;
          case mm:
            return gl;
          case vm:
            return Mt;
          case gm:
            return Tn;
        }
        return s;
      });
      function Mv(n, s, l) {
        for (var d = -1, v = l.length; ++d < v; ) {
          var w = l[d], C = w.size;
          switch (w.type) {
            case "drop":
              n += C;
              break;
            case "dropRight":
              s -= C;
              break;
            case "take":
              s = Xe(s, n + C);
              break;
            case "takeRight":
              n = Ge(n, s - C);
              break;
          }
        }
        return { start: n, end: s };
      }
      function Rv(n) {
        var s = n.match(jp);
        return s ? s[1].split(Bp) : [];
      }
      function ic(n, s, l) {
        s = Pi(s, n);
        for (var d = -1, v = s.length, w = false; ++d < v; ) {
          var C = Gt(s[d]);
          if (!(w = n != null && l(n, C))) break;
          n = n[C];
        }
        return w || ++d != v ? w : (v = n == null ? 0 : n.length, !!v && as(v) && si(C, v) && (re(n) || zi(n)));
      }
      function Fv(n) {
        var s = n.length, l = new n.constructor(s);
        return s && typeof n[0] == "string" && Pe.call(n, "index") && (l.index = n.index, l.input = n.input), l;
      }
      function nc(n) {
        return typeof n.constructor == "function" && !zn(n) ? rn(Fr(n)) : {};
      }
      function Lv(n, s, l) {
        var d = n.constructor;
        switch (s) {
          case xn:
            return Bo(n);
          case En:
          case Pn:
            return new d(+n);
          case qi:
            return yv(n, l);
          case Vs:
          case Gs:
          case Zs:
          case Js:
          case Hs:
          case qs:
          case Ks:
          case Ys:
          case Qs:
            return Bu(n, l);
          case It:
            return new d();
          case An:
          case On:
            return new d(n);
          case Sn:
            return bv(n);
          case Mt:
            return new d();
          case _r:
            return wv(n);
        }
      }
      function Nv(n, s) {
        var l = s.length;
        if (!l) return n;
        var d = l - 1;
        return s[d] = (l > 1 ? "& " : "") + s[d], s = s.join(l > 2 ? ", " : " "), n.replace(Dp, `{
/* [wrapped with ` + s + `] */
`);
      }
      function Dv(n) {
        return re(n) || zi(n) || !!(lu && n && n[lu]);
      }
      function si(n, s) {
        var l = typeof n;
        return s = s ?? oe, !!s && (l == "number" || l != "symbol" && Hp.test(n)) && n > -1 && n % 1 == 0 && n < s;
      }
      function nt(n, s, l) {
        if (!De(l)) return false;
        var d = typeof s;
        return (d == "number" ? lt(l) && si(s, l.length) : d == "string" && s in l) ? Lt(l[s], n) : false;
      }
      function Jo(n, s) {
        if (re(n)) return false;
        var l = typeof n;
        return l == "number" || l == "symbol" || l == "boolean" || n == null || gt(n) ? true : Rp.test(n) || !Mp.test(n) || s != null && n in Te(s);
      }
      function jv(n) {
        var s = typeof n;
        return s == "string" || s == "number" || s == "symbol" || s == "boolean" ? n !== "__proto__" : n === null;
      }
      function Ho(n) {
        var s = Xr(n), l = b[s];
        if (typeof l != "function" || !(s in me.prototype)) return false;
        if (n === l) return true;
        var d = Vo(l);
        return !!d && n === d[0];
      }
      function Bv(n) {
        return !!ru && ru in n;
      }
      var Uv = xr ? oi : ha;
      function zn(n) {
        var s = n && n.constructor, l = typeof s == "function" && s.prototype || en;
        return n === l;
      }
      function rc(n) {
        return n === n && !De(n);
      }
      function sc(n, s) {
        return function(l) {
          return l == null ? false : l[n] === s && (s !== i || n in Te(l));
        };
      }
      function $v(n) {
        var s = ss(n, function(d) {
          return l.size === h && l.clear(), d;
        }), l = s.cache;
        return s;
      }
      function zv(n, s) {
        var l = n[1], d = s[1], v = l | d, w = v < (R | N | pe), C = d == pe && l == B || d == pe && l == Se && n[7].length <= s[8] || d == (pe | Se) && s[7].length <= s[8] && l == B;
        if (!(w || C)) return n;
        d & R && (n[2] = s[2], v |= l & R ? 0 : j);
        var P = s[3];
        if (P) {
          var S = n[3];
          n[3] = S ? $u(S, P, s[4]) : P, n[4] = S ? bi(n[3], f) : s[4];
        }
        return P = s[5], P && (S = n[5], n[5] = S ? zu(S, P, s[6]) : P, n[6] = S ? bi(n[5], f) : s[6]), P = s[7], P && (n[7] = P), d & pe && (n[8] = n[8] == null ? s[8] : Xe(n[8], s[8])), n[9] == null && (n[9] = s[9]), n[0] = s[0], n[1] = v, n;
      }
      function Wv(n) {
        var s = [];
        if (n != null) for (var l in Te(n)) s.push(l);
        return s;
      }
      function Vv(n) {
        return Ir.call(n);
      }
      function oc(n, s, l) {
        return s = Ge(s === i ? n.length - 1 : s, 0), function() {
          for (var d = arguments, v = -1, w = Ge(d.length - s, 0), C = T(w); ++v < w; ) C[v] = d[s + v];
          v = -1;
          for (var P = T(s + 1); ++v < s; ) P[v] = d[v];
          return P[s] = l(C), ft(n, this, P);
        };
      }
      function ac(n, s) {
        return s.length < 2 ? n : Bi(n, At(s, 0, -1));
      }
      function Gv(n, s) {
        for (var l = n.length, d = Xe(s.length, l), v = at(n); d--; ) {
          var w = s[d];
          n[d] = si(w, l) ? v[w] : i;
        }
        return n;
      }
      function qo(n, s) {
        if (!(s === "constructor" && typeof n[s] == "function") && s != "__proto__") return n[s];
      }
      var lc = cc(Iu), Wn = om || function(n, s) {
        return Ze.setTimeout(n, s);
      }, Ko = cc(fv);
      function uc(n, s, l) {
        var d = s + "";
        return Ko(n, Nv(d, Zv(Rv(d), l)));
      }
      function cc(n) {
        var s = 0, l = 0;
        return function() {
          var d = cm(), v = fi - (d - l);
          if (l = d, v > 0) {
            if (++s >= tt) return arguments[0];
          } else s = 0;
          return n.apply(i, arguments);
        };
      }
      function ts(n, s) {
        var l = -1, d = n.length, v = d - 1;
        for (s = s === i ? d : s; ++l < s; ) {
          var w = Mo(l, v), C = n[w];
          n[w] = n[l], n[l] = C;
        }
        return n.length = s, n;
      }
      var hc = $v(function(n) {
        var s = [];
        return n.charCodeAt(0) === 46 && s.push(""), n.replace(Fp, function(l, d, v, w) {
          s.push(v ? w.replace(zp, "$1") : d || l);
        }), s;
      });
      function Gt(n) {
        if (typeof n == "string" || gt(n)) return n;
        var s = n + "";
        return s == "0" && 1 / n == -ve ? "-0" : s;
      }
      function $i(n) {
        if (n != null) {
          try {
            return kr.call(n);
          } catch {
          }
          try {
            return n + "";
          } catch {
          }
        }
        return "";
      }
      function Zv(n, s) {
        return _t(Ri, function(l) {
          var d = "_." + l[0];
          s & l[1] && !Ar(n, d) && n.push(d);
        }), n.sort();
      }
      function dc(n) {
        if (n instanceof me) return n.clone();
        var s = new Et(n.__wrapped__, n.__chain__);
        return s.__actions__ = at(n.__actions__), s.__index__ = n.__index__, s.__values__ = n.__values__, s;
      }
      function Jv(n, s, l) {
        (l ? nt(n, s, l) : s === i) ? s = 1 : s = Ge(ae(s), 0);
        var d = n == null ? 0 : n.length;
        if (!d || s < 1) return [];
        for (var v = 0, w = 0, C = T(Dr(d / s)); v < d; ) C[w++] = At(n, v, v += s);
        return C;
      }
      function Hv(n) {
        for (var s = -1, l = n == null ? 0 : n.length, d = 0, v = []; ++s < l; ) {
          var w = n[s];
          w && (v[d++] = w);
        }
        return v;
      }
      function qv() {
        var n = arguments.length;
        if (!n) return [];
        for (var s = T(n - 1), l = arguments[0], d = n; d--; ) s[d - 1] = arguments[d];
        return yi(re(l) ? at(l) : [l], Ye(s, 1));
      }
      var Kv = ce(function(n, s) {
        return Be(n) ? Dn(n, Ye(s, 1, Be, true)) : [];
      }), Yv = ce(function(n, s) {
        var l = St(s);
        return Be(l) && (l = i), Be(n) ? Dn(n, Ye(s, 1, Be, true), J(l, 2)) : [];
      }), Qv = ce(function(n, s) {
        var l = St(s);
        return Be(l) && (l = i), Be(n) ? Dn(n, Ye(s, 1, Be, true), i, l) : [];
      });
      function Xv(n, s, l) {
        var d = n == null ? 0 : n.length;
        return d ? (s = l || s === i ? 1 : ae(s), At(n, s < 0 ? 0 : s, d)) : [];
      }
      function eg(n, s, l) {
        var d = n == null ? 0 : n.length;
        return d ? (s = l || s === i ? 1 : ae(s), s = d - s, At(n, 0, s < 0 ? 0 : s)) : [];
      }
      function tg(n, s) {
        return n && n.length ? Jr(n, J(s, 3), true, true) : [];
      }
      function ig(n, s) {
        return n && n.length ? Jr(n, J(s, 3), true) : [];
      }
      function ng(n, s, l, d) {
        var v = n == null ? 0 : n.length;
        return v ? (l && typeof l != "number" && nt(n, s, l) && (l = 0, d = v), qm(n, s, l, d)) : [];
      }
      function pc(n, s, l) {
        var d = n == null ? 0 : n.length;
        if (!d) return -1;
        var v = l == null ? 0 : ae(l);
        return v < 0 && (v = Ge(d + v, 0)), Sr(n, J(s, 3), v);
      }
      function fc(n, s, l) {
        var d = n == null ? 0 : n.length;
        if (!d) return -1;
        var v = d - 1;
        return l !== i && (v = ae(l), v = l < 0 ? Ge(d + v, 0) : Xe(v, d - 1)), Sr(n, J(s, 3), v, true);
      }
      function mc(n) {
        var s = n == null ? 0 : n.length;
        return s ? Ye(n, 1) : [];
      }
      function rg(n) {
        var s = n == null ? 0 : n.length;
        return s ? Ye(n, ve) : [];
      }
      function sg(n, s) {
        var l = n == null ? 0 : n.length;
        return l ? (s = s === i ? 1 : ae(s), Ye(n, s)) : [];
      }
      function og(n) {
        for (var s = -1, l = n == null ? 0 : n.length, d = {}; ++s < l; ) {
          var v = n[s];
          d[v[0]] = v[1];
        }
        return d;
      }
      function vc(n) {
        return n && n.length ? n[0] : i;
      }
      function ag(n, s, l) {
        var d = n == null ? 0 : n.length;
        if (!d) return -1;
        var v = l == null ? 0 : ae(l);
        return v < 0 && (v = Ge(d + v, 0)), Yi(n, s, v);
      }
      function lg(n) {
        var s = n == null ? 0 : n.length;
        return s ? At(n, 0, -1) : [];
      }
      var ug = ce(function(n) {
        var s = Fe(n, Do);
        return s.length && s[0] === n[0] ? Oo(s) : [];
      }), cg = ce(function(n) {
        var s = St(n), l = Fe(n, Do);
        return s === St(l) ? s = i : l.pop(), l.length && l[0] === n[0] ? Oo(l, J(s, 2)) : [];
      }), hg = ce(function(n) {
        var s = St(n), l = Fe(n, Do);
        return s = typeof s == "function" ? s : i, s && l.pop(), l.length && l[0] === n[0] ? Oo(l, i, s) : [];
      });
      function dg(n, s) {
        return n == null ? "" : lm.call(n, s);
      }
      function St(n) {
        var s = n == null ? 0 : n.length;
        return s ? n[s - 1] : i;
      }
      function pg(n, s, l) {
        var d = n == null ? 0 : n.length;
        if (!d) return -1;
        var v = d;
        return l !== i && (v = ae(l), v = v < 0 ? Ge(d + v, 0) : Xe(v, d - 1)), s === s ? Zf(n, s, v) : Sr(n, Kl, v, true);
      }
      function fg(n, s) {
        return n && n.length ? Ou(n, ae(s)) : i;
      }
      var mg = ce(gc);
      function gc(n, s) {
        return n && n.length && s && s.length ? Io(n, s) : n;
      }
      function vg(n, s, l) {
        return n && n.length && s && s.length ? Io(n, s, J(l, 2)) : n;
      }
      function gg(n, s, l) {
        return n && n.length && s && s.length ? Io(n, s, i, l) : n;
      }
      var yg = ri(function(n, s) {
        var l = n == null ? 0 : n.length, d = Eo(n, s);
        return ku(n, Fe(s, function(v) {
          return si(v, l) ? +v : v;
        }).sort(Uu)), d;
      });
      function bg(n, s) {
        var l = [];
        if (!(n && n.length)) return l;
        var d = -1, v = [], w = n.length;
        for (s = J(s, 3); ++d < w; ) {
          var C = n[d];
          s(C, d, n) && (l.push(C), v.push(d));
        }
        return ku(n, v), l;
      }
      function Yo(n) {
        return n == null ? n : dm.call(n);
      }
      function wg(n, s, l) {
        var d = n == null ? 0 : n.length;
        return d ? (l && typeof l != "number" && nt(n, s, l) ? (s = 0, l = d) : (s = s == null ? 0 : ae(s), l = l === i ? d : ae(l)), At(n, s, l)) : [];
      }
      function _g(n, s) {
        return Zr(n, s);
      }
      function Cg(n, s, l) {
        return Fo(n, s, J(l, 2));
      }
      function Eg(n, s) {
        var l = n == null ? 0 : n.length;
        if (l) {
          var d = Zr(n, s);
          if (d < l && Lt(n[d], s)) return d;
        }
        return -1;
      }
      function Pg(n, s) {
        return Zr(n, s, true);
      }
      function Ag(n, s, l) {
        return Fo(n, s, J(l, 2), true);
      }
      function Sg(n, s) {
        var l = n == null ? 0 : n.length;
        if (l) {
          var d = Zr(n, s, true) - 1;
          if (Lt(n[d], s)) return d;
        }
        return -1;
      }
      function Og(n) {
        return n && n.length ? Mu(n) : [];
      }
      function Tg(n, s) {
        return n && n.length ? Mu(n, J(s, 2)) : [];
      }
      function xg(n) {
        var s = n == null ? 0 : n.length;
        return s ? At(n, 1, s) : [];
      }
      function kg(n, s, l) {
        return n && n.length ? (s = l || s === i ? 1 : ae(s), At(n, 0, s < 0 ? 0 : s)) : [];
      }
      function Ig(n, s, l) {
        var d = n == null ? 0 : n.length;
        return d ? (s = l || s === i ? 1 : ae(s), s = d - s, At(n, s < 0 ? 0 : s, d)) : [];
      }
      function Mg(n, s) {
        return n && n.length ? Jr(n, J(s, 3), false, true) : [];
      }
      function Rg(n, s) {
        return n && n.length ? Jr(n, J(s, 3)) : [];
      }
      var Fg = ce(function(n) {
        return Ei(Ye(n, 1, Be, true));
      }), Lg = ce(function(n) {
        var s = St(n);
        return Be(s) && (s = i), Ei(Ye(n, 1, Be, true), J(s, 2));
      }), Ng = ce(function(n) {
        var s = St(n);
        return s = typeof s == "function" ? s : i, Ei(Ye(n, 1, Be, true), i, s);
      });
      function Dg(n) {
        return n && n.length ? Ei(n) : [];
      }
      function jg(n, s) {
        return n && n.length ? Ei(n, J(s, 2)) : [];
      }
      function Bg(n, s) {
        return s = typeof s == "function" ? s : i, n && n.length ? Ei(n, i, s) : [];
      }
      function Qo(n) {
        if (!(n && n.length)) return [];
        var s = 0;
        return n = gi(n, function(l) {
          if (Be(l)) return s = Ge(l.length, s), true;
        }), mo(s, function(l) {
          return Fe(n, ho(l));
        });
      }
      function yc(n, s) {
        if (!(n && n.length)) return [];
        var l = Qo(n);
        return s == null ? l : Fe(l, function(d) {
          return ft(s, i, d);
        });
      }
      var Ug = ce(function(n, s) {
        return Be(n) ? Dn(n, s) : [];
      }), $g = ce(function(n) {
        return No(gi(n, Be));
      }), zg = ce(function(n) {
        var s = St(n);
        return Be(s) && (s = i), No(gi(n, Be), J(s, 2));
      }), Wg = ce(function(n) {
        var s = St(n);
        return s = typeof s == "function" ? s : i, No(gi(n, Be), i, s);
      }), Vg = ce(Qo);
      function Gg(n, s) {
        return Nu(n || [], s || [], Nn);
      }
      function Zg(n, s) {
        return Nu(n || [], s || [], Un);
      }
      var Jg = ce(function(n) {
        var s = n.length, l = s > 1 ? n[s - 1] : i;
        return l = typeof l == "function" ? (n.pop(), l) : i, yc(n, l);
      });
      function bc(n) {
        var s = b(n);
        return s.__chain__ = true, s;
      }
      function Hg(n, s) {
        return s(n), n;
      }
      function is(n, s) {
        return s(n);
      }
      var qg = ri(function(n) {
        var s = n.length, l = s ? n[0] : 0, d = this.__wrapped__, v = function(w) {
          return Eo(w, n);
        };
        return s > 1 || this.__actions__.length || !(d instanceof me) || !si(l) ? this.thru(v) : (d = d.slice(l, +l + (s ? 1 : 0)), d.__actions__.push({ func: is, args: [v], thisArg: i }), new Et(d, this.__chain__).thru(function(w) {
          return s && !w.length && w.push(i), w;
        }));
      });
      function Kg() {
        return bc(this);
      }
      function Yg() {
        return new Et(this.value(), this.__chain__);
      }
      function Qg() {
        this.__values__ === i && (this.__values__ = Rc(this.value()));
        var n = this.__index__ >= this.__values__.length, s = n ? i : this.__values__[this.__index__++];
        return { done: n, value: s };
      }
      function Xg() {
        return this;
      }
      function ey(n) {
        for (var s, l = this; l instanceof $r; ) {
          var d = dc(l);
          d.__index__ = 0, d.__values__ = i, s ? v.__wrapped__ = d : s = d;
          var v = d;
          l = l.__wrapped__;
        }
        return v.__wrapped__ = n, s;
      }
      function ty() {
        var n = this.__wrapped__;
        if (n instanceof me) {
          var s = n;
          return this.__actions__.length && (s = new me(this)), s = s.reverse(), s.__actions__.push({ func: is, args: [Yo], thisArg: i }), new Et(s, this.__chain__);
        }
        return this.thru(Yo);
      }
      function iy() {
        return Lu(this.__wrapped__, this.__actions__);
      }
      var ny = Hr(function(n, s, l) {
        Pe.call(n, l) ? ++n[l] : ii(n, l, 1);
      });
      function ry(n, s, l) {
        var d = re(n) ? Hl : Hm;
        return l && nt(n, s, l) && (s = i), d(n, J(s, 3));
      }
      function sy(n, s) {
        var l = re(n) ? gi : yu;
        return l(n, J(s, 3));
      }
      var oy = Zu(pc), ay = Zu(fc);
      function ly(n, s) {
        return Ye(ns(n, s), 1);
      }
      function uy(n, s) {
        return Ye(ns(n, s), ve);
      }
      function cy(n, s, l) {
        return l = l === i ? 1 : ae(l), Ye(ns(n, s), l);
      }
      function wc(n, s) {
        var l = re(n) ? _t : Ci;
        return l(n, J(s, 3));
      }
      function _c(n, s) {
        var l = re(n) ? xf : gu;
        return l(n, J(s, 3));
      }
      var hy = Hr(function(n, s, l) {
        Pe.call(n, l) ? n[l].push(s) : ii(n, l, [s]);
      });
      function dy(n, s, l, d) {
        n = lt(n) ? n : un(n), l = l && !d ? ae(l) : 0;
        var v = n.length;
        return l < 0 && (l = Ge(v + l, 0)), ls(n) ? l <= v && n.indexOf(s, l) > -1 : !!v && Yi(n, s, l) > -1;
      }
      var py = ce(function(n, s, l) {
        var d = -1, v = typeof s == "function", w = lt(n) ? T(n.length) : [];
        return Ci(n, function(C) {
          w[++d] = v ? ft(s, C, l) : jn(C, s, l);
        }), w;
      }), fy = Hr(function(n, s, l) {
        ii(n, l, s);
      });
      function ns(n, s) {
        var l = re(n) ? Fe : Pu;
        return l(n, J(s, 3));
      }
      function my(n, s, l, d) {
        return n == null ? [] : (re(s) || (s = s == null ? [] : [s]), l = d ? i : l, re(l) || (l = l == null ? [] : [l]), Tu(n, s, l));
      }
      var vy = Hr(function(n, s, l) {
        n[l ? 0 : 1].push(s);
      }, function() {
        return [[], []];
      });
      function gy(n, s, l) {
        var d = re(n) ? uo : Ql, v = arguments.length < 3;
        return d(n, J(s, 4), l, v, Ci);
      }
      function yy(n, s, l) {
        var d = re(n) ? kf : Ql, v = arguments.length < 3;
        return d(n, J(s, 4), l, v, gu);
      }
      function by(n, s) {
        var l = re(n) ? gi : yu;
        return l(n, os(J(s, 3)));
      }
      function wy(n) {
        var s = re(n) ? pu : dv;
        return s(n);
      }
      function _y(n, s, l) {
        (l ? nt(n, s, l) : s === i) ? s = 1 : s = ae(s);
        var d = re(n) ? Wm : pv;
        return d(n, s);
      }
      function Cy(n) {
        var s = re(n) ? Vm : mv;
        return s(n);
      }
      function Ey(n) {
        if (n == null) return 0;
        if (lt(n)) return ls(n) ? Xi(n) : n.length;
        var s = et(n);
        return s == It || s == Mt ? n.size : xo(n).length;
      }
      function Py(n, s, l) {
        var d = re(n) ? co : vv;
        return l && nt(n, s, l) && (s = i), d(n, J(s, 3));
      }
      var Ay = ce(function(n, s) {
        if (n == null) return [];
        var l = s.length;
        return l > 1 && nt(n, s[0], s[1]) ? s = [] : l > 2 && nt(s[0], s[1], s[2]) && (s = [s[0]]), Tu(n, Ye(s, 1), []);
      }), rs = sm || function() {
        return Ze.Date.now();
      };
      function Sy(n, s) {
        if (typeof s != "function") throw new Ct(u);
        return n = ae(n), function() {
          if (--n < 1) return s.apply(this, arguments);
        };
      }
      function Cc(n, s, l) {
        return s = l ? i : s, s = n && s == null ? n.length : s, ni(n, pe, i, i, i, i, s);
      }
      function Ec(n, s) {
        var l;
        if (typeof s != "function") throw new Ct(u);
        return n = ae(n), function() {
          return --n > 0 && (l = s.apply(this, arguments)), n <= 1 && (s = i), l;
        };
      }
      var Xo = ce(function(n, s, l) {
        var d = R;
        if (l.length) {
          var v = bi(l, an(Xo));
          d |= ie;
        }
        return ni(n, d, s, l, v);
      }), Pc = ce(function(n, s, l) {
        var d = R | N;
        if (l.length) {
          var v = bi(l, an(Pc));
          d |= ie;
        }
        return ni(s, d, n, l, v);
      });
      function Ac(n, s, l) {
        s = l ? i : s;
        var d = ni(n, B, i, i, i, i, i, s);
        return d.placeholder = Ac.placeholder, d;
      }
      function Sc(n, s, l) {
        s = l ? i : s;
        var d = ni(n, K, i, i, i, i, i, s);
        return d.placeholder = Sc.placeholder, d;
      }
      function Oc(n, s, l) {
        var d, v, w, C, P, S, I = 0, M = false, F = false, D = true;
        if (typeof n != "function") throw new Ct(u);
        s = Ot(s) || 0, De(l) && (M = !!l.leading, F = "maxWait" in l, w = F ? Ge(Ot(l.maxWait) || 0, s) : w, D = "trailing" in l ? !!l.trailing : D);
        function G(Ue) {
          var Nt = d, li = v;
          return d = v = i, I = Ue, C = n.apply(li, Nt), C;
        }
        function H(Ue) {
          return I = Ue, P = Wn(fe, s), M ? G(Ue) : C;
        }
        function le(Ue) {
          var Nt = Ue - S, li = Ue - I, Zc = s - Nt;
          return F ? Xe(Zc, w - li) : Zc;
        }
        function q(Ue) {
          var Nt = Ue - S, li = Ue - I;
          return S === i || Nt >= s || Nt < 0 || F && li >= w;
        }
        function fe() {
          var Ue = rs();
          if (q(Ue)) return ge(Ue);
          P = Wn(fe, le(Ue));
        }
        function ge(Ue) {
          return P = i, D && d ? G(Ue) : (d = v = i, C);
        }
        function yt() {
          P !== i && Du(P), I = 0, d = S = v = P = i;
        }
        function rt() {
          return P === i ? C : ge(rs());
        }
        function bt() {
          var Ue = rs(), Nt = q(Ue);
          if (d = arguments, v = this, S = Ue, Nt) {
            if (P === i) return H(S);
            if (F) return Du(P), P = Wn(fe, s), G(S);
          }
          return P === i && (P = Wn(fe, s)), C;
        }
        return bt.cancel = yt, bt.flush = rt, bt;
      }
      var Oy = ce(function(n, s) {
        return vu(n, 1, s);
      }), Ty = ce(function(n, s, l) {
        return vu(n, Ot(s) || 0, l);
      });
      function xy(n) {
        return ni(n, Le);
      }
      function ss(n, s) {
        if (typeof n != "function" || s != null && typeof s != "function") throw new Ct(u);
        var l = function() {
          var d = arguments, v = s ? s.apply(this, d) : d[0], w = l.cache;
          if (w.has(v)) return w.get(v);
          var C = n.apply(this, d);
          return l.cache = w.set(v, C) || w, C;
        };
        return l.cache = new (ss.Cache || ti)(), l;
      }
      ss.Cache = ti;
      function os(n) {
        if (typeof n != "function") throw new Ct(u);
        return function() {
          var s = arguments;
          switch (s.length) {
            case 0:
              return !n.call(this);
            case 1:
              return !n.call(this, s[0]);
            case 2:
              return !n.call(this, s[0], s[1]);
            case 3:
              return !n.call(this, s[0], s[1], s[2]);
          }
          return !n.apply(this, s);
        };
      }
      function ky(n) {
        return Ec(2, n);
      }
      var Iy = gv(function(n, s) {
        s = s.length == 1 && re(s[0]) ? Fe(s[0], mt(J())) : Fe(Ye(s, 1), mt(J()));
        var l = s.length;
        return ce(function(d) {
          for (var v = -1, w = Xe(d.length, l); ++v < w; ) d[v] = s[v].call(this, d[v]);
          return ft(n, this, d);
        });
      }), ea = ce(function(n, s) {
        var l = bi(s, an(ea));
        return ni(n, ie, i, s, l);
      }), Tc = ce(function(n, s) {
        var l = bi(s, an(Tc));
        return ni(n, we, i, s, l);
      }), My = ri(function(n, s) {
        return ni(n, Se, i, i, i, s);
      });
      function Ry(n, s) {
        if (typeof n != "function") throw new Ct(u);
        return s = s === i ? s : ae(s), ce(n, s);
      }
      function Fy(n, s) {
        if (typeof n != "function") throw new Ct(u);
        return s = s == null ? 0 : Ge(ae(s), 0), ce(function(l) {
          var d = l[s], v = Ai(l, 0, s);
          return d && yi(v, d), ft(n, this, v);
        });
      }
      function Ly(n, s, l) {
        var d = true, v = true;
        if (typeof n != "function") throw new Ct(u);
        return De(l) && (d = "leading" in l ? !!l.leading : d, v = "trailing" in l ? !!l.trailing : v), Oc(n, s, { leading: d, maxWait: s, trailing: v });
      }
      function Ny(n) {
        return Cc(n, 1);
      }
      function Dy(n, s) {
        return ea(jo(s), n);
      }
      function jy() {
        if (!arguments.length) return [];
        var n = arguments[0];
        return re(n) ? n : [n];
      }
      function By(n) {
        return Pt(n, g);
      }
      function Uy(n, s) {
        return s = typeof s == "function" ? s : i, Pt(n, g, s);
      }
      function $y(n) {
        return Pt(n, m | g);
      }
      function zy(n, s) {
        return s = typeof s == "function" ? s : i, Pt(n, m | g, s);
      }
      function Wy(n, s) {
        return s == null || mu(n, s, Je(s));
      }
      function Lt(n, s) {
        return n === s || n !== n && s !== s;
      }
      var Vy = Qr(So), Gy = Qr(function(n, s) {
        return n >= s;
      }), zi = _u(/* @__PURE__ */ function() {
        return arguments;
      }()) ? _u : function(n) {
        return je(n) && Pe.call(n, "callee") && !au.call(n, "callee");
      }, re = T.isArray, Zy = zl ? mt(zl) : ev;
      function lt(n) {
        return n != null && as(n.length) && !oi(n);
      }
      function Be(n) {
        return je(n) && lt(n);
      }
      function Jy(n) {
        return n === true || n === false || je(n) && it(n) == En;
      }
      var Si = am || ha, Hy = Wl ? mt(Wl) : tv;
      function qy(n) {
        return je(n) && n.nodeType === 1 && !Vn(n);
      }
      function Ky(n) {
        if (n == null) return true;
        if (lt(n) && (re(n) || typeof n == "string" || typeof n.splice == "function" || Si(n) || ln(n) || zi(n))) return !n.length;
        var s = et(n);
        if (s == It || s == Mt) return !n.size;
        if (zn(n)) return !xo(n).length;
        for (var l in n) if (Pe.call(n, l)) return false;
        return true;
      }
      function Yy(n, s) {
        return Bn(n, s);
      }
      function Qy(n, s, l) {
        l = typeof l == "function" ? l : i;
        var d = l ? l(n, s) : i;
        return d === i ? Bn(n, s, i, l) : !!d;
      }
      function ta(n) {
        if (!je(n)) return false;
        var s = it(n);
        return s == br || s == wp || typeof n.message == "string" && typeof n.name == "string" && !Vn(n);
      }
      function Xy(n) {
        return typeof n == "number" && uu(n);
      }
      function oi(n) {
        if (!De(n)) return false;
        var s = it(n);
        return s == wr || s == vl || s == bp || s == Cp;
      }
      function xc(n) {
        return typeof n == "number" && n == ae(n);
      }
      function as(n) {
        return typeof n == "number" && n > -1 && n % 1 == 0 && n <= oe;
      }
      function De(n) {
        var s = typeof n;
        return n != null && (s == "object" || s == "function");
      }
      function je(n) {
        return n != null && typeof n == "object";
      }
      var kc = Vl ? mt(Vl) : nv;
      function eb(n, s) {
        return n === s || To(n, s, Go(s));
      }
      function tb(n, s, l) {
        return l = typeof l == "function" ? l : i, To(n, s, Go(s), l);
      }
      function ib(n) {
        return Ic(n) && n != +n;
      }
      function nb(n) {
        if (Uv(n)) throw new ne(a);
        return Cu(n);
      }
      function rb(n) {
        return n === null;
      }
      function sb(n) {
        return n == null;
      }
      function Ic(n) {
        return typeof n == "number" || je(n) && it(n) == An;
      }
      function Vn(n) {
        if (!je(n) || it(n) != Xt) return false;
        var s = Fr(n);
        if (s === null) return true;
        var l = Pe.call(s, "constructor") && s.constructor;
        return typeof l == "function" && l instanceof l && kr.call(l) == tm;
      }
      var ia = Gl ? mt(Gl) : rv;
      function ob(n) {
        return xc(n) && n >= -oe && n <= oe;
      }
      var Mc = Zl ? mt(Zl) : sv;
      function ls(n) {
        return typeof n == "string" || !re(n) && je(n) && it(n) == On;
      }
      function gt(n) {
        return typeof n == "symbol" || je(n) && it(n) == _r;
      }
      var ln = Jl ? mt(Jl) : ov;
      function ab(n) {
        return n === i;
      }
      function lb(n) {
        return je(n) && et(n) == Tn;
      }
      function ub(n) {
        return je(n) && it(n) == Pp;
      }
      var cb = Qr(ko), hb = Qr(function(n, s) {
        return n <= s;
      });
      function Rc(n) {
        if (!n) return [];
        if (lt(n)) return ls(n) ? Rt(n) : at(n);
        if (In && n[In]) return Wf(n[In]());
        var s = et(n), l = s == It ? go : s == Mt ? Or : un;
        return l(n);
      }
      function ai(n) {
        if (!n) return n === 0 ? n : 0;
        if (n = Ot(n), n === ve || n === -ve) {
          var s = n < 0 ? -1 : 1;
          return s * Ne;
        }
        return n === n ? n : 0;
      }
      function ae(n) {
        var s = ai(n), l = s % 1;
        return s === s ? l ? s - l : s : 0;
      }
      function Fc(n) {
        return n ? ji(ae(n), 0, Re) : 0;
      }
      function Ot(n) {
        if (typeof n == "number") return n;
        if (gt(n)) return Ke;
        if (De(n)) {
          var s = typeof n.valueOf == "function" ? n.valueOf() : n;
          n = De(s) ? s + "" : s;
        }
        if (typeof n != "string") return n === 0 ? n : +n;
        n = Xl(n);
        var l = Gp.test(n);
        return l || Jp.test(n) ? Sf(n.slice(2), l ? 2 : 8) : Vp.test(n) ? Ke : +n;
      }
      function Lc(n) {
        return Vt(n, ut(n));
      }
      function db(n) {
        return n ? ji(ae(n), -oe, oe) : n === 0 ? n : 0;
      }
      function Ce(n) {
        return n == null ? "" : vt(n);
      }
      var pb = sn(function(n, s) {
        if (zn(s) || lt(s)) {
          Vt(s, Je(s), n);
          return;
        }
        for (var l in s) Pe.call(s, l) && Nn(n, l, s[l]);
      }), Nc = sn(function(n, s) {
        Vt(s, ut(s), n);
      }), us = sn(function(n, s, l, d) {
        Vt(s, ut(s), n, d);
      }), fb = sn(function(n, s, l, d) {
        Vt(s, Je(s), n, d);
      }), mb = ri(Eo);
      function vb(n, s) {
        var l = rn(n);
        return s == null ? l : fu(l, s);
      }
      var gb = ce(function(n, s) {
        n = Te(n);
        var l = -1, d = s.length, v = d > 2 ? s[2] : i;
        for (v && nt(s[0], s[1], v) && (d = 1); ++l < d; ) for (var w = s[l], C = ut(w), P = -1, S = C.length; ++P < S; ) {
          var I = C[P], M = n[I];
          (M === i || Lt(M, en[I]) && !Pe.call(n, I)) && (n[I] = w[I]);
        }
        return n;
      }), yb = ce(function(n) {
        return n.push(i, Xu), ft(Dc, i, n);
      });
      function bb(n, s) {
        return ql(n, J(s, 3), Wt);
      }
      function wb(n, s) {
        return ql(n, J(s, 3), Ao);
      }
      function _b(n, s) {
        return n == null ? n : Po(n, J(s, 3), ut);
      }
      function Cb(n, s) {
        return n == null ? n : bu(n, J(s, 3), ut);
      }
      function Eb(n, s) {
        return n && Wt(n, J(s, 3));
      }
      function Pb(n, s) {
        return n && Ao(n, J(s, 3));
      }
      function Ab(n) {
        return n == null ? [] : Vr(n, Je(n));
      }
      function Sb(n) {
        return n == null ? [] : Vr(n, ut(n));
      }
      function na(n, s, l) {
        var d = n == null ? i : Bi(n, s);
        return d === i ? l : d;
      }
      function Ob(n, s) {
        return n != null && ic(n, s, Km);
      }
      function ra(n, s) {
        return n != null && ic(n, s, Ym);
      }
      var Tb = Hu(function(n, s, l) {
        s != null && typeof s.toString != "function" && (s = Ir.call(s)), n[s] = l;
      }, oa(ct)), xb = Hu(function(n, s, l) {
        s != null && typeof s.toString != "function" && (s = Ir.call(s)), Pe.call(n, s) ? n[s].push(l) : n[s] = [l];
      }, J), kb = ce(jn);
      function Je(n) {
        return lt(n) ? du(n) : xo(n);
      }
      function ut(n) {
        return lt(n) ? du(n, true) : av(n);
      }
      function Ib(n, s) {
        var l = {};
        return s = J(s, 3), Wt(n, function(d, v, w) {
          ii(l, s(d, v, w), d);
        }), l;
      }
      function Mb(n, s) {
        var l = {};
        return s = J(s, 3), Wt(n, function(d, v, w) {
          ii(l, v, s(d, v, w));
        }), l;
      }
      var Rb = sn(function(n, s, l) {
        Gr(n, s, l);
      }), Dc = sn(function(n, s, l, d) {
        Gr(n, s, l, d);
      }), Fb = ri(function(n, s) {
        var l = {};
        if (n == null) return l;
        var d = false;
        s = Fe(s, function(w) {
          return w = Pi(w, n), d || (d = w.length > 1), w;
        }), Vt(n, Wo(n), l), d && (l = Pt(l, m | y | g, Tv));
        for (var v = s.length; v--; ) Lo(l, s[v]);
        return l;
      });
      function Lb(n, s) {
        return jc(n, os(J(s)));
      }
      var Nb = ri(function(n, s) {
        return n == null ? {} : uv(n, s);
      });
      function jc(n, s) {
        if (n == null) return {};
        var l = Fe(Wo(n), function(d) {
          return [d];
        });
        return s = J(s), xu(n, l, function(d, v) {
          return s(d, v[0]);
        });
      }
      function Db(n, s, l) {
        s = Pi(s, n);
        var d = -1, v = s.length;
        for (v || (v = 1, n = i); ++d < v; ) {
          var w = n == null ? i : n[Gt(s[d])];
          w === i && (d = v, w = l), n = oi(w) ? w.call(n) : w;
        }
        return n;
      }
      function jb(n, s, l) {
        return n == null ? n : Un(n, s, l);
      }
      function Bb(n, s, l, d) {
        return d = typeof d == "function" ? d : i, n == null ? n : Un(n, s, l, d);
      }
      var Bc = Yu(Je), Uc = Yu(ut);
      function Ub(n, s, l) {
        var d = re(n), v = d || Si(n) || ln(n);
        if (s = J(s, 4), l == null) {
          var w = n && n.constructor;
          v ? l = d ? new w() : [] : De(n) ? l = oi(w) ? rn(Fr(n)) : {} : l = {};
        }
        return (v ? _t : Wt)(n, function(C, P, S) {
          return s(l, C, P, S);
        }), l;
      }
      function $b(n, s) {
        return n == null ? true : Lo(n, s);
      }
      function zb(n, s, l) {
        return n == null ? n : Fu(n, s, jo(l));
      }
      function Wb(n, s, l, d) {
        return d = typeof d == "function" ? d : i, n == null ? n : Fu(n, s, jo(l), d);
      }
      function un(n) {
        return n == null ? [] : vo(n, Je(n));
      }
      function Vb(n) {
        return n == null ? [] : vo(n, ut(n));
      }
      function Gb(n, s, l) {
        return l === i && (l = s, s = i), l !== i && (l = Ot(l), l = l === l ? l : 0), s !== i && (s = Ot(s), s = s === s ? s : 0), ji(Ot(n), s, l);
      }
      function Zb(n, s, l) {
        return s = ai(s), l === i ? (l = s, s = 0) : l = ai(l), n = Ot(n), Qm(n, s, l);
      }
      function Jb(n, s, l) {
        if (l && typeof l != "boolean" && nt(n, s, l) && (s = l = i), l === i && (typeof s == "boolean" ? (l = s, s = i) : typeof n == "boolean" && (l = n, n = i)), n === i && s === i ? (n = 0, s = 1) : (n = ai(n), s === i ? (s = n, n = 0) : s = ai(s)), n > s) {
          var d = n;
          n = s, s = d;
        }
        if (l || n % 1 || s % 1) {
          var v = cu();
          return Xe(n + v * (s - n + Af("1e-" + ((v + "").length - 1))), s);
        }
        return Mo(n, s);
      }
      var Hb = on(function(n, s, l) {
        return s = s.toLowerCase(), n + (l ? $c(s) : s);
      });
      function $c(n) {
        return sa(Ce(n).toLowerCase());
      }
      function zc(n) {
        return n = Ce(n), n && n.replace(qp, jf).replace(mf, "");
      }
      function qb(n, s, l) {
        n = Ce(n), s = vt(s);
        var d = n.length;
        l = l === i ? d : ji(ae(l), 0, d);
        var v = l;
        return l -= s.length, l >= 0 && n.slice(l, v) == s;
      }
      function Kb(n) {
        return n = Ce(n), n && xp.test(n) ? n.replace(bl, Bf) : n;
      }
      function Yb(n) {
        return n = Ce(n), n && Lp.test(n) ? n.replace(Xs, "\\$&") : n;
      }
      var Qb = on(function(n, s, l) {
        return n + (l ? "-" : "") + s.toLowerCase();
      }), Xb = on(function(n, s, l) {
        return n + (l ? " " : "") + s.toLowerCase();
      }), e0 = Gu("toLowerCase");
      function t0(n, s, l) {
        n = Ce(n), s = ae(s);
        var d = s ? Xi(n) : 0;
        if (!s || d >= s) return n;
        var v = (s - d) / 2;
        return Yr(jr(v), l) + n + Yr(Dr(v), l);
      }
      function i0(n, s, l) {
        n = Ce(n), s = ae(s);
        var d = s ? Xi(n) : 0;
        return s && d < s ? n + Yr(s - d, l) : n;
      }
      function n0(n, s, l) {
        n = Ce(n), s = ae(s);
        var d = s ? Xi(n) : 0;
        return s && d < s ? Yr(s - d, l) + n : n;
      }
      function r0(n, s, l) {
        return l || s == null ? s = 0 : s && (s = +s), hm(Ce(n).replace(eo, ""), s || 0);
      }
      function s0(n, s, l) {
        return (l ? nt(n, s, l) : s === i) ? s = 1 : s = ae(s), Ro(Ce(n), s);
      }
      function o0() {
        var n = arguments, s = Ce(n[0]);
        return n.length < 3 ? s : s.replace(n[1], n[2]);
      }
      var a0 = on(function(n, s, l) {
        return n + (l ? "_" : "") + s.toLowerCase();
      });
      function l0(n, s, l) {
        return l && typeof l != "number" && nt(n, s, l) && (s = l = i), l = l === i ? Re : l >>> 0, l ? (n = Ce(n), n && (typeof s == "string" || s != null && !ia(s)) && (s = vt(s), !s && Qi(n)) ? Ai(Rt(n), 0, l) : n.split(s, l)) : [];
      }
      var u0 = on(function(n, s, l) {
        return n + (l ? " " : "") + sa(s);
      });
      function c0(n, s, l) {
        return n = Ce(n), l = l == null ? 0 : ji(ae(l), 0, n.length), s = vt(s), n.slice(l, l + s.length) == s;
      }
      function h0(n, s, l) {
        var d = b.templateSettings;
        l && nt(n, s, l) && (s = i), n = Ce(n), s = us({}, s, d, Qu);
        var v = us({}, s.imports, d.imports, Qu), w = Je(v), C = vo(v, w), P, S, I = 0, M = s.interpolate || Cr, F = "__p += '", D = yo((s.escape || Cr).source + "|" + M.source + "|" + (M === wl ? Wp : Cr).source + "|" + (s.evaluate || Cr).source + "|$", "g"), G = "//# sourceURL=" + (Pe.call(s, "sourceURL") ? (s.sourceURL + "").replace(/\s/g, " ") : "lodash.templateSources[" + ++wf + "]") + `
`;
        n.replace(D, function(q, fe, ge, yt, rt, bt) {
          return ge || (ge = yt), F += n.slice(I, bt).replace(Kp, Uf), fe && (P = true, F += `' +
__e(` + fe + `) +
'`), rt && (S = true, F += `';
` + rt + `;
__p += '`), ge && (F += `' +
((__t = (` + ge + `)) == null ? '' : __t) +
'`), I = bt + q.length, q;
        }), F += `';
`;
        var H = Pe.call(s, "variable") && s.variable;
        if (!H) F = `with (obj) {
` + F + `
}
`;
        else if ($p.test(H)) throw new ne(c);
        F = (S ? F.replace(Ap, "") : F).replace(Sp, "$1").replace(Op, "$1;"), F = "function(" + (H || "obj") + `) {
` + (H ? "" : `obj || (obj = {});
`) + "var __t, __p = ''" + (P ? ", __e = _.escape" : "") + (S ? `, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
` : `;
`) + F + `return __p
}`;
        var le = Vc(function() {
          return _e(w, G + "return " + F).apply(i, C);
        });
        if (le.source = F, ta(le)) throw le;
        return le;
      }
      function d0(n) {
        return Ce(n).toLowerCase();
      }
      function p0(n) {
        return Ce(n).toUpperCase();
      }
      function f0(n, s, l) {
        if (n = Ce(n), n && (l || s === i)) return Xl(n);
        if (!n || !(s = vt(s))) return n;
        var d = Rt(n), v = Rt(s), w = eu(d, v), C = tu(d, v) + 1;
        return Ai(d, w, C).join("");
      }
      function m0(n, s, l) {
        if (n = Ce(n), n && (l || s === i)) return n.slice(0, nu(n) + 1);
        if (!n || !(s = vt(s))) return n;
        var d = Rt(n), v = tu(d, Rt(s)) + 1;
        return Ai(d, 0, v).join("");
      }
      function v0(n, s, l) {
        if (n = Ce(n), n && (l || s === i)) return n.replace(eo, "");
        if (!n || !(s = vt(s))) return n;
        var d = Rt(n), v = eu(d, Rt(s));
        return Ai(d, v).join("");
      }
      function g0(n, s) {
        var l = Oe, d = xe;
        if (De(s)) {
          var v = "separator" in s ? s.separator : v;
          l = "length" in s ? ae(s.length) : l, d = "omission" in s ? vt(s.omission) : d;
        }
        n = Ce(n);
        var w = n.length;
        if (Qi(n)) {
          var C = Rt(n);
          w = C.length;
        }
        if (l >= w) return n;
        var P = l - Xi(d);
        if (P < 1) return d;
        var S = C ? Ai(C, 0, P).join("") : n.slice(0, P);
        if (v === i) return S + d;
        if (C && (P += S.length - P), ia(v)) {
          if (n.slice(P).search(v)) {
            var I, M = S;
            for (v.global || (v = yo(v.source, Ce(_l.exec(v)) + "g")), v.lastIndex = 0; I = v.exec(M); ) var F = I.index;
            S = S.slice(0, F === i ? P : F);
          }
        } else if (n.indexOf(vt(v), P) != P) {
          var D = S.lastIndexOf(v);
          D > -1 && (S = S.slice(0, D));
        }
        return S + d;
      }
      function y0(n) {
        return n = Ce(n), n && Tp.test(n) ? n.replace(yl, Jf) : n;
      }
      var b0 = on(function(n, s, l) {
        return n + (l ? " " : "") + s.toUpperCase();
      }), sa = Gu("toUpperCase");
      function Wc(n, s, l) {
        return n = Ce(n), s = l ? i : s, s === i ? zf(n) ? Kf(n) : Rf(n) : n.match(s) || [];
      }
      var Vc = ce(function(n, s) {
        try {
          return ft(n, i, s);
        } catch (l) {
          return ta(l) ? l : new ne(l);
        }
      }), w0 = ri(function(n, s) {
        return _t(s, function(l) {
          l = Gt(l), ii(n, l, Xo(n[l], n));
        }), n;
      });
      function _0(n) {
        var s = n == null ? 0 : n.length, l = J();
        return n = s ? Fe(n, function(d) {
          if (typeof d[1] != "function") throw new Ct(u);
          return [l(d[0]), d[1]];
        }) : [], ce(function(d) {
          for (var v = -1; ++v < s; ) {
            var w = n[v];
            if (ft(w[0], this, d)) return ft(w[1], this, d);
          }
        });
      }
      function C0(n) {
        return Jm(Pt(n, m));
      }
      function oa(n) {
        return function() {
          return n;
        };
      }
      function E0(n, s) {
        return n == null || n !== n ? s : n;
      }
      var P0 = Ju(), A0 = Ju(true);
      function ct(n) {
        return n;
      }
      function aa(n) {
        return Eu(typeof n == "function" ? n : Pt(n, m));
      }
      function S0(n) {
        return Au(Pt(n, m));
      }
      function O0(n, s) {
        return Su(n, Pt(s, m));
      }
      var T0 = ce(function(n, s) {
        return function(l) {
          return jn(l, n, s);
        };
      }), x0 = ce(function(n, s) {
        return function(l) {
          return jn(n, l, s);
        };
      });
      function la(n, s, l) {
        var d = Je(s), v = Vr(s, d);
        l == null && !(De(s) && (v.length || !d.length)) && (l = s, s = n, n = this, v = Vr(s, Je(s)));
        var w = !(De(l) && "chain" in l) || !!l.chain, C = oi(n);
        return _t(v, function(P) {
          var S = s[P];
          n[P] = S, C && (n.prototype[P] = function() {
            var I = this.__chain__;
            if (w || I) {
              var M = n(this.__wrapped__), F = M.__actions__ = at(this.__actions__);
              return F.push({ func: S, args: arguments, thisArg: n }), M.__chain__ = I, M;
            }
            return S.apply(n, yi([this.value()], arguments));
          });
        }), n;
      }
      function k0() {
        return Ze._ === this && (Ze._ = im), this;
      }
      function ua() {
      }
      function I0(n) {
        return n = ae(n), ce(function(s) {
          return Ou(s, n);
        });
      }
      var M0 = Uo(Fe), R0 = Uo(Hl), F0 = Uo(co);
      function Gc(n) {
        return Jo(n) ? ho(Gt(n)) : cv(n);
      }
      function L0(n) {
        return function(s) {
          return n == null ? i : Bi(n, s);
        };
      }
      var N0 = qu(), D0 = qu(true);
      function ca() {
        return [];
      }
      function ha() {
        return false;
      }
      function j0() {
        return {};
      }
      function B0() {
        return "";
      }
      function U0() {
        return true;
      }
      function $0(n, s) {
        if (n = ae(n), n < 1 || n > oe) return [];
        var l = Re, d = Xe(n, Re);
        s = J(s), n -= Re;
        for (var v = mo(d, s); ++l < n; ) s(l);
        return v;
      }
      function z0(n) {
        return re(n) ? Fe(n, Gt) : gt(n) ? [n] : at(hc(Ce(n)));
      }
      function W0(n) {
        var s = ++em;
        return Ce(n) + s;
      }
      var V0 = Kr(function(n, s) {
        return n + s;
      }, 0), G0 = $o("ceil"), Z0 = Kr(function(n, s) {
        return n / s;
      }, 1), J0 = $o("floor");
      function H0(n) {
        return n && n.length ? Wr(n, ct, So) : i;
      }
      function q0(n, s) {
        return n && n.length ? Wr(n, J(s, 2), So) : i;
      }
      function K0(n) {
        return Yl(n, ct);
      }
      function Y0(n, s) {
        return Yl(n, J(s, 2));
      }
      function Q0(n) {
        return n && n.length ? Wr(n, ct, ko) : i;
      }
      function X0(n, s) {
        return n && n.length ? Wr(n, J(s, 2), ko) : i;
      }
      var ew = Kr(function(n, s) {
        return n * s;
      }, 1), tw = $o("round"), iw = Kr(function(n, s) {
        return n - s;
      }, 0);
      function nw(n) {
        return n && n.length ? fo(n, ct) : 0;
      }
      function rw(n, s) {
        return n && n.length ? fo(n, J(s, 2)) : 0;
      }
      return b.after = Sy, b.ary = Cc, b.assign = pb, b.assignIn = Nc, b.assignInWith = us, b.assignWith = fb, b.at = mb, b.before = Ec, b.bind = Xo, b.bindAll = w0, b.bindKey = Pc, b.castArray = jy, b.chain = bc, b.chunk = Jv, b.compact = Hv, b.concat = qv, b.cond = _0, b.conforms = C0, b.constant = oa, b.countBy = ny, b.create = vb, b.curry = Ac, b.curryRight = Sc, b.debounce = Oc, b.defaults = gb, b.defaultsDeep = yb, b.defer = Oy, b.delay = Ty, b.difference = Kv, b.differenceBy = Yv, b.differenceWith = Qv, b.drop = Xv, b.dropRight = eg, b.dropRightWhile = tg, b.dropWhile = ig, b.fill = ng, b.filter = sy, b.flatMap = ly, b.flatMapDeep = uy, b.flatMapDepth = cy, b.flatten = mc, b.flattenDeep = rg, b.flattenDepth = sg, b.flip = xy, b.flow = P0, b.flowRight = A0, b.fromPairs = og, b.functions = Ab, b.functionsIn = Sb, b.groupBy = hy, b.initial = lg, b.intersection = ug, b.intersectionBy = cg, b.intersectionWith = hg, b.invert = Tb, b.invertBy = xb, b.invokeMap = py, b.iteratee = aa, b.keyBy = fy, b.keys = Je, b.keysIn = ut, b.map = ns, b.mapKeys = Ib, b.mapValues = Mb, b.matches = S0, b.matchesProperty = O0, b.memoize = ss, b.merge = Rb, b.mergeWith = Dc, b.method = T0, b.methodOf = x0, b.mixin = la, b.negate = os, b.nthArg = I0, b.omit = Fb, b.omitBy = Lb, b.once = ky, b.orderBy = my, b.over = M0, b.overArgs = Iy, b.overEvery = R0, b.overSome = F0, b.partial = ea, b.partialRight = Tc, b.partition = vy, b.pick = Nb, b.pickBy = jc, b.property = Gc, b.propertyOf = L0, b.pull = mg, b.pullAll = gc, b.pullAllBy = vg, b.pullAllWith = gg, b.pullAt = yg, b.range = N0, b.rangeRight = D0, b.rearg = My, b.reject = by, b.remove = bg, b.rest = Ry, b.reverse = Yo, b.sampleSize = _y, b.set = jb, b.setWith = Bb, b.shuffle = Cy, b.slice = wg, b.sortBy = Ay, b.sortedUniq = Og, b.sortedUniqBy = Tg, b.split = l0, b.spread = Fy, b.tail = xg, b.take = kg, b.takeRight = Ig, b.takeRightWhile = Mg, b.takeWhile = Rg, b.tap = Hg, b.throttle = Ly, b.thru = is, b.toArray = Rc, b.toPairs = Bc, b.toPairsIn = Uc, b.toPath = z0, b.toPlainObject = Lc, b.transform = Ub, b.unary = Ny, b.union = Fg, b.unionBy = Lg, b.unionWith = Ng, b.uniq = Dg, b.uniqBy = jg, b.uniqWith = Bg, b.unset = $b, b.unzip = Qo, b.unzipWith = yc, b.update = zb, b.updateWith = Wb, b.values = un, b.valuesIn = Vb, b.without = Ug, b.words = Wc, b.wrap = Dy, b.xor = $g, b.xorBy = zg, b.xorWith = Wg, b.zip = Vg, b.zipObject = Gg, b.zipObjectDeep = Zg, b.zipWith = Jg, b.entries = Bc, b.entriesIn = Uc, b.extend = Nc, b.extendWith = us, la(b, b), b.add = V0, b.attempt = Vc, b.camelCase = Hb, b.capitalize = $c, b.ceil = G0, b.clamp = Gb, b.clone = By, b.cloneDeep = $y, b.cloneDeepWith = zy, b.cloneWith = Uy, b.conformsTo = Wy, b.deburr = zc, b.defaultTo = E0, b.divide = Z0, b.endsWith = qb, b.eq = Lt, b.escape = Kb, b.escapeRegExp = Yb, b.every = ry, b.find = oy, b.findIndex = pc, b.findKey = bb, b.findLast = ay, b.findLastIndex = fc, b.findLastKey = wb, b.floor = J0, b.forEach = wc, b.forEachRight = _c, b.forIn = _b, b.forInRight = Cb, b.forOwn = Eb, b.forOwnRight = Pb, b.get = na, b.gt = Vy, b.gte = Gy, b.has = Ob, b.hasIn = ra, b.head = vc, b.identity = ct, b.includes = dy, b.indexOf = ag, b.inRange = Zb, b.invoke = kb, b.isArguments = zi, b.isArray = re, b.isArrayBuffer = Zy, b.isArrayLike = lt, b.isArrayLikeObject = Be, b.isBoolean = Jy, b.isBuffer = Si, b.isDate = Hy, b.isElement = qy, b.isEmpty = Ky, b.isEqual = Yy, b.isEqualWith = Qy, b.isError = ta, b.isFinite = Xy, b.isFunction = oi, b.isInteger = xc, b.isLength = as, b.isMap = kc, b.isMatch = eb, b.isMatchWith = tb, b.isNaN = ib, b.isNative = nb, b.isNil = sb, b.isNull = rb, b.isNumber = Ic, b.isObject = De, b.isObjectLike = je, b.isPlainObject = Vn, b.isRegExp = ia, b.isSafeInteger = ob, b.isSet = Mc, b.isString = ls, b.isSymbol = gt, b.isTypedArray = ln, b.isUndefined = ab, b.isWeakMap = lb, b.isWeakSet = ub, b.join = dg, b.kebabCase = Qb, b.last = St, b.lastIndexOf = pg, b.lowerCase = Xb, b.lowerFirst = e0, b.lt = cb, b.lte = hb, b.max = H0, b.maxBy = q0, b.mean = K0, b.meanBy = Y0, b.min = Q0, b.minBy = X0, b.stubArray = ca, b.stubFalse = ha, b.stubObject = j0, b.stubString = B0, b.stubTrue = U0, b.multiply = ew, b.nth = fg, b.noConflict = k0, b.noop = ua, b.now = rs, b.pad = t0, b.padEnd = i0, b.padStart = n0, b.parseInt = r0, b.random = Jb, b.reduce = gy, b.reduceRight = yy, b.repeat = s0, b.replace = o0, b.result = Db, b.round = tw, b.runInContext = A, b.sample = wy, b.size = Ey, b.snakeCase = a0, b.some = Py, b.sortedIndex = _g, b.sortedIndexBy = Cg, b.sortedIndexOf = Eg, b.sortedLastIndex = Pg, b.sortedLastIndexBy = Ag, b.sortedLastIndexOf = Sg, b.startCase = u0, b.startsWith = c0, b.subtract = iw, b.sum = nw, b.sumBy = rw, b.template = h0, b.times = $0, b.toFinite = ai, b.toInteger = ae, b.toLength = Fc, b.toLower = d0, b.toNumber = Ot, b.toSafeInteger = db, b.toString = Ce, b.toUpper = p0, b.trim = f0, b.trimEnd = m0, b.trimStart = v0, b.truncate = g0, b.unescape = y0, b.uniqueId = W0, b.upperCase = b0, b.upperFirst = sa, b.each = wc, b.eachRight = _c, b.first = vc, la(b, function() {
        var n = {};
        return Wt(b, function(s, l) {
          Pe.call(b.prototype, l) || (n[l] = s);
        }), n;
      }(), { chain: false }), b.VERSION = r, _t(["bind", "bindKey", "curry", "curryRight", "partial", "partialRight"], function(n) {
        b[n].placeholder = b;
      }), _t(["drop", "take"], function(n, s) {
        me.prototype[n] = function(l) {
          l = l === i ? 1 : Ge(ae(l), 0);
          var d = this.__filtered__ && !s ? new me(this) : this.clone();
          return d.__filtered__ ? d.__takeCount__ = Xe(l, d.__takeCount__) : d.__views__.push({ size: Xe(l, Re), type: n + (d.__dir__ < 0 ? "Right" : "") }), d;
        }, me.prototype[n + "Right"] = function(l) {
          return this.reverse()[n](l).reverse();
        };
      }), _t(["filter", "map", "takeWhile"], function(n, s) {
        var l = s + 1, d = l == pt || l == V;
        me.prototype[n] = function(v) {
          var w = this.clone();
          return w.__iteratees__.push({ iteratee: J(v, 3), type: l }), w.__filtered__ = w.__filtered__ || d, w;
        };
      }), _t(["head", "last"], function(n, s) {
        var l = "take" + (s ? "Right" : "");
        me.prototype[n] = function() {
          return this[l](1).value()[0];
        };
      }), _t(["initial", "tail"], function(n, s) {
        var l = "drop" + (s ? "" : "Right");
        me.prototype[n] = function() {
          return this.__filtered__ ? new me(this) : this[l](1);
        };
      }), me.prototype.compact = function() {
        return this.filter(ct);
      }, me.prototype.find = function(n) {
        return this.filter(n).head();
      }, me.prototype.findLast = function(n) {
        return this.reverse().find(n);
      }, me.prototype.invokeMap = ce(function(n, s) {
        return typeof n == "function" ? new me(this) : this.map(function(l) {
          return jn(l, n, s);
        });
      }), me.prototype.reject = function(n) {
        return this.filter(os(J(n)));
      }, me.prototype.slice = function(n, s) {
        n = ae(n);
        var l = this;
        return l.__filtered__ && (n > 0 || s < 0) ? new me(l) : (n < 0 ? l = l.takeRight(-n) : n && (l = l.drop(n)), s !== i && (s = ae(s), l = s < 0 ? l.dropRight(-s) : l.take(s - n)), l);
      }, me.prototype.takeRightWhile = function(n) {
        return this.reverse().takeWhile(n).reverse();
      }, me.prototype.toArray = function() {
        return this.take(Re);
      }, Wt(me.prototype, function(n, s) {
        var l = /^(?:filter|find|map|reject)|While$/.test(s), d = /^(?:head|last)$/.test(s), v = b[d ? "take" + (s == "last" ? "Right" : "") : s], w = d || /^find/.test(s);
        v && (b.prototype[s] = function() {
          var C = this.__wrapped__, P = d ? [1] : arguments, S = C instanceof me, I = P[0], M = S || re(C), F = function(fe) {
            var ge = v.apply(b, yi([fe], P));
            return d && D ? ge[0] : ge;
          };
          M && l && typeof I == "function" && I.length != 1 && (S = M = false);
          var D = this.__chain__, G = !!this.__actions__.length, H = w && !D, le = S && !G;
          if (!w && M) {
            C = le ? C : new me(this);
            var q = n.apply(C, P);
            return q.__actions__.push({ func: is, args: [F], thisArg: i }), new Et(q, D);
          }
          return H && le ? n.apply(this, P) : (q = this.thru(F), H ? d ? q.value()[0] : q.value() : q);
        });
      }), _t(["pop", "push", "shift", "sort", "splice", "unshift"], function(n) {
        var s = Tr[n], l = /^(?:push|sort|unshift)$/.test(n) ? "tap" : "thru", d = /^(?:pop|shift)$/.test(n);
        b.prototype[n] = function() {
          var v = arguments;
          if (d && !this.__chain__) {
            var w = this.value();
            return s.apply(re(w) ? w : [], v);
          }
          return this[l](function(C) {
            return s.apply(re(C) ? C : [], v);
          });
        };
      }), Wt(me.prototype, function(n, s) {
        var l = b[s];
        if (l) {
          var d = l.name + "";
          Pe.call(nn, d) || (nn[d] = []), nn[d].push({ name: s, func: l });
        }
      }), nn[qr(i, N).name] = [{ name: "wrapper", func: i }], me.prototype.clone = ym, me.prototype.reverse = bm, me.prototype.value = wm, b.prototype.at = qg, b.prototype.chain = Kg, b.prototype.commit = Yg, b.prototype.next = Qg, b.prototype.plant = ey, b.prototype.reverse = ty, b.prototype.toJSON = b.prototype.valueOf = b.prototype.value = iy, b.prototype.first = b.prototype.head, In && (b.prototype[In] = Xg), b;
    }, wi = Yf();
    typeof define == "function" && typeof define.amd == "object" && define.amd ? (Ze._ = wi, define(function() {
      return wi;
    })) : Fi ? ((Fi.exports = wi)._ = wi, oo._ = wi) : Ze._ = wi;
  }).call(e);
});
O();
var Kh = ((e) => (e.GLOBAL = "global-store", e.COMMENTS = "comments-store", e.WHO_IS_ONLINE = "who-is-online-store", e.VIDEO = "video-store", e.PRESENCE_3D = "presence-3d-store", e.CORE = "core-store", e))(Kh || {});
O();
var fw = zt(wn());
var mw = class {
  setConfig(e) {
    this.configuration = e;
  }
  get(e, t) {
    return this.configuration ? (0, fw.get)(this.configuration, e, t) : t;
  }
};
var Q = new mw();
O();
O();
function pr() {
  return { set value(e) {
    this.instance = e, setTimeout(() => Object.freeze(this));
  }, get value() {
    return this.instance;
  } };
}
O();
O();
O();
O();
O();
var Ea = function(e, t) {
  return Ea = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(i, r) {
    i.__proto__ = r;
  } || function(i, r) {
    for (var o in r) Object.prototype.hasOwnProperty.call(r, o) && (i[o] = r[o]);
  }, Ea(e, t);
};
function Qt(e, t) {
  if (typeof t != "function" && t !== null) throw new TypeError("Class extends value " + String(t) + " is not a constructor or null");
  Ea(e, t);
  function i() {
    this.constructor = e;
  }
  e.prototype = t === null ? Object.create(t) : (i.prototype = t.prototype, new i());
}
function vw(e, t, i, r) {
  function o(a) {
    return a instanceof i ? a : new i(function(u) {
      u(a);
    });
  }
  return new (i || (i = Promise))(function(a, u) {
    function c(f) {
      try {
        h(r.next(f));
      } catch (m) {
        u(m);
      }
    }
    function p(f) {
      try {
        h(r.throw(f));
      } catch (m) {
        u(m);
      }
    }
    function h(f) {
      f.done ? a(f.value) : o(f.value).then(c, p);
    }
    h((r = r.apply(e, [])).next());
  });
}
function Yh(e, t) {
  var i = { label: 0, sent: function() {
    if (a[0] & 1) throw a[1];
    return a[1];
  }, trys: [], ops: [] }, r, o, a, u;
  return u = { next: c(0), throw: c(1), return: c(2) }, typeof Symbol == "function" && (u[Symbol.iterator] = function() {
    return this;
  }), u;
  function c(h) {
    return function(f) {
      return p([h, f]);
    };
  }
  function p(h) {
    if (r) throw new TypeError("Generator is already executing.");
    for (; u && (u = 0, h[0] && (i = 0)), i; ) try {
      if (r = 1, o && (a = h[0] & 2 ? o.return : h[0] ? o.throw || ((a = o.return) && a.call(o), 0) : o.next) && !(a = a.call(o, h[1])).done) return a;
      switch (o = 0, a && (h = [h[0] & 2, a.value]), h[0]) {
        case 0:
        case 1:
          a = h;
          break;
        case 4:
          return i.label++, { value: h[1], done: false };
        case 5:
          i.label++, o = h[1], h = [0];
          continue;
        case 7:
          h = i.ops.pop(), i.trys.pop();
          continue;
        default:
          if (a = i.trys, !(a = a.length > 0 && a[a.length - 1]) && (h[0] === 6 || h[0] === 2)) {
            i = 0;
            continue;
          }
          if (h[0] === 3 && (!a || h[1] > a[0] && h[1] < a[3])) {
            i.label = h[1];
            break;
          }
          if (h[0] === 6 && i.label < a[1]) {
            i.label = a[1], a = h;
            break;
          }
          if (a && i.label < a[2]) {
            i.label = a[2], i.ops.push(h);
            break;
          }
          a[2] && i.ops.pop(), i.trys.pop();
          continue;
      }
      h = t.call(e, i);
    } catch (f) {
      h = [6, f], o = 0;
    } finally {
      r = a = 0;
    }
    if (h[0] & 5) throw h[1];
    return { value: h[0] ? h[1] : void 0, done: true };
  }
}
function fn(e) {
  var t = typeof Symbol == "function" && Symbol.iterator, i = t && e[t], r = 0;
  if (i) return i.call(e);
  if (e && typeof e.length == "number") return { next: function() {
    return e && r >= e.length && (e = void 0), { value: e && e[r++], done: !e };
  } };
  throw new TypeError(t ? "Object is not iterable." : "Symbol.iterator is not defined.");
}
function ki(e, t) {
  var i = typeof Symbol == "function" && e[Symbol.iterator];
  if (!i) return e;
  var r = i.call(e), o, a = [], u;
  try {
    for (; (t === void 0 || t-- > 0) && !(o = r.next()).done; ) a.push(o.value);
  } catch (c) {
    u = { error: c };
  } finally {
    try {
      o && !o.done && (i = r.return) && i.call(r);
    } finally {
      if (u) throw u.error;
    }
  }
  return a;
}
function Gi(e, t, i) {
  if (arguments.length === 2) for (var r = 0, o = t.length, a; r < o; r++) (a || !(r in t)) && (a || (a = Array.prototype.slice.call(t, 0, r)), a[r] = t[r]);
  return e.concat(a || Array.prototype.slice.call(t));
}
function dn(e) {
  return this instanceof dn ? (this.v = e, this) : new dn(e);
}
function gw(e, t, i) {
  if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
  var r = i.apply(e, t || []), o, a = [];
  return o = {}, u("next"), u("throw"), u("return"), o[Symbol.asyncIterator] = function() {
    return this;
  }, o;
  function u(y) {
    r[y] && (o[y] = function(g) {
      return new Promise(function(_, E) {
        a.push([y, g, _, E]) > 1 || c(y, g);
      });
    });
  }
  function c(y, g) {
    try {
      p(r[y](g));
    } catch (_) {
      m(a[0][3], _);
    }
  }
  function p(y) {
    y.value instanceof dn ? Promise.resolve(y.value.v).then(h, f) : m(a[0][2], y);
  }
  function h(y) {
    c("next", y);
  }
  function f(y) {
    c("throw", y);
  }
  function m(y, g) {
    y(g), a.shift(), a.length && c(a[0][0], a[0][1]);
  }
}
function yw(e) {
  if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
  var t = e[Symbol.asyncIterator], i;
  return t ? t.call(e) : (e = typeof fn == "function" ? fn(e) : e[Symbol.iterator](), i = {}, r("next"), r("throw"), r("return"), i[Symbol.asyncIterator] = function() {
    return this;
  }, i);
  function r(a) {
    i[a] = e[a] && function(u) {
      return new Promise(function(c, p) {
        u = e[a](u), o(c, p, u.done, u.value);
      });
    };
  }
  function o(a, u, c, p) {
    Promise.resolve(p).then(function(h) {
      a({ value: h, done: c });
    }, u);
  }
}
O();
function Me(e) {
  return typeof e == "function";
}
O();
O();
O();
function Qh(e) {
  var t = function(r) {
    Error.call(r), r.stack = new Error().stack;
  }, i = e(t);
  return i.prototype = Object.create(Error.prototype), i.prototype.constructor = i, i;
}
var da = Qh(function(e) {
  return function(t) {
    e(this), this.message = t ? t.length + ` errors occurred during unsubscription:
` + t.map(function(i, r) {
      return r + 1 + ") " + i.toString();
    }).join(`
  `) : "", this.name = "UnsubscriptionError", this.errors = t;
  };
});
O();
function Os(e, t) {
  if (e) {
    var i = e.indexOf(t);
    0 <= i && e.splice(i, 1);
  }
}
var fr = function() {
  function e(t) {
    this.initialTeardown = t, this.closed = false, this._parentage = null, this._finalizers = null;
  }
  return e.prototype.unsubscribe = function() {
    var t, i, r, o, a;
    if (!this.closed) {
      this.closed = true;
      var u = this._parentage;
      if (u) if (this._parentage = null, Array.isArray(u)) try {
        for (var c = fn(u), p = c.next(); !p.done; p = c.next()) {
          var h = p.value;
          h.remove(this);
        }
      } catch (E) {
        t = { error: E };
      } finally {
        try {
          p && !p.done && (i = c.return) && i.call(c);
        } finally {
          if (t) throw t.error;
        }
      }
      else u.remove(this);
      var f = this.initialTeardown;
      if (Me(f)) try {
        f();
      } catch (E) {
        a = E instanceof da ? E.errors : [E];
      }
      var m = this._finalizers;
      if (m) {
        this._finalizers = null;
        try {
          for (var y = fn(m), g = y.next(); !g.done; g = y.next()) {
            var _ = g.value;
            try {
              qc(_);
            } catch (E) {
              a = a ?? [], E instanceof da ? a = Gi(Gi([], ki(a)), ki(E.errors)) : a.push(E);
            }
          }
        } catch (E) {
          r = { error: E };
        } finally {
          try {
            g && !g.done && (o = y.return) && o.call(y);
          } finally {
            if (r) throw r.error;
          }
        }
      }
      if (a) throw new da(a);
    }
  }, e.prototype.add = function(t) {
    var i;
    if (t && t !== this) if (this.closed) qc(t);
    else {
      if (t instanceof e) {
        if (t.closed || t._hasParent(this)) return;
        t._addParent(this);
      }
      (this._finalizers = (i = this._finalizers) !== null && i !== void 0 ? i : []).push(t);
    }
  }, e.prototype._hasParent = function(t) {
    var i = this._parentage;
    return i === t || Array.isArray(i) && i.includes(t);
  }, e.prototype._addParent = function(t) {
    var i = this._parentage;
    this._parentage = Array.isArray(i) ? (i.push(t), i) : i ? [i, t] : t;
  }, e.prototype._removeParent = function(t) {
    var i = this._parentage;
    i === t ? this._parentage = null : Array.isArray(i) && Os(i, t);
  }, e.prototype.remove = function(t) {
    var i = this._finalizers;
    i && Os(i, t), t instanceof e && t._removeParent(this);
  }, e.EMPTY = function() {
    var t = new e();
    return t.closed = true, t;
  }(), e;
}();
var Xh = fr.EMPTY;
function ed(e) {
  return e instanceof fr || e && "closed" in e && Me(e.remove) && Me(e.add) && Me(e.unsubscribe);
}
function qc(e) {
  Me(e) ? e() : e.unsubscribe();
}
O();
var td = { onUnhandledError: null, onStoppedNotification: null, Promise: void 0, useDeprecatedSynchronousErrorHandling: false, useDeprecatedNextContext: false };
O();
O();
var bw = { setTimeout: function(e, t) {
  for (var i = [], r = 2; r < arguments.length; r++) i[r - 2] = arguments[r];
  return setTimeout.apply(void 0, Gi([e, t], ki(i)));
}, clearTimeout: function(e) {
  return clearTimeout(e);
}, delegate: void 0 };
function id(e) {
  bw.setTimeout(function() {
    throw e;
  });
}
O();
function Kc() {
}
O();
O();
function bs(e) {
  e();
}
var Xa = function(e) {
  Qt(t, e);
  function t(i) {
    var r = e.call(this) || this;
    return r.isStopped = false, i ? (r.destination = i, ed(i) && i.add(r)) : r.destination = Ew, r;
  }
  return t.create = function(i, r, o) {
    return new Kn(i, r, o);
  }, t.prototype.next = function(i) {
    this.isStopped ? void 0 : this._next(i);
  }, t.prototype.error = function(i) {
    this.isStopped ? void 0 : (this.isStopped = true, this._error(i));
  }, t.prototype.complete = function() {
    this.isStopped ? void 0 : (this.isStopped = true, this._complete());
  }, t.prototype.unsubscribe = function() {
    this.closed || (this.isStopped = true, e.prototype.unsubscribe.call(this), this.destination = null);
  }, t.prototype._next = function(i) {
    this.destination.next(i);
  }, t.prototype._error = function(i) {
    try {
      this.destination.error(i);
    } finally {
      this.unsubscribe();
    }
  }, t.prototype._complete = function() {
    try {
      this.destination.complete();
    } finally {
      this.unsubscribe();
    }
  }, t;
}(fr);
var ww = Function.prototype.bind;
function pa(e, t) {
  return ww.call(e, t);
}
var _w = function() {
  function e(t) {
    this.partialObserver = t;
  }
  return e.prototype.next = function(t) {
    var i = this.partialObserver;
    if (i.next) try {
      i.next(t);
    } catch (r) {
      hs(r);
    }
  }, e.prototype.error = function(t) {
    var i = this.partialObserver;
    if (i.error) try {
      i.error(t);
    } catch (r) {
      hs(r);
    }
    else hs(t);
  }, e.prototype.complete = function() {
    var t = this.partialObserver;
    if (t.complete) try {
      t.complete();
    } catch (i) {
      hs(i);
    }
  }, e;
}();
var Kn = function(e) {
  Qt(t, e);
  function t(i, r, o) {
    var a = e.call(this) || this, u;
    if (Me(i) || !i) u = { next: i ?? void 0, error: r ?? void 0, complete: o ?? void 0 };
    else {
      var c;
      a && td.useDeprecatedNextContext ? (c = Object.create(i), c.unsubscribe = function() {
        return a.unsubscribe();
      }, u = { next: i.next && pa(i.next, c), error: i.error && pa(i.error, c), complete: i.complete && pa(i.complete, c) }) : u = i;
    }
    return a.destination = new _w(u), a;
  }
  return t;
}(Xa);
function hs(e) {
  id(e);
}
function Cw(e) {
  throw e;
}
var Ew = { closed: true, next: Kc, error: Cw, complete: Kc };
O();
var el = function() {
  return typeof Symbol == "function" && Symbol.observable || "@@observable";
}();
O();
O();
function nd(e) {
  return e;
}
function Pw(e) {
  return e.length === 0 ? nd : e.length === 1 ? e[0] : function(t) {
    return e.reduce(function(i, r) {
      return r(i);
    }, t);
  };
}
var qt = function() {
  function e(t) {
    t && (this._subscribe = t);
  }
  return e.prototype.lift = function(t) {
    var i = new e();
    return i.source = this, i.operator = t, i;
  }, e.prototype.subscribe = function(t, i, r) {
    var o = this, a = Sw(t) ? t : new Kn(t, i, r);
    return bs(function() {
      var u = o, c = u.operator, p = u.source;
      a.add(c ? c.call(a, p) : p ? o._subscribe(a) : o._trySubscribe(a));
    }), a;
  }, e.prototype._trySubscribe = function(t) {
    try {
      return this._subscribe(t);
    } catch (i) {
      t.error(i);
    }
  }, e.prototype.forEach = function(t, i) {
    var r = this;
    return i = Yc(i), new i(function(o, a) {
      var u = new Kn({ next: function(c) {
        try {
          t(c);
        } catch (p) {
          a(p), u.unsubscribe();
        }
      }, error: a, complete: o });
      r.subscribe(u);
    });
  }, e.prototype._subscribe = function(t) {
    var i;
    return (i = this.source) === null || i === void 0 ? void 0 : i.subscribe(t);
  }, e.prototype[el] = function() {
    return this;
  }, e.prototype.pipe = function() {
    for (var t = [], i = 0; i < arguments.length; i++) t[i] = arguments[i];
    return Pw(t)(this);
  }, e.prototype.toPromise = function(t) {
    var i = this;
    return t = Yc(t), new t(function(r, o) {
      var a;
      i.subscribe(function(u) {
        return a = u;
      }, function(u) {
        return o(u);
      }, function() {
        return r(a);
      });
    });
  }, e.create = function(t) {
    return new e(t);
  }, e;
}();
function Yc(e) {
  var t;
  return (t = e ?? td.Promise) !== null && t !== void 0 ? t : Promise;
}
function Aw(e) {
  return e && Me(e.next) && Me(e.error) && Me(e.complete);
}
function Sw(e) {
  return e && e instanceof Xa || Aw(e) && ed(e);
}
O();
function Ow(e) {
  return Me(e == null ? void 0 : e.lift);
}
function mr(e) {
  return function(t) {
    if (Ow(t)) return t.lift(function(i) {
      try {
        return e(i, this);
      } catch (r) {
        this.error(r);
      }
    });
    throw new TypeError("Unable to lift unknown Observable type");
  };
}
O();
function mn(e, t, i, r, o) {
  return new Tw(e, t, i, r, o);
}
var Tw = function(e) {
  Qt(t, e);
  function t(i, r, o, a, u, c) {
    var p = e.call(this, i) || this;
    return p.onFinalize = u, p.shouldUnsubscribe = c, p._next = r ? function(h) {
      try {
        r(h);
      } catch (f) {
        i.error(f);
      }
    } : e.prototype._next, p._error = a ? function(h) {
      try {
        a(h);
      } catch (f) {
        i.error(f);
      } finally {
        this.unsubscribe();
      }
    } : e.prototype._error, p._complete = o ? function() {
      try {
        o();
      } catch (h) {
        i.error(h);
      } finally {
        this.unsubscribe();
      }
    } : e.prototype._complete, p;
  }
  return t.prototype.unsubscribe = function() {
    var i;
    if (!this.shouldUnsubscribe || this.shouldUnsubscribe()) {
      var r = this.closed;
      e.prototype.unsubscribe.call(this), !r && ((i = this.onFinalize) === null || i === void 0 || i.call(this));
    }
  }, t;
}(Xa);
O();
O();
var xw = Qh(function(e) {
  return function() {
    e(this), this.name = "ObjectUnsubscribedError", this.message = "object unsubscribed";
  };
});
var vr = function(e) {
  Qt(t, e);
  function t() {
    var i = e.call(this) || this;
    return i.closed = false, i.currentObservers = null, i.observers = [], i.isStopped = false, i.hasError = false, i.thrownError = null, i;
  }
  return t.prototype.lift = function(i) {
    var r = new Qc(this, this);
    return r.operator = i, r;
  }, t.prototype._throwIfClosed = function() {
    if (this.closed) throw new xw();
  }, t.prototype.next = function(i) {
    var r = this;
    bs(function() {
      var o, a;
      if (r._throwIfClosed(), !r.isStopped) {
        r.currentObservers || (r.currentObservers = Array.from(r.observers));
        try {
          for (var u = fn(r.currentObservers), c = u.next(); !c.done; c = u.next()) {
            var p = c.value;
            p.next(i);
          }
        } catch (h) {
          o = { error: h };
        } finally {
          try {
            c && !c.done && (a = u.return) && a.call(u);
          } finally {
            if (o) throw o.error;
          }
        }
      }
    });
  }, t.prototype.error = function(i) {
    var r = this;
    bs(function() {
      if (r._throwIfClosed(), !r.isStopped) {
        r.hasError = r.isStopped = true, r.thrownError = i;
        for (var o = r.observers; o.length; ) o.shift().error(i);
      }
    });
  }, t.prototype.complete = function() {
    var i = this;
    bs(function() {
      if (i._throwIfClosed(), !i.isStopped) {
        i.isStopped = true;
        for (var r = i.observers; r.length; ) r.shift().complete();
      }
    });
  }, t.prototype.unsubscribe = function() {
    this.isStopped = this.closed = true, this.observers = this.currentObservers = null;
  }, Object.defineProperty(t.prototype, "observed", { get: function() {
    var i;
    return ((i = this.observers) === null || i === void 0 ? void 0 : i.length) > 0;
  }, enumerable: false, configurable: true }), t.prototype._trySubscribe = function(i) {
    return this._throwIfClosed(), e.prototype._trySubscribe.call(this, i);
  }, t.prototype._subscribe = function(i) {
    return this._throwIfClosed(), this._checkFinalizedStatuses(i), this._innerSubscribe(i);
  }, t.prototype._innerSubscribe = function(i) {
    var r = this, o = this, a = o.hasError, u = o.isStopped, c = o.observers;
    return a || u ? Xh : (this.currentObservers = null, c.push(i), new fr(function() {
      r.currentObservers = null, Os(c, i);
    }));
  }, t.prototype._checkFinalizedStatuses = function(i) {
    var r = this, o = r.hasError, a = r.thrownError, u = r.isStopped;
    o ? i.error(a) : u && i.complete();
  }, t.prototype.asObservable = function() {
    var i = new qt();
    return i.source = this, i;
  }, t.create = function(i, r) {
    return new Qc(i, r);
  }, t;
}(qt);
var Qc = function(e) {
  Qt(t, e);
  function t(i, r) {
    var o = e.call(this) || this;
    return o.destination = i, o.source = r, o;
  }
  return t.prototype.next = function(i) {
    var r, o;
    (o = (r = this.destination) === null || r === void 0 ? void 0 : r.next) === null || o === void 0 || o.call(r, i);
  }, t.prototype.error = function(i) {
    var r, o;
    (o = (r = this.destination) === null || r === void 0 ? void 0 : r.error) === null || o === void 0 || o.call(r, i);
  }, t.prototype.complete = function() {
    var i, r;
    (r = (i = this.destination) === null || i === void 0 ? void 0 : i.complete) === null || r === void 0 || r.call(i);
  }, t.prototype._subscribe = function(i) {
    var r, o;
    return (o = (r = this.source) === null || r === void 0 ? void 0 : r.subscribe(i)) !== null && o !== void 0 ? o : Xh;
  }, t;
}(vr);
O();
var rd = function(e) {
  Qt(t, e);
  function t(i) {
    var r = e.call(this) || this;
    return r._value = i, r;
  }
  return Object.defineProperty(t.prototype, "value", { get: function() {
    return this.getValue();
  }, enumerable: false, configurable: true }), t.prototype._subscribe = function(i) {
    var r = e.prototype._subscribe.call(this, i);
    return !r.closed && i.next(this._value), r;
  }, t.prototype.getValue = function() {
    var i = this, r = i.hasError, o = i.thrownError, a = i._value;
    if (r) throw o;
    return this._throwIfClosed(), a;
  }, t.prototype.next = function(i) {
    e.prototype.next.call(this, this._value = i);
  }, t;
}(vr);
O();
O();
var tl = { now: function() {
  return (tl.delegate || Date).now();
}, delegate: void 0 };
var kw = function(e) {
  Qt(t, e);
  function t(i, r, o) {
    i === void 0 && (i = 1 / 0), r === void 0 && (r = 1 / 0), o === void 0 && (o = tl);
    var a = e.call(this) || this;
    return a._bufferSize = i, a._windowTime = r, a._timestampProvider = o, a._buffer = [], a._infiniteTimeWindow = true, a._infiniteTimeWindow = r === 1 / 0, a._bufferSize = Math.max(1, i), a._windowTime = Math.max(1, r), a;
  }
  return t.prototype.next = function(i) {
    var r = this, o = r.isStopped, a = r._buffer, u = r._infiniteTimeWindow, c = r._timestampProvider, p = r._windowTime;
    o || (a.push(i), !u && a.push(c.now() + p)), this._trimBuffer(), e.prototype.next.call(this, i);
  }, t.prototype._subscribe = function(i) {
    this._throwIfClosed(), this._trimBuffer();
    for (var r = this._innerSubscribe(i), o = this, a = o._infiniteTimeWindow, u = o._buffer, c = u.slice(), p = 0; p < c.length && !i.closed; p += a ? 1 : 2) i.next(c[p]);
    return this._checkFinalizedStatuses(i), r;
  }, t.prototype._trimBuffer = function() {
    var i = this, r = i._bufferSize, o = i._timestampProvider, a = i._buffer, u = i._infiniteTimeWindow, c = (u ? 1 : 2) * r;
    if (r < 1 / 0 && c < a.length && a.splice(0, a.length - c), !u) {
      for (var p = o.now(), h = 0, f = 1; f < a.length && a[f] <= p; f += 2) h = f;
      h && a.splice(0, h + 1);
    }
  }, t;
}(vr);
O();
O();
var Iw = function(e) {
  Qt(t, e);
  function t(i, r) {
    return e.call(this) || this;
  }
  return t.prototype.schedule = function(i, r) {
    return this;
  }, t;
}(fr);
O();
var Pa = { setInterval: function(e, t) {
  for (var i = [], r = 2; r < arguments.length; r++) i[r - 2] = arguments[r];
  var o = Pa.delegate;
  return o != null && o.setInterval ? o.setInterval.apply(o, Gi([e, t], ki(i))) : setInterval.apply(void 0, Gi([e, t], ki(i)));
}, clearInterval: function(e) {
  return clearInterval(e);
}, delegate: void 0 };
var Mw = function(e) {
  Qt(t, e);
  function t(i, r) {
    var o = e.call(this, i, r) || this;
    return o.scheduler = i, o.work = r, o.pending = false, o;
  }
  return t.prototype.schedule = function(i, r) {
    var o;
    if (r === void 0 && (r = 0), this.closed) return this;
    this.state = i;
    var a = this.id, u = this.scheduler;
    return a != null && (this.id = this.recycleAsyncId(u, a, r)), this.pending = true, this.delay = r, this.id = (o = this.id) !== null && o !== void 0 ? o : this.requestAsyncId(u, this.id, r), this;
  }, t.prototype.requestAsyncId = function(i, r, o) {
    return o === void 0 && (o = 0), Pa.setInterval(i.flush.bind(i, this), o);
  }, t.prototype.recycleAsyncId = function(i, r, o) {
    if (o === void 0 && (o = 0), o != null && this.delay === o && this.pending === false) return r;
    r != null && Pa.clearInterval(r);
  }, t.prototype.execute = function(i, r) {
    if (this.closed) return new Error("executing a cancelled action");
    this.pending = false;
    var o = this._execute(i, r);
    if (o) return o;
    this.pending === false && this.id != null && (this.id = this.recycleAsyncId(this.scheduler, this.id, null));
  }, t.prototype._execute = function(i, r) {
    var o = false, a;
    try {
      this.work(i);
    } catch (u) {
      o = true, a = u || new Error("Scheduled action threw falsy error");
    }
    if (o) return this.unsubscribe(), a;
  }, t.prototype.unsubscribe = function() {
    if (!this.closed) {
      var i = this, r = i.id, o = i.scheduler, a = o.actions;
      this.work = this.state = this.scheduler = null, this.pending = false, Os(a, this), r != null && (this.id = this.recycleAsyncId(o, r, null)), this.delay = null, e.prototype.unsubscribe.call(this);
    }
  }, t;
}(Iw);
O();
O();
var Xc = function() {
  function e(t, i) {
    i === void 0 && (i = e.now), this.schedulerActionCtor = t, this.now = i;
  }
  return e.prototype.schedule = function(t, i, r) {
    return i === void 0 && (i = 0), new this.schedulerActionCtor(this, t).schedule(r, i);
  }, e.now = tl.now, e;
}();
var Rw = function(e) {
  Qt(t, e);
  function t(i, r) {
    r === void 0 && (r = Xc.now);
    var o = e.call(this, i, r) || this;
    return o.actions = [], o._active = false, o;
  }
  return t.prototype.flush = function(i) {
    var r = this.actions;
    if (this._active) {
      r.push(i);
      return;
    }
    var o;
    this._active = true;
    do
      if (o = i.execute(i.state, i.delay)) break;
    while (i = r.shift());
    if (this._active = false, o) {
      for (; i = r.shift(); ) i.unsubscribe();
      throw o;
    }
  }, t;
}(Xc);
O();
var sd = new Rw(Mw);
var Fw = sd;
O();
function Lw(e) {
  return e && Me(e.schedule);
}
O();
O();
var od = function(e) {
  return e && typeof e.length == "number" && typeof e != "function";
};
O();
function Nw(e) {
  return Me(e == null ? void 0 : e.then);
}
O();
function Dw(e) {
  return Me(e[el]);
}
O();
function jw(e) {
  return Symbol.asyncIterator && Me(e == null ? void 0 : e[Symbol.asyncIterator]);
}
O();
function Bw(e) {
  return new TypeError("You provided " + (e !== null && typeof e == "object" ? "an invalid object" : "'" + e + "'") + " where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.");
}
O();
O();
function Uw() {
  return typeof Symbol != "function" || !Symbol.iterator ? "@@iterator" : Symbol.iterator;
}
var $w = Uw();
function zw(e) {
  return Me(e == null ? void 0 : e[$w]);
}
O();
function Ww(e) {
  return gw(this, arguments, function() {
    var t, i, r, o;
    return Yh(this, function(a) {
      switch (a.label) {
        case 0:
          t = e.getReader(), a.label = 1;
        case 1:
          a.trys.push([1, , 9, 10]), a.label = 2;
        case 2:
          return [4, dn(t.read())];
        case 3:
          return i = a.sent(), r = i.value, o = i.done, o ? [4, dn(void 0)] : [3, 5];
        case 4:
          return [2, a.sent()];
        case 5:
          return [4, dn(r)];
        case 6:
          return [4, a.sent()];
        case 7:
          return a.sent(), [3, 2];
        case 8:
          return [3, 10];
        case 9:
          return t.releaseLock(), [7];
        case 10:
          return [2];
      }
    });
  });
}
function Vw(e) {
  return Me(e == null ? void 0 : e.getReader);
}
function _n(e) {
  if (e instanceof qt) return e;
  if (e != null) {
    if (Dw(e)) return Gw(e);
    if (od(e)) return Zw(e);
    if (Nw(e)) return Jw(e);
    if (jw(e)) return ad(e);
    if (zw(e)) return Hw(e);
    if (Vw(e)) return qw(e);
  }
  throw Bw(e);
}
function Gw(e) {
  return new qt(function(t) {
    var i = e[el]();
    if (Me(i.subscribe)) return i.subscribe(t);
    throw new TypeError("Provided object does not correctly implement Symbol.observable");
  });
}
function Zw(e) {
  return new qt(function(t) {
    for (var i = 0; i < e.length && !t.closed; i++) t.next(e[i]);
    t.complete();
  });
}
function Jw(e) {
  return new qt(function(t) {
    e.then(function(i) {
      t.closed || (t.next(i), t.complete());
    }, function(i) {
      return t.error(i);
    }).then(null, id);
  });
}
function Hw(e) {
  return new qt(function(t) {
    var i, r;
    try {
      for (var o = fn(e), a = o.next(); !a.done; a = o.next()) {
        var u = a.value;
        if (t.next(u), t.closed) return;
      }
    } catch (c) {
      i = { error: c };
    } finally {
      try {
        a && !a.done && (r = o.return) && r.call(o);
      } finally {
        if (i) throw i.error;
      }
    }
    t.complete();
  });
}
function ad(e) {
  return new qt(function(t) {
    Kw(e, t).catch(function(i) {
      return t.error(i);
    });
  });
}
function qw(e) {
  return ad(Ww(e));
}
function Kw(e, t) {
  var i, r, o, a;
  return vw(this, void 0, void 0, function() {
    var u, c;
    return Yh(this, function(p) {
      switch (p.label) {
        case 0:
          p.trys.push([0, 5, 6, 11]), i = yw(e), p.label = 1;
        case 1:
          return [4, i.next()];
        case 2:
          if (r = p.sent(), !!r.done) return [3, 4];
          if (u = r.value, t.next(u), t.closed) return [2];
          p.label = 3;
        case 3:
          return [3, 1];
        case 4:
          return [3, 11];
        case 5:
          return c = p.sent(), o = { error: c }, [3, 11];
        case 6:
          return p.trys.push([6, , 9, 10]), r && !r.done && (a = i.return) ? [4, a.call(i)] : [3, 8];
        case 7:
          p.sent(), p.label = 8;
        case 8:
          return [3, 10];
        case 9:
          if (o) throw o.error;
          return [7];
        case 10:
          return [7];
        case 11:
          return t.complete(), [2];
      }
    });
  });
}
O();
function Yw(e, t, i, r, o) {
  r === void 0 && (r = 0), o === void 0 && (o = false);
  var a = t.schedule(function() {
    i(), o ? e.add(this.schedule(null, r)) : this.unsubscribe();
  }, r);
  if (e.add(a), !o) return a;
}
O();
function Qw(e) {
  return e instanceof Date && !isNaN(e);
}
O();
O();
function ld(e, t) {
  return mr(function(i, r) {
    var o = 0;
    i.subscribe(mn(r, function(a) {
      r.next(e.call(t, a, o++));
    }));
  });
}
var Xw = Array.isArray;
function e_(e, t) {
  return Xw(t) ? e.apply(void 0, Gi([], ki(t))) : e(t);
}
function t_(e) {
  return ld(function(t) {
    return e_(e, t);
  });
}
O();
O();
function i_(e, t, i, r, o, a, u, c) {
  var p = [], h = 0, f = 0, m = false, y = function() {
    m && !p.length && !h && t.complete();
  }, g = function(E) {
    return h < r ? _(E) : p.push(E);
  }, _ = function(E) {
    h++;
    var R = false;
    _n(i(E, f++)).subscribe(mn(t, function(N) {
      t.next(N);
    }, function() {
      R = true;
    }, void 0, function() {
      if (R) try {
        h--;
        for (var N = function() {
          var j = p.shift();
          u ? Yw(t, u, function() {
            return _(j);
          }) : _(j);
        }; p.length && h < r; ) N();
        y();
      } catch (j) {
        t.error(j);
      }
    }));
  };
  return e.subscribe(mn(t, g, function() {
    m = true, y();
  })), function() {
  };
}
function ud(e, t, i) {
  return i === void 0 && (i = 1 / 0), Me(t) ? ud(function(r, o) {
    return ld(function(a, u) {
      return t(r, a, o, u);
    })(_n(e(r, o)));
  }, i) : (typeof t == "number" && (i = t), mr(function(r, o) {
    return i_(r, o, e, i);
  }));
}
O();
var n_ = ["addListener", "removeListener"];
var r_ = ["addEventListener", "removeEventListener"];
var s_ = ["on", "off"];
function Aa(e, t, i, r) {
  if (Me(i) && (r = i, i = void 0), r) return Aa(e, t, i).pipe(t_(r));
  var o = ki(l_(e) ? r_.map(function(c) {
    return function(p) {
      return e[c](t, p, i);
    };
  }) : o_(e) ? n_.map(eh(e, t)) : a_(e) ? s_.map(eh(e, t)) : [], 2), a = o[0], u = o[1];
  if (!a && od(e)) return ud(function(c) {
    return Aa(c, t, i);
  })(_n(e));
  if (!a) throw new TypeError("Invalid event target");
  return new qt(function(c) {
    var p = function() {
      for (var h = [], f = 0; f < arguments.length; f++) h[f] = arguments[f];
      return c.next(1 < h.length ? h : h[0]);
    };
    return a(p), function() {
      return u(p);
    };
  });
}
function eh(e, t) {
  return function(i) {
    return function(r) {
      return e[i](t, r);
    };
  };
}
function o_(e) {
  return Me(e.addListener) && Me(e.removeListener);
}
function a_(e) {
  return Me(e.on) && Me(e.off);
}
function l_(e) {
  return Me(e.addEventListener) && Me(e.removeEventListener);
}
O();
function u_(e, t, i) {
  i === void 0 && (i = Fw);
  var r = -1;
  return t != null && (Lw(t) ? i = t : r = t), new qt(function(o) {
    var a = Qw(e) ? +e - i.now() : e;
    a < 0 && (a = 0);
    var u = 0;
    return i.schedule(function() {
      o.closed || (o.next(u++), 0 <= r ? this.schedule(void 0, r) : o.complete());
    }, a);
  });
}
O();
function th(e, t) {
  return t === void 0 && (t = nd), e = e ?? c_, mr(function(i, r) {
    var o, a = true;
    i.subscribe(mn(r, function(u) {
      var c = t(u);
      (a || !e(o, c)) && (a = false, o = c, r.next(u));
    }));
  });
}
function c_(e, t) {
  return e === t;
}
O();
function h_(e) {
  e === void 0 && (e = {});
  var t = e.connector, i = t === void 0 ? function() {
    return new vr();
  } : t, r = e.resetOnError, o = r === void 0 ? true : r, a = e.resetOnComplete, u = a === void 0 ? true : a, c = e.resetOnRefCountZero, p = c === void 0 ? true : c;
  return function(h) {
    var f, m, y, g = 0, _ = false, E = false, R = function() {
      m == null || m.unsubscribe(), m = void 0;
    }, N = function() {
      R(), f = y = void 0, _ = E = false;
    }, j = function() {
      var B = f;
      N(), B == null || B.unsubscribe();
    };
    return mr(function(B, K) {
      g++, !E && !_ && R();
      var ie = y = y ?? i();
      K.add(function() {
        g--, g === 0 && !E && !_ && (m = fa(j, p));
      }), ie.subscribe(K), !f && g > 0 && (f = new Kn({ next: function(we) {
        return ie.next(we);
      }, error: function(we) {
        E = true, R(), m = fa(N, o, we), ie.error(we);
      }, complete: function() {
        _ = true, R(), m = fa(N, u), ie.complete();
      } }), _n(B).subscribe(f));
    })(h);
  };
}
function fa(e, t) {
  for (var i = [], r = 2; r < arguments.length; r++) i[r - 2] = arguments[r];
  if (t === true) {
    e();
    return;
  }
  if (t !== false) {
    var o = new Kn({ next: function() {
      o.unsubscribe(), e();
    } });
    return _n(t.apply(void 0, Gi([], ki(i)))).subscribe(o);
  }
}
O();
function ih(e, t, i) {
  var r, o, a, u, c = false;
  return e && typeof e == "object" ? (r = e.bufferSize, u = r === void 0 ? 1 / 0 : r, o = e.windowTime, t = o === void 0 ? 1 / 0 : o, a = e.refCount, c = a === void 0 ? false : a, i = e.scheduler) : u = e ?? 1 / 0, h_({ connector: function() {
    return new kw(u, t, i);
  }, resetOnError: true, resetOnComplete: false, resetOnRefCountZero: c });
}
O();
function d_(e, t) {
  return mr(function(i, r) {
    var o = t ?? {}, a = o.leading, u = a === void 0 ? true : a, c = o.trailing, p = c === void 0 ? false : c, h = false, f = null, m = null, y = false, g = function() {
      m == null || m.unsubscribe(), m = null, p && (R(), y && r.complete());
    }, _ = function() {
      m = null, y && r.complete();
    }, E = function(N) {
      return m = _n(e(N)).subscribe(mn(r, g, _));
    }, R = function() {
      if (h) {
        h = false;
        var N = f;
        f = null, r.next(N), !y && E(N);
      }
    };
    i.subscribe(mn(r, function(N) {
      h = true, f = N, !(m && !m.closed) && (u ? R() : E(N));
    }, function() {
      y = true, !(p && h && m && !m.closed) && r.complete();
    }));
  });
}
O();
function p_(e, t, i) {
  t === void 0 && (t = sd);
  var r = u_(e, t);
  return d_(function() {
    return r;
  }, i);
}
var f_ = class {
  constructor(e, t) {
    this.subscriptions = /* @__PURE__ */ new Map(), this.setValue = (i) => {
      this.state = i, this.subject.next(this.state);
    }, this.subscribe = (i, r) => {
      let o = this.subject.subscribe(r);
      if (this.subscriptions.has(i)) {
        this.subscriptions.get(i).push(o);
        return;
      }
      this.subscriptions.set(i, [o]);
    }, this.state = e, this.firstState = e, this.subject = t.pipe(th(), ih({ bufferSize: 1, refCount: true }));
  }
  getValue() {
    return this.state;
  }
  unsubscribe(e) {
    var t;
    (t = this.subscriptions.get(e)) == null || t.forEach((i) => i.unsubscribe()), this.subscriptions.delete(e);
  }
  destroy() {
    this.subscriptions.clear(), this.subject.complete(), this.restart();
  }
  restart() {
    this.state = this.firstState, this.subject = new rd(this.firstState).pipe(th(), ih({ bufferSize: 1, refCount: true }));
  }
  expose() {
    let e = this.subscribe.bind(this), t = this.unsubscribe.bind(this), i = this.getValue.bind(this), r = this.setValue.bind(this);
    return { get value() {
      return i();
    }, set value(o) {
      r(o);
    }, subscribe: e, unsubscribe: t };
  }
};
function Ae(e) {
  let t = new rd(e);
  return new f_(e, t);
}
var nh = pr();
var m_ = class {
  constructor() {
    if (this.localParticipant = Ae({}), this.participants = Ae({}), this.group = Ae(null), this.isDomainWhitelisted = Ae(true), this.hasJoinedRoom = Ae(false), nh.value) throw new Error("CommentsStore is a singleton. There can only be one instance of it.");
    nh.value = this;
  }
  destroy() {
    this.localParticipant.destroy(), this.participants.destroy(), this.group.destroy(), this.isDomainWhitelisted.destroy(), this.hasJoinedRoom.destroy();
  }
};
var Zi = new m_();
var v_ = Zi.destroy.bind(Zi);
var g_ = Zi.group.expose();
var y_ = Zi.participants.expose();
var b_ = Zi.localParticipant.expose();
var w_ = Zi.isDomainWhitelisted.expose();
var __ = Zi.hasJoinedRoom.expose();
function il() {
  return { localParticipant: b_, participants: y_, group: g_, isDomainWhitelisted: w_, hasJoinedRoom: __, destroy: v_ };
}
O();
O();
var rh = pr();
var C_ = class {
  constructor() {
    if (this.localParticipant = Ae({}), this.participants = Ae({}), rh.value) throw new Error("CoreStore is a singleton. There can only be one instance of it.");
    rh.value = this;
  }
  destroy() {
    this.localParticipant.destroy(), this.participants.destroy();
  }
};
var Ts = new C_();
var E_ = Ts.destroy.bind(Ts);
var P_ = Ts.localParticipant.expose();
var A_ = Ts.participants.expose();
function S_() {
  return { localParticipant: P_, participants: A_, destroy: E_ };
}
O();
var sh = pr();
var O_ = class {
  constructor() {
    if (this.hasJoined3D = Ae(false), this.participants = Ae([]), sh.value) throw new Error("Presence3DStore is a singleton. There can only be one instance of it.");
    sh.value = this;
  }
  destroy() {
    this.hasJoined3D.destroy(), this.participants.destroy();
  }
};
var xs = new O_();
var T_ = xs.destroy.bind(xs);
var x_ = xs.hasJoined3D.expose();
var k_ = xs.participants.expose();
function I_() {
  return { hasJoined3D: x_, participants: k_, destroy: T_ };
}
O();
O();
var cd = ((e) => (e[e.DISCONNECTED = 0] = "DISCONNECTED", e[e.INITIALIZING = 1] = "INITIALIZING", e[e.READY_TO_JOIN = 2] = "READY_TO_JOIN", e[e.CONNECTING = 3] = "CONNECTING", e[e.CONNECTED = 4] = "CONNECTED", e[e.JOINED = 5] = "JOINED", e[e.FAILED = -1] = "FAILED", e[e.RETRYING = -2] = "RETRYING", e))(cd || {});
var oh = pr();
var M_ = class {
  constructor() {
    if (this.meetingState = Ae(0), this.gather = Ae(false), this.hostId = Ae(""), this.isGridModeEnabled = Ae(false), this.followParticipantId = Ae(""), this.drawing = Ae(null), this.transcript = Ae(null), oh.value) throw new Error("VideoStore is a singleton. There can only be one instance of it.");
    oh.value = this;
  }
  destroy() {
    this.meetingState.destroy(), this.gather.destroy(), this.hostId.destroy(), this.isGridModeEnabled.destroy(), this.followParticipantId.destroy(), this.drawing.destroy(), this.transcript.destroy();
  }
};
var hi = new M_();
var R_ = hi.destroy.bind(hi);
var F_ = hi.meetingState.expose();
var L_ = hi.gather.expose();
var N_ = hi.hostId.expose();
var D_ = hi.isGridModeEnabled.expose();
var j_ = hi.followParticipantId.expose();
var B_ = hi.drawing.expose();
var U_ = hi.transcript.expose();
function $_() {
  return { meetingState: F_, gather: L_, destroy: R_, hostId: N_, isGridModeEnabled: D_, followParticipantId: j_, drawing: B_, transcript: U_ };
}
O();
var ah = pr();
var z_ = class {
  constructor() {
    if (this.disablePresenceControls = Ae(false), this.disableGoToParticipant = Ae(false), this.disableFollowParticipant = Ae(false), this.disablePrivateMode = Ae(false), this.disableGatherAll = Ae(false), this.disableFollowMe = Ae(false), this.participants = Ae([]), this.extras = Ae([]), this.joinedPresence = Ae(void 0), this.everyoneFollowsMe = Ae(false), this.privateMode = Ae(false), this.following = Ae(void 0), ah.value) throw new Error("WhoIsOnlineStore is a singleton. There can only be one instance of it.");
    ah.value = this;
  }
  destroy() {
    this.disableGoToParticipant.destroy(), this.disablePresenceControls.destroy(), this.disableFollowParticipant.destroy(), this.disablePrivateMode.destroy(), this.disableGatherAll.destroy(), this.disableFollowMe.destroy(), this.participants.destroy(), this.extras.destroy(), this.joinedPresence.destroy(), this.everyoneFollowsMe.destroy(), this.privateMode.destroy(), this.following.destroy();
  }
};
var ht = new z_();
var W_ = ht.destroy.bind(ht);
var V_ = ht.disablePresenceControls.expose();
var G_ = ht.disableGoToParticipant.expose();
var Z_ = ht.disableFollowParticipant.expose();
var J_ = ht.disablePrivateMode.expose();
var H_ = ht.disableGatherAll.expose();
var q_ = ht.disableFollowMe.expose();
var K_ = ht.joinedPresence.expose();
var Y_ = ht.participants.expose();
var Q_ = ht.extras.expose();
var X_ = ht.everyoneFollowsMe.expose();
var eC = ht.privateMode.expose();
var tC = ht.following.expose();
function iC() {
  return { disablePresenceControls: V_, disableGoToParticipant: G_, disableFollowParticipant: Z_, disablePrivateMode: J_, disableGatherAll: H_, disableFollowMe: q_, participants: Y_, extras: Q_, joinedPresence: K_, everyoneFollowsMe: X_, privateMode: eC, following: tC, destroy: W_ };
}
var nC = { "global-store": il, "who-is-online-store": iC, "video-store": $_, "presence-3d-store": I_, "core-store": S_ };
function rC(e, t, i) {
  t.subscribe(this, () => {
    i ? i(t.value) : this[e] = t.value, this.requestUpdate && this.requestUpdate();
  }), this.unsubscribeFrom || (this.unsubscribeFrom = []), this.unsubscribeFrom.push(t.unsubscribe);
}
function st(e) {
  let t = nC[e](), i = rC.bind(this);
  return new Proxy(t, { get(r, o) {
    return o === "destroy" ? r.destroy : { subscribe(a) {
      i(o, r[o], a);
    }, subject: r[o], get value() {
      return this.subject.value;
    }, publish(a) {
      this.subject.value = a;
    } };
  } });
}
var sC = We((e, t) => {
  O();
  var i = 1e3, r = i * 60, o = r * 60, a = o * 24, u = a * 7, c = a * 365.25;
  t.exports = function(y, g) {
    g = g || {};
    var _ = typeof y;
    if (_ === "string" && y.length > 0) return p(y);
    if (_ === "number" && isFinite(y)) return g.long ? f(y) : h(y);
    throw new Error("val is not a non-empty string or a valid number. val=" + JSON.stringify(y));
  };
  function p(y) {
    if (y = String(y), !(y.length > 100)) {
      var g = /^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);
      if (g) {
        var _ = parseFloat(g[1]), E = (g[2] || "ms").toLowerCase();
        switch (E) {
          case "years":
          case "year":
          case "yrs":
          case "yr":
          case "y":
            return _ * c;
          case "weeks":
          case "week":
          case "w":
            return _ * u;
          case "days":
          case "day":
          case "d":
            return _ * a;
          case "hours":
          case "hour":
          case "hrs":
          case "hr":
          case "h":
            return _ * o;
          case "minutes":
          case "minute":
          case "mins":
          case "min":
          case "m":
            return _ * r;
          case "seconds":
          case "second":
          case "secs":
          case "sec":
          case "s":
            return _ * i;
          case "milliseconds":
          case "millisecond":
          case "msecs":
          case "msec":
          case "ms":
            return _;
          default:
            return;
        }
      }
    }
  }
  function h(y) {
    var g = Math.abs(y);
    return g >= a ? Math.round(y / a) + "d" : g >= o ? Math.round(y / o) + "h" : g >= r ? Math.round(y / r) + "m" : g >= i ? Math.round(y / i) + "s" : y + "ms";
  }
  function f(y) {
    var g = Math.abs(y);
    return g >= a ? m(y, g, a, "day") : g >= o ? m(y, g, o, "hour") : g >= r ? m(y, g, r, "minute") : g >= i ? m(y, g, i, "second") : y + " ms";
  }
  function m(y, g, _, E) {
    var R = g >= _ * 1.5;
    return Math.round(y / _) + " " + E + (R ? "s" : "");
  }
});
var oC = We((e, t) => {
  O();
  function i(r) {
    a.debug = a, a.default = a, a.coerce = m, a.disable = p, a.enable = c, a.enabled = h, a.humanize = sC(), a.destroy = y, Object.keys(r).forEach((g) => {
      a[g] = r[g];
    }), a.names = [], a.skips = [], a.formatters = {};
    function o(g) {
      let _ = 0;
      for (let E = 0; E < g.length; E++) _ = (_ << 5) - _ + g.charCodeAt(E), _ |= 0;
      return a.colors[Math.abs(_) % a.colors.length];
    }
    a.selectColor = o;
    function a(g) {
      let _, E = null, R, N;
      function j(...B) {
        if (!j.enabled) return;
        let K = j, ie = Number(/* @__PURE__ */ new Date()), we = ie - (_ || ie);
        K.diff = we, K.prev = _, K.curr = ie, _ = ie, B[0] = a.coerce(B[0]), typeof B[0] != "string" && B.unshift("%O");
        let pe = 0;
        B[0] = B[0].replace(/%([a-zA-Z%])/g, (Se, Le) => {
          if (Se === "%%") return "%";
          pe++;
          let Oe = a.formatters[Le];
          if (typeof Oe == "function") {
            let xe = B[pe];
            Se = Oe.call(K, xe), B.splice(pe, 1), pe--;
          }
          return Se;
        }), a.formatArgs.call(K, B), (K.log || a.log).apply(K, B);
      }
      return j.namespace = g, j.useColors = a.useColors(), j.color = a.selectColor(g), j.extend = u, j.destroy = a.destroy, Object.defineProperty(j, "enabled", { enumerable: true, configurable: false, get: () => E !== null ? E : (R !== a.namespaces && (R = a.namespaces, N = a.enabled(g)), N), set: (B) => {
        E = B;
      } }), typeof a.init == "function" && a.init(j), j;
    }
    function u(g, _) {
      let E = a(this.namespace + (typeof _ > "u" ? ":" : _) + g);
      return E.log = this.log, E;
    }
    function c(g) {
      a.save(g), a.namespaces = g, a.names = [], a.skips = [];
      let _, E = (typeof g == "string" ? g : "").split(/[\s,]+/), R = E.length;
      for (_ = 0; _ < R; _++) E[_] && (g = E[_].replace(/\*/g, ".*?"), g[0] === "-" ? a.skips.push(new RegExp("^" + g.slice(1) + "$")) : a.names.push(new RegExp("^" + g + "$")));
    }
    function p() {
      let g = [...a.names.map(f), ...a.skips.map(f).map((_) => "-" + _)].join(",");
      return a.enable(""), g;
    }
    function h(g) {
      if (g[g.length - 1] === "*") return true;
      let _, E;
      for (_ = 0, E = a.skips.length; _ < E; _++) if (a.skips[_].test(g)) return false;
      for (_ = 0, E = a.names.length; _ < E; _++) if (a.names[_].test(g)) return true;
      return false;
    }
    function f(g) {
      return g.toString().substring(2, g.toString().length - 2).replace(/\.\*\?$/, "*");
    }
    function m(g) {
      return g instanceof Error ? g.stack || g.message : g;
    }
    function y() {
      console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");
    }
    return a.enable(a.load()), a;
  }
  t.exports = i;
});
var hd = We((e, t) => {
  O(), e.formatArgs = r, e.save = o, e.load = a, e.useColors = i, e.storage = u(), e.destroy = /* @__PURE__ */ (() => {
    let p = false;
    return () => {
      p || (p = true, console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."));
    };
  })(), e.colors = ["#0000CC", "#0000FF", "#0033CC", "#0033FF", "#0066CC", "#0066FF", "#0099CC", "#0099FF", "#00CC00", "#00CC33", "#00CC66", "#00CC99", "#00CCCC", "#00CCFF", "#3300CC", "#3300FF", "#3333CC", "#3333FF", "#3366CC", "#3366FF", "#3399CC", "#3399FF", "#33CC00", "#33CC33", "#33CC66", "#33CC99", "#33CCCC", "#33CCFF", "#6600CC", "#6600FF", "#6633CC", "#6633FF", "#66CC00", "#66CC33", "#9900CC", "#9900FF", "#9933CC", "#9933FF", "#99CC00", "#99CC33", "#CC0000", "#CC0033", "#CC0066", "#CC0099", "#CC00CC", "#CC00FF", "#CC3300", "#CC3333", "#CC3366", "#CC3399", "#CC33CC", "#CC33FF", "#CC6600", "#CC6633", "#CC9900", "#CC9933", "#CCCC00", "#CCCC33", "#FF0000", "#FF0033", "#FF0066", "#FF0099", "#FF00CC", "#FF00FF", "#FF3300", "#FF3333", "#FF3366", "#FF3399", "#FF33CC", "#FF33FF", "#FF6600", "#FF6633", "#FF9900", "#FF9933", "#FFCC00", "#FFCC33"];
  function i() {
    if (typeof window < "u" && window.process && (window.process.type === "renderer" || window.process.__nwjs)) return true;
    if (typeof navigator < "u" && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)) return false;
    let p;
    return typeof document < "u" && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance || typeof window < "u" && window.console && (window.console.firebug || window.console.exception && window.console.table) || typeof navigator < "u" && navigator.userAgent && (p = navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)) && parseInt(p[1], 10) >= 31 || typeof navigator < "u" && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/);
  }
  function r(p) {
    if (p[0] = (this.useColors ? "%c" : "") + this.namespace + (this.useColors ? " %c" : " ") + p[0] + (this.useColors ? "%c " : " ") + "+" + t.exports.humanize(this.diff), !this.useColors) return;
    let h = "color: " + this.color;
    p.splice(1, 0, h, "color: inherit");
    let f = 0, m = 0;
    p[0].replace(/%[a-zA-Z%]/g, (y) => {
      y !== "%%" && (f++, y === "%c" && (m = f));
    }), p.splice(m, 0, h);
  }
  e.log = console.debug || console.log || (() => {
  });
  function o(p) {
    try {
      p ? e.storage.setItem("debug", p) : e.storage.removeItem("debug");
    } catch {
    }
  }
  function a() {
    let p;
    try {
      p = e.storage.getItem("debug");
    } catch {
    }
    return !p && typeof process < "u" && "env" in process && (p = Ya.DEBUG), p;
  }
  function u() {
    try {
      return localStorage;
    } catch {
    }
  }
  t.exports = oC()(e);
  var { formatters: c } = t.exports;
  c.j = function(p) {
    try {
      return JSON.stringify(p);
    } catch (h) {
      return "[UnexpectedJSONParseError]: " + h.message;
    }
  };
});
var nl = We((e, t) => {
  O();
  function i(r) {
    var o = typeof r;
    return r != null && (o == "object" || o == "function");
  }
  t.exports = i;
});
var aC = We((e, t) => {
  O();
  var i = typeof window == "object" && window && window.Object === Object && window;
  t.exports = i;
});
var dd = We((e, t) => {
  O();
  var i = aC(), r = typeof self == "object" && self && self.Object === Object && self, o = i || r || Function("return this")();
  t.exports = o;
});
var lC = We((e, t) => {
  O();
  var i = dd(), r = function() {
    return i.Date.now();
  };
  t.exports = r;
});
var uC = We((e, t) => {
  O();
  var i = /\s/;
  function r(o) {
    for (var a = o.length; a-- && i.test(o.charAt(a)); ) ;
    return a;
  }
  t.exports = r;
});
var cC = We((e, t) => {
  O();
  var i = uC(), r = /^\s+/;
  function o(a) {
    return a && a.slice(0, i(a) + 1).replace(r, "");
  }
  t.exports = o;
});
var pd = We((e, t) => {
  O();
  var i = dd(), r = i.Symbol;
  t.exports = r;
});
var hC = We((e, t) => {
  O();
  var i = pd(), r = Object.prototype, o = r.hasOwnProperty, a = r.toString, u = i ? i.toStringTag : void 0;
  function c(p) {
    var h = o.call(p, u), f = p[u];
    try {
      p[u] = void 0;
      var m = true;
    } catch {
    }
    var y = a.call(p);
    return m && (h ? p[u] = f : delete p[u]), y;
  }
  t.exports = c;
});
var dC = We((e, t) => {
  O();
  var i = Object.prototype, r = i.toString;
  function o(a) {
    return r.call(a);
  }
  t.exports = o;
});
var pC = We((e, t) => {
  O();
  var i = pd(), r = hC(), o = dC(), a = "[object Null]", u = "[object Undefined]", c = i ? i.toStringTag : void 0;
  function p(h) {
    return h == null ? h === void 0 ? u : a : c && c in Object(h) ? r(h) : o(h);
  }
  t.exports = p;
});
var fC = We((e, t) => {
  O();
  function i(r) {
    return r != null && typeof r == "object";
  }
  t.exports = i;
});
var mC = We((e, t) => {
  O();
  var i = pC(), r = fC(), o = "[object Symbol]";
  function a(u) {
    return typeof u == "symbol" || r(u) && i(u) == o;
  }
  t.exports = a;
});
var vC = We((e, t) => {
  O();
  var i = cC(), r = nl(), o = mC(), a = NaN, u = /^[-+]0x[0-9a-f]+$/i, c = /^0b[01]+$/i, p = /^0o[0-7]+$/i, h = parseInt;
  function f(m) {
    if (typeof m == "number") return m;
    if (o(m)) return a;
    if (r(m)) {
      var y = typeof m.valueOf == "function" ? m.valueOf() : m;
      m = r(y) ? y + "" : y;
    }
    if (typeof m != "string") return m === 0 ? m : +m;
    m = i(m);
    var g = c.test(m);
    return g || p.test(m) ? h(m.slice(2), g ? 2 : 8) : u.test(m) ? a : +m;
  }
  t.exports = f;
});
var gC = We((e, t) => {
  O();
  var i = nl(), r = lC(), o = vC(), a = "Expected a function", u = Math.max, c = Math.min;
  function p(h, f, m) {
    var y, g, _, E, R, N, j = 0, B = false, K = false, ie = true;
    if (typeof h != "function") throw new TypeError(a);
    f = o(f) || 0, i(m) && (B = !!m.leading, K = "maxWait" in m, _ = K ? u(o(m.maxWait) || 0, f) : _, ie = "trailing" in m ? !!m.trailing : ie);
    function we(Ee) {
      var V = y, ve = g;
      return y = g = void 0, j = Ee, E = h.apply(ve, V), E;
    }
    function pe(Ee) {
      return j = Ee, R = setTimeout(Oe, f), B ? we(Ee) : E;
    }
    function Se(Ee) {
      var V = Ee - N, ve = Ee - j, oe = f - V;
      return K ? c(oe, _ - ve) : oe;
    }
    function Le(Ee) {
      var V = Ee - N, ve = Ee - j;
      return N === void 0 || V >= f || V < 0 || K && ve >= _;
    }
    function Oe() {
      var Ee = r();
      if (Le(Ee)) return xe(Ee);
      R = setTimeout(Oe, Se(Ee));
    }
    function xe(Ee) {
      return R = void 0, ie && y ? we(Ee) : (y = g = void 0, E);
    }
    function tt() {
      R !== void 0 && clearTimeout(R), j = 0, y = N = g = R = void 0;
    }
    function fi() {
      return R === void 0 ? E : xe(r());
    }
    function pt() {
      var Ee = r(), V = Le(Ee);
      if (y = arguments, g = this, N = Ee, V) {
        if (R === void 0) return pe(N);
        if (K) return clearTimeout(R), R = setTimeout(Oe, f), we(N);
      }
      return R === void 0 && (R = setTimeout(Oe, f)), E;
    }
    return pt.cancel = tt, pt.flush = fi, pt;
  }
  t.exports = p;
});
var fd = We((e, t) => {
  O();
  var i = gC(), r = nl(), o = "Expected a function";
  function a(u, c, p) {
    var h = true, f = true;
    if (typeof u != "function") throw new TypeError(o);
    return r(p) && (h = "leading" in p ? !!p.leading : h, f = "trailing" in p ? !!p.trailing : f), i(u, c, { leading: h, maxWait: c, trailing: f });
  }
  t.exports = a;
});
var yC = We((e, t) => {
  O(), function(i, r) {
    typeof e == "object" && typeof t == "object" ? t.exports = r() : typeof define == "function" && define.amd ? define([], r) : typeof e == "object" ? e.bowser = r() : i.bowser = r();
  }(e, function() {
    return function(i) {
      var r = {};
      function o(a) {
        if (r[a]) return r[a].exports;
        var u = r[a] = { i: a, l: false, exports: {} };
        return i[a].call(u.exports, u, u.exports, o), u.l = true, u.exports;
      }
      return o.m = i, o.c = r, o.d = function(a, u, c) {
        o.o(a, u) || Object.defineProperty(a, u, { enumerable: true, get: c });
      }, o.r = function(a) {
        typeof Symbol < "u" && Symbol.toStringTag && Object.defineProperty(a, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(a, "__esModule", { value: true });
      }, o.t = function(a, u) {
        if (1 & u && (a = o(a)), 8 & u || 4 & u && typeof a == "object" && a && a.__esModule) return a;
        var c = /* @__PURE__ */ Object.create(null);
        if (o.r(c), Object.defineProperty(c, "default", { enumerable: true, value: a }), 2 & u && typeof a != "string") for (var p in a) o.d(c, p, (function(h) {
          return a[h];
        }).bind(null, p));
        return c;
      }, o.n = function(a) {
        var u = a && a.__esModule ? function() {
          return a.default;
        } : function() {
          return a;
        };
        return o.d(u, "a", u), u;
      }, o.o = function(a, u) {
        return Object.prototype.hasOwnProperty.call(a, u);
      }, o.p = "", o(o.s = 90);
    }({ 17: function(i, r, o) {
      r.__esModule = true, r.default = void 0;
      var a = o(18), u = function() {
        function c() {
        }
        return c.getFirstMatch = function(p, h) {
          var f = h.match(p);
          return f && f.length > 0 && f[1] || "";
        }, c.getSecondMatch = function(p, h) {
          var f = h.match(p);
          return f && f.length > 1 && f[2] || "";
        }, c.matchAndReturnConst = function(p, h, f) {
          if (p.test(h)) return f;
        }, c.getWindowsVersionName = function(p) {
          switch (p) {
            case "NT":
              return "NT";
            case "XP":
              return "XP";
            case "NT 5.0":
              return "2000";
            case "NT 5.1":
              return "XP";
            case "NT 5.2":
              return "2003";
            case "NT 6.0":
              return "Vista";
            case "NT 6.1":
              return "7";
            case "NT 6.2":
              return "8";
            case "NT 6.3":
              return "8.1";
            case "NT 10.0":
              return "10";
            default:
              return;
          }
        }, c.getMacOSVersionName = function(p) {
          var h = p.split(".").splice(0, 2).map(function(f) {
            return parseInt(f, 10) || 0;
          });
          if (h.push(0), h[0] === 10) switch (h[1]) {
            case 5:
              return "Leopard";
            case 6:
              return "Snow Leopard";
            case 7:
              return "Lion";
            case 8:
              return "Mountain Lion";
            case 9:
              return "Mavericks";
            case 10:
              return "Yosemite";
            case 11:
              return "El Capitan";
            case 12:
              return "Sierra";
            case 13:
              return "High Sierra";
            case 14:
              return "Mojave";
            case 15:
              return "Catalina";
            default:
              return;
          }
        }, c.getAndroidVersionName = function(p) {
          var h = p.split(".").splice(0, 2).map(function(f) {
            return parseInt(f, 10) || 0;
          });
          if (h.push(0), !(h[0] === 1 && h[1] < 5)) return h[0] === 1 && h[1] < 6 ? "Cupcake" : h[0] === 1 && h[1] >= 6 ? "Donut" : h[0] === 2 && h[1] < 2 ? "Eclair" : h[0] === 2 && h[1] === 2 ? "Froyo" : h[0] === 2 && h[1] > 2 ? "Gingerbread" : h[0] === 3 ? "Honeycomb" : h[0] === 4 && h[1] < 1 ? "Ice Cream Sandwich" : h[0] === 4 && h[1] < 4 ? "Jelly Bean" : h[0] === 4 && h[1] >= 4 ? "KitKat" : h[0] === 5 ? "Lollipop" : h[0] === 6 ? "Marshmallow" : h[0] === 7 ? "Nougat" : h[0] === 8 ? "Oreo" : h[0] === 9 ? "Pie" : void 0;
        }, c.getVersionPrecision = function(p) {
          return p.split(".").length;
        }, c.compareVersions = function(p, h, f) {
          f === void 0 && (f = false);
          var m = c.getVersionPrecision(p), y = c.getVersionPrecision(h), g = Math.max(m, y), _ = 0, E = c.map([p, h], function(R) {
            var N = g - c.getVersionPrecision(R), j = R + new Array(N + 1).join(".0");
            return c.map(j.split("."), function(B) {
              return new Array(20 - B.length).join("0") + B;
            }).reverse();
          });
          for (f && (_ = g - Math.min(m, y)), g -= 1; g >= _; ) {
            if (E[0][g] > E[1][g]) return 1;
            if (E[0][g] === E[1][g]) {
              if (g === _) return 0;
              g -= 1;
            } else if (E[0][g] < E[1][g]) return -1;
          }
        }, c.map = function(p, h) {
          var f, m = [];
          if (Array.prototype.map) return Array.prototype.map.call(p, h);
          for (f = 0; f < p.length; f += 1) m.push(h(p[f]));
          return m;
        }, c.find = function(p, h) {
          var f, m;
          if (Array.prototype.find) return Array.prototype.find.call(p, h);
          for (f = 0, m = p.length; f < m; f += 1) {
            var y = p[f];
            if (h(y, f)) return y;
          }
        }, c.assign = function(p) {
          for (var h, f, m = p, y = arguments.length, g = new Array(y > 1 ? y - 1 : 0), _ = 1; _ < y; _++) g[_ - 1] = arguments[_];
          if (Object.assign) return Object.assign.apply(Object, [p].concat(g));
          var E = function() {
            var R = g[h];
            typeof R == "object" && R !== null && Object.keys(R).forEach(function(N) {
              m[N] = R[N];
            });
          };
          for (h = 0, f = g.length; h < f; h += 1) E();
          return p;
        }, c.getBrowserAlias = function(p) {
          return a.BROWSER_ALIASES_MAP[p];
        }, c.getBrowserTypeByAlias = function(p) {
          return a.BROWSER_MAP[p] || "";
        }, c;
      }();
      r.default = u, i.exports = r.default;
    }, 18: function(i, r, o) {
      r.__esModule = true, r.ENGINE_MAP = r.OS_MAP = r.PLATFORMS_MAP = r.BROWSER_MAP = r.BROWSER_ALIASES_MAP = void 0, r.BROWSER_ALIASES_MAP = { "Amazon Silk": "amazon_silk", "Android Browser": "android", Bada: "bada", BlackBerry: "blackberry", Chrome: "chrome", Chromium: "chromium", Electron: "electron", Epiphany: "epiphany", Firefox: "firefox", Focus: "focus", Generic: "generic", "Google Search": "google_search", Googlebot: "googlebot", "Internet Explorer": "ie", "K-Meleon": "k_meleon", Maxthon: "maxthon", "Microsoft Edge": "edge", "MZ Browser": "mz", "NAVER Whale Browser": "naver", Opera: "opera", "Opera Coast": "opera_coast", PhantomJS: "phantomjs", Puffin: "puffin", QupZilla: "qupzilla", QQ: "qq", QQLite: "qqlite", Safari: "safari", Sailfish: "sailfish", "Samsung Internet for Android": "samsung_internet", SeaMonkey: "seamonkey", Sleipnir: "sleipnir", Swing: "swing", Tizen: "tizen", "UC Browser": "uc", Vivaldi: "vivaldi", "WebOS Browser": "webos", WeChat: "wechat", "Yandex Browser": "yandex", Roku: "roku" }, r.BROWSER_MAP = { amazon_silk: "Amazon Silk", android: "Android Browser", bada: "Bada", blackberry: "BlackBerry", chrome: "Chrome", chromium: "Chromium", electron: "Electron", epiphany: "Epiphany", firefox: "Firefox", focus: "Focus", generic: "Generic", googlebot: "Googlebot", google_search: "Google Search", ie: "Internet Explorer", k_meleon: "K-Meleon", maxthon: "Maxthon", edge: "Microsoft Edge", mz: "MZ Browser", naver: "NAVER Whale Browser", opera: "Opera", opera_coast: "Opera Coast", phantomjs: "PhantomJS", puffin: "Puffin", qupzilla: "QupZilla", qq: "QQ Browser", qqlite: "QQ Browser Lite", safari: "Safari", sailfish: "Sailfish", samsung_internet: "Samsung Internet for Android", seamonkey: "SeaMonkey", sleipnir: "Sleipnir", swing: "Swing", tizen: "Tizen", uc: "UC Browser", vivaldi: "Vivaldi", webos: "WebOS Browser", wechat: "WeChat", yandex: "Yandex Browser" }, r.PLATFORMS_MAP = { tablet: "tablet", mobile: "mobile", desktop: "desktop", tv: "tv" }, r.OS_MAP = { WindowsPhone: "Windows Phone", Windows: "Windows", MacOS: "macOS", iOS: "iOS", Android: "Android", WebOS: "WebOS", BlackBerry: "BlackBerry", Bada: "Bada", Tizen: "Tizen", Linux: "Linux", ChromeOS: "Chrome OS", PlayStation4: "PlayStation 4", Roku: "Roku" }, r.ENGINE_MAP = { EdgeHTML: "EdgeHTML", Blink: "Blink", Trident: "Trident", Presto: "Presto", Gecko: "Gecko", WebKit: "WebKit" };
    }, 90: function(i, r, o) {
      r.__esModule = true, r.default = void 0;
      var a, u = (a = o(91)) && a.__esModule ? a : { default: a }, c = o(18);
      function p(f, m) {
        for (var y = 0; y < m.length; y++) {
          var g = m[y];
          g.enumerable = g.enumerable || false, g.configurable = true, "value" in g && (g.writable = true), Object.defineProperty(f, g.key, g);
        }
      }
      var h = function() {
        function f() {
        }
        var m, y, g;
        return f.getParser = function(_, E) {
          if (E === void 0 && (E = false), typeof _ != "string") throw new Error("UserAgent should be a string");
          return new u.default(_, E);
        }, f.parse = function(_) {
          return new u.default(_).getResult();
        }, m = f, g = [{ key: "BROWSER_MAP", get: function() {
          return c.BROWSER_MAP;
        } }, { key: "ENGINE_MAP", get: function() {
          return c.ENGINE_MAP;
        } }, { key: "OS_MAP", get: function() {
          return c.OS_MAP;
        } }, { key: "PLATFORMS_MAP", get: function() {
          return c.PLATFORMS_MAP;
        } }], (y = null) && p(m.prototype, y), g && p(m, g), f;
      }();
      r.default = h, i.exports = r.default;
    }, 91: function(i, r, o) {
      r.__esModule = true, r.default = void 0;
      var a = f(o(92)), u = f(o(93)), c = f(o(94)), p = f(o(95)), h = f(o(17));
      function f(y) {
        return y && y.__esModule ? y : { default: y };
      }
      var m = function() {
        function y(_, E) {
          if (E === void 0 && (E = false), _ == null || _ === "") throw new Error("UserAgent parameter can't be empty");
          this._ua = _, this.parsedResult = {}, E !== true && this.parse();
        }
        var g = y.prototype;
        return g.getUA = function() {
          return this._ua;
        }, g.test = function(_) {
          return _.test(this._ua);
        }, g.parseBrowser = function() {
          var _ = this;
          this.parsedResult.browser = {};
          var E = h.default.find(a.default, function(R) {
            if (typeof R.test == "function") return R.test(_);
            if (R.test instanceof Array) return R.test.some(function(N) {
              return _.test(N);
            });
            throw new Error("Browser's test function is not valid");
          });
          return E && (this.parsedResult.browser = E.describe(this.getUA())), this.parsedResult.browser;
        }, g.getBrowser = function() {
          return this.parsedResult.browser ? this.parsedResult.browser : this.parseBrowser();
        }, g.getBrowserName = function(_) {
          return _ ? String(this.getBrowser().name).toLowerCase() || "" : this.getBrowser().name || "";
        }, g.getBrowserVersion = function() {
          return this.getBrowser().version;
        }, g.getOS = function() {
          return this.parsedResult.os ? this.parsedResult.os : this.parseOS();
        }, g.parseOS = function() {
          var _ = this;
          this.parsedResult.os = {};
          var E = h.default.find(u.default, function(R) {
            if (typeof R.test == "function") return R.test(_);
            if (R.test instanceof Array) return R.test.some(function(N) {
              return _.test(N);
            });
            throw new Error("Browser's test function is not valid");
          });
          return E && (this.parsedResult.os = E.describe(this.getUA())), this.parsedResult.os;
        }, g.getOSName = function(_) {
          var E = this.getOS().name;
          return _ ? String(E).toLowerCase() || "" : E || "";
        }, g.getOSVersion = function() {
          return this.getOS().version;
        }, g.getPlatform = function() {
          return this.parsedResult.platform ? this.parsedResult.platform : this.parsePlatform();
        }, g.getPlatformType = function(_) {
          _ === void 0 && (_ = false);
          var E = this.getPlatform().type;
          return _ ? String(E).toLowerCase() || "" : E || "";
        }, g.parsePlatform = function() {
          var _ = this;
          this.parsedResult.platform = {};
          var E = h.default.find(c.default, function(R) {
            if (typeof R.test == "function") return R.test(_);
            if (R.test instanceof Array) return R.test.some(function(N) {
              return _.test(N);
            });
            throw new Error("Browser's test function is not valid");
          });
          return E && (this.parsedResult.platform = E.describe(this.getUA())), this.parsedResult.platform;
        }, g.getEngine = function() {
          return this.parsedResult.engine ? this.parsedResult.engine : this.parseEngine();
        }, g.getEngineName = function(_) {
          return _ ? String(this.getEngine().name).toLowerCase() || "" : this.getEngine().name || "";
        }, g.parseEngine = function() {
          var _ = this;
          this.parsedResult.engine = {};
          var E = h.default.find(p.default, function(R) {
            if (typeof R.test == "function") return R.test(_);
            if (R.test instanceof Array) return R.test.some(function(N) {
              return _.test(N);
            });
            throw new Error("Browser's test function is not valid");
          });
          return E && (this.parsedResult.engine = E.describe(this.getUA())), this.parsedResult.engine;
        }, g.parse = function() {
          return this.parseBrowser(), this.parseOS(), this.parsePlatform(), this.parseEngine(), this;
        }, g.getResult = function() {
          return h.default.assign({}, this.parsedResult);
        }, g.satisfies = function(_) {
          var E = this, R = {}, N = 0, j = {}, B = 0;
          if (Object.keys(_).forEach(function(xe) {
            var tt = _[xe];
            typeof tt == "string" ? (j[xe] = tt, B += 1) : typeof tt == "object" && (R[xe] = tt, N += 1);
          }), N > 0) {
            var K = Object.keys(R), ie = h.default.find(K, function(xe) {
              return E.isOS(xe);
            });
            if (ie) {
              var we = this.satisfies(R[ie]);
              if (we !== void 0) return we;
            }
            var pe = h.default.find(K, function(xe) {
              return E.isPlatform(xe);
            });
            if (pe) {
              var Se = this.satisfies(R[pe]);
              if (Se !== void 0) return Se;
            }
          }
          if (B > 0) {
            var Le = Object.keys(j), Oe = h.default.find(Le, function(xe) {
              return E.isBrowser(xe, true);
            });
            if (Oe !== void 0) return this.compareVersion(j[Oe]);
          }
        }, g.isBrowser = function(_, E) {
          E === void 0 && (E = false);
          var R = this.getBrowserName().toLowerCase(), N = _.toLowerCase(), j = h.default.getBrowserTypeByAlias(N);
          return E && j && (N = j.toLowerCase()), N === R;
        }, g.compareVersion = function(_) {
          var E = [0], R = _, N = false, j = this.getBrowserVersion();
          if (typeof j == "string") return _[0] === ">" || _[0] === "<" ? (R = _.substr(1), _[1] === "=" ? (N = true, R = _.substr(2)) : E = [], _[0] === ">" ? E.push(1) : E.push(-1)) : _[0] === "=" ? R = _.substr(1) : _[0] === "~" && (N = true, R = _.substr(1)), E.indexOf(h.default.compareVersions(j, R, N)) > -1;
        }, g.isOS = function(_) {
          return this.getOSName(true) === String(_).toLowerCase();
        }, g.isPlatform = function(_) {
          return this.getPlatformType(true) === String(_).toLowerCase();
        }, g.isEngine = function(_) {
          return this.getEngineName(true) === String(_).toLowerCase();
        }, g.is = function(_, E) {
          return E === void 0 && (E = false), this.isBrowser(_, E) || this.isOS(_) || this.isPlatform(_);
        }, g.some = function(_) {
          var E = this;
          return _ === void 0 && (_ = []), _.some(function(R) {
            return E.is(R);
          });
        }, y;
      }();
      r.default = m, i.exports = r.default;
    }, 92: function(i, r, o) {
      r.__esModule = true, r.default = void 0;
      var a, u = (a = o(17)) && a.__esModule ? a : { default: a }, c = /version\/(\d+(\.?_?\d+)+)/i, p = [{ test: [/googlebot/i], describe: function(h) {
        var f = { name: "Googlebot" }, m = u.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i, h) || u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/opera/i], describe: function(h) {
        var f = { name: "Opera" }, m = u.default.getFirstMatch(c, h) || u.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/opr\/|opios/i], describe: function(h) {
        var f = { name: "Opera" }, m = u.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i, h) || u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/SamsungBrowser/i], describe: function(h) {
        var f = { name: "Samsung Internet for Android" }, m = u.default.getFirstMatch(c, h) || u.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/Whale/i], describe: function(h) {
        var f = { name: "NAVER Whale Browser" }, m = u.default.getFirstMatch(c, h) || u.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/MZBrowser/i], describe: function(h) {
        var f = { name: "MZ Browser" }, m = u.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i, h) || u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/focus/i], describe: function(h) {
        var f = { name: "Focus" }, m = u.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i, h) || u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/swing/i], describe: function(h) {
        var f = { name: "Swing" }, m = u.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i, h) || u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/coast/i], describe: function(h) {
        var f = { name: "Opera Coast" }, m = u.default.getFirstMatch(c, h) || u.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/opt\/\d+(?:.?_?\d+)+/i], describe: function(h) {
        var f = { name: "Opera Touch" }, m = u.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i, h) || u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/yabrowser/i], describe: function(h) {
        var f = { name: "Yandex Browser" }, m = u.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i, h) || u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/ucbrowser/i], describe: function(h) {
        var f = { name: "UC Browser" }, m = u.default.getFirstMatch(c, h) || u.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/Maxthon|mxios/i], describe: function(h) {
        var f = { name: "Maxthon" }, m = u.default.getFirstMatch(c, h) || u.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/epiphany/i], describe: function(h) {
        var f = { name: "Epiphany" }, m = u.default.getFirstMatch(c, h) || u.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/puffin/i], describe: function(h) {
        var f = { name: "Puffin" }, m = u.default.getFirstMatch(c, h) || u.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/sleipnir/i], describe: function(h) {
        var f = { name: "Sleipnir" }, m = u.default.getFirstMatch(c, h) || u.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/k-meleon/i], describe: function(h) {
        var f = { name: "K-Meleon" }, m = u.default.getFirstMatch(c, h) || u.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/micromessenger/i], describe: function(h) {
        var f = { name: "WeChat" }, m = u.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i, h) || u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/qqbrowser/i], describe: function(h) {
        var f = { name: /qqbrowserlite/i.test(h) ? "QQ Browser Lite" : "QQ Browser" }, m = u.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i, h) || u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/msie|trident/i], describe: function(h) {
        var f = { name: "Internet Explorer" }, m = u.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/\sedg\//i], describe: function(h) {
        var f = { name: "Microsoft Edge" }, m = u.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/edg([ea]|ios)/i], describe: function(h) {
        var f = { name: "Microsoft Edge" }, m = u.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/vivaldi/i], describe: function(h) {
        var f = { name: "Vivaldi" }, m = u.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/seamonkey/i], describe: function(h) {
        var f = { name: "SeaMonkey" }, m = u.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/sailfish/i], describe: function(h) {
        var f = { name: "Sailfish" }, m = u.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/silk/i], describe: function(h) {
        var f = { name: "Amazon Silk" }, m = u.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/phantom/i], describe: function(h) {
        var f = { name: "PhantomJS" }, m = u.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/slimerjs/i], describe: function(h) {
        var f = { name: "SlimerJS" }, m = u.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/blackberry|\bbb\d+/i, /rim\stablet/i], describe: function(h) {
        var f = { name: "BlackBerry" }, m = u.default.getFirstMatch(c, h) || u.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/(web|hpw)[o0]s/i], describe: function(h) {
        var f = { name: "WebOS Browser" }, m = u.default.getFirstMatch(c, h) || u.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/bada/i], describe: function(h) {
        var f = { name: "Bada" }, m = u.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/tizen/i], describe: function(h) {
        var f = { name: "Tizen" }, m = u.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i, h) || u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/qupzilla/i], describe: function(h) {
        var f = { name: "QupZilla" }, m = u.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i, h) || u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/firefox|iceweasel|fxios/i], describe: function(h) {
        var f = { name: "Firefox" }, m = u.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/electron/i], describe: function(h) {
        var f = { name: "Electron" }, m = u.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/MiuiBrowser/i], describe: function(h) {
        var f = { name: "Miui" }, m = u.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/chromium/i], describe: function(h) {
        var f = { name: "Chromium" }, m = u.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i, h) || u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/chrome|crios|crmo/i], describe: function(h) {
        var f = { name: "Chrome" }, m = u.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/GSA/i], describe: function(h) {
        var f = { name: "Google Search" }, m = u.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: function(h) {
        var f = !h.test(/like android/i), m = h.test(/android/i);
        return f && m;
      }, describe: function(h) {
        var f = { name: "Android Browser" }, m = u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/playstation 4/i], describe: function(h) {
        var f = { name: "PlayStation 4" }, m = u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/safari|applewebkit/i], describe: function(h) {
        var f = { name: "Safari" }, m = u.default.getFirstMatch(c, h);
        return m && (f.version = m), f;
      } }, { test: [/.*/i], describe: function(h) {
        var f = h.search("\\(") !== -1 ? /^(.*)\/(.*)[ \t]\((.*)/ : /^(.*)\/(.*) /;
        return { name: u.default.getFirstMatch(f, h), version: u.default.getSecondMatch(f, h) };
      } }];
      r.default = p, i.exports = r.default;
    }, 93: function(i, r, o) {
      r.__esModule = true, r.default = void 0;
      var a, u = (a = o(17)) && a.__esModule ? a : { default: a }, c = o(18), p = [{ test: [/Roku\/DVP/], describe: function(h) {
        var f = u.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i, h);
        return { name: c.OS_MAP.Roku, version: f };
      } }, { test: [/windows phone/i], describe: function(h) {
        var f = u.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i, h);
        return { name: c.OS_MAP.WindowsPhone, version: f };
      } }, { test: [/windows /i], describe: function(h) {
        var f = u.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i, h), m = u.default.getWindowsVersionName(f);
        return { name: c.OS_MAP.Windows, version: f, versionName: m };
      } }, { test: [/Macintosh(.*?) FxiOS(.*?)\//], describe: function(h) {
        var f = { name: c.OS_MAP.iOS }, m = u.default.getSecondMatch(/(Version\/)(\d[\d.]+)/, h);
        return m && (f.version = m), f;
      } }, { test: [/macintosh/i], describe: function(h) {
        var f = u.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i, h).replace(/[_\s]/g, "."), m = u.default.getMacOSVersionName(f), y = { name: c.OS_MAP.MacOS, version: f };
        return m && (y.versionName = m), y;
      } }, { test: [/(ipod|iphone|ipad)/i], describe: function(h) {
        var f = u.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i, h).replace(/[_\s]/g, ".");
        return { name: c.OS_MAP.iOS, version: f };
      } }, { test: function(h) {
        var f = !h.test(/like android/i), m = h.test(/android/i);
        return f && m;
      }, describe: function(h) {
        var f = u.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i, h), m = u.default.getAndroidVersionName(f), y = { name: c.OS_MAP.Android, version: f };
        return m && (y.versionName = m), y;
      } }, { test: [/(web|hpw)[o0]s/i], describe: function(h) {
        var f = u.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i, h), m = { name: c.OS_MAP.WebOS };
        return f && f.length && (m.version = f), m;
      } }, { test: [/blackberry|\bbb\d+/i, /rim\stablet/i], describe: function(h) {
        var f = u.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i, h) || u.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i, h) || u.default.getFirstMatch(/\bbb(\d+)/i, h);
        return { name: c.OS_MAP.BlackBerry, version: f };
      } }, { test: [/bada/i], describe: function(h) {
        var f = u.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i, h);
        return { name: c.OS_MAP.Bada, version: f };
      } }, { test: [/tizen/i], describe: function(h) {
        var f = u.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i, h);
        return { name: c.OS_MAP.Tizen, version: f };
      } }, { test: [/linux/i], describe: function() {
        return { name: c.OS_MAP.Linux };
      } }, { test: [/CrOS/], describe: function() {
        return { name: c.OS_MAP.ChromeOS };
      } }, { test: [/PlayStation 4/], describe: function(h) {
        var f = u.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i, h);
        return { name: c.OS_MAP.PlayStation4, version: f };
      } }];
      r.default = p, i.exports = r.default;
    }, 94: function(i, r, o) {
      r.__esModule = true, r.default = void 0;
      var a, u = (a = o(17)) && a.__esModule ? a : { default: a }, c = o(18), p = [{ test: [/googlebot/i], describe: function() {
        return { type: "bot", vendor: "Google" };
      } }, { test: [/huawei/i], describe: function(h) {
        var f = u.default.getFirstMatch(/(can-l01)/i, h) && "Nova", m = { type: c.PLATFORMS_MAP.mobile, vendor: "Huawei" };
        return f && (m.model = f), m;
      } }, { test: [/nexus\s*(?:7|8|9|10).*/i], describe: function() {
        return { type: c.PLATFORMS_MAP.tablet, vendor: "Nexus" };
      } }, { test: [/ipad/i], describe: function() {
        return { type: c.PLATFORMS_MAP.tablet, vendor: "Apple", model: "iPad" };
      } }, { test: [/Macintosh(.*?) FxiOS(.*?)\//], describe: function() {
        return { type: c.PLATFORMS_MAP.tablet, vendor: "Apple", model: "iPad" };
      } }, { test: [/kftt build/i], describe: function() {
        return { type: c.PLATFORMS_MAP.tablet, vendor: "Amazon", model: "Kindle Fire HD 7" };
      } }, { test: [/silk/i], describe: function() {
        return { type: c.PLATFORMS_MAP.tablet, vendor: "Amazon" };
      } }, { test: [/tablet(?! pc)/i], describe: function() {
        return { type: c.PLATFORMS_MAP.tablet };
      } }, { test: function(h) {
        var f = h.test(/ipod|iphone/i), m = h.test(/like (ipod|iphone)/i);
        return f && !m;
      }, describe: function(h) {
        var f = u.default.getFirstMatch(/(ipod|iphone)/i, h);
        return { type: c.PLATFORMS_MAP.mobile, vendor: "Apple", model: f };
      } }, { test: [/nexus\s*[0-6].*/i, /galaxy nexus/i], describe: function() {
        return { type: c.PLATFORMS_MAP.mobile, vendor: "Nexus" };
      } }, { test: [/[^-]mobi/i], describe: function() {
        return { type: c.PLATFORMS_MAP.mobile };
      } }, { test: function(h) {
        return h.getBrowserName(true) === "blackberry";
      }, describe: function() {
        return { type: c.PLATFORMS_MAP.mobile, vendor: "BlackBerry" };
      } }, { test: function(h) {
        return h.getBrowserName(true) === "bada";
      }, describe: function() {
        return { type: c.PLATFORMS_MAP.mobile };
      } }, { test: function(h) {
        return h.getBrowserName() === "windows phone";
      }, describe: function() {
        return { type: c.PLATFORMS_MAP.mobile, vendor: "Microsoft" };
      } }, { test: function(h) {
        var f = Number(String(h.getOSVersion()).split(".")[0]);
        return h.getOSName(true) === "android" && f >= 3;
      }, describe: function() {
        return { type: c.PLATFORMS_MAP.tablet };
      } }, { test: function(h) {
        return h.getOSName(true) === "android";
      }, describe: function() {
        return { type: c.PLATFORMS_MAP.mobile };
      } }, { test: function(h) {
        return h.getOSName(true) === "macos";
      }, describe: function() {
        return { type: c.PLATFORMS_MAP.desktop, vendor: "Apple" };
      } }, { test: function(h) {
        return h.getOSName(true) === "windows";
      }, describe: function() {
        return { type: c.PLATFORMS_MAP.desktop };
      } }, { test: function(h) {
        return h.getOSName(true) === "linux";
      }, describe: function() {
        return { type: c.PLATFORMS_MAP.desktop };
      } }, { test: function(h) {
        return h.getOSName(true) === "playstation 4";
      }, describe: function() {
        return { type: c.PLATFORMS_MAP.tv };
      } }, { test: function(h) {
        return h.getOSName(true) === "roku";
      }, describe: function() {
        return { type: c.PLATFORMS_MAP.tv };
      } }];
      r.default = p, i.exports = r.default;
    }, 95: function(i, r, o) {
      r.__esModule = true, r.default = void 0;
      var a, u = (a = o(17)) && a.__esModule ? a : { default: a }, c = o(18), p = [{ test: function(h) {
        return h.getBrowserName(true) === "microsoft edge";
      }, describe: function(h) {
        if (/\sedg\//i.test(h)) return { name: c.ENGINE_MAP.Blink };
        var f = u.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i, h);
        return { name: c.ENGINE_MAP.EdgeHTML, version: f };
      } }, { test: [/trident/i], describe: function(h) {
        var f = { name: c.ENGINE_MAP.Trident }, m = u.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: function(h) {
        return h.test(/presto/i);
      }, describe: function(h) {
        var f = { name: c.ENGINE_MAP.Presto }, m = u.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: function(h) {
        var f = h.test(/gecko/i), m = h.test(/like gecko/i);
        return f && !m;
      }, describe: function(h) {
        var f = { name: c.ENGINE_MAP.Gecko }, m = u.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }, { test: [/(apple)?webkit\/537\.36/i], describe: function() {
        return { name: c.ENGINE_MAP.Blink };
      } }, { test: [/(apple)?webkit/i], describe: function(h) {
        var f = { name: c.ENGINE_MAP.WebKit }, m = u.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i, h);
        return m && (f.version = m), f;
      } }];
      r.default = p, i.exports = r.default;
    } });
  });
});
O();
O();
var lh = zt(hd());
O();
var md = ((e) => (e.svPrimary = "sv-primary", e.svPrimary900 = "sv-primary-900", e.svPrimary200 = "sv-primary-200", e.svSecondary = "sv-secondary", e.svGray = "sv-gray", e.svSuccess = "sv-success", e.svDanger = "sv-danger", e.svBlack = "sv-black", e.svWhite = "sv-white", e.svGray100 = "sv-gray-100", e.svGray200 = "sv-gray-200", e.svGray300 = "sv-gray-300", e.svGray400 = "sv-gray-400", e.svGray500 = "sv-gray-500", e.svGray600 = "sv-gray-600", e.svGray700 = "sv-gray-700", e.svGray800 = "sv-gray-800", e))(md || {});
O();
O();
O();
O();
var He = (e, t, i, ...r) => he(void 0, [e, t, i, ...r], function* (o, a, u, c = {}) {
  let p = yield fetch(o, { method: a, headers: $({ "Content-Type": "application/json" }, c), body: u ? JSON.stringify(u) : null });
  if (!p.ok) throw p;
  try {
    return yield p.json();
  } catch {
    return p.ok;
  }
});
O();
var bC = zt(hd());
var qe = class {
  constructor(e) {
    this.debug = (0, bC.default)(e);
  }
  log(e, ...t) {
    this.debug(e, ...t);
  }
};
O();
O();
var wC = zt(fd());
var $e = class {
  constructor(e = {}) {
    this.subscribe = (r) => {
      this.callbacks.push(r);
    }, this.unsubscribe = (r) => {
      this.callbacks = this.callbacks.filter((o) => o !== r);
    }, this.publish = (...r) => {
      this.callbacks && this.callbacks.forEach((o) => {
        this.callListener(o, r).catch((a) => {
          var u;
          (u = this.logger) == null || u.log("superviz-sdk:observer-helper:publish:error", `
            Failed to execute callback on publish value.
            Callback: ${o.name}
            Event: ${JSON.stringify(r)}
            Error: ${a}
          `);
        });
      });
    }, this.reset = () => {
      this.callbacks = [];
    }, this.destroy = () => {
      delete this.logger, delete this.callbacks;
    }, this.callListener = (r, o) => new Promise((a, u) => {
      try {
        let c = r(...o);
        a(c);
      } catch (c) {
        u(c);
      }
    });
    let { logger: t, throttleTime: i } = e;
    this.logger = t || new qe("@superviz/sdk/observer-helper"), this.throttle = i, this.callbacks = [], this.throttle && (this.publish = (0, wC.default)(this.publish, this.throttle));
  }
};
var rl = class {
  constructor() {
    this.observers = {}, this.subscribe = (e, t) => {
      this.logger.log(`subscribed to ${e} event`), this.observers[e] || (this.observers[e] = new $e({ logger: this.logger })), this.observers[e].subscribe(t);
    }, this.unsubscribe = (e, t) => {
      if (this.logger.log(`unsubscribed from ${e} event`), !!this.observers[e]) {
        if (!t) {
          this.observers[e].destroy(), delete this.observers[e];
          return;
        }
        this.observers[e].unsubscribe(t);
      }
    }, this.publish = (e, t) => {
      e in this.observers && this.observers[e].publish(t);
    };
  }
};
O();
var Qe = class {
  static createUrl(e, t, i = {}) {
    let r = new URL(t, e);
    return Object.keys(i).forEach((o) => r.searchParams.append(o, i[o])), r.toString();
  }
  static validateApiKey(e, t) {
    let i = this.createUrl(e, "/user/checkapikey");
    return He(i, "POST", { apiKey: t });
  }
  static fetchConfig(e, t) {
    let i = this.createUrl(e, "/immersive-config");
    return He(i, "POST", { apiKey: t });
  }
  static fetchLimits(e, t) {
    return he(this, null, function* () {
      let i = this.createUrl(e, "/user/check_limits_v2");
      return (yield He(i, "GET", "", { apikey: t })).limits;
    });
  }
  static fetchWaterMark(e, t) {
    return he(this, null, function* () {
      let i = this.createUrl(e, "/user/watermark"), { message: r } = yield He(i, "POST", { apiKey: t });
      return r;
    });
  }
  static createAnnotations(e, t, i) {
    return he(this, null, function* () {
      let r = this.createUrl(e, "/annotations");
      return He(r, "POST", $({}, i), { apikey: t });
    });
  }
  static updateComment(e, t, i, r) {
    return he(this, null, function* () {
      let o = `/comments/${i}`, a = this.createUrl(e, o);
      return He(a, "PUT", { text: r }, { apikey: t });
    });
  }
  static createComment(e, t, i) {
    return he(this, null, function* () {
      let r = this.createUrl(e, "/comments");
      return He(r, "POST", $({}, i), { apikey: t });
    });
  }
  static fetchAnnotation(e, t, i) {
    return he(this, null, function* () {
      let r = this.createUrl(e, "/annotations", { roomId: i.roomId });
      return He(r, "GET", void 0, { apikey: t });
    });
  }
  static resolveAnnotation(e, t, i) {
    return he(this, null, function* () {
      let r = `/annotations/resolve/${i}`, o = this.createUrl(e, r);
      return He(o, "POST", {}, { apikey: t });
    });
  }
  static deleteComment(e, t, i) {
    return he(this, null, function* () {
      let r = `/comments/${i}`, o = this.createUrl(e, r);
      return He(o, "DELETE", {}, { apikey: t });
    });
  }
  static deleteAnnotation(e, t, i) {
    return he(this, null, function* () {
      let r = `/annotations/${i}`, o = this.createUrl(e, r);
      return He(o, "DELETE", {}, { apikey: t });
    });
  }
  static createParticipant(e) {
    return he(this, null, function* () {
      let t = Q.get("apiUrl"), i = this.createUrl(t, "/participants");
      return He(i, "POST", $({}, e), { apikey: Q.get("apiKey") });
    });
  }
  static fetchParticipant(e) {
    return he(this, null, function* () {
      let t = Q.get("apiUrl"), i = `/participants/${e}`, r = this.createUrl(t, i);
      return He(r, "GET", void 0, { apikey: Q.get("apiKey") });
    });
  }
  static sendActivity(e, t, i, r) {
    return he(this, null, function* () {
      let o = "/activity", a = Q.get("apiUrl"), u = Q.get("roomId"), c = Q.get("apiKey"), p = this.createUrl(a, o);
      return He(p, "POST", { groupId: t, groupName: i, meetingId: u, product: r, userId: e }, { apikey: c });
    });
  }
  static fetchParticipantsByGroup(e) {
    return he(this, null, function* () {
      let t = `/groups/participants/${e}`, i = Q.get("apiUrl"), r = this.createUrl(i, t, { take: 1e4 });
      return He(r, "GET", void 0, { apikey: Q.get("apiKey") });
    });
  }
  static createMentions(e) {
    return he(this, null, function* () {
      let t = "/mentions", i = Q.get("apiUrl"), r = this.createUrl(i, t);
      return He(r, "POST", e, { apikey: Q.get("apiKey") });
    });
  }
};
O();
function _C(e, t) {
  return he(this, null, function* () {
    try {
      return (yield Qe.validateApiKey(e, t)) === true;
    } catch (i) {
      if (i.status === 404) return false;
      throw new Error("Unable to validate API key");
    }
  });
}
var CC = _C;
O();
var EC = "6.7.1-beta.1";
var Sa = class {
  static getRemoteConfig() {
    return he(this, arguments, function* (e = "prod") {
      if (e === "local") return (yield import("./.remote-config-W6AJZY5U-DfKMz4G3-6ZWLUV2Y.js")).default.remoteConfig;
      let t = { version: EC, environment: e }, i = this.createUrl(t);
      return He(i, "GET", null);
    });
  }
  static getFeatures(e) {
    return he(this, null, function* () {
      return He(`${this.REMOTE_CONFIG_BASE_URL}/features/${e}`, "GET", void 0);
    });
  }
  static createUrl({ version: e, environment: t }) {
    return `${this.REMOTE_CONFIG_BASE_URL}/sdk/${e}?env=${t}`;
  }
};
Sa.REMOTE_CONFIG_BASE_URL = "https://remote-config.superviz.com";
O();
O();
var PC = Object.create;
var Us = Object.defineProperty;
var AC = Object.defineProperties;
var SC = Object.getOwnPropertyDescriptor;
var OC = Object.getOwnPropertyDescriptors;
var TC = Object.getOwnPropertyNames;
var uh = Object.getOwnPropertySymbols;
var xC = Object.getPrototypeOf;
var vd = Object.prototype.hasOwnProperty;
var kC = Object.prototype.propertyIsEnumerable;
var ch = (e, t, i) => t in e ? Us(e, t, { enumerable: true, configurable: true, writable: true, value: i }) : e[t] = i;
var k = (e, t) => {
  for (var i in t || (t = {})) vd.call(t, i) && ch(e, i, t[i]);
  if (uh) for (var i of uh(t)) kC.call(t, i) && ch(e, i, t[i]);
  return e;
};
var X = (e, t) => AC(e, OC(t));
var sl = (e, t) => () => (t || e((t = { exports: {} }).exports, t), t.exports);
var IC = (e, t) => {
  for (var i in t) Us(e, i, { get: t[i], enumerable: true });
};
var MC = (e, t, i, r) => {
  if (t && typeof t == "object" || typeof t == "function") for (let o of TC(t)) !vd.call(e, o) && o !== i && Us(e, o, { get: () => t[o], enumerable: !(r = SC(t, o)) || r.enumerable });
  return e;
};
var RC = (e, t, i) => (i = e != null ? PC(xC(e)) : {}, MC(!e || !e.__esModule ? Us(i, "default", { value: e, enumerable: true }) : i, e));
var di = (e, t, i) => new Promise((r, o) => {
  var a = (p) => {
    try {
      c(i.next(p));
    } catch (h) {
      o(h);
    }
  }, u = (p) => {
    try {
      c(i.throw(p));
    } catch (h) {
      o(h);
    }
  }, c = (p) => p.done ? r(p.value) : Promise.resolve(p.value).then(a, u);
  c((i = i.apply(e, t)).next());
});
var FC = sl((e, t) => {
  var i = 1e3, r = i * 60, o = r * 60, a = o * 24, u = a * 7, c = a * 365.25;
  t.exports = function(y, g) {
    g = g || {};
    var _ = typeof y;
    if (_ === "string" && y.length > 0) return p(y);
    if (_ === "number" && isFinite(y)) return g.long ? f(y) : h(y);
    throw new Error("val is not a non-empty string or a valid number. val=" + JSON.stringify(y));
  };
  function p(y) {
    if (y = String(y), !(y.length > 100)) {
      var g = /^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);
      if (g) {
        var _ = parseFloat(g[1]), E = (g[2] || "ms").toLowerCase();
        switch (E) {
          case "years":
          case "year":
          case "yrs":
          case "yr":
          case "y":
            return _ * c;
          case "weeks":
          case "week":
          case "w":
            return _ * u;
          case "days":
          case "day":
          case "d":
            return _ * a;
          case "hours":
          case "hour":
          case "hrs":
          case "hr":
          case "h":
            return _ * o;
          case "minutes":
          case "minute":
          case "mins":
          case "min":
          case "m":
            return _ * r;
          case "seconds":
          case "second":
          case "secs":
          case "sec":
          case "s":
            return _ * i;
          case "milliseconds":
          case "millisecond":
          case "msecs":
          case "msec":
          case "ms":
            return _;
          default:
            return;
        }
      }
    }
  }
  function h(y) {
    var g = Math.abs(y);
    return g >= a ? Math.round(y / a) + "d" : g >= o ? Math.round(y / o) + "h" : g >= r ? Math.round(y / r) + "m" : g >= i ? Math.round(y / i) + "s" : y + "ms";
  }
  function f(y) {
    var g = Math.abs(y);
    return g >= a ? m(y, g, a, "day") : g >= o ? m(y, g, o, "hour") : g >= r ? m(y, g, r, "minute") : g >= i ? m(y, g, i, "second") : y + " ms";
  }
  function m(y, g, _, E) {
    var R = g >= _ * 1.5;
    return Math.round(y / _) + " " + E + (R ? "s" : "");
  }
});
var LC = sl((e, t) => {
  function i(r) {
    a.debug = a, a.default = a, a.coerce = m, a.disable = p, a.enable = c, a.enabled = h, a.humanize = FC(), a.destroy = y, Object.keys(r).forEach((g) => {
      a[g] = r[g];
    }), a.names = [], a.skips = [], a.formatters = {};
    function o(g) {
      let _ = 0;
      for (let E = 0; E < g.length; E++) _ = (_ << 5) - _ + g.charCodeAt(E), _ |= 0;
      return a.colors[Math.abs(_) % a.colors.length];
    }
    a.selectColor = o;
    function a(g) {
      let _, E = null, R, N;
      function j(...B) {
        if (!j.enabled) return;
        let K = j, ie = Number(/* @__PURE__ */ new Date()), we = ie - (_ || ie);
        K.diff = we, K.prev = _, K.curr = ie, _ = ie, B[0] = a.coerce(B[0]), typeof B[0] != "string" && B.unshift("%O");
        let pe = 0;
        B[0] = B[0].replace(/%([a-zA-Z%])/g, (Se, Le) => {
          if (Se === "%%") return "%";
          pe++;
          let Oe = a.formatters[Le];
          if (typeof Oe == "function") {
            let xe = B[pe];
            Se = Oe.call(K, xe), B.splice(pe, 1), pe--;
          }
          return Se;
        }), a.formatArgs.call(K, B), (K.log || a.log).apply(K, B);
      }
      return j.namespace = g, j.useColors = a.useColors(), j.color = a.selectColor(g), j.extend = u, j.destroy = a.destroy, Object.defineProperty(j, "enabled", { enumerable: true, configurable: false, get: () => E !== null ? E : (R !== a.namespaces && (R = a.namespaces, N = a.enabled(g)), N), set: (B) => {
        E = B;
      } }), typeof a.init == "function" && a.init(j), j;
    }
    function u(g, _) {
      let E = a(this.namespace + (typeof _ > "u" ? ":" : _) + g);
      return E.log = this.log, E;
    }
    function c(g) {
      a.save(g), a.namespaces = g, a.names = [], a.skips = [];
      let _, E = (typeof g == "string" ? g : "").split(/[\s,]+/), R = E.length;
      for (_ = 0; _ < R; _++) E[_] && (g = E[_].replace(/\*/g, ".*?"), g[0] === "-" ? a.skips.push(new RegExp("^" + g.slice(1) + "$")) : a.names.push(new RegExp("^" + g + "$")));
    }
    function p() {
      let g = [...a.names.map(f), ...a.skips.map(f).map((_) => "-" + _)].join(",");
      return a.enable(""), g;
    }
    function h(g) {
      if (g[g.length - 1] === "*") return true;
      let _, E;
      for (_ = 0, E = a.skips.length; _ < E; _++) if (a.skips[_].test(g)) return false;
      for (_ = 0, E = a.names.length; _ < E; _++) if (a.names[_].test(g)) return true;
      return false;
    }
    function f(g) {
      return g.toString().substring(2, g.toString().length - 2).replace(/\.\*\?$/, "*");
    }
    function m(g) {
      return g instanceof Error ? g.stack || g.message : g;
    }
    function y() {
      console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");
    }
    return a.enable(a.load()), a;
  }
  t.exports = i;
});
var NC = sl((e, t) => {
  e.formatArgs = r, e.save = o, e.load = a, e.useColors = i, e.storage = u(), e.destroy = /* @__PURE__ */ (() => {
    let p = false;
    return () => {
      p || (p = true, console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."));
    };
  })(), e.colors = ["#0000CC", "#0000FF", "#0033CC", "#0033FF", "#0066CC", "#0066FF", "#0099CC", "#0099FF", "#00CC00", "#00CC33", "#00CC66", "#00CC99", "#00CCCC", "#00CCFF", "#3300CC", "#3300FF", "#3333CC", "#3333FF", "#3366CC", "#3366FF", "#3399CC", "#3399FF", "#33CC00", "#33CC33", "#33CC66", "#33CC99", "#33CCCC", "#33CCFF", "#6600CC", "#6600FF", "#6633CC", "#6633FF", "#66CC00", "#66CC33", "#9900CC", "#9900FF", "#9933CC", "#9933FF", "#99CC00", "#99CC33", "#CC0000", "#CC0033", "#CC0066", "#CC0099", "#CC00CC", "#CC00FF", "#CC3300", "#CC3333", "#CC3366", "#CC3399", "#CC33CC", "#CC33FF", "#CC6600", "#CC6633", "#CC9900", "#CC9933", "#CCCC00", "#CCCC33", "#FF0000", "#FF0033", "#FF0066", "#FF0099", "#FF00CC", "#FF00FF", "#FF3300", "#FF3333", "#FF3366", "#FF3399", "#FF33CC", "#FF33FF", "#FF6600", "#FF6633", "#FF9900", "#FF9933", "#FFCC00", "#FFCC33"];
  function i() {
    if (typeof window < "u" && window.process && (window.process.type === "renderer" || window.process.__nwjs)) return true;
    if (typeof navigator < "u" && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)) return false;
    let p;
    return typeof document < "u" && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance || typeof window < "u" && window.console && (window.console.firebug || window.console.exception && window.console.table) || typeof navigator < "u" && navigator.userAgent && (p = navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)) && parseInt(p[1], 10) >= 31 || typeof navigator < "u" && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/);
  }
  function r(p) {
    if (p[0] = (this.useColors ? "%c" : "") + this.namespace + (this.useColors ? " %c" : " ") + p[0] + (this.useColors ? "%c " : " ") + "+" + t.exports.humanize(this.diff), !this.useColors) return;
    let h = "color: " + this.color;
    p.splice(1, 0, h, "color: inherit");
    let f = 0, m = 0;
    p[0].replace(/%[a-zA-Z%]/g, (y) => {
      y !== "%%" && (f++, y === "%c" && (m = f));
    }), p.splice(m, 0, h);
  }
  e.log = console.debug || console.log || (() => {
  });
  function o(p) {
    try {
      p ? e.storage.setItem("debug", p) : e.storage.removeItem("debug");
    } catch {
    }
  }
  function a() {
    let p;
    try {
      p = e.storage.getItem("debug");
    } catch {
    }
    return !p && typeof process < "u" && "env" in process && (p = Ya.DEBUG), p;
  }
  function u() {
    try {
      return localStorage;
    } catch {
    }
  }
  t.exports = LC()(e);
  var { formatters: c } = t.exports;
  c.j = function(p) {
    try {
      return JSON.stringify(p);
    } catch (h) {
      return "[UnexpectedJSONParseError]: " + h.message;
    }
  };
});
var DC = ((e) => (e.JOIN_ROOM = "room.join", e.JOINED_ROOM = "room.joined", e.LEAVE_ROOM = "room.leave", e.UPDATE = "room.update", e.ERROR = "room.error", e))(DC || {});
var ee = ((e) => (e.JOINED_ROOM = "presence.joined-room", e.LEAVE = "presence.leave", e.UPDATE = "presence.update", e))(ee || {});
var gd = ((e) => (e.CONNECTED = "CONNECTED", e.CONNECTING = "CONNECTING", e.DISCONNECTED = "DISCONNECTED", e.CONNECTION_ERROR = "CONNECTION_ERROR", e.RECONNECTING = "RECONNECTING", e.RECONNECT_ERROR = "RECONNECT_ERROR", e))(gd || {});
var Oa = function(e, t) {
  return Oa = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(i, r) {
    i.__proto__ = r;
  } || function(i, r) {
    for (var o in r) Object.prototype.hasOwnProperty.call(r, o) && (i[o] = r[o]);
  }, Oa(e, t);
};
function $s(e, t) {
  if (typeof t != "function" && t !== null) throw new TypeError("Class extends value " + String(t) + " is not a constructor or null");
  Oa(e, t);
  function i() {
    this.constructor = e;
  }
  e.prototype = t === null ? Object.create(t) : (i.prototype = t.prototype, new i());
}
function Ta(e) {
  var t = typeof Symbol == "function" && Symbol.iterator, i = t && e[t], r = 0;
  if (i) return i.call(e);
  if (e && typeof e.length == "number") return { next: function() {
    return e && r >= e.length && (e = void 0), { value: e && e[r++], done: !e };
  } };
  throw new TypeError(t ? "Object is not iterable." : "Symbol.iterator is not defined.");
}
function xa(e, t) {
  var i = typeof Symbol == "function" && e[Symbol.iterator];
  if (!i) return e;
  var r = i.call(e), o, a = [], u;
  try {
    for (; (t === void 0 || t-- > 0) && !(o = r.next()).done; ) a.push(o.value);
  } catch (c) {
    u = { error: c };
  } finally {
    try {
      o && !o.done && (i = r.return) && i.call(r);
    } finally {
      if (u) throw u.error;
    }
  }
  return a;
}
function ka(e, t, i) {
  if (arguments.length === 2) for (var r = 0, o = t.length, a; r < o; r++) (a || !(r in t)) && (a || (a = Array.prototype.slice.call(t, 0, r)), a[r] = t[r]);
  return e.concat(a || Array.prototype.slice.call(t));
}
function ci(e) {
  return typeof e == "function";
}
function yd(e) {
  var t = function(r) {
    Error.call(r), r.stack = new Error().stack;
  }, i = e(t);
  return i.prototype = Object.create(Error.prototype), i.prototype.constructor = i, i;
}
var ma = yd(function(e) {
  return function(t) {
    e(this), this.message = t ? t.length + ` errors occurred during unsubscription:
` + t.map(function(i, r) {
      return r + 1 + ") " + i.toString();
    }).join(`
  `) : "", this.name = "UnsubscriptionError", this.errors = t;
  };
});
function Ia(e, t) {
  if (e) {
    var i = e.indexOf(t);
    0 <= i && e.splice(i, 1);
  }
}
var zs = function() {
  function e(t) {
    this.initialTeardown = t, this.closed = false, this._parentage = null, this._finalizers = null;
  }
  return e.prototype.unsubscribe = function() {
    var t, i, r, o, a;
    if (!this.closed) {
      this.closed = true;
      var u = this._parentage;
      if (u) if (this._parentage = null, Array.isArray(u)) try {
        for (var c = Ta(u), p = c.next(); !p.done; p = c.next()) {
          var h = p.value;
          h.remove(this);
        }
      } catch (E) {
        t = { error: E };
      } finally {
        try {
          p && !p.done && (i = c.return) && i.call(c);
        } finally {
          if (t) throw t.error;
        }
      }
      else u.remove(this);
      var f = this.initialTeardown;
      if (ci(f)) try {
        f();
      } catch (E) {
        a = E instanceof ma ? E.errors : [E];
      }
      var m = this._finalizers;
      if (m) {
        this._finalizers = null;
        try {
          for (var y = Ta(m), g = y.next(); !g.done; g = y.next()) {
            var _ = g.value;
            try {
              hh(_);
            } catch (E) {
              a = a ?? [], E instanceof ma ? a = ka(ka([], xa(a)), xa(E.errors)) : a.push(E);
            }
          }
        } catch (E) {
          r = { error: E };
        } finally {
          try {
            g && !g.done && (o = y.return) && o.call(y);
          } finally {
            if (r) throw r.error;
          }
        }
      }
      if (a) throw new ma(a);
    }
  }, e.prototype.add = function(t) {
    var i;
    if (t && t !== this) if (this.closed) hh(t);
    else {
      if (t instanceof e) {
        if (t.closed || t._hasParent(this)) return;
        t._addParent(this);
      }
      (this._finalizers = (i = this._finalizers) !== null && i !== void 0 ? i : []).push(t);
    }
  }, e.prototype._hasParent = function(t) {
    var i = this._parentage;
    return i === t || Array.isArray(i) && i.includes(t);
  }, e.prototype._addParent = function(t) {
    var i = this._parentage;
    this._parentage = Array.isArray(i) ? (i.push(t), i) : i ? [i, t] : t;
  }, e.prototype._removeParent = function(t) {
    var i = this._parentage;
    i === t ? this._parentage = null : Array.isArray(i) && Ia(i, t);
  }, e.prototype.remove = function(t) {
    var i = this._finalizers;
    i && Ia(i, t), t instanceof e && t._removeParent(this);
  }, e.EMPTY = function() {
    var t = new e();
    return t.closed = true, t;
  }(), e;
}();
var bd = zs.EMPTY;
function wd(e) {
  return e instanceof zs || e && "closed" in e && ci(e.remove) && ci(e.add) && ci(e.unsubscribe);
}
function hh(e) {
  ci(e) ? e() : e.unsubscribe();
}
var _d = { onUnhandledError: null, onStoppedNotification: null, Promise: void 0, useDeprecatedSynchronousErrorHandling: false, useDeprecatedNextContext: false };
var jC = { setTimeout: function(e, t) {
  for (var i = [], r = 2; r < arguments.length; r++) i[r - 2] = arguments[r];
  return setTimeout.apply(void 0, ka([e, t], xa(i)));
}, clearTimeout: function(e) {
  return clearTimeout(e);
}, delegate: void 0 };
function BC(e) {
  jC.setTimeout(function() {
    throw e;
  });
}
function dh() {
}
function ws(e) {
  e();
}
var Cd = function(e) {
  $s(t, e);
  function t(i) {
    var r = e.call(this) || this;
    return r.isStopped = false, i ? (r.destination = i, wd(i) && i.add(r)) : r.destination = WC, r;
  }
  return t.create = function(i, r, o) {
    return new Ma(i, r, o);
  }, t.prototype.next = function(i) {
    this.isStopped ? void 0 : this._next(i);
  }, t.prototype.error = function(i) {
    this.isStopped ? void 0 : (this.isStopped = true, this._error(i));
  }, t.prototype.complete = function() {
    this.isStopped ? void 0 : (this.isStopped = true, this._complete());
  }, t.prototype.unsubscribe = function() {
    this.closed || (this.isStopped = true, e.prototype.unsubscribe.call(this), this.destination = null);
  }, t.prototype._next = function(i) {
    this.destination.next(i);
  }, t.prototype._error = function(i) {
    try {
      this.destination.error(i);
    } finally {
      this.unsubscribe();
    }
  }, t.prototype._complete = function() {
    try {
      this.destination.complete();
    } finally {
      this.unsubscribe();
    }
  }, t;
}(zs);
var UC = Function.prototype.bind;
function va(e, t) {
  return UC.call(e, t);
}
var $C = function() {
  function e(t) {
    this.partialObserver = t;
  }
  return e.prototype.next = function(t) {
    var i = this.partialObserver;
    if (i.next) try {
      i.next(t);
    } catch (r) {
      ds(r);
    }
  }, e.prototype.error = function(t) {
    var i = this.partialObserver;
    if (i.error) try {
      i.error(t);
    } catch (r) {
      ds(r);
    }
    else ds(t);
  }, e.prototype.complete = function() {
    var t = this.partialObserver;
    if (t.complete) try {
      t.complete();
    } catch (i) {
      ds(i);
    }
  }, e;
}();
var Ma = function(e) {
  $s(t, e);
  function t(i, r, o) {
    var a = e.call(this) || this, u;
    if (ci(i) || !i) u = { next: i ?? void 0, error: r ?? void 0, complete: o ?? void 0 };
    else {
      var c;
      a && _d.useDeprecatedNextContext ? (c = Object.create(i), c.unsubscribe = function() {
        return a.unsubscribe();
      }, u = { next: i.next && va(i.next, c), error: i.error && va(i.error, c), complete: i.complete && va(i.complete, c) }) : u = i;
    }
    return a.destination = new $C(u), a;
  }
  return t;
}(Cd);
function ds(e) {
  BC(e);
}
function zC(e) {
  throw e;
}
var WC = { closed: true, next: dh, error: zC, complete: dh };
var VC = function() {
  return typeof Symbol == "function" && Symbol.observable || "@@observable";
}();
function GC(e) {
  return e;
}
function ZC(e) {
  return e.length === 0 ? GC : e.length === 1 ? e[0] : function(t) {
    return e.reduce(function(i, r) {
      return r(i);
    }, t);
  };
}
var ph = function() {
  function e(t) {
    t && (this._subscribe = t);
  }
  return e.prototype.lift = function(t) {
    var i = new e();
    return i.source = this, i.operator = t, i;
  }, e.prototype.subscribe = function(t, i, r) {
    var o = this, a = HC(t) ? t : new Ma(t, i, r);
    return ws(function() {
      var u = o, c = u.operator, p = u.source;
      a.add(c ? c.call(a, p) : p ? o._subscribe(a) : o._trySubscribe(a));
    }), a;
  }, e.prototype._trySubscribe = function(t) {
    try {
      return this._subscribe(t);
    } catch (i) {
      t.error(i);
    }
  }, e.prototype.forEach = function(t, i) {
    var r = this;
    return i = fh(i), new i(function(o, a) {
      var u = new Ma({ next: function(c) {
        try {
          t(c);
        } catch (p) {
          a(p), u.unsubscribe();
        }
      }, error: a, complete: o });
      r.subscribe(u);
    });
  }, e.prototype._subscribe = function(t) {
    var i;
    return (i = this.source) === null || i === void 0 ? void 0 : i.subscribe(t);
  }, e.prototype[VC] = function() {
    return this;
  }, e.prototype.pipe = function() {
    for (var t = [], i = 0; i < arguments.length; i++) t[i] = arguments[i];
    return ZC(t)(this);
  }, e.prototype.toPromise = function(t) {
    var i = this;
    return t = fh(t), new t(function(r, o) {
      var a;
      i.subscribe(function(u) {
        return a = u;
      }, function(u) {
        return o(u);
      }, function() {
        return r(a);
      });
    });
  }, e.create = function(t) {
    return new e(t);
  }, e;
}();
function fh(e) {
  var t;
  return (t = e ?? _d.Promise) !== null && t !== void 0 ? t : Promise;
}
function JC(e) {
  return e && ci(e.next) && ci(e.error) && ci(e.complete);
}
function HC(e) {
  return e && e instanceof Cd || JC(e) && wd(e);
}
var qC = yd(function(e) {
  return function() {
    e(this), this.name = "ObjectUnsubscribedError", this.message = "object unsubscribed";
  };
});
var Zt = function(e) {
  $s(t, e);
  function t() {
    var i = e.call(this) || this;
    return i.closed = false, i.currentObservers = null, i.observers = [], i.isStopped = false, i.hasError = false, i.thrownError = null, i;
  }
  return t.prototype.lift = function(i) {
    var r = new mh(this, this);
    return r.operator = i, r;
  }, t.prototype._throwIfClosed = function() {
    if (this.closed) throw new qC();
  }, t.prototype.next = function(i) {
    var r = this;
    ws(function() {
      var o, a;
      if (r._throwIfClosed(), !r.isStopped) {
        r.currentObservers || (r.currentObservers = Array.from(r.observers));
        try {
          for (var u = Ta(r.currentObservers), c = u.next(); !c.done; c = u.next()) {
            var p = c.value;
            p.next(i);
          }
        } catch (h) {
          o = { error: h };
        } finally {
          try {
            c && !c.done && (a = u.return) && a.call(u);
          } finally {
            if (o) throw o.error;
          }
        }
      }
    });
  }, t.prototype.error = function(i) {
    var r = this;
    ws(function() {
      if (r._throwIfClosed(), !r.isStopped) {
        r.hasError = r.isStopped = true, r.thrownError = i;
        for (var o = r.observers; o.length; ) o.shift().error(i);
      }
    });
  }, t.prototype.complete = function() {
    var i = this;
    ws(function() {
      if (i._throwIfClosed(), !i.isStopped) {
        i.isStopped = true;
        for (var r = i.observers; r.length; ) r.shift().complete();
      }
    });
  }, t.prototype.unsubscribe = function() {
    this.isStopped = this.closed = true, this.observers = this.currentObservers = null;
  }, Object.defineProperty(t.prototype, "observed", { get: function() {
    var i;
    return ((i = this.observers) === null || i === void 0 ? void 0 : i.length) > 0;
  }, enumerable: false, configurable: true }), t.prototype._trySubscribe = function(i) {
    return this._throwIfClosed(), e.prototype._trySubscribe.call(this, i);
  }, t.prototype._subscribe = function(i) {
    return this._throwIfClosed(), this._checkFinalizedStatuses(i), this._innerSubscribe(i);
  }, t.prototype._innerSubscribe = function(i) {
    var r = this, o = this, a = o.hasError, u = o.isStopped, c = o.observers;
    return a || u ? bd : (this.currentObservers = null, c.push(i), new zs(function() {
      r.currentObservers = null, Ia(c, i);
    }));
  }, t.prototype._checkFinalizedStatuses = function(i) {
    var r = this, o = r.hasError, a = r.thrownError, u = r.isStopped;
    o ? i.error(a) : u && i.complete();
  }, t.prototype.asObservable = function() {
    var i = new ph();
    return i.source = this, i;
  }, t.create = function(i, r) {
    return new mh(i, r);
  }, t;
}(ph);
var mh = function(e) {
  $s(t, e);
  function t(i, r) {
    var o = e.call(this) || this;
    return o.destination = i, o.source = r, o;
  }
  return t.prototype.next = function(i) {
    var r, o;
    (o = (r = this.destination) === null || r === void 0 ? void 0 : r.next) === null || o === void 0 || o.call(r, i);
  }, t.prototype.error = function(i) {
    var r, o;
    (o = (r = this.destination) === null || r === void 0 ? void 0 : r.error) === null || o === void 0 || o.call(r, i);
  }, t.prototype.complete = function() {
    var i, r;
    (r = (i = this.destination) === null || i === void 0 ? void 0 : i.complete) === null || r === void 0 || r.call(i);
  }, t.prototype._subscribe = function(i) {
    var r, o;
    return (o = (r = this.source) === null || r === void 0 ? void 0 : r.subscribe(i)) !== null && o !== void 0 ? o : bd;
  }, t;
}(Zt);
var vh = RC(NC());
var ol = class {
  constructor(e) {
    this.debug = (0, vh.default)(e), vh.default.enable("*");
  }
  log(e, ...t) {
    this.debug(e, ...t);
  }
};
var KC = class Ed {
  constructor(t, i, r) {
    this.io = t, this.presence = i, this.roomId = r, this.presences = /* @__PURE__ */ new Set(), this.observers = /* @__PURE__ */ new Map(), this.onPresenceJoin = (o) => {
      (o == null ? void 0 : o.roomId) === this.roomId && (this.logger.log("presence room @ presence join", o), this.presences.add(o), this.observers.get("presence.joined-room").next({ connectionId: o.connectionId, data: o.data, id: o.id, name: o.name, timestamp: o.timestamp }));
    }, this.onPresenceLeave = (o) => {
      (o == null ? void 0 : o.roomId) === this.roomId && (this.logger.log("presence room @ presence leave", o), this.presences.delete(o), this.observers.get("presence.leave").next(o));
    }, this.onPresenceUpdate = (o) => {
      (o == null ? void 0 : o.roomId) === this.roomId && (this.logger.log("presence room @ presence update", o), this.observers.get("presence.update").next({ connectionId: o.connectionId, data: o.data, id: o.id, name: o.name, roomId: o == null ? void 0 : o.roomId, timestamp: o.timestamp }));
    }, this.logger = new ol("@superviz/socket-client/presence"), this.registerSubjects(), this.subscribeToPresenceEvents();
  }
  static register(t, i, r) {
    return new Ed(t, i, r);
  }
  get(t, i) {
    let r = new Zt();
    r.subscribe({ next: t, error: i });
    let o = (a) => {
      let u = a.presences.map((c) => ({ connectionId: c.connectionId, data: c.data, id: c.id, name: c.name, timestamp: c.timestamp }));
      this.logger.log("presence room @ get", a), this.io.off("presence.get", o), r.next(u), r.complete();
    };
    this.io.on("presence.get", o), this.io.emit("presence.get", this.roomId);
  }
  update(t) {
    let i = { connectionId: this.io.id, data: t, id: this.presence.id, name: this.presence.name, timestamp: Date.now() };
    this.io.emit("presence.update", this.roomId, i), this.logger.log("presence room @ update", this.roomId, i);
  }
  destroy() {
    this.io.off("presence.joined-room", this.onPresenceJoin), this.io.off("presence.leave", this.onPresenceLeave), this.io.off("presence.update", this.onPresenceUpdate), this.observers.forEach((t) => t.unsubscribe()), this.observers.clear();
  }
  registerSubjects() {
    this.observers.set("presence.joined-room", new Zt()), this.observers.set("presence.leave", new Zt()), this.observers.set("presence.update", new Zt());
  }
  on(t, i, r) {
    this.observers.get(t).subscribe({ error: r, next: i });
  }
  off(t) {
    this.observers.get(t).unsubscribe(), this.observers.delete(t), this.observers.set(t, new Zt());
  }
  subscribeToPresenceEvents() {
    this.io.on("presence.joined-room", this.onPresenceJoin), this.io.on("presence.leave", this.onPresenceLeave), this.io.on("presence.update", this.onPresenceUpdate);
  }
};
var Kt = /* @__PURE__ */ Object.create(null);
Kt.open = "0";
Kt.close = "1";
Kt.ping = "2";
Kt.pong = "3";
Kt.message = "4";
Kt.upgrade = "5";
Kt.noop = "6";
var _s = /* @__PURE__ */ Object.create(null);
Object.keys(Kt).forEach((e) => {
  _s[Kt[e]] = e;
});
var Ra = { type: "error", data: "parser error" };
var Pd = typeof Blob == "function" || typeof Blob < "u" && Object.prototype.toString.call(Blob) === "[object BlobConstructor]";
var Ad = typeof ArrayBuffer == "function";
var Sd = (e) => typeof ArrayBuffer.isView == "function" ? ArrayBuffer.isView(e) : e && e.buffer instanceof ArrayBuffer;
var al = ({ type: e, data: t }, i, r) => Pd && t instanceof Blob ? i ? r(t) : gh(t, r) : Ad && (t instanceof ArrayBuffer || Sd(t)) ? i ? r(t) : gh(new Blob([t]), r) : r(Kt[e] + (t || ""));
var gh = (e, t) => {
  let i = new FileReader();
  return i.onload = function() {
    let r = i.result.split(",")[1];
    t("b" + (r || ""));
  }, i.readAsDataURL(e);
};
function yh(e) {
  return e instanceof Uint8Array ? e : e instanceof ArrayBuffer ? new Uint8Array(e) : new Uint8Array(e.buffer, e.byteOffset, e.byteLength);
}
var ga;
function YC(e, t) {
  if (Pd && e.data instanceof Blob) return e.data.arrayBuffer().then(yh).then(t);
  if (Ad && (e.data instanceof ArrayBuffer || Sd(e.data))) return t(yh(e.data));
  al(e, false, (i) => {
    ga || (ga = new TextEncoder()), t(ga.encode(i));
  });
}
var bh = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
var Zn = typeof Uint8Array > "u" ? [] : new Uint8Array(256);
for (let e = 0; e < bh.length; e++) Zn[bh.charCodeAt(e)] = e;
var QC = (e) => {
  let t = e.length * 0.75, i = e.length, r, o = 0, a, u, c, p;
  e[e.length - 1] === "=" && (t--, e[e.length - 2] === "=" && t--);
  let h = new ArrayBuffer(t), f = new Uint8Array(h);
  for (r = 0; r < i; r += 4) a = Zn[e.charCodeAt(r)], u = Zn[e.charCodeAt(r + 1)], c = Zn[e.charCodeAt(r + 2)], p = Zn[e.charCodeAt(r + 3)], f[o++] = a << 2 | u >> 4, f[o++] = (u & 15) << 4 | c >> 2, f[o++] = (c & 3) << 6 | p & 63;
  return h;
};
var XC = typeof ArrayBuffer == "function";
var ll = (e, t) => {
  if (typeof e != "string") return { type: "message", data: Od(e, t) };
  let i = e.charAt(0);
  return i === "b" ? { type: "message", data: eE(e.substring(1), t) } : _s[i] ? e.length > 1 ? { type: _s[i], data: e.substring(1) } : { type: _s[i] } : Ra;
};
var eE = (e, t) => {
  if (XC) {
    let i = QC(e);
    return Od(i, t);
  } else return { base64: true, data: e };
};
var Od = (e, t) => {
  switch (t) {
    case "blob":
      return e instanceof Blob ? e : new Blob([e]);
    case "arraybuffer":
    default:
      return e instanceof ArrayBuffer ? e : e.buffer;
  }
};
var Td = "";
var tE = (e, t) => {
  let i = e.length, r = new Array(i), o = 0;
  e.forEach((a, u) => {
    al(a, false, (c) => {
      r[u] = c, ++o === i && t(r.join(Td));
    });
  });
};
var iE = (e, t) => {
  let i = e.split(Td), r = [];
  for (let o = 0; o < i.length; o++) {
    let a = ll(i[o], t);
    if (r.push(a), a.type === "error") break;
  }
  return r;
};
function nE() {
  return new TransformStream({ transform(e, t) {
    YC(e, (i) => {
      let r = i.length, o;
      if (r < 126) o = new Uint8Array(1), new DataView(o.buffer).setUint8(0, r);
      else if (r < 65536) {
        o = new Uint8Array(3);
        let a = new DataView(o.buffer);
        a.setUint8(0, 126), a.setUint16(1, r);
      } else {
        o = new Uint8Array(9);
        let a = new DataView(o.buffer);
        a.setUint8(0, 127), a.setBigUint64(1, BigInt(r));
      }
      e.data && typeof e.data != "string" && (o[0] |= 128), t.enqueue(o), t.enqueue(i);
    });
  } });
}
var ya;
function ps(e) {
  return e.reduce((t, i) => t + i.length, 0);
}
function fs(e, t) {
  if (e[0].length === t) return e.shift();
  let i = new Uint8Array(t), r = 0;
  for (let o = 0; o < t; o++) i[o] = e[0][r++], r === e[0].length && (e.shift(), r = 0);
  return e.length && r < e[0].length && (e[0] = e[0].slice(r)), i;
}
function rE(e, t) {
  ya || (ya = new TextDecoder());
  let i = [], r = 0, o = -1, a = false;
  return new TransformStream({ transform(u, c) {
    for (i.push(u); ; ) {
      if (r === 0) {
        if (ps(i) < 1) break;
        let p = fs(i, 1);
        a = (p[0] & 128) === 128, o = p[0] & 127, o < 126 ? r = 3 : o === 126 ? r = 1 : r = 2;
      } else if (r === 1) {
        if (ps(i) < 2) break;
        let p = fs(i, 2);
        o = new DataView(p.buffer, p.byteOffset, p.length).getUint16(0), r = 3;
      } else if (r === 2) {
        if (ps(i) < 8) break;
        let p = fs(i, 8), h = new DataView(p.buffer, p.byteOffset, p.length), f = h.getUint32(0);
        if (f > Math.pow(2, 21) - 1) {
          c.enqueue(Ra);
          break;
        }
        o = f * Math.pow(2, 32) + h.getUint32(4), r = 3;
      } else {
        if (ps(i) < o) break;
        let p = fs(i, o);
        c.enqueue(ll(a ? p : ya.decode(p), t)), r = 0;
      }
      if (o === 0 || o > e) {
        c.enqueue(Ra);
        break;
      }
    }
  } });
}
var xd = 4;
function ze(e) {
  if (e) return sE(e);
}
function sE(e) {
  for (var t in ze.prototype) e[t] = ze.prototype[t];
  return e;
}
ze.prototype.on = ze.prototype.addEventListener = function(e, t) {
  return this._callbacks = this._callbacks || {}, (this._callbacks["$" + e] = this._callbacks["$" + e] || []).push(t), this;
};
ze.prototype.once = function(e, t) {
  function i() {
    this.off(e, i), t.apply(this, arguments);
  }
  return i.fn = t, this.on(e, i), this;
};
ze.prototype.off = ze.prototype.removeListener = ze.prototype.removeAllListeners = ze.prototype.removeEventListener = function(e, t) {
  if (this._callbacks = this._callbacks || {}, arguments.length == 0) return this._callbacks = {}, this;
  var i = this._callbacks["$" + e];
  if (!i) return this;
  if (arguments.length == 1) return delete this._callbacks["$" + e], this;
  for (var r, o = 0; o < i.length; o++) if (r = i[o], r === t || r.fn === t) {
    i.splice(o, 1);
    break;
  }
  return i.length === 0 && delete this._callbacks["$" + e], this;
};
ze.prototype.emit = function(e) {
  this._callbacks = this._callbacks || {};
  for (var t = new Array(arguments.length - 1), i = this._callbacks["$" + e], r = 1; r < arguments.length; r++) t[r - 1] = arguments[r];
  if (i) {
    i = i.slice(0);
    for (var r = 0, o = i.length; r < o; ++r) i[r].apply(this, t);
  }
  return this;
};
ze.prototype.emitReserved = ze.prototype.emit;
ze.prototype.listeners = function(e) {
  return this._callbacks = this._callbacks || {}, this._callbacks["$" + e] || [];
};
ze.prototype.hasListeners = function(e) {
  return !!this.listeners(e).length;
};
var Tt = typeof self < "u" ? self : typeof window < "u" ? window : Function("return this")();
function kd(e, ...t) {
  return t.reduce((i, r) => (e.hasOwnProperty(r) && (i[r] = e[r]), i), {});
}
var oE = Tt.setTimeout;
var aE = Tt.clearTimeout;
function Ws(e, t) {
  t.useNativeTimers ? (e.setTimeoutFn = oE.bind(Tt), e.clearTimeoutFn = aE.bind(Tt)) : (e.setTimeoutFn = Tt.setTimeout.bind(Tt), e.clearTimeoutFn = Tt.clearTimeout.bind(Tt));
}
var lE = 1.33;
function uE(e) {
  return typeof e == "string" ? cE(e) : Math.ceil((e.byteLength || e.size) * lE);
}
function cE(e) {
  let t = 0, i = 0;
  for (let r = 0, o = e.length; r < o; r++) t = e.charCodeAt(r), t < 128 ? i += 1 : t < 2048 ? i += 2 : t < 55296 || t >= 57344 ? i += 3 : (r++, i += 4);
  return i;
}
function hE(e) {
  let t = "";
  for (let i in e) e.hasOwnProperty(i) && (t.length && (t += "&"), t += encodeURIComponent(i) + "=" + encodeURIComponent(e[i]));
  return t;
}
function dE(e) {
  let t = {}, i = e.split("&");
  for (let r = 0, o = i.length; r < o; r++) {
    let a = i[r].split("=");
    t[decodeURIComponent(a[0])] = decodeURIComponent(a[1]);
  }
  return t;
}
var pE = class extends Error {
  constructor(e, t, i) {
    super(e), this.description = t, this.context = i, this.type = "TransportError";
  }
};
var ul = class extends ze {
  constructor(e) {
    super(), this.writable = false, Ws(this, e), this.opts = e, this.query = e.query, this.socket = e.socket;
  }
  onError(e, t, i) {
    return super.emitReserved("error", new pE(e, t, i)), this;
  }
  open() {
    return this.readyState = "opening", this.doOpen(), this;
  }
  close() {
    return (this.readyState === "opening" || this.readyState === "open") && (this.doClose(), this.onClose()), this;
  }
  send(e) {
    this.readyState === "open" && this.write(e);
  }
  onOpen() {
    this.readyState = "open", this.writable = true, super.emitReserved("open");
  }
  onData(e) {
    let t = ll(e, this.socket.binaryType);
    this.onPacket(t);
  }
  onPacket(e) {
    super.emitReserved("packet", e);
  }
  onClose(e) {
    this.readyState = "closed", super.emitReserved("close", e);
  }
  pause(e) {
  }
  createUri(e, t = {}) {
    return e + "://" + this._hostname() + this._port() + this.opts.path + this._query(t);
  }
  _hostname() {
    let e = this.opts.hostname;
    return e.indexOf(":") === -1 ? e : "[" + e + "]";
  }
  _port() {
    return this.opts.port && (this.opts.secure && +(this.opts.port !== 443) || !this.opts.secure && Number(this.opts.port) !== 80) ? ":" + this.opts.port : "";
  }
  _query(e) {
    let t = hE(e);
    return t.length ? "?" + t : "";
  }
};
var Id = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split("");
var Fa = 64;
var fE = {};
var wh = 0;
var ms = 0;
var _h;
function Ch(e) {
  let t = "";
  do
    t = Id[e % Fa] + t, e = Math.floor(e / Fa);
  while (e > 0);
  return t;
}
function Md() {
  let e = Ch(+/* @__PURE__ */ new Date());
  return e !== _h ? (wh = 0, _h = e) : e + "." + Ch(wh++);
}
for (; ms < Fa; ms++) fE[Id[ms]] = ms;
var Rd = false;
try {
  Rd = typeof XMLHttpRequest < "u" && "withCredentials" in new XMLHttpRequest();
} catch {
}
var mE = Rd;
function Fd(e) {
  let t = e.xdomain;
  try {
    if (typeof XMLHttpRequest < "u" && (!t || mE)) return new XMLHttpRequest();
  } catch {
  }
  if (!t) try {
    return new Tt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP");
  } catch {
  }
}
function vE() {
}
var gE = function() {
  return new Fd({ xdomain: false }).responseType != null;
}();
var yE = class extends ul {
  constructor(e) {
    if (super(e), this.polling = false, typeof location < "u") {
      let i = location.protocol === "https:", r = location.port;
      r || (r = i ? "443" : "80"), this.xd = typeof location < "u" && e.hostname !== location.hostname || r !== e.port;
    }
    let t = e && e.forceBase64;
    this.supportsBinary = gE && !t, this.opts.withCredentials && (this.cookieJar = void 0);
  }
  get name() {
    return "polling";
  }
  doOpen() {
    this.poll();
  }
  pause(e) {
    this.readyState = "pausing";
    let t = () => {
      this.readyState = "paused", e();
    };
    if (this.polling || !this.writable) {
      let i = 0;
      this.polling && (i++, this.once("pollComplete", function() {
        --i || t();
      })), this.writable || (i++, this.once("drain", function() {
        --i || t();
      }));
    } else t();
  }
  poll() {
    this.polling = true, this.doPoll(), this.emitReserved("poll");
  }
  onData(e) {
    let t = (i) => {
      if (this.readyState === "opening" && i.type === "open" && this.onOpen(), i.type === "close") return this.onClose({ description: "transport closed by the server" }), false;
      this.onPacket(i);
    };
    iE(e, this.socket.binaryType).forEach(t), this.readyState !== "closed" && (this.polling = false, this.emitReserved("pollComplete"), this.readyState === "open" && this.poll());
  }
  doClose() {
    let e = () => {
      this.write([{ type: "close" }]);
    };
    this.readyState === "open" ? e() : this.once("open", e);
  }
  write(e) {
    this.writable = false, tE(e, (t) => {
      this.doWrite(t, () => {
        this.writable = true, this.emitReserved("drain");
      });
    });
  }
  uri() {
    let e = this.opts.secure ? "https" : "http", t = this.query || {};
    return this.opts.timestampRequests !== false && (t[this.opts.timestampParam] = Md()), !this.supportsBinary && !t.sid && (t.b64 = 1), this.createUri(e, t);
  }
  request(e = {}) {
    return Object.assign(e, { xd: this.xd, cookieJar: this.cookieJar }, this.opts), new pn(this.uri(), e);
  }
  doWrite(e, t) {
    let i = this.request({ method: "POST", data: e });
    i.on("success", t), i.on("error", (r, o) => {
      this.onError("xhr post error", r, o);
    });
  }
  doPoll() {
    let e = this.request();
    e.on("data", this.onData.bind(this)), e.on("error", (t, i) => {
      this.onError("xhr poll error", t, i);
    }), this.pollXhr = e;
  }
};
var pn = class Cs extends ze {
  constructor(t, i) {
    super(), Ws(this, i), this.opts = i, this.method = i.method || "GET", this.uri = t, this.data = i.data !== void 0 ? i.data : null, this.create();
  }
  create() {
    var t;
    let i = kd(this.opts, "agent", "pfx", "key", "passphrase", "cert", "ca", "ciphers", "rejectUnauthorized", "autoUnref");
    i.xdomain = !!this.opts.xd;
    let r = this.xhr = new Fd(i);
    try {
      r.open(this.method, this.uri, true);
      try {
        if (this.opts.extraHeaders) {
          r.setDisableHeaderCheck && r.setDisableHeaderCheck(true);
          for (let o in this.opts.extraHeaders) this.opts.extraHeaders.hasOwnProperty(o) && r.setRequestHeader(o, this.opts.extraHeaders[o]);
        }
      } catch {
      }
      if (this.method === "POST") try {
        r.setRequestHeader("Content-type", "text/plain;charset=UTF-8");
      } catch {
      }
      try {
        r.setRequestHeader("Accept", "*/*");
      } catch {
      }
      (t = this.opts.cookieJar) === null || t === void 0 || t.addCookies(r), "withCredentials" in r && (r.withCredentials = this.opts.withCredentials), this.opts.requestTimeout && (r.timeout = this.opts.requestTimeout), r.onreadystatechange = () => {
        var o;
        r.readyState === 3 && ((o = this.opts.cookieJar) === null || o === void 0 || o.parseCookies(r)), r.readyState === 4 && (r.status === 200 || r.status === 1223 ? this.onLoad() : this.setTimeoutFn(() => {
          this.onError(typeof r.status == "number" ? r.status : 0);
        }, 0));
      }, r.send(this.data);
    } catch (o) {
      this.setTimeoutFn(() => {
        this.onError(o);
      }, 0);
      return;
    }
    typeof document < "u" && (this.index = Cs.requestsCount++, Cs.requests[this.index] = this);
  }
  onError(t) {
    this.emitReserved("error", t, this.xhr), this.cleanup(true);
  }
  cleanup(t) {
    if (!(typeof this.xhr > "u" || this.xhr === null)) {
      if (this.xhr.onreadystatechange = vE, t) try {
        this.xhr.abort();
      } catch {
      }
      typeof document < "u" && delete Cs.requests[this.index], this.xhr = null;
    }
  }
  onLoad() {
    let t = this.xhr.responseText;
    t !== null && (this.emitReserved("data", t), this.emitReserved("success"), this.cleanup());
  }
  abort() {
    this.cleanup();
  }
};
pn.requestsCount = 0;
pn.requests = {};
if (typeof document < "u") {
  if (typeof attachEvent == "function") attachEvent("onunload", Eh);
  else if (typeof addEventListener == "function") {
    let e = "onpagehide" in Tt ? "pagehide" : "unload";
    addEventListener(e, Eh, false);
  }
}
function Eh() {
  for (let e in pn.requests) pn.requests.hasOwnProperty(e) && pn.requests[e].abort();
}
var cl = typeof Promise == "function" && typeof Promise.resolve == "function" ? (e) => Promise.resolve().then(e) : (e, t) => t(e, 0);
var vs = Tt.WebSocket || Tt.MozWebSocket;
var Ph = true;
var bE = "arraybuffer";
var Ah = typeof navigator < "u" && typeof navigator.product == "string" && navigator.product.toLowerCase() === "reactnative";
var wE = class extends ul {
  constructor(e) {
    super(e), this.supportsBinary = !e.forceBase64;
  }
  get name() {
    return "websocket";
  }
  doOpen() {
    if (!this.check()) return;
    let e = this.uri(), t = this.opts.protocols, i = Ah ? {} : kd(this.opts, "agent", "perMessageDeflate", "pfx", "key", "passphrase", "cert", "ca", "ciphers", "rejectUnauthorized", "localAddress", "protocolVersion", "origin", "maxPayload", "family", "checkServerIdentity");
    this.opts.extraHeaders && (i.headers = this.opts.extraHeaders);
    try {
      this.ws = Ph && !Ah ? t ? new vs(e, t) : new vs(e) : new vs(e, t, i);
    } catch (r) {
      return this.emitReserved("error", r);
    }
    this.ws.binaryType = this.socket.binaryType, this.addEventListeners();
  }
  addEventListeners() {
    this.ws.onopen = () => {
      this.opts.autoUnref && this.ws._socket.unref(), this.onOpen();
    }, this.ws.onclose = (e) => this.onClose({ description: "websocket connection closed", context: e }), this.ws.onmessage = (e) => this.onData(e.data), this.ws.onerror = (e) => this.onError("websocket error", e);
  }
  write(e) {
    this.writable = false;
    for (let t = 0; t < e.length; t++) {
      let i = e[t], r = t === e.length - 1;
      al(i, this.supportsBinary, (o) => {
        let a = {};
        try {
          Ph ? this.ws.send(o) : this.ws.send(o, a);
        } catch {
        }
        r && cl(() => {
          this.writable = true, this.emitReserved("drain");
        }, this.setTimeoutFn);
      });
    }
  }
  doClose() {
    typeof this.ws < "u" && (this.ws.close(), this.ws = null);
  }
  uri() {
    let e = this.opts.secure ? "wss" : "ws", t = this.query || {};
    return this.opts.timestampRequests && (t[this.opts.timestampParam] = Md()), this.supportsBinary || (t.b64 = 1), this.createUri(e, t);
  }
  check() {
    return !!vs;
  }
};
var _E = class extends ul {
  get name() {
    return "webtransport";
  }
  doOpen() {
    typeof WebTransport == "function" && (this.transport = new WebTransport(this.createUri("https"), this.opts.transportOptions[this.name]), this.transport.closed.then(() => {
      this.onClose();
    }).catch((e) => {
      this.onError("webtransport error", e);
    }), this.transport.ready.then(() => {
      this.transport.createBidirectionalStream().then((e) => {
        let t = rE(Number.MAX_SAFE_INTEGER, this.socket.binaryType), i = e.readable.pipeThrough(t).getReader(), r = nE();
        r.readable.pipeTo(e.writable), this.writer = r.writable.getWriter();
        let o = () => {
          i.read().then(({ done: u, value: c }) => {
            u || (this.onPacket(c), o());
          }).catch((u) => {
          });
        };
        o();
        let a = { type: "open" };
        this.query.sid && (a.data = `{"sid":"${this.query.sid}"}`), this.writer.write(a).then(() => this.onOpen());
      });
    }));
  }
  write(e) {
    this.writable = false;
    for (let t = 0; t < e.length; t++) {
      let i = e[t], r = t === e.length - 1;
      this.writer.write(i).then(() => {
        r && cl(() => {
          this.writable = true, this.emitReserved("drain");
        }, this.setTimeoutFn);
      });
    }
  }
  doClose() {
    var e;
    (e = this.transport) === null || e === void 0 || e.close();
  }
};
var CE = { websocket: wE, webtransport: _E, polling: yE };
var EE = /^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;
var PE = ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "anchor"];
function La(e) {
  if (e.length > 2e3) throw "URI too long";
  let t = e, i = e.indexOf("["), r = e.indexOf("]");
  i != -1 && r != -1 && (e = e.substring(0, i) + e.substring(i, r).replace(/:/g, ";") + e.substring(r, e.length));
  let o = EE.exec(e || ""), a = {}, u = 14;
  for (; u--; ) a[PE[u]] = o[u] || "";
  return i != -1 && r != -1 && (a.source = t, a.host = a.host.substring(1, a.host.length - 1).replace(/;/g, ":"), a.authority = a.authority.replace("[", "").replace("]", "").replace(/;/g, ":"), a.ipv6uri = true), a.pathNames = AE(a, a.path), a.queryKey = SE(a, a.query), a;
}
function AE(e, t) {
  let i = /\/{2,9}/g, r = t.replace(i, "/").split("/");
  return (t.slice(0, 1) == "/" || t.length === 0) && r.splice(0, 1), t.slice(-1) == "/" && r.splice(r.length - 1, 1), r;
}
function SE(e, t) {
  let i = {};
  return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function(r, o, a) {
    o && (i[o] = a);
  }), i;
}
var Ld = class cn extends ze {
  constructor(t, i = {}) {
    super(), this.binaryType = bE, this.writeBuffer = [], t && typeof t == "object" && (i = t, t = null), t ? (t = La(t), i.hostname = t.host, i.secure = t.protocol === "https" || t.protocol === "wss", i.port = t.port, t.query && (i.query = t.query)) : i.host && (i.hostname = La(i.host).host), Ws(this, i), this.secure = i.secure != null ? i.secure : typeof location < "u" && location.protocol === "https:", i.hostname && !i.port && (i.port = this.secure ? "443" : "80"), this.hostname = i.hostname || (typeof location < "u" ? location.hostname : "localhost"), this.port = i.port || (typeof location < "u" && location.port ? location.port : this.secure ? "443" : "80"), this.transports = i.transports || ["polling", "websocket", "webtransport"], this.writeBuffer = [], this.prevBufferLen = 0, this.opts = Object.assign({ path: "/engine.io", agent: false, withCredentials: false, upgrade: true, timestampParam: "t", rememberUpgrade: false, addTrailingSlash: true, rejectUnauthorized: true, perMessageDeflate: { threshold: 1024 }, transportOptions: {}, closeOnBeforeunload: false }, i), this.opts.path = this.opts.path.replace(/\/$/, "") + (this.opts.addTrailingSlash ? "/" : ""), typeof this.opts.query == "string" && (this.opts.query = dE(this.opts.query)), this.id = null, this.upgrades = null, this.pingInterval = null, this.pingTimeout = null, this.pingTimeoutTimer = null, typeof addEventListener == "function" && (this.opts.closeOnBeforeunload && (this.beforeunloadEventListener = () => {
      this.transport && (this.transport.removeAllListeners(), this.transport.close());
    }, addEventListener("beforeunload", this.beforeunloadEventListener, false)), this.hostname !== "localhost" && (this.offlineEventListener = () => {
      this.onClose("transport close", { description: "network connection lost" });
    }, addEventListener("offline", this.offlineEventListener, false))), this.open();
  }
  createTransport(t) {
    let i = Object.assign({}, this.opts.query);
    i.EIO = xd, i.transport = t, this.id && (i.sid = this.id);
    let r = Object.assign({}, this.opts, { query: i, socket: this, hostname: this.hostname, secure: this.secure, port: this.port }, this.opts.transportOptions[t]);
    return new CE[t](r);
  }
  open() {
    let t;
    if (this.opts.rememberUpgrade && cn.priorWebsocketSuccess && this.transports.indexOf("websocket") !== -1) t = "websocket";
    else if (this.transports.length === 0) {
      this.setTimeoutFn(() => {
        this.emitReserved("error", "No transports available");
      }, 0);
      return;
    } else t = this.transports[0];
    this.readyState = "opening";
    try {
      t = this.createTransport(t);
    } catch {
      this.transports.shift(), this.open();
      return;
    }
    t.open(), this.setTransport(t);
  }
  setTransport(t) {
    this.transport && this.transport.removeAllListeners(), this.transport = t, t.on("drain", this.onDrain.bind(this)).on("packet", this.onPacket.bind(this)).on("error", this.onError.bind(this)).on("close", (i) => this.onClose("transport close", i));
  }
  probe(t) {
    let i = this.createTransport(t), r = false;
    cn.priorWebsocketSuccess = false;
    let o = () => {
      r || (i.send([{ type: "ping", data: "probe" }]), i.once("packet", (m) => {
        if (!r) if (m.type === "pong" && m.data === "probe") {
          if (this.upgrading = true, this.emitReserved("upgrading", i), !i) return;
          cn.priorWebsocketSuccess = i.name === "websocket", this.transport.pause(() => {
            r || this.readyState !== "closed" && (f(), this.setTransport(i), i.send([{ type: "upgrade" }]), this.emitReserved("upgrade", i), i = null, this.upgrading = false, this.flush());
          });
        } else {
          let y = new Error("probe error");
          y.transport = i.name, this.emitReserved("upgradeError", y);
        }
      }));
    };
    function a() {
      r || (r = true, f(), i.close(), i = null);
    }
    let u = (m) => {
      let y = new Error("probe error: " + m);
      y.transport = i.name, a(), this.emitReserved("upgradeError", y);
    };
    function c() {
      u("transport closed");
    }
    function p() {
      u("socket closed");
    }
    function h(m) {
      i && m.name !== i.name && a();
    }
    let f = () => {
      i.removeListener("open", o), i.removeListener("error", u), i.removeListener("close", c), this.off("close", p), this.off("upgrading", h);
    };
    i.once("open", o), i.once("error", u), i.once("close", c), this.once("close", p), this.once("upgrading", h), this.upgrades.indexOf("webtransport") !== -1 && t !== "webtransport" ? this.setTimeoutFn(() => {
      r || i.open();
    }, 200) : i.open();
  }
  onOpen() {
    if (this.readyState = "open", cn.priorWebsocketSuccess = this.transport.name === "websocket", this.emitReserved("open"), this.flush(), this.readyState === "open" && this.opts.upgrade) {
      let t = 0, i = this.upgrades.length;
      for (; t < i; t++) this.probe(this.upgrades[t]);
    }
  }
  onPacket(t) {
    if (this.readyState === "opening" || this.readyState === "open" || this.readyState === "closing") switch (this.emitReserved("packet", t), this.emitReserved("heartbeat"), this.resetPingTimeout(), t.type) {
      case "open":
        this.onHandshake(JSON.parse(t.data));
        break;
      case "ping":
        this.sendPacket("pong"), this.emitReserved("ping"), this.emitReserved("pong");
        break;
      case "error":
        let i = new Error("server error");
        i.code = t.data, this.onError(i);
        break;
      case "message":
        this.emitReserved("data", t.data), this.emitReserved("message", t.data);
        break;
    }
  }
  onHandshake(t) {
    this.emitReserved("handshake", t), this.id = t.sid, this.transport.query.sid = t.sid, this.upgrades = this.filterUpgrades(t.upgrades), this.pingInterval = t.pingInterval, this.pingTimeout = t.pingTimeout, this.maxPayload = t.maxPayload, this.onOpen(), this.readyState !== "closed" && this.resetPingTimeout();
  }
  resetPingTimeout() {
    this.clearTimeoutFn(this.pingTimeoutTimer), this.pingTimeoutTimer = this.setTimeoutFn(() => {
      this.onClose("ping timeout");
    }, this.pingInterval + this.pingTimeout), this.opts.autoUnref && this.pingTimeoutTimer.unref();
  }
  onDrain() {
    this.writeBuffer.splice(0, this.prevBufferLen), this.prevBufferLen = 0, this.writeBuffer.length === 0 ? this.emitReserved("drain") : this.flush();
  }
  flush() {
    if (this.readyState !== "closed" && this.transport.writable && !this.upgrading && this.writeBuffer.length) {
      let t = this.getWritablePackets();
      this.transport.send(t), this.prevBufferLen = t.length, this.emitReserved("flush");
    }
  }
  getWritablePackets() {
    if (!(this.maxPayload && this.transport.name === "polling" && this.writeBuffer.length > 1)) return this.writeBuffer;
    let t = 1;
    for (let i = 0; i < this.writeBuffer.length; i++) {
      let r = this.writeBuffer[i].data;
      if (r && (t += uE(r)), i > 0 && t > this.maxPayload) return this.writeBuffer.slice(0, i);
      t += 2;
    }
    return this.writeBuffer;
  }
  write(t, i, r) {
    return this.sendPacket("message", t, i, r), this;
  }
  send(t, i, r) {
    return this.sendPacket("message", t, i, r), this;
  }
  sendPacket(t, i, r, o) {
    if (typeof i == "function" && (o = i, i = void 0), typeof r == "function" && (o = r, r = null), this.readyState === "closing" || this.readyState === "closed") return;
    r = r || {}, r.compress = r.compress !== false;
    let a = { type: t, data: i, options: r };
    this.emitReserved("packetCreate", a), this.writeBuffer.push(a), o && this.once("flush", o), this.flush();
  }
  close() {
    let t = () => {
      this.onClose("forced close"), this.transport.close();
    }, i = () => {
      this.off("upgrade", i), this.off("upgradeError", i), t();
    }, r = () => {
      this.once("upgrade", i), this.once("upgradeError", i);
    };
    return (this.readyState === "opening" || this.readyState === "open") && (this.readyState = "closing", this.writeBuffer.length ? this.once("drain", () => {
      this.upgrading ? r() : t();
    }) : this.upgrading ? r() : t()), this;
  }
  onError(t) {
    cn.priorWebsocketSuccess = false, this.emitReserved("error", t), this.onClose("transport error", t);
  }
  onClose(t, i) {
    (this.readyState === "opening" || this.readyState === "open" || this.readyState === "closing") && (this.clearTimeoutFn(this.pingTimeoutTimer), this.transport.removeAllListeners("close"), this.transport.close(), this.transport.removeAllListeners(), typeof removeEventListener == "function" && (removeEventListener("beforeunload", this.beforeunloadEventListener, false), removeEventListener("offline", this.offlineEventListener, false)), this.readyState = "closed", this.id = null, this.emitReserved("close", t, i), this.writeBuffer = [], this.prevBufferLen = 0);
  }
  filterUpgrades(t) {
    let i = [], r = 0, o = t.length;
    for (; r < o; r++) ~this.transports.indexOf(t[r]) && i.push(t[r]);
    return i;
  }
};
Ld.protocol = xd;
function OE(e, t = "", i) {
  let r = e;
  i = i || typeof location < "u" && location, e == null && (e = i.protocol + "//" + i.host), typeof e == "string" && (e.charAt(0) === "/" && (e.charAt(1) === "/" ? e = i.protocol + e : e = i.host + e), /^(https?|wss?):\/\//.test(e) || (typeof i < "u" ? e = i.protocol + "//" + e : e = "https://" + e), r = La(e)), r.port || (/^(http|ws)$/.test(r.protocol) ? r.port = "80" : /^(http|ws)s$/.test(r.protocol) && (r.port = "443")), r.path = r.path || "/";
  let o = r.host.indexOf(":") !== -1 ? "[" + r.host + "]" : r.host;
  return r.id = r.protocol + "://" + o + ":" + r.port + t, r.href = r.protocol + "://" + o + (i && i.port === r.port ? "" : ":" + r.port), r;
}
var Nd = {};
IC(Nd, { Decoder: () => DE, Encoder: () => NE, PacketType: () => ye, protocol: () => LE });
var TE = typeof ArrayBuffer == "function";
var xE = (e) => typeof ArrayBuffer.isView == "function" ? ArrayBuffer.isView(e) : e.buffer instanceof ArrayBuffer;
var Dd = Object.prototype.toString;
var kE = typeof Blob == "function" || typeof Blob < "u" && Dd.call(Blob) === "[object BlobConstructor]";
var IE = typeof File == "function" || typeof File < "u" && Dd.call(File) === "[object FileConstructor]";
function hl(e) {
  return TE && (e instanceof ArrayBuffer || xE(e)) || kE && e instanceof Blob || IE && e instanceof File;
}
function Es(e, t) {
  if (!e || typeof e != "object") return false;
  if (Array.isArray(e)) {
    for (let i = 0, r = e.length; i < r; i++) if (Es(e[i])) return true;
    return false;
  }
  if (hl(e)) return true;
  if (e.toJSON && typeof e.toJSON == "function" && arguments.length === 1) return Es(e.toJSON(), true);
  for (let i in e) if (Object.prototype.hasOwnProperty.call(e, i) && Es(e[i])) return true;
  return false;
}
function ME(e) {
  let t = [], i = e.data, r = e;
  return r.data = Na(i, t), r.attachments = t.length, { packet: r, buffers: t };
}
function Na(e, t) {
  if (!e) return e;
  if (hl(e)) {
    let i = { _placeholder: true, num: t.length };
    return t.push(e), i;
  } else if (Array.isArray(e)) {
    let i = new Array(e.length);
    for (let r = 0; r < e.length; r++) i[r] = Na(e[r], t);
    return i;
  } else if (typeof e == "object" && !(e instanceof Date)) {
    let i = {};
    for (let r in e) Object.prototype.hasOwnProperty.call(e, r) && (i[r] = Na(e[r], t));
    return i;
  }
  return e;
}
function RE(e, t) {
  return e.data = Da(e.data, t), delete e.attachments, e;
}
function Da(e, t) {
  if (!e) return e;
  if (e && e._placeholder === true) {
    if (typeof e.num == "number" && e.num >= 0 && e.num < t.length) return t[e.num];
    throw new Error("illegal attachments");
  } else if (Array.isArray(e)) for (let i = 0; i < e.length; i++) e[i] = Da(e[i], t);
  else if (typeof e == "object") for (let i in e) Object.prototype.hasOwnProperty.call(e, i) && (e[i] = Da(e[i], t));
  return e;
}
var FE = ["connect", "connect_error", "disconnect", "disconnecting", "newListener", "removeListener"];
var LE = 5;
var ye;
(function(e) {
  e[e.CONNECT = 0] = "CONNECT", e[e.DISCONNECT = 1] = "DISCONNECT", e[e.EVENT = 2] = "EVENT", e[e.ACK = 3] = "ACK", e[e.CONNECT_ERROR = 4] = "CONNECT_ERROR", e[e.BINARY_EVENT = 5] = "BINARY_EVENT", e[e.BINARY_ACK = 6] = "BINARY_ACK";
})(ye || (ye = {}));
var NE = class {
  constructor(e) {
    this.replacer = e;
  }
  encode(e) {
    return (e.type === ye.EVENT || e.type === ye.ACK) && Es(e) ? this.encodeAsBinary({ type: e.type === ye.EVENT ? ye.BINARY_EVENT : ye.BINARY_ACK, nsp: e.nsp, data: e.data, id: e.id }) : [this.encodeAsString(e)];
  }
  encodeAsString(e) {
    let t = "" + e.type;
    return (e.type === ye.BINARY_EVENT || e.type === ye.BINARY_ACK) && (t += e.attachments + "-"), e.nsp && e.nsp !== "/" && (t += e.nsp + ","), e.id != null && (t += e.id), e.data != null && (t += JSON.stringify(e.data, this.replacer)), t;
  }
  encodeAsBinary(e) {
    let t = ME(e), i = this.encodeAsString(t.packet), r = t.buffers;
    return r.unshift(i), r;
  }
};
function Sh(e) {
  return Object.prototype.toString.call(e) === "[object Object]";
}
var DE = class jd extends ze {
  constructor(t) {
    super(), this.reviver = t;
  }
  add(t) {
    let i;
    if (typeof t == "string") {
      if (this.reconstructor) throw new Error("got plaintext data when reconstructing a packet");
      i = this.decodeString(t);
      let r = i.type === ye.BINARY_EVENT;
      r || i.type === ye.BINARY_ACK ? (i.type = r ? ye.EVENT : ye.ACK, this.reconstructor = new jE(i), i.attachments === 0 && super.emitReserved("decoded", i)) : super.emitReserved("decoded", i);
    } else if (hl(t) || t.base64) if (this.reconstructor) i = this.reconstructor.takeBinaryData(t), i && (this.reconstructor = null, super.emitReserved("decoded", i));
    else throw new Error("got binary data when not reconstructing a packet");
    else throw new Error("Unknown type: " + t);
  }
  decodeString(t) {
    let i = 0, r = { type: Number(t.charAt(0)) };
    if (ye[r.type] === void 0) throw new Error("unknown packet type " + r.type);
    if (r.type === ye.BINARY_EVENT || r.type === ye.BINARY_ACK) {
      let a = i + 1;
      for (; t.charAt(++i) !== "-" && i != t.length; ) ;
      let u = t.substring(a, i);
      if (u != Number(u) || t.charAt(i) !== "-") throw new Error("Illegal attachments");
      r.attachments = Number(u);
    }
    if (t.charAt(i + 1) === "/") {
      let a = i + 1;
      for (; ++i && !(t.charAt(i) === "," || i === t.length); ) ;
      r.nsp = t.substring(a, i);
    } else r.nsp = "/";
    let o = t.charAt(i + 1);
    if (o !== "" && Number(o) == o) {
      let a = i + 1;
      for (; ++i; ) {
        let u = t.charAt(i);
        if (u == null || Number(u) != u) {
          --i;
          break;
        }
        if (i === t.length) break;
      }
      r.id = Number(t.substring(a, i + 1));
    }
    if (t.charAt(++i)) {
      let a = this.tryParse(t.substr(i));
      if (jd.isPayloadValid(r.type, a)) r.data = a;
      else throw new Error("invalid payload");
    }
    return r;
  }
  tryParse(t) {
    try {
      return JSON.parse(t, this.reviver);
    } catch {
      return false;
    }
  }
  static isPayloadValid(t, i) {
    switch (t) {
      case ye.CONNECT:
        return Sh(i);
      case ye.DISCONNECT:
        return i === void 0;
      case ye.CONNECT_ERROR:
        return typeof i == "string" || Sh(i);
      case ye.EVENT:
      case ye.BINARY_EVENT:
        return Array.isArray(i) && (typeof i[0] == "number" || typeof i[0] == "string" && FE.indexOf(i[0]) === -1);
      case ye.ACK:
      case ye.BINARY_ACK:
        return Array.isArray(i);
    }
  }
  destroy() {
    this.reconstructor && (this.reconstructor.finishedReconstruction(), this.reconstructor = null);
  }
};
var jE = class {
  constructor(e) {
    this.packet = e, this.buffers = [], this.reconPack = e;
  }
  takeBinaryData(e) {
    if (this.buffers.push(e), this.buffers.length === this.reconPack.attachments) {
      let t = RE(this.reconPack, this.buffers);
      return this.finishedReconstruction(), t;
    }
    return null;
  }
  finishedReconstruction() {
    this.reconPack = null, this.buffers = [];
  }
};
function Bt(e, t, i) {
  return e.on(t, i), function() {
    e.off(t, i);
  };
}
var BE = Object.freeze({ connect: 1, connect_error: 1, disconnect: 1, disconnecting: 1, newListener: 1, removeListener: 1 });
var Bd = class extends ze {
  constructor(e, t, i) {
    super(), this.connected = false, this.recovered = false, this.receiveBuffer = [], this.sendBuffer = [], this._queue = [], this._queueSeq = 0, this.ids = 0, this.acks = {}, this.flags = {}, this.io = e, this.nsp = t, i && i.auth && (this.auth = i.auth), this._opts = Object.assign({}, i), this.io._autoConnect && this.open();
  }
  get disconnected() {
    return !this.connected;
  }
  subEvents() {
    if (this.subs) return;
    let e = this.io;
    this.subs = [Bt(e, "open", this.onopen.bind(this)), Bt(e, "packet", this.onpacket.bind(this)), Bt(e, "error", this.onerror.bind(this)), Bt(e, "close", this.onclose.bind(this))];
  }
  get active() {
    return !!this.subs;
  }
  connect() {
    return this.connected ? this : (this.subEvents(), this.io._reconnecting || this.io.open(), this.io._readyState === "open" && this.onopen(), this);
  }
  open() {
    return this.connect();
  }
  send(...e) {
    return e.unshift("message"), this.emit.apply(this, e), this;
  }
  emit(e, ...t) {
    if (BE.hasOwnProperty(e)) throw new Error('"' + e.toString() + '" is a reserved event name');
    if (t.unshift(e), this._opts.retries && !this.flags.fromQueue && !this.flags.volatile) return this._addToQueue(t), this;
    let i = { type: ye.EVENT, data: t };
    if (i.options = {}, i.options.compress = this.flags.compress !== false, typeof t[t.length - 1] == "function") {
      let o = this.ids++, a = t.pop();
      this._registerAckCallback(o, a), i.id = o;
    }
    let r = this.io.engine && this.io.engine.transport && this.io.engine.transport.writable;
    return this.flags.volatile && (!r || !this.connected) || (this.connected ? (this.notifyOutgoingListeners(i), this.packet(i)) : this.sendBuffer.push(i)), this.flags = {}, this;
  }
  _registerAckCallback(e, t) {
    var i;
    let r = (i = this.flags.timeout) !== null && i !== void 0 ? i : this._opts.ackTimeout;
    if (r === void 0) {
      this.acks[e] = t;
      return;
    }
    let o = this.io.setTimeoutFn(() => {
      delete this.acks[e];
      for (let u = 0; u < this.sendBuffer.length; u++) this.sendBuffer[u].id === e && this.sendBuffer.splice(u, 1);
      t.call(this, new Error("operation has timed out"));
    }, r), a = (...u) => {
      this.io.clearTimeoutFn(o), t.apply(this, u);
    };
    a.withError = true, this.acks[e] = a;
  }
  emitWithAck(e, ...t) {
    return new Promise((i, r) => {
      let o = (a, u) => a ? r(a) : i(u);
      o.withError = true, t.push(o), this.emit(e, ...t);
    });
  }
  _addToQueue(e) {
    let t;
    typeof e[e.length - 1] == "function" && (t = e.pop());
    let i = { id: this._queueSeq++, tryCount: 0, pending: false, args: e, flags: Object.assign({ fromQueue: true }, this.flags) };
    e.push((r, ...o) => i !== this._queue[0] ? void 0 : (r !== null ? i.tryCount > this._opts.retries && (this._queue.shift(), t && t(r)) : (this._queue.shift(), t && t(null, ...o)), i.pending = false, this._drainQueue())), this._queue.push(i), this._drainQueue();
  }
  _drainQueue(e = false) {
    if (!this.connected || this._queue.length === 0) return;
    let t = this._queue[0];
    t.pending && !e || (t.pending = true, t.tryCount++, this.flags = t.flags, this.emit.apply(this, t.args));
  }
  packet(e) {
    e.nsp = this.nsp, this.io._packet(e);
  }
  onopen() {
    typeof this.auth == "function" ? this.auth((e) => {
      this._sendConnectPacket(e);
    }) : this._sendConnectPacket(this.auth);
  }
  _sendConnectPacket(e) {
    this.packet({ type: ye.CONNECT, data: this._pid ? Object.assign({ pid: this._pid, offset: this._lastOffset }, e) : e });
  }
  onerror(e) {
    this.connected || this.emitReserved("connect_error", e);
  }
  onclose(e, t) {
    this.connected = false, delete this.id, this.emitReserved("disconnect", e, t), this._clearAcks();
  }
  _clearAcks() {
    Object.keys(this.acks).forEach((e) => {
      if (!this.sendBuffer.some((t) => String(t.id) === e)) {
        let t = this.acks[e];
        delete this.acks[e], t.withError && t.call(this, new Error("socket has been disconnected"));
      }
    });
  }
  onpacket(e) {
    if (e.nsp === this.nsp) switch (e.type) {
      case ye.CONNECT:
        e.data && e.data.sid ? this.onconnect(e.data.sid, e.data.pid) : this.emitReserved("connect_error", new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));
        break;
      case ye.EVENT:
      case ye.BINARY_EVENT:
        this.onevent(e);
        break;
      case ye.ACK:
      case ye.BINARY_ACK:
        this.onack(e);
        break;
      case ye.DISCONNECT:
        this.ondisconnect();
        break;
      case ye.CONNECT_ERROR:
        this.destroy();
        let t = new Error(e.data.message);
        t.data = e.data.data, this.emitReserved("connect_error", t);
        break;
    }
  }
  onevent(e) {
    let t = e.data || [];
    e.id != null && t.push(this.ack(e.id)), this.connected ? this.emitEvent(t) : this.receiveBuffer.push(Object.freeze(t));
  }
  emitEvent(e) {
    if (this._anyListeners && this._anyListeners.length) {
      let t = this._anyListeners.slice();
      for (let i of t) i.apply(this, e);
    }
    super.emit.apply(this, e), this._pid && e.length && typeof e[e.length - 1] == "string" && (this._lastOffset = e[e.length - 1]);
  }
  ack(e) {
    let t = this, i = false;
    return function(...r) {
      i || (i = true, t.packet({ type: ye.ACK, id: e, data: r }));
    };
  }
  onack(e) {
    let t = this.acks[e.id];
    typeof t == "function" && (delete this.acks[e.id], t.withError && e.data.unshift(null), t.apply(this, e.data));
  }
  onconnect(e, t) {
    this.id = e, this.recovered = t && this._pid === t, this._pid = t, this.connected = true, this.emitBuffered(), this.emitReserved("connect"), this._drainQueue(true);
  }
  emitBuffered() {
    this.receiveBuffer.forEach((e) => this.emitEvent(e)), this.receiveBuffer = [], this.sendBuffer.forEach((e) => {
      this.notifyOutgoingListeners(e), this.packet(e);
    }), this.sendBuffer = [];
  }
  ondisconnect() {
    this.destroy(), this.onclose("io server disconnect");
  }
  destroy() {
    this.subs && (this.subs.forEach((e) => e()), this.subs = void 0), this.io._destroy(this);
  }
  disconnect() {
    return this.connected && this.packet({ type: ye.DISCONNECT }), this.destroy(), this.connected && this.onclose("io client disconnect"), this;
  }
  close() {
    return this.disconnect();
  }
  compress(e) {
    return this.flags.compress = e, this;
  }
  get volatile() {
    return this.flags.volatile = true, this;
  }
  timeout(e) {
    return this.flags.timeout = e, this;
  }
  onAny(e) {
    return this._anyListeners = this._anyListeners || [], this._anyListeners.push(e), this;
  }
  prependAny(e) {
    return this._anyListeners = this._anyListeners || [], this._anyListeners.unshift(e), this;
  }
  offAny(e) {
    if (!this._anyListeners) return this;
    if (e) {
      let t = this._anyListeners;
      for (let i = 0; i < t.length; i++) if (e === t[i]) return t.splice(i, 1), this;
    } else this._anyListeners = [];
    return this;
  }
  listenersAny() {
    return this._anyListeners || [];
  }
  onAnyOutgoing(e) {
    return this._anyOutgoingListeners = this._anyOutgoingListeners || [], this._anyOutgoingListeners.push(e), this;
  }
  prependAnyOutgoing(e) {
    return this._anyOutgoingListeners = this._anyOutgoingListeners || [], this._anyOutgoingListeners.unshift(e), this;
  }
  offAnyOutgoing(e) {
    if (!this._anyOutgoingListeners) return this;
    if (e) {
      let t = this._anyOutgoingListeners;
      for (let i = 0; i < t.length; i++) if (e === t[i]) return t.splice(i, 1), this;
    } else this._anyOutgoingListeners = [];
    return this;
  }
  listenersAnyOutgoing() {
    return this._anyOutgoingListeners || [];
  }
  notifyOutgoingListeners(e) {
    if (this._anyOutgoingListeners && this._anyOutgoingListeners.length) {
      let t = this._anyOutgoingListeners.slice();
      for (let i of t) i.apply(this, e.data);
    }
  }
};
function Cn(e) {
  e = e || {}, this.ms = e.min || 100, this.max = e.max || 1e4, this.factor = e.factor || 2, this.jitter = e.jitter > 0 && e.jitter <= 1 ? e.jitter : 0, this.attempts = 0;
}
Cn.prototype.duration = function() {
  var e = this.ms * Math.pow(this.factor, this.attempts++);
  if (this.jitter) {
    var t = Math.random(), i = Math.floor(t * this.jitter * e);
    e = Math.floor(t * 10) & 1 ? e + i : e - i;
  }
  return Math.min(e, this.max) | 0;
};
Cn.prototype.reset = function() {
  this.attempts = 0;
};
Cn.prototype.setMin = function(e) {
  this.ms = e;
};
Cn.prototype.setMax = function(e) {
  this.max = e;
};
Cn.prototype.setJitter = function(e) {
  this.jitter = e;
};
var ks = class extends ze {
  constructor(e, t) {
    var i;
    super(), this.nsps = {}, this.subs = [], e && typeof e == "object" && (t = e, e = void 0), t = t || {}, t.path = t.path || "/socket.io", this.opts = t, Ws(this, t), this.reconnection(t.reconnection !== false), this.reconnectionAttempts(t.reconnectionAttempts || 1 / 0), this.reconnectionDelay(t.reconnectionDelay || 1e3), this.reconnectionDelayMax(t.reconnectionDelayMax || 5e3), this.randomizationFactor((i = t.randomizationFactor) !== null && i !== void 0 ? i : 0.5), this.backoff = new Cn({ min: this.reconnectionDelay(), max: this.reconnectionDelayMax(), jitter: this.randomizationFactor() }), this.timeout(t.timeout == null ? 2e4 : t.timeout), this._readyState = "closed", this.uri = e;
    let r = t.parser || Nd;
    this.encoder = new r.Encoder(), this.decoder = new r.Decoder(), this._autoConnect = t.autoConnect !== false, this._autoConnect && this.open();
  }
  reconnection(e) {
    return arguments.length ? (this._reconnection = !!e, this) : this._reconnection;
  }
  reconnectionAttempts(e) {
    return e === void 0 ? this._reconnectionAttempts : (this._reconnectionAttempts = e, this);
  }
  reconnectionDelay(e) {
    var t;
    return e === void 0 ? this._reconnectionDelay : (this._reconnectionDelay = e, (t = this.backoff) === null || t === void 0 || t.setMin(e), this);
  }
  randomizationFactor(e) {
    var t;
    return e === void 0 ? this._randomizationFactor : (this._randomizationFactor = e, (t = this.backoff) === null || t === void 0 || t.setJitter(e), this);
  }
  reconnectionDelayMax(e) {
    var t;
    return e === void 0 ? this._reconnectionDelayMax : (this._reconnectionDelayMax = e, (t = this.backoff) === null || t === void 0 || t.setMax(e), this);
  }
  timeout(e) {
    return arguments.length ? (this._timeout = e, this) : this._timeout;
  }
  maybeReconnectOnOpen() {
    !this._reconnecting && this._reconnection && this.backoff.attempts === 0 && this.reconnect();
  }
  open(e) {
    if (~this._readyState.indexOf("open")) return this;
    this.engine = new Ld(this.uri, this.opts);
    let t = this.engine, i = this;
    this._readyState = "opening", this.skipReconnect = false;
    let r = Bt(t, "open", function() {
      i.onopen(), e && e();
    }), o = (u) => {
      this.cleanup(), this._readyState = "closed", this.emitReserved("error", u), e ? e(u) : this.maybeReconnectOnOpen();
    }, a = Bt(t, "error", o);
    if (this._timeout !== false) {
      let u = this._timeout, c = this.setTimeoutFn(() => {
        r(), o(new Error("timeout")), t.close();
      }, u);
      this.opts.autoUnref && c.unref(), this.subs.push(() => {
        this.clearTimeoutFn(c);
      });
    }
    return this.subs.push(r), this.subs.push(a), this;
  }
  connect(e) {
    return this.open(e);
  }
  onopen() {
    this.cleanup(), this._readyState = "open", this.emitReserved("open");
    let e = this.engine;
    this.subs.push(Bt(e, "ping", this.onping.bind(this)), Bt(e, "data", this.ondata.bind(this)), Bt(e, "error", this.onerror.bind(this)), Bt(e, "close", this.onclose.bind(this)), Bt(this.decoder, "decoded", this.ondecoded.bind(this)));
  }
  onping() {
    this.emitReserved("ping");
  }
  ondata(e) {
    try {
      this.decoder.add(e);
    } catch (t) {
      this.onclose("parse error", t);
    }
  }
  ondecoded(e) {
    cl(() => {
      this.emitReserved("packet", e);
    }, this.setTimeoutFn);
  }
  onerror(e) {
    this.emitReserved("error", e);
  }
  socket(e, t) {
    let i = this.nsps[e];
    return i ? this._autoConnect && !i.active && i.connect() : (i = new Bd(this, e, t), this.nsps[e] = i), i;
  }
  _destroy(e) {
    let t = Object.keys(this.nsps);
    for (let i of t) if (this.nsps[i].active) return;
    this._close();
  }
  _packet(e) {
    let t = this.encoder.encode(e);
    for (let i = 0; i < t.length; i++) this.engine.write(t[i], e.options);
  }
  cleanup() {
    this.subs.forEach((e) => e()), this.subs.length = 0, this.decoder.destroy();
  }
  _close() {
    this.skipReconnect = true, this._reconnecting = false, this.onclose("forced close"), this.engine && this.engine.close();
  }
  disconnect() {
    return this._close();
  }
  onclose(e, t) {
    this.cleanup(), this.backoff.reset(), this._readyState = "closed", this.emitReserved("close", e, t), this._reconnection && !this.skipReconnect && this.reconnect();
  }
  reconnect() {
    if (this._reconnecting || this.skipReconnect) return this;
    let e = this;
    if (this.backoff.attempts >= this._reconnectionAttempts) this.backoff.reset(), this.emitReserved("reconnect_failed"), this._reconnecting = false;
    else {
      let t = this.backoff.duration();
      this._reconnecting = true;
      let i = this.setTimeoutFn(() => {
        e.skipReconnect || (this.emitReserved("reconnect_attempt", e.backoff.attempts), !e.skipReconnect && e.open((r) => {
          r ? (e._reconnecting = false, e.reconnect(), this.emitReserved("reconnect_error", r)) : e.onreconnect();
        }));
      }, t);
      this.opts.autoUnref && i.unref(), this.subs.push(() => {
        this.clearTimeoutFn(i);
      });
    }
  }
  onreconnect() {
    let e = this.backoff.attempts;
    this._reconnecting = false, this.backoff.reset(), this.emitReserved("reconnect", e);
  }
};
var Gn = {};
function ba(e, t) {
  typeof e == "object" && (t = e, e = void 0), t = t || {};
  let i = OE(e, t.path || "/socket.io"), r = i.source, o = i.id, a = i.path, u = Gn[o] && a in Gn[o].nsps, c = t.forceNew || t["force new connection"] || t.multiplex === false || u, p;
  return c ? p = new ks(r, t) : (Gn[o] || (Gn[o] = new ks(r, t)), p = Gn[o]), i.query && !t.query && (t.query = i.queryKey), p.socket(i.path, t);
}
Object.assign(ba, { Manager: ks, Socket: Bd, io: ba, connect: ba });
var be;
(function(e) {
  e.assertEqual = (o) => o;
  function t(o) {
  }
  e.assertIs = t;
  function i(o) {
    throw new Error();
  }
  e.assertNever = i, e.arrayToEnum = (o) => {
    let a = {};
    for (let u of o) a[u] = u;
    return a;
  }, e.getValidEnumValues = (o) => {
    let a = e.objectKeys(o).filter((c) => typeof o[o[c]] != "number"), u = {};
    for (let c of a) u[c] = o[c];
    return e.objectValues(u);
  }, e.objectValues = (o) => e.objectKeys(o).map(function(a) {
    return o[a];
  }), e.objectKeys = typeof Object.keys == "function" ? (o) => Object.keys(o) : (o) => {
    let a = [];
    for (let u in o) Object.prototype.hasOwnProperty.call(o, u) && a.push(u);
    return a;
  }, e.find = (o, a) => {
    for (let u of o) if (a(u)) return u;
  }, e.isInteger = typeof Number.isInteger == "function" ? (o) => Number.isInteger(o) : (o) => typeof o == "number" && isFinite(o) && Math.floor(o) === o;
  function r(o, a = " | ") {
    return o.map((u) => typeof u == "string" ? `'${u}'` : u).join(a);
  }
  e.joinValues = r, e.jsonStringifyReplacer = (o, a) => typeof a == "bigint" ? a.toString() : a;
})(be || (be = {}));
var ja;
(function(e) {
  e.mergeShapes = (t, i) => k(k({}, t), i);
})(ja || (ja = {}));
var z = be.arrayToEnum(["string", "nan", "number", "integer", "float", "boolean", "date", "bigint", "symbol", "function", "undefined", "null", "array", "object", "unknown", "promise", "void", "never", "map", "set"]);
var xi = (e) => {
  switch (typeof e) {
    case "undefined":
      return z.undefined;
    case "string":
      return z.string;
    case "number":
      return isNaN(e) ? z.nan : z.number;
    case "boolean":
      return z.boolean;
    case "function":
      return z.function;
    case "bigint":
      return z.bigint;
    case "symbol":
      return z.symbol;
    case "object":
      return Array.isArray(e) ? z.array : e === null ? z.null : e.then && typeof e.then == "function" && e.catch && typeof e.catch == "function" ? z.promise : typeof Map < "u" && e instanceof Map ? z.map : typeof Set < "u" && e instanceof Set ? z.set : typeof Date < "u" && e instanceof Date ? z.date : z.object;
    default:
      return z.unknown;
  }
};
var L = be.arrayToEnum(["invalid_type", "invalid_literal", "custom", "invalid_union", "invalid_union_discriminator", "invalid_enum_value", "unrecognized_keys", "invalid_arguments", "invalid_return_type", "invalid_date", "invalid_string", "too_small", "too_big", "invalid_intersection_types", "not_multiple_of", "not_finite"]);
var UE = (e) => JSON.stringify(e, null, 2).replace(/"([^"]+)":/g, "$1:");
var Ut = class Ud extends Error {
  constructor(t) {
    super(), this.issues = [], this.addIssue = (r) => {
      this.issues = [...this.issues, r];
    }, this.addIssues = (r = []) => {
      this.issues = [...this.issues, ...r];
    };
    let i = new.target.prototype;
    Object.setPrototypeOf ? Object.setPrototypeOf(this, i) : this.__proto__ = i, this.name = "ZodError", this.issues = t;
  }
  get errors() {
    return this.issues;
  }
  format(t) {
    let i = t || function(a) {
      return a.message;
    }, r = { _errors: [] }, o = (a) => {
      for (let u of a.issues) if (u.code === "invalid_union") u.unionErrors.map(o);
      else if (u.code === "invalid_return_type") o(u.returnTypeError);
      else if (u.code === "invalid_arguments") o(u.argumentsError);
      else if (u.path.length === 0) r._errors.push(i(u));
      else {
        let c = r, p = 0;
        for (; p < u.path.length; ) {
          let h = u.path[p];
          p === u.path.length - 1 ? (c[h] = c[h] || { _errors: [] }, c[h]._errors.push(i(u))) : c[h] = c[h] || { _errors: [] }, c = c[h], p++;
        }
      }
    };
    return o(this), r;
  }
  static assert(t) {
    if (!(t instanceof Ud)) throw new Error(`Not a ZodError: ${t}`);
  }
  toString() {
    return this.message;
  }
  get message() {
    return JSON.stringify(this.issues, be.jsonStringifyReplacer, 2);
  }
  get isEmpty() {
    return this.issues.length === 0;
  }
  flatten(t = (i) => i.message) {
    let i = {}, r = [];
    for (let o of this.issues) o.path.length > 0 ? (i[o.path[0]] = i[o.path[0]] || [], i[o.path[0]].push(t(o))) : r.push(t(o));
    return { formErrors: r, fieldErrors: i };
  }
  get formErrors() {
    return this.flatten();
  }
};
Ut.create = (e) => new Ut(e);
var vn = (e, t) => {
  let i;
  switch (e.code) {
    case L.invalid_type:
      e.received === z.undefined ? i = "Required" : i = `Expected ${e.expected}, received ${e.received}`;
      break;
    case L.invalid_literal:
      i = `Invalid literal value, expected ${JSON.stringify(e.expected, be.jsonStringifyReplacer)}`;
      break;
    case L.unrecognized_keys:
      i = `Unrecognized key(s) in object: ${be.joinValues(e.keys, ", ")}`;
      break;
    case L.invalid_union:
      i = "Invalid input";
      break;
    case L.invalid_union_discriminator:
      i = `Invalid discriminator value. Expected ${be.joinValues(e.options)}`;
      break;
    case L.invalid_enum_value:
      i = `Invalid enum value. Expected ${be.joinValues(e.options)}, received '${e.received}'`;
      break;
    case L.invalid_arguments:
      i = "Invalid function arguments";
      break;
    case L.invalid_return_type:
      i = "Invalid function return type";
      break;
    case L.invalid_date:
      i = "Invalid date";
      break;
    case L.invalid_string:
      typeof e.validation == "object" ? "includes" in e.validation ? (i = `Invalid input: must include "${e.validation.includes}"`, typeof e.validation.position == "number" && (i = `${i} at one or more positions greater than or equal to ${e.validation.position}`)) : "startsWith" in e.validation ? i = `Invalid input: must start with "${e.validation.startsWith}"` : "endsWith" in e.validation ? i = `Invalid input: must end with "${e.validation.endsWith}"` : be.assertNever(e.validation) : e.validation !== "regex" ? i = `Invalid ${e.validation}` : i = "Invalid";
      break;
    case L.too_small:
      e.type === "array" ? i = `Array must contain ${e.exact ? "exactly" : e.inclusive ? "at least" : "more than"} ${e.minimum} element(s)` : e.type === "string" ? i = `String must contain ${e.exact ? "exactly" : e.inclusive ? "at least" : "over"} ${e.minimum} character(s)` : e.type === "number" ? i = `Number must be ${e.exact ? "exactly equal to " : e.inclusive ? "greater than or equal to " : "greater than "}${e.minimum}` : e.type === "date" ? i = `Date must be ${e.exact ? "exactly equal to " : e.inclusive ? "greater than or equal to " : "greater than "}${new Date(Number(e.minimum))}` : i = "Invalid input";
      break;
    case L.too_big:
      e.type === "array" ? i = `Array must contain ${e.exact ? "exactly" : e.inclusive ? "at most" : "less than"} ${e.maximum} element(s)` : e.type === "string" ? i = `String must contain ${e.exact ? "exactly" : e.inclusive ? "at most" : "under"} ${e.maximum} character(s)` : e.type === "number" ? i = `Number must be ${e.exact ? "exactly" : e.inclusive ? "less than or equal to" : "less than"} ${e.maximum}` : e.type === "bigint" ? i = `BigInt must be ${e.exact ? "exactly" : e.inclusive ? "less than or equal to" : "less than"} ${e.maximum}` : e.type === "date" ? i = `Date must be ${e.exact ? "exactly" : e.inclusive ? "smaller than or equal to" : "smaller than"} ${new Date(Number(e.maximum))}` : i = "Invalid input";
      break;
    case L.custom:
      i = "Invalid input";
      break;
    case L.invalid_intersection_types:
      i = "Intersection results could not be merged";
      break;
    case L.not_multiple_of:
      i = `Number must be a multiple of ${e.multipleOf}`;
      break;
    case L.not_finite:
      i = "Number must be finite";
      break;
    default:
      i = t.defaultError, be.assertNever(e);
  }
  return { message: i };
};
var $d = vn;
function $E(e) {
  $d = e;
}
function Is() {
  return $d;
}
var Ms = (e) => {
  let { data: t, path: i, errorMaps: r, issueData: o } = e, a = [...i, ...o.path || []], u = X(k({}, o), { path: a });
  if (o.message !== void 0) return X(k({}, o), { path: a, message: o.message });
  let c = "", p = r.filter((h) => !!h).slice().reverse();
  for (let h of p) c = h(u, { data: t, defaultError: c }).message;
  return X(k({}, o), { path: a, message: c });
};
var zE = [];
function U(e, t) {
  let i = Is(), r = Ms({ issueData: t, data: e.data, path: e.path, errorMaps: [e.common.contextualErrorMap, e.schemaErrorMap, i, i === vn ? void 0 : vn].filter((o) => !!o) });
  e.common.issues.push(r);
}
var dt = class zd {
  constructor() {
    this.value = "valid";
  }
  dirty() {
    this.value === "valid" && (this.value = "dirty");
  }
  abort() {
    this.value !== "aborted" && (this.value = "aborted");
  }
  static mergeArray(t, i) {
    let r = [];
    for (let o of i) {
      if (o.status === "aborted") return te;
      o.status === "dirty" && t.dirty(), r.push(o.value);
    }
    return { status: t.value, value: r };
  }
  static mergeObjectAsync(t, i) {
    return di(this, null, function* () {
      let r = [];
      for (let o of i) {
        let a = yield o.key, u = yield o.value;
        r.push({ key: a, value: u });
      }
      return zd.mergeObjectSync(t, r);
    });
  }
  static mergeObjectSync(t, i) {
    let r = {};
    for (let o of i) {
      let { key: a, value: u } = o;
      if (a.status === "aborted" || u.status === "aborted") return te;
      a.status === "dirty" && t.dirty(), u.status === "dirty" && t.dirty(), a.value !== "__proto__" && (typeof u.value < "u" || o.alwaysSet) && (r[a.value] = u.value);
    }
    return { status: t.value, value: r };
  }
};
var te = Object.freeze({ status: "aborted" });
var Rs = (e) => ({ status: "dirty", value: e });
var ot = (e) => ({ status: "valid", value: e });
var Ba = (e) => e.status === "aborted";
var Ua = (e) => e.status === "dirty";
var Yn = (e) => e.status === "valid";
var Qn = (e) => typeof Promise < "u" && e instanceof Promise;
function Fs(e, t, i, r) {
  if (typeof t == "function" ? e !== t || !r : !t.has(e)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
  return t.get(e);
}
function Wd(e, t, i, r, o) {
  if (typeof t == "function" ? e !== t || !o : !t.has(e)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
  return t.set(e, i), i;
}
var Z;
(function(e) {
  e.errToObj = (t) => typeof t == "string" ? { message: t } : t || {}, e.toString = (t) => typeof t == "string" ? t : t == null ? void 0 : t.message;
})(Z || (Z = {}));
var Jn;
var Hn;
var Yt = class {
  constructor(e, t, i, r) {
    this._cachedPath = [], this.parent = e, this.data = t, this._path = i, this._key = r;
  }
  get path() {
    return this._cachedPath.length || (this._key instanceof Array ? this._cachedPath.push(...this._path, ...this._key) : this._cachedPath.push(...this._path, this._key)), this._cachedPath;
  }
};
var Oh = (e, t) => {
  if (Yn(t)) return { success: true, data: t.value };
  if (!e.common.issues.length) throw new Error("Validation failed but no issues detected.");
  return { success: false, get error() {
    if (this._error) return this._error;
    let i = new Ut(e.common.issues);
    return this._error = i, this._error;
  } };
};
function se(e) {
  if (!e) return {};
  let { errorMap: t, invalid_type_error: i, required_error: r, description: o } = e;
  if (t && (i || r)) throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);
  return t ? { errorMap: t, description: o } : { errorMap: (a, u) => {
    var c, p;
    let { message: h } = e;
    return a.code === "invalid_enum_value" ? { message: h ?? u.defaultError } : typeof u.data > "u" ? { message: (c = h ?? r) !== null && c !== void 0 ? c : u.defaultError } : a.code !== "invalid_type" ? { message: u.defaultError } : { message: (p = h ?? i) !== null && p !== void 0 ? p : u.defaultError };
  }, description: o };
}
var ue = class {
  constructor(e) {
    this.spa = this.safeParseAsync, this._def = e, this.parse = this.parse.bind(this), this.safeParse = this.safeParse.bind(this), this.parseAsync = this.parseAsync.bind(this), this.safeParseAsync = this.safeParseAsync.bind(this), this.spa = this.spa.bind(this), this.refine = this.refine.bind(this), this.refinement = this.refinement.bind(this), this.superRefine = this.superRefine.bind(this), this.optional = this.optional.bind(this), this.nullable = this.nullable.bind(this), this.nullish = this.nullish.bind(this), this.array = this.array.bind(this), this.promise = this.promise.bind(this), this.or = this.or.bind(this), this.and = this.and.bind(this), this.transform = this.transform.bind(this), this.brand = this.brand.bind(this), this.default = this.default.bind(this), this.catch = this.catch.bind(this), this.describe = this.describe.bind(this), this.pipe = this.pipe.bind(this), this.readonly = this.readonly.bind(this), this.isNullable = this.isNullable.bind(this), this.isOptional = this.isOptional.bind(this);
  }
  get description() {
    return this._def.description;
  }
  _getType(e) {
    return xi(e.data);
  }
  _getOrReturnCtx(e, t) {
    return t || { common: e.parent.common, data: e.data, parsedType: xi(e.data), schemaErrorMap: this._def.errorMap, path: e.path, parent: e.parent };
  }
  _processInputParams(e) {
    return { status: new dt(), ctx: { common: e.parent.common, data: e.data, parsedType: xi(e.data), schemaErrorMap: this._def.errorMap, path: e.path, parent: e.parent } };
  }
  _parseSync(e) {
    let t = this._parse(e);
    if (Qn(t)) throw new Error("Synchronous parse encountered promise.");
    return t;
  }
  _parseAsync(e) {
    let t = this._parse(e);
    return Promise.resolve(t);
  }
  parse(e, t) {
    let i = this.safeParse(e, t);
    if (i.success) return i.data;
    throw i.error;
  }
  safeParse(e, t) {
    var i;
    let r = { common: { issues: [], async: (i = t == null ? void 0 : t.async) !== null && i !== void 0 ? i : false, contextualErrorMap: t == null ? void 0 : t.errorMap }, path: (t == null ? void 0 : t.path) || [], schemaErrorMap: this._def.errorMap, parent: null, data: e, parsedType: xi(e) }, o = this._parseSync({ data: e, path: r.path, parent: r });
    return Oh(r, o);
  }
  parseAsync(e, t) {
    return di(this, null, function* () {
      let i = yield this.safeParseAsync(e, t);
      if (i.success) return i.data;
      throw i.error;
    });
  }
  safeParseAsync(e, t) {
    return di(this, null, function* () {
      let i = { common: { issues: [], contextualErrorMap: t == null ? void 0 : t.errorMap, async: true }, path: (t == null ? void 0 : t.path) || [], schemaErrorMap: this._def.errorMap, parent: null, data: e, parsedType: xi(e) }, r = this._parse({ data: e, path: i.path, parent: i }), o = yield Qn(r) ? r : Promise.resolve(r);
      return Oh(i, o);
    });
  }
  refine(e, t) {
    let i = (r) => typeof t == "string" || typeof t > "u" ? { message: t } : typeof t == "function" ? t(r) : t;
    return this._refinement((r, o) => {
      let a = e(r), u = () => o.addIssue(k({ code: L.custom }, i(r)));
      return typeof Promise < "u" && a instanceof Promise ? a.then((c) => c ? true : (u(), false)) : a ? true : (u(), false);
    });
  }
  refinement(e, t) {
    return this._refinement((i, r) => e(i) ? true : (r.addIssue(typeof t == "function" ? t(i, r) : t), false));
  }
  _refinement(e) {
    return new $t({ schema: this, typeName: Y.ZodEffects, effect: { type: "refinement", refinement: e } });
  }
  superRefine(e) {
    return this._refinement(e);
  }
  optional() {
    return Ht.create(this, this._def);
  }
  nullable() {
    return Mi.create(this, this._def);
  }
  nullish() {
    return this.nullable().optional();
  }
  array() {
    return Ji.create(this, this._def);
  }
  promise() {
    return bn.create(this, this._def);
  }
  or(e) {
    return sr.create([this, e], this._def);
  }
  and(e) {
    return or.create(this, e, this._def);
  }
  transform(e) {
    return new $t(X(k({}, se(this._def)), { schema: this, typeName: Y.ZodEffects, effect: { type: "transform", transform: e } }));
  }
  default(e) {
    let t = typeof e == "function" ? e : () => e;
    return new cr(X(k({}, se(this._def)), { innerType: this, defaultValue: t, typeName: Y.ZodDefault }));
  }
  brand() {
    return new dl(k({ typeName: Y.ZodBranded, type: this }, se(this._def)));
  }
  catch(e) {
    let t = typeof e == "function" ? e : () => e;
    return new hr(X(k({}, se(this._def)), { innerType: this, catchValue: t, typeName: Y.ZodCatch }));
  }
  describe(e) {
    let t = this.constructor;
    return new t(X(k({}, this._def), { description: e }));
  }
  pipe(e) {
    return pl.create(this, e);
  }
  readonly() {
    return dr.create(this);
  }
  isOptional() {
    return this.safeParse(void 0).success;
  }
  isNullable() {
    return this.safeParse(null).success;
  }
};
var WE = /^c[^\s-]{8,}$/i;
var VE = /^[0-9a-z]+$/;
var GE = /^[0-9A-HJKMNP-TV-Z]{26}$/;
var ZE = /^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i;
var JE = /^[a-z0-9_-]{21}$/i;
var HE = /^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/;
var qE = /^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;
var KE = "^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";
var wa;
var YE = /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/;
var QE = /^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;
var XE = /^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;
var Vd = "((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))";
var eP = new RegExp(`^${Vd}$`);
function Gd(e) {
  let t = "([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";
  return e.precision ? t = `${t}\\.\\d{${e.precision}}` : e.precision == null && (t = `${t}(\\.\\d+)?`), t;
}
function tP(e) {
  return new RegExp(`^${Gd(e)}$`);
}
function Zd(e) {
  let t = `${Vd}T${Gd(e)}`, i = [];
  return i.push(e.local ? "Z?" : "Z"), e.offset && i.push("([+-]\\d{2}:?\\d{2})"), t = `${t}(${i.join("|")})`, new RegExp(`^${t}$`);
}
function iP(e, t) {
  return !!((t === "v4" || !t) && YE.test(e) || (t === "v6" || !t) && QE.test(e));
}
var gn = class qn extends ue {
  _parse(t) {
    if (this._def.coerce && (t.data = String(t.data)), this._getType(t) !== z.string) {
      let o = this._getOrReturnCtx(t);
      return U(o, { code: L.invalid_type, expected: z.string, received: o.parsedType }), te;
    }
    let i = new dt(), r;
    for (let o of this._def.checks) if (o.kind === "min") t.data.length < o.value && (r = this._getOrReturnCtx(t, r), U(r, { code: L.too_small, minimum: o.value, type: "string", inclusive: true, exact: false, message: o.message }), i.dirty());
    else if (o.kind === "max") t.data.length > o.value && (r = this._getOrReturnCtx(t, r), U(r, { code: L.too_big, maximum: o.value, type: "string", inclusive: true, exact: false, message: o.message }), i.dirty());
    else if (o.kind === "length") {
      let a = t.data.length > o.value, u = t.data.length < o.value;
      (a || u) && (r = this._getOrReturnCtx(t, r), a ? U(r, { code: L.too_big, maximum: o.value, type: "string", inclusive: true, exact: true, message: o.message }) : u && U(r, { code: L.too_small, minimum: o.value, type: "string", inclusive: true, exact: true, message: o.message }), i.dirty());
    } else if (o.kind === "email") qE.test(t.data) || (r = this._getOrReturnCtx(t, r), U(r, { validation: "email", code: L.invalid_string, message: o.message }), i.dirty());
    else if (o.kind === "emoji") wa || (wa = new RegExp(KE, "u")), wa.test(t.data) || (r = this._getOrReturnCtx(t, r), U(r, { validation: "emoji", code: L.invalid_string, message: o.message }), i.dirty());
    else if (o.kind === "uuid") ZE.test(t.data) || (r = this._getOrReturnCtx(t, r), U(r, { validation: "uuid", code: L.invalid_string, message: o.message }), i.dirty());
    else if (o.kind === "nanoid") JE.test(t.data) || (r = this._getOrReturnCtx(t, r), U(r, { validation: "nanoid", code: L.invalid_string, message: o.message }), i.dirty());
    else if (o.kind === "cuid") WE.test(t.data) || (r = this._getOrReturnCtx(t, r), U(r, { validation: "cuid", code: L.invalid_string, message: o.message }), i.dirty());
    else if (o.kind === "cuid2") VE.test(t.data) || (r = this._getOrReturnCtx(t, r), U(r, { validation: "cuid2", code: L.invalid_string, message: o.message }), i.dirty());
    else if (o.kind === "ulid") GE.test(t.data) || (r = this._getOrReturnCtx(t, r), U(r, { validation: "ulid", code: L.invalid_string, message: o.message }), i.dirty());
    else if (o.kind === "url") try {
      new URL(t.data);
    } catch {
      r = this._getOrReturnCtx(t, r), U(r, { validation: "url", code: L.invalid_string, message: o.message }), i.dirty();
    }
    else o.kind === "regex" ? (o.regex.lastIndex = 0, o.regex.test(t.data) || (r = this._getOrReturnCtx(t, r), U(r, { validation: "regex", code: L.invalid_string, message: o.message }), i.dirty())) : o.kind === "trim" ? t.data = t.data.trim() : o.kind === "includes" ? t.data.includes(o.value, o.position) || (r = this._getOrReturnCtx(t, r), U(r, { code: L.invalid_string, validation: { includes: o.value, position: o.position }, message: o.message }), i.dirty()) : o.kind === "toLowerCase" ? t.data = t.data.toLowerCase() : o.kind === "toUpperCase" ? t.data = t.data.toUpperCase() : o.kind === "startsWith" ? t.data.startsWith(o.value) || (r = this._getOrReturnCtx(t, r), U(r, { code: L.invalid_string, validation: { startsWith: o.value }, message: o.message }), i.dirty()) : o.kind === "endsWith" ? t.data.endsWith(o.value) || (r = this._getOrReturnCtx(t, r), U(r, { code: L.invalid_string, validation: { endsWith: o.value }, message: o.message }), i.dirty()) : o.kind === "datetime" ? Zd(o).test(t.data) || (r = this._getOrReturnCtx(t, r), U(r, { code: L.invalid_string, validation: "datetime", message: o.message }), i.dirty()) : o.kind === "date" ? eP.test(t.data) || (r = this._getOrReturnCtx(t, r), U(r, { code: L.invalid_string, validation: "date", message: o.message }), i.dirty()) : o.kind === "time" ? tP(o).test(t.data) || (r = this._getOrReturnCtx(t, r), U(r, { code: L.invalid_string, validation: "time", message: o.message }), i.dirty()) : o.kind === "duration" ? HE.test(t.data) || (r = this._getOrReturnCtx(t, r), U(r, { validation: "duration", code: L.invalid_string, message: o.message }), i.dirty()) : o.kind === "ip" ? iP(t.data, o.version) || (r = this._getOrReturnCtx(t, r), U(r, { validation: "ip", code: L.invalid_string, message: o.message }), i.dirty()) : o.kind === "base64" ? XE.test(t.data) || (r = this._getOrReturnCtx(t, r), U(r, { validation: "base64", code: L.invalid_string, message: o.message }), i.dirty()) : be.assertNever(o);
    return { status: i.value, value: t.data };
  }
  _regex(t, i, r) {
    return this.refinement((o) => t.test(o), k({ validation: i, code: L.invalid_string }, Z.errToObj(r)));
  }
  _addCheck(t) {
    return new qn(X(k({}, this._def), { checks: [...this._def.checks, t] }));
  }
  email(t) {
    return this._addCheck(k({ kind: "email" }, Z.errToObj(t)));
  }
  url(t) {
    return this._addCheck(k({ kind: "url" }, Z.errToObj(t)));
  }
  emoji(t) {
    return this._addCheck(k({ kind: "emoji" }, Z.errToObj(t)));
  }
  uuid(t) {
    return this._addCheck(k({ kind: "uuid" }, Z.errToObj(t)));
  }
  nanoid(t) {
    return this._addCheck(k({ kind: "nanoid" }, Z.errToObj(t)));
  }
  cuid(t) {
    return this._addCheck(k({ kind: "cuid" }, Z.errToObj(t)));
  }
  cuid2(t) {
    return this._addCheck(k({ kind: "cuid2" }, Z.errToObj(t)));
  }
  ulid(t) {
    return this._addCheck(k({ kind: "ulid" }, Z.errToObj(t)));
  }
  base64(t) {
    return this._addCheck(k({ kind: "base64" }, Z.errToObj(t)));
  }
  ip(t) {
    return this._addCheck(k({ kind: "ip" }, Z.errToObj(t)));
  }
  datetime(t) {
    var i, r;
    return typeof t == "string" ? this._addCheck({ kind: "datetime", precision: null, offset: false, local: false, message: t }) : this._addCheck(k({ kind: "datetime", precision: typeof (t == null ? void 0 : t.precision) > "u" ? null : t == null ? void 0 : t.precision, offset: (i = t == null ? void 0 : t.offset) !== null && i !== void 0 ? i : false, local: (r = t == null ? void 0 : t.local) !== null && r !== void 0 ? r : false }, Z.errToObj(t == null ? void 0 : t.message)));
  }
  date(t) {
    return this._addCheck({ kind: "date", message: t });
  }
  time(t) {
    return typeof t == "string" ? this._addCheck({ kind: "time", precision: null, message: t }) : this._addCheck(k({ kind: "time", precision: typeof (t == null ? void 0 : t.precision) > "u" ? null : t == null ? void 0 : t.precision }, Z.errToObj(t == null ? void 0 : t.message)));
  }
  duration(t) {
    return this._addCheck(k({ kind: "duration" }, Z.errToObj(t)));
  }
  regex(t, i) {
    return this._addCheck(k({ kind: "regex", regex: t }, Z.errToObj(i)));
  }
  includes(t, i) {
    return this._addCheck(k({ kind: "includes", value: t, position: i == null ? void 0 : i.position }, Z.errToObj(i == null ? void 0 : i.message)));
  }
  startsWith(t, i) {
    return this._addCheck(k({ kind: "startsWith", value: t }, Z.errToObj(i)));
  }
  endsWith(t, i) {
    return this._addCheck(k({ kind: "endsWith", value: t }, Z.errToObj(i)));
  }
  min(t, i) {
    return this._addCheck(k({ kind: "min", value: t }, Z.errToObj(i)));
  }
  max(t, i) {
    return this._addCheck(k({ kind: "max", value: t }, Z.errToObj(i)));
  }
  length(t, i) {
    return this._addCheck(k({ kind: "length", value: t }, Z.errToObj(i)));
  }
  nonempty(t) {
    return this.min(1, Z.errToObj(t));
  }
  trim() {
    return new qn(X(k({}, this._def), { checks: [...this._def.checks, { kind: "trim" }] }));
  }
  toLowerCase() {
    return new qn(X(k({}, this._def), { checks: [...this._def.checks, { kind: "toLowerCase" }] }));
  }
  toUpperCase() {
    return new qn(X(k({}, this._def), { checks: [...this._def.checks, { kind: "toUpperCase" }] }));
  }
  get isDatetime() {
    return !!this._def.checks.find((t) => t.kind === "datetime");
  }
  get isDate() {
    return !!this._def.checks.find((t) => t.kind === "date");
  }
  get isTime() {
    return !!this._def.checks.find((t) => t.kind === "time");
  }
  get isDuration() {
    return !!this._def.checks.find((t) => t.kind === "duration");
  }
  get isEmail() {
    return !!this._def.checks.find((t) => t.kind === "email");
  }
  get isURL() {
    return !!this._def.checks.find((t) => t.kind === "url");
  }
  get isEmoji() {
    return !!this._def.checks.find((t) => t.kind === "emoji");
  }
  get isUUID() {
    return !!this._def.checks.find((t) => t.kind === "uuid");
  }
  get isNANOID() {
    return !!this._def.checks.find((t) => t.kind === "nanoid");
  }
  get isCUID() {
    return !!this._def.checks.find((t) => t.kind === "cuid");
  }
  get isCUID2() {
    return !!this._def.checks.find((t) => t.kind === "cuid2");
  }
  get isULID() {
    return !!this._def.checks.find((t) => t.kind === "ulid");
  }
  get isIP() {
    return !!this._def.checks.find((t) => t.kind === "ip");
  }
  get isBase64() {
    return !!this._def.checks.find((t) => t.kind === "base64");
  }
  get minLength() {
    let t = null;
    for (let i of this._def.checks) i.kind === "min" && (t === null || i.value > t) && (t = i.value);
    return t;
  }
  get maxLength() {
    let t = null;
    for (let i of this._def.checks) i.kind === "max" && (t === null || i.value < t) && (t = i.value);
    return t;
  }
};
gn.create = (e) => {
  var t;
  return new gn(k({ checks: [], typeName: Y.ZodString, coerce: (t = e == null ? void 0 : e.coerce) !== null && t !== void 0 ? t : false }, se(e)));
};
function nP(e, t) {
  let i = (e.toString().split(".")[1] || "").length, r = (t.toString().split(".")[1] || "").length, o = i > r ? i : r, a = parseInt(e.toFixed(o).replace(".", "")), u = parseInt(t.toFixed(o).replace(".", ""));
  return a % u / Math.pow(10, o);
}
var Xn = class $a extends ue {
  constructor() {
    super(...arguments), this.min = this.gte, this.max = this.lte, this.step = this.multipleOf;
  }
  _parse(t) {
    if (this._def.coerce && (t.data = Number(t.data)), this._getType(t) !== z.number) {
      let o = this._getOrReturnCtx(t);
      return U(o, { code: L.invalid_type, expected: z.number, received: o.parsedType }), te;
    }
    let i, r = new dt();
    for (let o of this._def.checks) o.kind === "int" ? be.isInteger(t.data) || (i = this._getOrReturnCtx(t, i), U(i, { code: L.invalid_type, expected: "integer", received: "float", message: o.message }), r.dirty()) : o.kind === "min" ? (o.inclusive ? t.data < o.value : t.data <= o.value) && (i = this._getOrReturnCtx(t, i), U(i, { code: L.too_small, minimum: o.value, type: "number", inclusive: o.inclusive, exact: false, message: o.message }), r.dirty()) : o.kind === "max" ? (o.inclusive ? t.data > o.value : t.data >= o.value) && (i = this._getOrReturnCtx(t, i), U(i, { code: L.too_big, maximum: o.value, type: "number", inclusive: o.inclusive, exact: false, message: o.message }), r.dirty()) : o.kind === "multipleOf" ? nP(t.data, o.value) !== 0 && (i = this._getOrReturnCtx(t, i), U(i, { code: L.not_multiple_of, multipleOf: o.value, message: o.message }), r.dirty()) : o.kind === "finite" ? Number.isFinite(t.data) || (i = this._getOrReturnCtx(t, i), U(i, { code: L.not_finite, message: o.message }), r.dirty()) : be.assertNever(o);
    return { status: r.value, value: t.data };
  }
  gte(t, i) {
    return this.setLimit("min", t, true, Z.toString(i));
  }
  gt(t, i) {
    return this.setLimit("min", t, false, Z.toString(i));
  }
  lte(t, i) {
    return this.setLimit("max", t, true, Z.toString(i));
  }
  lt(t, i) {
    return this.setLimit("max", t, false, Z.toString(i));
  }
  setLimit(t, i, r, o) {
    return new $a(X(k({}, this._def), { checks: [...this._def.checks, { kind: t, value: i, inclusive: r, message: Z.toString(o) }] }));
  }
  _addCheck(t) {
    return new $a(X(k({}, this._def), { checks: [...this._def.checks, t] }));
  }
  int(t) {
    return this._addCheck({ kind: "int", message: Z.toString(t) });
  }
  positive(t) {
    return this._addCheck({ kind: "min", value: 0, inclusive: false, message: Z.toString(t) });
  }
  negative(t) {
    return this._addCheck({ kind: "max", value: 0, inclusive: false, message: Z.toString(t) });
  }
  nonpositive(t) {
    return this._addCheck({ kind: "max", value: 0, inclusive: true, message: Z.toString(t) });
  }
  nonnegative(t) {
    return this._addCheck({ kind: "min", value: 0, inclusive: true, message: Z.toString(t) });
  }
  multipleOf(t, i) {
    return this._addCheck({ kind: "multipleOf", value: t, message: Z.toString(i) });
  }
  finite(t) {
    return this._addCheck({ kind: "finite", message: Z.toString(t) });
  }
  safe(t) {
    return this._addCheck({ kind: "min", inclusive: true, value: Number.MIN_SAFE_INTEGER, message: Z.toString(t) })._addCheck({ kind: "max", inclusive: true, value: Number.MAX_SAFE_INTEGER, message: Z.toString(t) });
  }
  get minValue() {
    let t = null;
    for (let i of this._def.checks) i.kind === "min" && (t === null || i.value > t) && (t = i.value);
    return t;
  }
  get maxValue() {
    let t = null;
    for (let i of this._def.checks) i.kind === "max" && (t === null || i.value < t) && (t = i.value);
    return t;
  }
  get isInt() {
    return !!this._def.checks.find((t) => t.kind === "int" || t.kind === "multipleOf" && be.isInteger(t.value));
  }
  get isFinite() {
    let t = null, i = null;
    for (let r of this._def.checks) {
      if (r.kind === "finite" || r.kind === "int" || r.kind === "multipleOf") return true;
      r.kind === "min" ? (i === null || r.value > i) && (i = r.value) : r.kind === "max" && (t === null || r.value < t) && (t = r.value);
    }
    return Number.isFinite(i) && Number.isFinite(t);
  }
};
Xn.create = (e) => new Xn(k({ checks: [], typeName: Y.ZodNumber, coerce: (e == null ? void 0 : e.coerce) || false }, se(e)));
var er = class za extends ue {
  constructor() {
    super(...arguments), this.min = this.gte, this.max = this.lte;
  }
  _parse(t) {
    if (this._def.coerce && (t.data = BigInt(t.data)), this._getType(t) !== z.bigint) {
      let o = this._getOrReturnCtx(t);
      return U(o, { code: L.invalid_type, expected: z.bigint, received: o.parsedType }), te;
    }
    let i, r = new dt();
    for (let o of this._def.checks) o.kind === "min" ? (o.inclusive ? t.data < o.value : t.data <= o.value) && (i = this._getOrReturnCtx(t, i), U(i, { code: L.too_small, type: "bigint", minimum: o.value, inclusive: o.inclusive, message: o.message }), r.dirty()) : o.kind === "max" ? (o.inclusive ? t.data > o.value : t.data >= o.value) && (i = this._getOrReturnCtx(t, i), U(i, { code: L.too_big, type: "bigint", maximum: o.value, inclusive: o.inclusive, message: o.message }), r.dirty()) : o.kind === "multipleOf" ? t.data % o.value !== BigInt(0) && (i = this._getOrReturnCtx(t, i), U(i, { code: L.not_multiple_of, multipleOf: o.value, message: o.message }), r.dirty()) : be.assertNever(o);
    return { status: r.value, value: t.data };
  }
  gte(t, i) {
    return this.setLimit("min", t, true, Z.toString(i));
  }
  gt(t, i) {
    return this.setLimit("min", t, false, Z.toString(i));
  }
  lte(t, i) {
    return this.setLimit("max", t, true, Z.toString(i));
  }
  lt(t, i) {
    return this.setLimit("max", t, false, Z.toString(i));
  }
  setLimit(t, i, r, o) {
    return new za(X(k({}, this._def), { checks: [...this._def.checks, { kind: t, value: i, inclusive: r, message: Z.toString(o) }] }));
  }
  _addCheck(t) {
    return new za(X(k({}, this._def), { checks: [...this._def.checks, t] }));
  }
  positive(t) {
    return this._addCheck({ kind: "min", value: BigInt(0), inclusive: false, message: Z.toString(t) });
  }
  negative(t) {
    return this._addCheck({ kind: "max", value: BigInt(0), inclusive: false, message: Z.toString(t) });
  }
  nonpositive(t) {
    return this._addCheck({ kind: "max", value: BigInt(0), inclusive: true, message: Z.toString(t) });
  }
  nonnegative(t) {
    return this._addCheck({ kind: "min", value: BigInt(0), inclusive: true, message: Z.toString(t) });
  }
  multipleOf(t, i) {
    return this._addCheck({ kind: "multipleOf", value: t, message: Z.toString(i) });
  }
  get minValue() {
    let t = null;
    for (let i of this._def.checks) i.kind === "min" && (t === null || i.value > t) && (t = i.value);
    return t;
  }
  get maxValue() {
    let t = null;
    for (let i of this._def.checks) i.kind === "max" && (t === null || i.value < t) && (t = i.value);
    return t;
  }
};
er.create = (e) => {
  var t;
  return new er(k({ checks: [], typeName: Y.ZodBigInt, coerce: (t = e == null ? void 0 : e.coerce) !== null && t !== void 0 ? t : false }, se(e)));
};
var tr = class extends ue {
  _parse(e) {
    if (this._def.coerce && (e.data = !!e.data), this._getType(e) !== z.boolean) {
      let t = this._getOrReturnCtx(e);
      return U(t, { code: L.invalid_type, expected: z.boolean, received: t.parsedType }), te;
    }
    return ot(e.data);
  }
};
tr.create = (e) => new tr(k({ typeName: Y.ZodBoolean, coerce: (e == null ? void 0 : e.coerce) || false }, se(e)));
var ir = class Jd extends ue {
  _parse(t) {
    if (this._def.coerce && (t.data = new Date(t.data)), this._getType(t) !== z.date) {
      let o = this._getOrReturnCtx(t);
      return U(o, { code: L.invalid_type, expected: z.date, received: o.parsedType }), te;
    }
    if (isNaN(t.data.getTime())) {
      let o = this._getOrReturnCtx(t);
      return U(o, { code: L.invalid_date }), te;
    }
    let i = new dt(), r;
    for (let o of this._def.checks) o.kind === "min" ? t.data.getTime() < o.value && (r = this._getOrReturnCtx(t, r), U(r, { code: L.too_small, message: o.message, inclusive: true, exact: false, minimum: o.value, type: "date" }), i.dirty()) : o.kind === "max" ? t.data.getTime() > o.value && (r = this._getOrReturnCtx(t, r), U(r, { code: L.too_big, message: o.message, inclusive: true, exact: false, maximum: o.value, type: "date" }), i.dirty()) : be.assertNever(o);
    return { status: i.value, value: new Date(t.data.getTime()) };
  }
  _addCheck(t) {
    return new Jd(X(k({}, this._def), { checks: [...this._def.checks, t] }));
  }
  min(t, i) {
    return this._addCheck({ kind: "min", value: t.getTime(), message: Z.toString(i) });
  }
  max(t, i) {
    return this._addCheck({ kind: "max", value: t.getTime(), message: Z.toString(i) });
  }
  get minDate() {
    let t = null;
    for (let i of this._def.checks) i.kind === "min" && (t === null || i.value > t) && (t = i.value);
    return t != null ? new Date(t) : null;
  }
  get maxDate() {
    let t = null;
    for (let i of this._def.checks) i.kind === "max" && (t === null || i.value < t) && (t = i.value);
    return t != null ? new Date(t) : null;
  }
};
ir.create = (e) => new ir(k({ checks: [], coerce: (e == null ? void 0 : e.coerce) || false, typeName: Y.ZodDate }, se(e)));
var Ls = class extends ue {
  _parse(e) {
    if (this._getType(e) !== z.symbol) {
      let t = this._getOrReturnCtx(e);
      return U(t, { code: L.invalid_type, expected: z.symbol, received: t.parsedType }), te;
    }
    return ot(e.data);
  }
};
Ls.create = (e) => new Ls(k({ typeName: Y.ZodSymbol }, se(e)));
var nr = class extends ue {
  _parse(e) {
    if (this._getType(e) !== z.undefined) {
      let t = this._getOrReturnCtx(e);
      return U(t, { code: L.invalid_type, expected: z.undefined, received: t.parsedType }), te;
    }
    return ot(e.data);
  }
};
nr.create = (e) => new nr(k({ typeName: Y.ZodUndefined }, se(e)));
var rr = class extends ue {
  _parse(e) {
    if (this._getType(e) !== z.null) {
      let t = this._getOrReturnCtx(e);
      return U(t, { code: L.invalid_type, expected: z.null, received: t.parsedType }), te;
    }
    return ot(e.data);
  }
};
rr.create = (e) => new rr(k({ typeName: Y.ZodNull }, se(e)));
var yn = class extends ue {
  constructor() {
    super(...arguments), this._any = true;
  }
  _parse(e) {
    return ot(e.data);
  }
};
yn.create = (e) => new yn(k({ typeName: Y.ZodAny }, se(e)));
var Vi = class extends ue {
  constructor() {
    super(...arguments), this._unknown = true;
  }
  _parse(e) {
    return ot(e.data);
  }
};
Vi.create = (e) => new Vi(k({ typeName: Y.ZodUnknown }, se(e)));
var pi = class extends ue {
  _parse(e) {
    let t = this._getOrReturnCtx(e);
    return U(t, { code: L.invalid_type, expected: z.never, received: t.parsedType }), te;
  }
};
pi.create = (e) => new pi(k({ typeName: Y.ZodNever }, se(e)));
var Ns = class extends ue {
  _parse(e) {
    if (this._getType(e) !== z.undefined) {
      let t = this._getOrReturnCtx(e);
      return U(t, { code: L.invalid_type, expected: z.void, received: t.parsedType }), te;
    }
    return ot(e.data);
  }
};
Ns.create = (e) => new Ns(k({ typeName: Y.ZodVoid }, se(e)));
var Ji = class Ps extends ue {
  _parse(t) {
    let { ctx: i, status: r } = this._processInputParams(t), o = this._def;
    if (i.parsedType !== z.array) return U(i, { code: L.invalid_type, expected: z.array, received: i.parsedType }), te;
    if (o.exactLength !== null) {
      let u = i.data.length > o.exactLength.value, c = i.data.length < o.exactLength.value;
      (u || c) && (U(i, { code: u ? L.too_big : L.too_small, minimum: c ? o.exactLength.value : void 0, maximum: u ? o.exactLength.value : void 0, type: "array", inclusive: true, exact: true, message: o.exactLength.message }), r.dirty());
    }
    if (o.minLength !== null && i.data.length < o.minLength.value && (U(i, { code: L.too_small, minimum: o.minLength.value, type: "array", inclusive: true, exact: false, message: o.minLength.message }), r.dirty()), o.maxLength !== null && i.data.length > o.maxLength.value && (U(i, { code: L.too_big, maximum: o.maxLength.value, type: "array", inclusive: true, exact: false, message: o.maxLength.message }), r.dirty()), i.common.async) return Promise.all([...i.data].map((u, c) => o.type._parseAsync(new Yt(i, u, i.path, c)))).then((u) => dt.mergeArray(r, u));
    let a = [...i.data].map((u, c) => o.type._parseSync(new Yt(i, u, i.path, c)));
    return dt.mergeArray(r, a);
  }
  get element() {
    return this._def.type;
  }
  min(t, i) {
    return new Ps(X(k({}, this._def), { minLength: { value: t, message: Z.toString(i) } }));
  }
  max(t, i) {
    return new Ps(X(k({}, this._def), { maxLength: { value: t, message: Z.toString(i) } }));
  }
  length(t, i) {
    return new Ps(X(k({}, this._def), { exactLength: { value: t, message: Z.toString(i) } }));
  }
  nonempty(t) {
    return this.min(1, t);
  }
};
Ji.create = (e, t) => new Ji(k({ type: e, minLength: null, maxLength: null, exactLength: null, typeName: Y.ZodArray }, se(t)));
function hn(e) {
  if (e instanceof xt) {
    let t = {};
    for (let i in e.shape) {
      let r = e.shape[i];
      t[i] = Ht.create(hn(r));
    }
    return new xt(X(k({}, e._def), { shape: () => t }));
  } else return e instanceof Ji ? new Ji(X(k({}, e._def), { type: hn(e.element) })) : e instanceof Ht ? Ht.create(hn(e.unwrap())) : e instanceof Mi ? Mi.create(hn(e.unwrap())) : e instanceof Ii ? Ii.create(e.items.map((t) => hn(t))) : e;
}
var xt = class Dt extends ue {
  constructor() {
    super(...arguments), this._cached = null, this.nonstrict = this.passthrough, this.augment = this.extend;
  }
  _getCached() {
    if (this._cached !== null) return this._cached;
    let t = this._def.shape(), i = be.objectKeys(t);
    return this._cached = { shape: t, keys: i };
  }
  _parse(t) {
    if (this._getType(t) !== z.object) {
      let p = this._getOrReturnCtx(t);
      return U(p, { code: L.invalid_type, expected: z.object, received: p.parsedType }), te;
    }
    let { status: i, ctx: r } = this._processInputParams(t), { shape: o, keys: a } = this._getCached(), u = [];
    if (!(this._def.catchall instanceof pi && this._def.unknownKeys === "strip")) for (let p in r.data) a.includes(p) || u.push(p);
    let c = [];
    for (let p of a) {
      let h = o[p], f = r.data[p];
      c.push({ key: { status: "valid", value: p }, value: h._parse(new Yt(r, f, r.path, p)), alwaysSet: p in r.data });
    }
    if (this._def.catchall instanceof pi) {
      let p = this._def.unknownKeys;
      if (p === "passthrough") for (let h of u) c.push({ key: { status: "valid", value: h }, value: { status: "valid", value: r.data[h] } });
      else if (p === "strict") u.length > 0 && (U(r, { code: L.unrecognized_keys, keys: u }), i.dirty());
      else if (p !== "strip") throw new Error("Internal ZodObject error: invalid unknownKeys value.");
    } else {
      let p = this._def.catchall;
      for (let h of u) {
        let f = r.data[h];
        c.push({ key: { status: "valid", value: h }, value: p._parse(new Yt(r, f, r.path, h)), alwaysSet: h in r.data });
      }
    }
    return r.common.async ? Promise.resolve().then(() => di(this, null, function* () {
      let p = [];
      for (let h of c) {
        let f = yield h.key, m = yield h.value;
        p.push({ key: f, value: m, alwaysSet: h.alwaysSet });
      }
      return p;
    })).then((p) => dt.mergeObjectSync(i, p)) : dt.mergeObjectSync(i, c);
  }
  get shape() {
    return this._def.shape();
  }
  strict(t) {
    return Z.errToObj, new Dt(k(X(k({}, this._def), { unknownKeys: "strict" }), t !== void 0 ? { errorMap: (i, r) => {
      var o, a, u, c;
      let p = (u = (a = (o = this._def).errorMap) === null || a === void 0 ? void 0 : a.call(o, i, r).message) !== null && u !== void 0 ? u : r.defaultError;
      return i.code === "unrecognized_keys" ? { message: (c = Z.errToObj(t).message) !== null && c !== void 0 ? c : p } : { message: p };
    } } : {}));
  }
  strip() {
    return new Dt(X(k({}, this._def), { unknownKeys: "strip" }));
  }
  passthrough() {
    return new Dt(X(k({}, this._def), { unknownKeys: "passthrough" }));
  }
  extend(t) {
    return new Dt(X(k({}, this._def), { shape: () => k(k({}, this._def.shape()), t) }));
  }
  merge(t) {
    return new Dt({ unknownKeys: t._def.unknownKeys, catchall: t._def.catchall, shape: () => k(k({}, this._def.shape()), t._def.shape()), typeName: Y.ZodObject });
  }
  setKey(t, i) {
    return this.augment({ [t]: i });
  }
  catchall(t) {
    return new Dt(X(k({}, this._def), { catchall: t }));
  }
  pick(t) {
    let i = {};
    return be.objectKeys(t).forEach((r) => {
      t[r] && this.shape[r] && (i[r] = this.shape[r]);
    }), new Dt(X(k({}, this._def), { shape: () => i }));
  }
  omit(t) {
    let i = {};
    return be.objectKeys(this.shape).forEach((r) => {
      t[r] || (i[r] = this.shape[r]);
    }), new Dt(X(k({}, this._def), { shape: () => i }));
  }
  deepPartial() {
    return hn(this);
  }
  partial(t) {
    let i = {};
    return be.objectKeys(this.shape).forEach((r) => {
      let o = this.shape[r];
      t && !t[r] ? i[r] = o : i[r] = o.optional();
    }), new Dt(X(k({}, this._def), { shape: () => i }));
  }
  required(t) {
    let i = {};
    return be.objectKeys(this.shape).forEach((r) => {
      if (t && !t[r]) i[r] = this.shape[r];
      else {
        let o = this.shape[r];
        for (; o instanceof Ht; ) o = o._def.innerType;
        i[r] = o;
      }
    }), new Dt(X(k({}, this._def), { shape: () => i }));
  }
  keyof() {
    return Xd(be.objectKeys(this.shape));
  }
};
xt.create = (e, t) => new xt(k({ shape: () => e, unknownKeys: "strip", catchall: pi.create(), typeName: Y.ZodObject }, se(t)));
xt.strictCreate = (e, t) => new xt(k({ shape: () => e, unknownKeys: "strict", catchall: pi.create(), typeName: Y.ZodObject }, se(t)));
xt.lazycreate = (e, t) => new xt(k({ shape: e, unknownKeys: "strip", catchall: pi.create(), typeName: Y.ZodObject }, se(t)));
var sr = class extends ue {
  _parse(e) {
    let { ctx: t } = this._processInputParams(e), i = this._def.options;
    function r(o) {
      for (let u of o) if (u.result.status === "valid") return u.result;
      for (let u of o) if (u.result.status === "dirty") return t.common.issues.push(...u.ctx.common.issues), u.result;
      let a = o.map((u) => new Ut(u.ctx.common.issues));
      return U(t, { code: L.invalid_union, unionErrors: a }), te;
    }
    if (t.common.async) return Promise.all(i.map((o) => di(this, null, function* () {
      let a = X(k({}, t), { common: X(k({}, t.common), { issues: [] }), parent: null });
      return { result: yield o._parseAsync({ data: t.data, path: t.path, parent: a }), ctx: a };
    }))).then(r);
    {
      let o, a = [];
      for (let c of i) {
        let p = X(k({}, t), { common: X(k({}, t.common), { issues: [] }), parent: null }), h = c._parseSync({ data: t.data, path: t.path, parent: p });
        if (h.status === "valid") return h;
        h.status === "dirty" && !o && (o = { result: h, ctx: p }), p.common.issues.length && a.push(p.common.issues);
      }
      if (o) return t.common.issues.push(...o.ctx.common.issues), o.result;
      let u = a.map((c) => new Ut(c));
      return U(t, { code: L.invalid_union, unionErrors: u }), te;
    }
  }
  get options() {
    return this._def.options;
  }
};
sr.create = (e, t) => new sr(k({ options: e, typeName: Y.ZodUnion }, se(t)));
var Ti = (e) => e instanceof ar ? Ti(e.schema) : e instanceof $t ? Ti(e.innerType()) : e instanceof lr ? [e.value] : e instanceof gr ? e.options : e instanceof ur ? be.objectValues(e.enum) : e instanceof cr ? Ti(e._def.innerType) : e instanceof nr ? [void 0] : e instanceof rr ? [null] : e instanceof Ht ? [void 0, ...Ti(e.unwrap())] : e instanceof Mi ? [null, ...Ti(e.unwrap())] : e instanceof dl || e instanceof dr ? Ti(e.unwrap()) : e instanceof hr ? Ti(e._def.innerType) : [];
var Hd = class qd extends ue {
  _parse(t) {
    let { ctx: i } = this._processInputParams(t);
    if (i.parsedType !== z.object) return U(i, { code: L.invalid_type, expected: z.object, received: i.parsedType }), te;
    let r = this.discriminator, o = i.data[r], a = this.optionsMap.get(o);
    return a ? i.common.async ? a._parseAsync({ data: i.data, path: i.path, parent: i }) : a._parseSync({ data: i.data, path: i.path, parent: i }) : (U(i, { code: L.invalid_union_discriminator, options: Array.from(this.optionsMap.keys()), path: [r] }), te);
  }
  get discriminator() {
    return this._def.discriminator;
  }
  get options() {
    return this._def.options;
  }
  get optionsMap() {
    return this._def.optionsMap;
  }
  static create(t, i, r) {
    let o = /* @__PURE__ */ new Map();
    for (let a of i) {
      let u = Ti(a.shape[t]);
      if (!u.length) throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);
      for (let c of u) {
        if (o.has(c)) throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(c)}`);
        o.set(c, a);
      }
    }
    return new qd(k({ typeName: Y.ZodDiscriminatedUnion, discriminator: t, options: i, optionsMap: o }, se(r)));
  }
};
function Wa(e, t) {
  let i = xi(e), r = xi(t);
  if (e === t) return { valid: true, data: e };
  if (i === z.object && r === z.object) {
    let o = be.objectKeys(t), a = be.objectKeys(e).filter((c) => o.indexOf(c) !== -1), u = k(k({}, e), t);
    for (let c of a) {
      let p = Wa(e[c], t[c]);
      if (!p.valid) return { valid: false };
      u[c] = p.data;
    }
    return { valid: true, data: u };
  } else if (i === z.array && r === z.array) {
    if (e.length !== t.length) return { valid: false };
    let o = [];
    for (let a = 0; a < e.length; a++) {
      let u = e[a], c = t[a], p = Wa(u, c);
      if (!p.valid) return { valid: false };
      o.push(p.data);
    }
    return { valid: true, data: o };
  } else return i === z.date && r === z.date && +e == +t ? { valid: true, data: e } : { valid: false };
}
var or = class extends ue {
  _parse(e) {
    let { status: t, ctx: i } = this._processInputParams(e), r = (o, a) => {
      if (Ba(o) || Ba(a)) return te;
      let u = Wa(o.value, a.value);
      return u.valid ? ((Ua(o) || Ua(a)) && t.dirty(), { status: t.value, value: u.data }) : (U(i, { code: L.invalid_intersection_types }), te);
    };
    return i.common.async ? Promise.all([this._def.left._parseAsync({ data: i.data, path: i.path, parent: i }), this._def.right._parseAsync({ data: i.data, path: i.path, parent: i })]).then(([o, a]) => r(o, a)) : r(this._def.left._parseSync({ data: i.data, path: i.path, parent: i }), this._def.right._parseSync({ data: i.data, path: i.path, parent: i }));
  }
};
or.create = (e, t, i) => new or(k({ left: e, right: t, typeName: Y.ZodIntersection }, se(i)));
var Ii = class Kd extends ue {
  _parse(t) {
    let { status: i, ctx: r } = this._processInputParams(t);
    if (r.parsedType !== z.array) return U(r, { code: L.invalid_type, expected: z.array, received: r.parsedType }), te;
    if (r.data.length < this._def.items.length) return U(r, { code: L.too_small, minimum: this._def.items.length, inclusive: true, exact: false, type: "array" }), te;
    !this._def.rest && r.data.length > this._def.items.length && (U(r, { code: L.too_big, maximum: this._def.items.length, inclusive: true, exact: false, type: "array" }), i.dirty());
    let o = [...r.data].map((a, u) => {
      let c = this._def.items[u] || this._def.rest;
      return c ? c._parse(new Yt(r, a, r.path, u)) : null;
    }).filter((a) => !!a);
    return r.common.async ? Promise.all(o).then((a) => dt.mergeArray(i, a)) : dt.mergeArray(i, o);
  }
  get items() {
    return this._def.items;
  }
  rest(t) {
    return new Kd(X(k({}, this._def), { rest: t }));
  }
};
Ii.create = (e, t) => {
  if (!Array.isArray(e)) throw new Error("You must pass an array of schemas to z.tuple([ ... ])");
  return new Ii(k({ items: e, typeName: Y.ZodTuple, rest: null }, se(t)));
};
var Yd = class Va extends ue {
  get keySchema() {
    return this._def.keyType;
  }
  get valueSchema() {
    return this._def.valueType;
  }
  _parse(t) {
    let { status: i, ctx: r } = this._processInputParams(t);
    if (r.parsedType !== z.object) return U(r, { code: L.invalid_type, expected: z.object, received: r.parsedType }), te;
    let o = [], a = this._def.keyType, u = this._def.valueType;
    for (let c in r.data) o.push({ key: a._parse(new Yt(r, c, r.path, c)), value: u._parse(new Yt(r, r.data[c], r.path, c)), alwaysSet: c in r.data });
    return r.common.async ? dt.mergeObjectAsync(i, o) : dt.mergeObjectSync(i, o);
  }
  get element() {
    return this._def.valueType;
  }
  static create(t, i, r) {
    return i instanceof ue ? new Va(k({ keyType: t, valueType: i, typeName: Y.ZodRecord }, se(r))) : new Va(k({ keyType: gn.create(), valueType: t, typeName: Y.ZodRecord }, se(i)));
  }
};
var Ds = class extends ue {
  get keySchema() {
    return this._def.keyType;
  }
  get valueSchema() {
    return this._def.valueType;
  }
  _parse(e) {
    let { status: t, ctx: i } = this._processInputParams(e);
    if (i.parsedType !== z.map) return U(i, { code: L.invalid_type, expected: z.map, received: i.parsedType }), te;
    let r = this._def.keyType, o = this._def.valueType, a = [...i.data.entries()].map(([u, c], p) => ({ key: r._parse(new Yt(i, u, i.path, [p, "key"])), value: o._parse(new Yt(i, c, i.path, [p, "value"])) }));
    if (i.common.async) {
      let u = /* @__PURE__ */ new Map();
      return Promise.resolve().then(() => di(this, null, function* () {
        for (let c of a) {
          let p = yield c.key, h = yield c.value;
          if (p.status === "aborted" || h.status === "aborted") return te;
          (p.status === "dirty" || h.status === "dirty") && t.dirty(), u.set(p.value, h.value);
        }
        return { status: t.value, value: u };
      }));
    } else {
      let u = /* @__PURE__ */ new Map();
      for (let c of a) {
        let p = c.key, h = c.value;
        if (p.status === "aborted" || h.status === "aborted") return te;
        (p.status === "dirty" || h.status === "dirty") && t.dirty(), u.set(p.value, h.value);
      }
      return { status: t.value, value: u };
    }
  }
};
Ds.create = (e, t, i) => new Ds(k({ valueType: t, keyType: e, typeName: Y.ZodMap }, se(i)));
var js = class Ga extends ue {
  _parse(t) {
    let { status: i, ctx: r } = this._processInputParams(t);
    if (r.parsedType !== z.set) return U(r, { code: L.invalid_type, expected: z.set, received: r.parsedType }), te;
    let o = this._def;
    o.minSize !== null && r.data.size < o.minSize.value && (U(r, { code: L.too_small, minimum: o.minSize.value, type: "set", inclusive: true, exact: false, message: o.minSize.message }), i.dirty()), o.maxSize !== null && r.data.size > o.maxSize.value && (U(r, { code: L.too_big, maximum: o.maxSize.value, type: "set", inclusive: true, exact: false, message: o.maxSize.message }), i.dirty());
    let a = this._def.valueType;
    function u(p) {
      let h = /* @__PURE__ */ new Set();
      for (let f of p) {
        if (f.status === "aborted") return te;
        f.status === "dirty" && i.dirty(), h.add(f.value);
      }
      return { status: i.value, value: h };
    }
    let c = [...r.data.values()].map((p, h) => a._parse(new Yt(r, p, r.path, h)));
    return r.common.async ? Promise.all(c).then((p) => u(p)) : u(c);
  }
  min(t, i) {
    return new Ga(X(k({}, this._def), { minSize: { value: t, message: Z.toString(i) } }));
  }
  max(t, i) {
    return new Ga(X(k({}, this._def), { maxSize: { value: t, message: Z.toString(i) } }));
  }
  size(t, i) {
    return this.min(t, i).max(t, i);
  }
  nonempty(t) {
    return this.min(1, t);
  }
};
js.create = (e, t) => new js(k({ valueType: e, minSize: null, maxSize: null, typeName: Y.ZodSet }, se(t)));
var Qd = class As extends ue {
  constructor() {
    super(...arguments), this.validate = this.implement;
  }
  _parse(t) {
    let { ctx: i } = this._processInputParams(t);
    if (i.parsedType !== z.function) return U(i, { code: L.invalid_type, expected: z.function, received: i.parsedType }), te;
    function r(c, p) {
      return Ms({ data: c, path: i.path, errorMaps: [i.common.contextualErrorMap, i.schemaErrorMap, Is(), vn].filter((h) => !!h), issueData: { code: L.invalid_arguments, argumentsError: p } });
    }
    function o(c, p) {
      return Ms({ data: c, path: i.path, errorMaps: [i.common.contextualErrorMap, i.schemaErrorMap, Is(), vn].filter((h) => !!h), issueData: { code: L.invalid_return_type, returnTypeError: p } });
    }
    let a = { errorMap: i.common.contextualErrorMap }, u = i.data;
    if (this._def.returns instanceof bn) {
      let c = this;
      return ot(function(...p) {
        return di(this, null, function* () {
          let h = new Ut([]), f = yield c._def.args.parseAsync(p, a).catch((y) => {
            throw h.addIssue(r(p, y)), h;
          }), m = yield Reflect.apply(u, this, f);
          return yield c._def.returns._def.type.parseAsync(m, a).catch((y) => {
            throw h.addIssue(o(m, y)), h;
          });
        });
      });
    } else {
      let c = this;
      return ot(function(...p) {
        let h = c._def.args.safeParse(p, a);
        if (!h.success) throw new Ut([r(p, h.error)]);
        let f = Reflect.apply(u, this, h.data), m = c._def.returns.safeParse(f, a);
        if (!m.success) throw new Ut([o(f, m.error)]);
        return m.data;
      });
    }
  }
  parameters() {
    return this._def.args;
  }
  returnType() {
    return this._def.returns;
  }
  args(...t) {
    return new As(X(k({}, this._def), { args: Ii.create(t).rest(Vi.create()) }));
  }
  returns(t) {
    return new As(X(k({}, this._def), { returns: t }));
  }
  implement(t) {
    return this.parse(t);
  }
  strictImplement(t) {
    return this.parse(t);
  }
  static create(t, i, r) {
    return new As(k({ args: t || Ii.create([]).rest(Vi.create()), returns: i || Vi.create(), typeName: Y.ZodFunction }, se(r)));
  }
};
var ar = class extends ue {
  get schema() {
    return this._def.getter();
  }
  _parse(e) {
    let { ctx: t } = this._processInputParams(e);
    return this._def.getter()._parse({ data: t.data, path: t.path, parent: t });
  }
};
ar.create = (e, t) => new ar(k({ getter: e, typeName: Y.ZodLazy }, se(t)));
var lr = class extends ue {
  _parse(e) {
    if (e.data !== this._def.value) {
      let t = this._getOrReturnCtx(e);
      return U(t, { received: t.data, code: L.invalid_literal, expected: this._def.value }), te;
    }
    return { status: "valid", value: e.data };
  }
  get value() {
    return this._def.value;
  }
};
lr.create = (e, t) => new lr(k({ value: e, typeName: Y.ZodLiteral }, se(t)));
function Xd(e, t) {
  return new gr(k({ values: e, typeName: Y.ZodEnum }, se(t)));
}
var gr = class Za extends ue {
  constructor() {
    super(...arguments), Jn.set(this, void 0);
  }
  _parse(t) {
    if (typeof t.data != "string") {
      let i = this._getOrReturnCtx(t), r = this._def.values;
      return U(i, { expected: be.joinValues(r), received: i.parsedType, code: L.invalid_type }), te;
    }
    if (Fs(this, Jn) || Wd(this, Jn, new Set(this._def.values)), !Fs(this, Jn).has(t.data)) {
      let i = this._getOrReturnCtx(t), r = this._def.values;
      return U(i, { received: i.data, code: L.invalid_enum_value, options: r }), te;
    }
    return ot(t.data);
  }
  get options() {
    return this._def.values;
  }
  get enum() {
    let t = {};
    for (let i of this._def.values) t[i] = i;
    return t;
  }
  get Values() {
    let t = {};
    for (let i of this._def.values) t[i] = i;
    return t;
  }
  get Enum() {
    let t = {};
    for (let i of this._def.values) t[i] = i;
    return t;
  }
  extract(t, i = this._def) {
    return Za.create(t, k(k({}, this._def), i));
  }
  exclude(t, i = this._def) {
    return Za.create(this.options.filter((r) => !t.includes(r)), k(k({}, this._def), i));
  }
};
Jn = /* @__PURE__ */ new WeakMap();
gr.create = Xd;
var ur = class extends ue {
  constructor() {
    super(...arguments), Hn.set(this, void 0);
  }
  _parse(e) {
    let t = be.getValidEnumValues(this._def.values), i = this._getOrReturnCtx(e);
    if (i.parsedType !== z.string && i.parsedType !== z.number) {
      let r = be.objectValues(t);
      return U(i, { expected: be.joinValues(r), received: i.parsedType, code: L.invalid_type }), te;
    }
    if (Fs(this, Hn) || Wd(this, Hn, new Set(be.getValidEnumValues(this._def.values))), !Fs(this, Hn).has(e.data)) {
      let r = be.objectValues(t);
      return U(i, { received: i.data, code: L.invalid_enum_value, options: r }), te;
    }
    return ot(e.data);
  }
  get enum() {
    return this._def.values;
  }
};
Hn = /* @__PURE__ */ new WeakMap();
ur.create = (e, t) => new ur(k({ values: e, typeName: Y.ZodNativeEnum }, se(t)));
var bn = class extends ue {
  unwrap() {
    return this._def.type;
  }
  _parse(e) {
    let { ctx: t } = this._processInputParams(e);
    if (t.parsedType !== z.promise && t.common.async === false) return U(t, { code: L.invalid_type, expected: z.promise, received: t.parsedType }), te;
    let i = t.parsedType === z.promise ? t.data : Promise.resolve(t.data);
    return ot(i.then((r) => this._def.type.parseAsync(r, { path: t.path, errorMap: t.common.contextualErrorMap })));
  }
};
bn.create = (e, t) => new bn(k({ type: e, typeName: Y.ZodPromise }, se(t)));
var $t = class extends ue {
  innerType() {
    return this._def.schema;
  }
  sourceType() {
    return this._def.schema._def.typeName === Y.ZodEffects ? this._def.schema.sourceType() : this._def.schema;
  }
  _parse(e) {
    let { status: t, ctx: i } = this._processInputParams(e), r = this._def.effect || null, o = { addIssue: (a) => {
      U(i, a), a.fatal ? t.abort() : t.dirty();
    }, get path() {
      return i.path;
    } };
    if (o.addIssue = o.addIssue.bind(o), r.type === "preprocess") {
      let a = r.transform(i.data, o);
      if (i.common.async) return Promise.resolve(a).then((u) => di(this, null, function* () {
        if (t.value === "aborted") return te;
        let c = yield this._def.schema._parseAsync({ data: u, path: i.path, parent: i });
        return c.status === "aborted" ? te : c.status === "dirty" || t.value === "dirty" ? Rs(c.value) : c;
      }));
      {
        if (t.value === "aborted") return te;
        let u = this._def.schema._parseSync({ data: a, path: i.path, parent: i });
        return u.status === "aborted" ? te : u.status === "dirty" || t.value === "dirty" ? Rs(u.value) : u;
      }
    }
    if (r.type === "refinement") {
      let a = (u) => {
        let c = r.refinement(u, o);
        if (i.common.async) return Promise.resolve(c);
        if (c instanceof Promise) throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");
        return u;
      };
      if (i.common.async === false) {
        let u = this._def.schema._parseSync({ data: i.data, path: i.path, parent: i });
        return u.status === "aborted" ? te : (u.status === "dirty" && t.dirty(), a(u.value), { status: t.value, value: u.value });
      } else return this._def.schema._parseAsync({ data: i.data, path: i.path, parent: i }).then((u) => u.status === "aborted" ? te : (u.status === "dirty" && t.dirty(), a(u.value).then(() => ({ status: t.value, value: u.value }))));
    }
    if (r.type === "transform") if (i.common.async === false) {
      let a = this._def.schema._parseSync({ data: i.data, path: i.path, parent: i });
      if (!Yn(a)) return a;
      let u = r.transform(a.value, o);
      if (u instanceof Promise) throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");
      return { status: t.value, value: u };
    } else return this._def.schema._parseAsync({ data: i.data, path: i.path, parent: i }).then((a) => Yn(a) ? Promise.resolve(r.transform(a.value, o)).then((u) => ({ status: t.value, value: u })) : a);
    be.assertNever(r);
  }
};
$t.create = (e, t, i) => new $t(k({ schema: e, typeName: Y.ZodEffects, effect: t }, se(i)));
$t.createWithPreprocess = (e, t, i) => new $t(k({ schema: t, effect: { type: "preprocess", transform: e }, typeName: Y.ZodEffects }, se(i)));
var Ht = class extends ue {
  _parse(e) {
    return this._getType(e) === z.undefined ? ot(void 0) : this._def.innerType._parse(e);
  }
  unwrap() {
    return this._def.innerType;
  }
};
Ht.create = (e, t) => new Ht(k({ innerType: e, typeName: Y.ZodOptional }, se(t)));
var Mi = class extends ue {
  _parse(e) {
    return this._getType(e) === z.null ? ot(null) : this._def.innerType._parse(e);
  }
  unwrap() {
    return this._def.innerType;
  }
};
Mi.create = (e, t) => new Mi(k({ innerType: e, typeName: Y.ZodNullable }, se(t)));
var cr = class extends ue {
  _parse(e) {
    let { ctx: t } = this._processInputParams(e), i = t.data;
    return t.parsedType === z.undefined && (i = this._def.defaultValue()), this._def.innerType._parse({ data: i, path: t.path, parent: t });
  }
  removeDefault() {
    return this._def.innerType;
  }
};
cr.create = (e, t) => new cr(k({ innerType: e, typeName: Y.ZodDefault, defaultValue: typeof t.default == "function" ? t.default : () => t.default }, se(t)));
var hr = class extends ue {
  _parse(e) {
    let { ctx: t } = this._processInputParams(e), i = X(k({}, t), { common: X(k({}, t.common), { issues: [] }) }), r = this._def.innerType._parse({ data: i.data, path: i.path, parent: k({}, i) });
    return Qn(r) ? r.then((o) => ({ status: "valid", value: o.status === "valid" ? o.value : this._def.catchValue({ get error() {
      return new Ut(i.common.issues);
    }, input: i.data }) })) : { status: "valid", value: r.status === "valid" ? r.value : this._def.catchValue({ get error() {
      return new Ut(i.common.issues);
    }, input: i.data }) };
  }
  removeCatch() {
    return this._def.innerType;
  }
};
hr.create = (e, t) => new hr(k({ innerType: e, typeName: Y.ZodCatch, catchValue: typeof t.catch == "function" ? t.catch : () => t.catch }, se(t)));
var Bs = class extends ue {
  _parse(e) {
    if (this._getType(e) !== z.nan) {
      let t = this._getOrReturnCtx(e);
      return U(t, { code: L.invalid_type, expected: z.nan, received: t.parsedType }), te;
    }
    return { status: "valid", value: e.data };
  }
};
Bs.create = (e) => new Bs(k({ typeName: Y.ZodNaN }, se(e)));
var rP = Symbol("zod_brand");
var dl = class extends ue {
  _parse(e) {
    let { ctx: t } = this._processInputParams(e), i = t.data;
    return this._def.type._parse({ data: i, path: t.path, parent: t });
  }
  unwrap() {
    return this._def.type;
  }
};
var pl = class ep extends ue {
  _parse(t) {
    let { status: i, ctx: r } = this._processInputParams(t);
    if (r.common.async) return di(this, null, function* () {
      let o = yield this._def.in._parseAsync({ data: r.data, path: r.path, parent: r });
      return o.status === "aborted" ? te : o.status === "dirty" ? (i.dirty(), Rs(o.value)) : this._def.out._parseAsync({ data: o.value, path: r.path, parent: r });
    });
    {
      let o = this._def.in._parseSync({ data: r.data, path: r.path, parent: r });
      return o.status === "aborted" ? te : o.status === "dirty" ? (i.dirty(), { status: "dirty", value: o.value }) : this._def.out._parseSync({ data: o.value, path: r.path, parent: r });
    }
  }
  static create(t, i) {
    return new ep({ in: t, out: i, typeName: Y.ZodPipeline });
  }
};
var dr = class extends ue {
  _parse(e) {
    let t = this._def.innerType._parse(e), i = (r) => (Yn(r) && (r.value = Object.freeze(r.value)), r);
    return Qn(t) ? t.then((r) => i(r)) : i(t);
  }
  unwrap() {
    return this._def.innerType;
  }
};
dr.create = (e, t) => new dr(k({ innerType: e, typeName: Y.ZodReadonly }, se(t)));
function tp(e, t = {}, i) {
  return e ? yn.create().superRefine((r, o) => {
    var a, u;
    if (!e(r)) {
      let c = typeof t == "function" ? t(r) : typeof t == "string" ? { message: t } : t, p = (u = (a = c.fatal) !== null && a !== void 0 ? a : i) !== null && u !== void 0 ? u : true, h = typeof c == "string" ? { message: c } : c;
      o.addIssue(X(k({ code: "custom" }, h), { fatal: p }));
    }
  }) : yn.create();
}
var sP = { object: xt.lazycreate };
var Y;
(function(e) {
  e.ZodString = "ZodString", e.ZodNumber = "ZodNumber", e.ZodNaN = "ZodNaN", e.ZodBigInt = "ZodBigInt", e.ZodBoolean = "ZodBoolean", e.ZodDate = "ZodDate", e.ZodSymbol = "ZodSymbol", e.ZodUndefined = "ZodUndefined", e.ZodNull = "ZodNull", e.ZodAny = "ZodAny", e.ZodUnknown = "ZodUnknown", e.ZodNever = "ZodNever", e.ZodVoid = "ZodVoid", e.ZodArray = "ZodArray", e.ZodObject = "ZodObject", e.ZodUnion = "ZodUnion", e.ZodDiscriminatedUnion = "ZodDiscriminatedUnion", e.ZodIntersection = "ZodIntersection", e.ZodTuple = "ZodTuple", e.ZodRecord = "ZodRecord", e.ZodMap = "ZodMap", e.ZodSet = "ZodSet", e.ZodFunction = "ZodFunction", e.ZodLazy = "ZodLazy", e.ZodLiteral = "ZodLiteral", e.ZodEnum = "ZodEnum", e.ZodEffects = "ZodEffects", e.ZodNativeEnum = "ZodNativeEnum", e.ZodOptional = "ZodOptional", e.ZodNullable = "ZodNullable", e.ZodDefault = "ZodDefault", e.ZodCatch = "ZodCatch", e.ZodPromise = "ZodPromise", e.ZodBranded = "ZodBranded", e.ZodPipeline = "ZodPipeline", e.ZodReadonly = "ZodReadonly";
})(Y || (Y = {}));
var oP = (e, t = { message: `Input not instance of ${e.name}` }) => tp((i) => i instanceof e, t);
var ip = gn.create;
var np = Xn.create;
var aP = Bs.create;
var lP = er.create;
var rp = tr.create;
var uP = ir.create;
var cP = Ls.create;
var hP = nr.create;
var dP = rr.create;
var pP = yn.create;
var fP = Vi.create;
var mP = pi.create;
var vP = Ns.create;
var gP = Ji.create;
var yP = xt.create;
var bP = xt.strictCreate;
var wP = sr.create;
var _P = Hd.create;
var CP = or.create;
var EP = Ii.create;
var PP = Yd.create;
var AP = Ds.create;
var SP = js.create;
var OP = Qd.create;
var TP = ar.create;
var xP = lr.create;
var kP = gr.create;
var IP = ur.create;
var MP = bn.create;
var Th = $t.create;
var RP = Ht.create;
var FP = Mi.create;
var LP = $t.createWithPreprocess;
var NP = pl.create;
var DP = () => ip().optional();
var jP = () => np().optional();
var BP = () => rp().optional();
var UP = { string: (e) => gn.create(X(k({}, e), { coerce: true })), number: (e) => Xn.create(X(k({}, e), { coerce: true })), boolean: (e) => tr.create(X(k({}, e), { coerce: true })), bigint: (e) => er.create(X(k({}, e), { coerce: true })), date: (e) => ir.create(X(k({}, e), { coerce: true })) };
var $P = te;
var jt = Object.freeze({ __proto__: null, defaultErrorMap: vn, setErrorMap: $E, getErrorMap: Is, makeIssue: Ms, EMPTY_PATH: zE, addIssueToContext: U, ParseStatus: dt, INVALID: te, DIRTY: Rs, OK: ot, isAborted: Ba, isDirty: Ua, isValid: Yn, isAsync: Qn, get util() {
  return be;
}, get objectUtil() {
  return ja;
}, ZodParsedType: z, getParsedType: xi, ZodType: ue, datetimeRegex: Zd, ZodString: gn, ZodNumber: Xn, ZodBigInt: er, ZodBoolean: tr, ZodDate: ir, ZodSymbol: Ls, ZodUndefined: nr, ZodNull: rr, ZodAny: yn, ZodUnknown: Vi, ZodNever: pi, ZodVoid: Ns, ZodArray: Ji, ZodObject: xt, ZodUnion: sr, ZodDiscriminatedUnion: Hd, ZodIntersection: or, ZodTuple: Ii, ZodRecord: Yd, ZodMap: Ds, ZodSet: js, ZodFunction: Qd, ZodLazy: ar, ZodLiteral: lr, ZodEnum: gr, ZodNativeEnum: ur, ZodPromise: bn, ZodEffects: $t, ZodTransformer: $t, ZodOptional: Ht, ZodNullable: Mi, ZodDefault: cr, ZodCatch: hr, ZodNaN: Bs, BRAND: rP, ZodBranded: dl, ZodPipeline: pl, ZodReadonly: dr, custom: tp, Schema: ue, ZodSchema: ue, late: sP, get ZodFirstPartyTypeKind() {
  return Y;
}, coerce: UP, any: pP, array: gP, bigint: lP, boolean: rp, date: uP, discriminatedUnion: _P, effect: Th, enum: kP, function: OP, instanceof: oP, intersection: CP, lazy: TP, literal: xP, map: AP, nan: aP, nativeEnum: IP, never: mP, null: dP, nullable: FP, number: np, object: yP, oboolean: BP, onumber: jP, optional: RP, ostring: DP, pipeline: NP, preprocess: LP, promise: MP, record: PP, set: SP, strictObject: bP, string: ip, symbol: cP, transformer: Th, tuple: EP, undefined: hP, union: wP, unknown: fP, void: vP, NEVER: $P, ZodIssueCode: L, quotelessJson: UE, ZodError: Ut });
var zP = jt.object({ serverUrl: jt.string() });
var WP = zP.parse({ serverUrl: "https://io.superviz.com" });
var VP = class {
  constructor(e) {
    this.socket = e, this.onConnect = () => {
      this.logger.log("connection @ on connect", "Connected to the socket"), this.changeState("CONNECTED");
    }, this.onDisconnect = (t) => {
      this.logger.log("connection @ on disconnect", "Disconnected from the socket"), this.changeState("DISCONNECTED", t);
    }, this.onConnectError = (t) => {
      this.logger.log("connection @ on connect error", "Connection error", t), this.changeState("CONNECTION_ERROR", t.message);
    }, this.onConnectionError = (t) => {
      this.logger.log("connection @ on connection error", "Connection error", t), this.changeState("CONNECTION_ERROR", t.message);
    }, this.onReconnect = () => {
      this.logger.log("connection @ on reconnect", "Reconnected to the socket"), this.changeState("CONNECTED");
    }, this.onReconnectError = (t) => {
      this.logger.log("connection @ on reconnect error", "Reconnect error", t), this.changeState("RECONNECT_ERROR", t.message);
    }, this.onReconnectFailed = () => {
      this.logger.log("connection @ on reconnect failed", "Failed to reconnect to the socket"), this.changeState("RECONNECT_ERROR");
    }, this.onReconnecAttempt = (t) => {
      this.logger.log("connection @ on reconnect attempt", `Reconnect attempt #${t}`), this.changeState("RECONNECTING", `Reconnect attempt #${t}`);
    }, this.onCustomError = (t) => {
      t.needsToDisconnect && (this.socket.disconnect(), this.changeState("DISCONNECTED", t.errorType));
      let i = `[SuperViz] 
    - Error: ${t.errorType}
    - Message: ${t.message}
    `;
      if (t.level === "error") {
        console.error(i);
        return;
      }
      console.warn(i);
    }, this.logger = new ol("@superviz/socket-client/connection"), this.subscribeToManagerEvents(), this.stateObserver = new Zt();
  }
  on(e, t) {
    this.stateObserver.closed && (this.stateObserver = new Zt()), this.stateObserver.subscribe({ next: e, error: t });
  }
  off() {
    this.stateObserver.closed || this.stateObserver.unsubscribe();
  }
  subscribeToManagerEvents() {
    this.socket.on("connect", this.onConnect), this.socket.on("disconnect", this.onDisconnect), this.socket.on("connect_error", this.onConnectError), this.socket.io.on("error", this.onConnectionError), this.socket.io.on("reconnect", this.onReconnect), this.socket.io.on("reconnect_attempt", this.onReconnecAttempt), this.socket.io.on("reconnect_error", this.onReconnectError), this.socket.io.on("reconnect_failed", this.onReconnectFailed), this.socket.on("socket-event.error", this.onCustomError);
  }
  changeState(e, t) {
    this.state = e, !this.stateObserver.closed && this.stateObserver.next({ state: e, reason: t });
  }
};
var GP = class sp {
  constructor(t, i, r, o, a = 100) {
    this.io = t, this.user = i, this.roomId = r, this.apiKey = o, this.maxConnections = a, this.isJoined = false, this.subscriptions = /* @__PURE__ */ new Map(), this.observers = /* @__PURE__ */ new Map(), this.onJoinedRoom = (c) => {
      var p;
      this.roomId === ((p = c == null ? void 0 : c.data) == null ? void 0 : p.name) && (this.isJoined = true, this.io.emit("room.joined", this.roomId, c.data), this.logger.log("room @ joined", c));
    }, this.onHttpEvent = (c) => {
      this.publishEventToClient(c.name, c);
    }, this.logger = new ol("@superviz/socket-client/room");
    let u = { name: r, user: i, maxConnections: a };
    this.presence = KC.register(t, i, r), this.io.emit("room.join", u), this.subscribeToRoomEvents();
  }
  static register(t, i, r, o, a) {
    return new sp(t, i, r, o, a);
  }
  on(t, i) {
    this.logger.log("room @ on", t);
    let r = this.observers.get(t);
    r || (r = new Zt(), this.observers.set(t, r), this.io.on(t, (o) => {
      this.publishEventToClient(t, o);
    })), this.subscriptions.set(i, r.subscribe(i));
  }
  off(t, i) {
    var r;
    if (this.logger.log("room @ off", t), !i) {
      this.observers.delete(t), this.io.off(t);
      return;
    }
    (r = this.subscriptions.get(i)) == null || r.unsubscribe();
  }
  emit(t, i) {
    if (!this.isJoined) {
      this.logger.log("Cannot emit event. Not joined to room");
      return;
    }
    let r = { name: t, roomId: this.roomId, presence: this.user, connectionId: this.io.id, data: i, timestamp: Date.now() };
    this.io.emit("room.update", this.roomId, r), this.logger.log("room @ emit", t, i);
  }
  history(t, i) {
    let r = new Zt();
    r.subscribe({ next: t, error: i });
    let o = (a) => {
      this.logger.log("room @ history", a), this.io.off("room.get", o), r.next(a), r.complete(), r.unsubscribe();
    };
    this.io.on("room.get", o), this.io.emit("room.get", this.roomId);
  }
  disconnect() {
    this.logger.log("room @ disconnect", "Leaving room...", this.roomId), this.io.emit("room.leave", this.roomId), this.subscriptions.forEach((t) => t.unsubscribe()), this.subscriptions.clear(), this.observers.forEach((t) => t.unsubscribe()), this.observers.clear(), this.presence.destroy();
  }
  publishEventToClient(t, i) {
    let r = this.observers.get(t);
    !r || i.roomId !== this.roomId || r.next(i);
  }
  subscribeToRoomEvents() {
    this.io.on("room.joined", this.onJoinedRoom), this.io.on("room.error", (t) => {
      this.logger.log("Error:", t.data);
    }), this.io.on(`http:${this.roomId}:${this.apiKey}`, this.onHttpEvent);
  }
};
var ZP = class {
  constructor(e, t, i, r, o) {
    this.apiKey = e, this.environment = t, this.presence = i, this.secret = r, this.clientId = o, this.manager = new ks(WP.serverUrl, { addTrailingSlash: false, secure: true, withCredentials: true, reconnection: true, reconnectionDelay: 1e3, reconnectionDelayMax: 5e3, reconnectionAttempts: 5, extraHeaders: { "sv-api-key": this.apiKey } });
    let a;
    typeof window < "u" && (a = window.location.origin), this.socket = this.manager.socket(`/${t}`, { auth: { apiKey: this.apiKey, origin: a, envirioment: this.environment, secret: this.secret, clientId: this.clientId } }), this.connection = new VP(this.socket);
  }
  get state() {
    return this.connection.state;
  }
  connect(e, t) {
    return GP.register(this.socket, this.presence, e, this.apiKey, t);
  }
  destroy() {
    this.socket.disconnect(), this.connection.off();
  }
};
jt.object({ name: jt.string(), user: jt.object({ id: jt.string(), name: jt.string().nullable() }), maxConnections: jt.union([jt.number(), jt.literal("unlimited"), jt.undefined()]) });
var JP = zt(wn());
O();
var xh = class {
  constructor() {
    this.observers = /* @__PURE__ */ new Map(), this.subscribe = (e, t) => {
      this.logger.log("event bus service @ subscribe", { event: e, callback: t }), this.observers.has(e) || this.observers.set(e, new $e()), this.observers.get(e).subscribe(t);
    }, this.unsubscribe = (e, t) => {
      this.logger.log("event bus service @ unsubscribe", { event: e, callback: t }), this.observers.has(e) && (this.observers.get(e).reset(), this.observers.delete(e));
    }, this.publish = (e, t) => {
      this.logger.log("event bus service @ publish", { event: e, data: t }), this.observers.has(e) && this.observers.get(e).publish(t);
    }, this.destroy = () => {
      this.logger.log("event bus service @ destroy"), this.observers.forEach((e) => {
        e.reset(), e.destroy();
      }), this.observers.clear();
    }, this.logger = new qe("@superviz/sdk/event-bus"), this.logger.log("event bus created");
  }
};
O();
O();
var HP = class {
  constructor(e) {
    this.participant = e, this.stateSubject = new vr(), this.handleConnectionState = (t) => {
      if (t.reason === "Unauthorized connection") {
        console.error("[Superviz] Unauthorized connection. Please check your API key and if your domain is white listed."), this.state = { state: gd.DISCONNECTED, reason: "Unauthorized connection" }, this.stateSubject.next("AUTH_ERROR");
        return;
      }
      if (t.reason === "user-already-in-room") {
        this.state = t, this.stateSubject.next("SAME_ACCOUNT_ERROR");
        return;
      }
      this.state = t, this.stateSubject.next(t.state);
    }, this.createClient();
  }
  destroy() {
    this.stateSubject.complete(), this.client.destroy();
  }
  subscribeToDefaultEvents() {
    this.client.connection.on(this.handleConnectionState);
  }
  createClient() {
    let e = Q.get("environment");
    e = ["dev", "prod"].includes(e) ? e : "dev", this.client = new ZP(Q.get("apiKey"), e, { id: this.participant.id, name: this.participant.name }), this.subscribeToDefaultEvents();
  }
  createRoom(e, t = 50) {
    let i = Q.get("roomId");
    return this.client.connect(`${i}:${e}`, t);
  }
};
O();
O();
var op = ((e) => (e.comments = "presence", e.presence3dMatterport = "presence", e.presence3dAutodesk = "presence", e.presence3dThreejs = "presence", e.whoIsOnline = "presence", e.formElements = "presence", e.yjsProvider = "presence", e))(op || {});
var kh = class {
  static checkComponentLimit(e) {
    var t, i;
    let r = Q.get("limits"), o = (t = op[e]) != null ? t : e;
    return (i = r == null ? void 0 : r[o]) != null ? i : { canUse: false, maxParticipants: 50 };
  }
};
O();
var qP = zt(wn());
O();
var KP = 1e3;
var YP = class {
  constructor(e, t) {
    this.participants3DObservers = [], this.initializeParticipantsList = () => {
      this.room.presence.get((r) => {
        r.forEach((o) => {
          this.unthrottledUpdatePresence3D(o.data);
        });
      });
    }, this.onLocalParticipantJoined = (r) => {
      var o;
      if (!r.slot || ((o = r.slot) == null ? void 0 : o.index) === null) {
        setTimeout(() => {
          this.onLocalParticipantJoined(this.localParticipant);
        }, 2e3);
        return;
      }
      if (!this.room.isJoined) {
        setTimeout(() => {
          this.onLocalParticipantJoined(r);
        }, 2e3);
        return;
      }
      let { hasJoined3D: a } = this.useStore("presence-3d-store");
      a.publish(true), this.room.emit("participant-joined", r), this.room.presence.update(r), this.initializeParticipantsList();
    }, this.subscribeToRoomEvents = () => {
      this.room.on("participant-joined", this.onJoinedRoom), this.room.presence.on(ee.LEAVE, this.onLeaveRoom), this.room.presence.on(ee.UPDATE, this.onParticipantUpdate), this.room.presence.on(ee.JOINED_ROOM, this.onJoinedPresence);
    }, this.unsubscribeFromRoomEvents = () => {
      this.room.off("participant-joined", this.onJoinedRoom), this.room.presence.off(ee.LEAVE), this.room.presence.off(ee.UPDATE), this.room.presence.off(ee.JOINED_ROOM);
    }, this.onJoinedRoom = (r) => {
      let { participants: o } = this.useStore("presence-3d-store"), a = o.value.find((u) => u.id === r.data.id);
      o.publish([...o.value.filter((u) => u.id !== r.data.id), $($({}, a), r.data)]);
    }, this.onLeaveRoom = (r) => {
      if (r.id === this.localParticipant.id) {
        this.unsubscribeFromRoomEvents(), this.useStore("presence-3d-store").destroy();
        return;
      }
      let { participants: o } = this.useStore("presence-3d-store"), a = o.value.filter((u) => u.id !== r.id);
      o.publish(a);
    }, this.unthrottledUpdatePresence3D = (r) => {
      if (!(r != null && r.id)) return;
      let { participants: o, hasJoined3D: a } = this.useStore("presence-3d-store"), u = $($({}, o.value.find((c) => c.id === r.id)), r);
      o.publish([...o.value.filter((c) => c.id !== r.id), u]), !(!a.value || u.id !== this.localParticipant.id) && this.room.presence.update(u);
    }, this.onJoinedPresence = (r) => {
      r.id === this.localParticipant.id && (this.logger.log("participant joined 3D room", r.id, this.localParticipant), this.onLocalParticipantJoined(this.localParticipant));
    }, this.updatePresence3D = (0, qP.throttle)((r) => {
      this.unthrottledUpdatePresence3D(r);
    }, KP), this.onParticipantUpdate = (r) => {
      if (r.id === this.localParticipant.id) return;
      let { participants: o } = this.useStore("presence-3d-store"), a = $($({}, o.value.filter((c) => c.id === r.id)[0]), r.data), u = o.value.map((c) => c.id === r.id ? a : c);
      o.publish(u), this.participants3DObservers[r.id] && this.participants3DObservers[r.id].publish(a);
    }, this.setParticipantData = (r) => {
      this.updatePresence3D(r);
    }, this.room = e, this.logger = new qe("@superviz/sdk/presence3D-manager"), this.useStore = t, this.subscribeToRoomEvents();
    let { localParticipant: i } = this.useStore("global-store");
    i.subscribe((r) => {
      this.room.presence.update(r);
      let { participants: o } = this.useStore("presence-3d-store"), a = $($({}, o.value.find((u) => u.id === r.id)), r);
      o.publish([...o.value.filter((u) => u.id !== r.id), a]), this.localParticipant = a;
    });
  }
  subscribeToUpdates(e, t) {
    this.participants3DObservers[e] || (this.participants3DObservers[e] = new $e({ logger: this.logger })), this.participants3DObservers[e].subscribe(t);
  }
  unsubscribeFromUpdates(e, t) {
    this.participants3DObservers[e] && this.participants3DObservers[e].unsubscribe(t);
  }
  get getParticipants() {
    return this.useStore("presence-3d-store").participants.value;
  }
};
O();
O();
var ap = ((e) => (e.HOST = "host", e.GUEST = "guest", e.AUDIENCE = "audience", e))(ap || {});
var QP = class {
  constructor(e, t) {
    this.room = e, this.useStore = t, this.isAssigningSlot = false, this.slot = { index: null, color: Jt.gray, textColor: "#fff", colorName: "gray", timestamp: Date.now() }, this.onPresenceUpdate = (i) => he(this, null, function* () {
      var r, o, a;
      let { localParticipant: u } = this.useStore("global-store");
      if (i.id === u.value.id) {
        let c = yield this.validateSlotType(i.data);
        u.publish(de($({}, u.value), { slot: c }));
        return;
      }
      if (!(((r = i.data.slot) == null ? void 0 : r.index) === null || this.slot.index === null) && ((o = i.data.slot) == null ? void 0 : o.index) === ((a = this.slot) == null ? void 0 : a.index)) {
        let c = yield this.assignSlot();
        u.publish(de($({}, u.value), { slot: c })), console.debug(`[SuperViz] - Slot reassigned to ${u.value.id}, slot: ${c.colorName}`);
      }
    }), this.participantNeedsSlot = (i) => {
      var r;
      let o = ["formElements", "whoIsOnline", "presence", "presence3dAutodesk", "presence3dMatterport", "presence3dThreejs", "yjsProvider"].some((u) => {
        var c;
        return (c = i == null ? void 0 : i.activeComponents) == null ? void 0 : c.includes(u);
      }), a = ((r = i == null ? void 0 : i.activeComponents) == null ? void 0 : r.includes("videoConference")) && i.type !== "audience";
      return o || a;
    }, this.validateSlotType = (i) => he(this, null, function* () {
      var r, o;
      if (this.isAssigningSlot) return this.slot;
      let a = this.participantNeedsSlot(i);
      if (((r = i.slot) == null ? void 0 : r.index) === null && a) {
        let u = yield this.assignSlot();
        this.slot = u;
      }
      return ((o = i.slot) == null ? void 0 : o.index) !== null && !a && this.setDefaultSlot(), this.slot;
    }), this.room = e, this.room.presence.on(ee.UPDATE, this.onPresenceUpdate);
  }
  assignSlot() {
    return he(this, null, function* () {
      if (this.isAssigningSlot) return this.slot;
      this.isAssigningSlot = true;
      let e = Array.from({ length: 50 }, (o, a) => a), t = Math.floor(Math.random() * 50), { localParticipant: i, participants: r } = st("global-store");
      try {
        yield new Promise((u, c) => {
          this.room.presence.get((p) => {
            if ((!p || !p.length) && u(true), p.length >= 50) {
              e = [], c(new Error("[SuperViz] - No more slots available"));
              return;
            }
            p.forEach((h) => {
              h.id !== i.value.id && (e = e.filter((f) => {
                var m, y;
                return f !== ((y = (m = h.data) == null ? void 0 : m.slot) == null ? void 0 : y.index);
              }));
            }), u(true);
          });
        }), !e.includes(t) && (t = e.shift());
        let o = Object.keys(Jt)[t], a = { index: t, color: Jt[o], textColor: pw.includes(o) ? "#fff" : "#000", colorName: o, timestamp: Date.now() };
        return this.slot = a, i.publish(de($({}, i.value), { slot: a })), r.publish(de($({}, r.value), { [i.value.id]: de($({}, r.value[i.value.id]), { slot: a }) })), this.room.presence.update({ slot: a }), this.isAssigningSlot = false, a;
      } catch (o) {
        return console.error(o), null;
      }
    });
  }
  setDefaultSlot() {
    let { localParticipant: e, participants: t } = st("global-store"), i = { index: null, color: Jt.gray, textColor: "#fff", colorName: "gray", timestamp: Date.now() };
    this.slot = i, e.publish(de($({}, e.value), { slot: i })), t.publish(de($({}, t.value), { [e.value.id]: de($({}, t.value[e.value.id]), { slot: i }) })), this.room.presence.update({ slot: i });
  }
};
O();
var XP = class extends rl {
  constructor({ participant: e, group: t }) {
    super(), this.isDestroyed = false, this.activeComponents = [], this.componentsToAttachAfterJoin = [], this.activeComponentsInstances = [], this.eventBus = new xh(), this.useStore = st.bind(this), this.addComponent = (c) => he(this, null, function* () {
      if (!this.canAddComponent(c)) return;
      let { hasJoinedRoom: p, group: h, localParticipant: f } = st("global-store");
      if (!p.value) {
        this.logger.log("launcher service @ addComponent - not joined yet"), this.componentsToAttachAfterJoin.push(c);
        return;
      }
      let m = kh.checkComponentLimit(c.name);
      c.attach({ ioc: this.ioc, config: Q.configuration, eventBus: this.eventBus, useStore: st, Presence3DManagerService: YP, connectionLimit: m.maxParticipants }), this.activeComponents.push(c.name), this.activeComponentsInstances.some((y) => y.name === c.name) ? this.activeComponentsInstances = this.activeComponentsInstances.map((y) => y.name === c.name ? c : y) : this.activeComponentsInstances.push(c), f.publish(de($({}, f.value), { activeComponents: this.activeComponents })), this.room.presence.update(de($({}, f.value), { slot: this.slotService.slot, activeComponents: this.activeComponents })), Qe.sendActivity(this.participant.id, h.value.id, h.value.name, c.name);
    }), this.attachComponentsAfterJoin = () => {
      this.logger.log("launcher service @ attachComponentsAfterJoin"), this.componentsToAttachAfterJoin.forEach((c) => {
        this.logger.log("launcher service @ attachComponentsAfterJoin - attaching component", c.name), this.addComponent(c);
      }), this.componentsToAttachAfterJoin = [];
    }, this.removeComponent = (c) => {
      if (!this.activeComponents.includes(c.name)) {
        let p = `[SuperViz] Component ${c.name} is not initialized yet.`;
        this.logger.log(p), console.error(p);
        return;
      }
      c.detach(), this.activeComponentsInstances = this.activeComponentsInstances.filter((p) => p.name !== c.name), this.activeComponents.splice(this.activeComponents.indexOf(c.name), 1), this.room.presence.update(de($({}, this.participant), { activeComponents: this.activeComponents }));
    }, this.destroy = () => {
      var c, p, h, f, m, y;
      this.logger.log("launcher service @ destroy"), this.activeComponentsInstances.forEach((g) => {
        this.logger.log("launcher service @ destroy - removing component", g.name), this.removeComponent(g);
      }), this.activeComponents = [], this.activeComponentsInstances = [], (c = il()) == null || c.destroy(), (p = this.eventBus) == null || p.destroy(), this.eventBus = void 0, (h = this.room) == null || h.presence.off(ee.JOINED_ROOM), (f = this.room) == null || f.presence.off(ee.LEAVE), (m = this.room) == null || m.presence.off(ee.UPDATE), (y = this.ioc) == null || y.destroy(), this.isDestroyed = true, typeof window < "u" && (window.SUPERVIZ = void 0);
    }, this.canAddComponent = (c) => {
      var p;
      let h = Q.get(`features.${c.name}`), f = kh.checkComponentLimit(c.name), m = (p = this.activeComponents) == null ? void 0 : p.includes(c.name), y = [{ isValid: h, message: `[SuperViz] Component ${c.name} is not enabled in the room` }, { isValid: !this.isDestroyed, message: "[SuperViz] Component can not be added because the superviz room is destroyed. Initialize a new room to add and use components." }, { isValid: !m, message: `[SuperViz] Component ${c.name} is already active. Please remove it first` }, { isValid: f.canUse, message: `[SuperViz] You reached the limit usage of ${c.name}` }];
      for (let g = 0; g < y.length; g++) {
        let { isValid: _, message: E } = y[g];
        if (!_) return this.logger.log(E), console.error(E), false;
      }
      return true;
    }, this.onAuthentication = (c) => {
      c || (this.destroy(), console.error("[SuperViz] Room cannot be initialized because this website's domain is not whitelisted. If you are the developer, please add your domain in https://dashboard.superviz.com/developer"));
    }, this.onLocalParticipantUpdateOnStore = (c) => {
      this.participant = c, this.activeComponents = c.activeComponents || [];
    }, this.onLocalParticipantUpdateOnCore = (c) => {
      this.room && this.room.presence.update(c);
    }, this.onParticipantsListUpdateOnCore = (c) => {
      let { participants: p } = this.useStore("global-store");
      p.publish(c);
    }, this.onSameAccount = () => {
      this.publish("participant.same-account-error"), this.destroy();
    }, this.startIOC = () => {
      this.logger.log("launcher service @ startIOC");
      let { participants: c } = st("global-store");
      this.ioc.stateSubject.subscribe(this.onConnectionStateChange), this.room.presence.get((p) => {
        let h = {};
        p.forEach((f) => {
          h[f.id] = de($({}, f.data), { name: f.name, id: f.id, timestamp: f.timestamp });
        }), h[this.participant.id] = $($({}, h[this.participant.id]), this.participant), c.publish(h);
      }), this.room.presence.on(ee.JOINED_ROOM, this.onParticipantJoinedIOC), this.room.presence.on(ee.LEAVE, this.onParticipantLeaveIOC), this.room.presence.on(ee.UPDATE, this.onParticipantUpdatedIOC);
    }, this.onConnectionStateChange = (c) => {
      if (c === "AUTH_ERROR") {
        this.onAuthentication(false);
        return;
      }
      c === "SAME_ACCOUNT_ERROR" && this.onSameAccount();
    }, this.onParticipantJoinedIOC = (c) => he(this, null, function* () {
      if (c.id !== this.participant.id) return;
      this.room.presence.update(this.participant), this.logger.log("launcher service @ onParticipantJoined - local participant joined");
      let { hasJoinedRoom: p } = st("global-store");
      p.publish(true), this.attachComponentsAfterJoin(), this.publish("participant.local-joined", this.participant), this.publish("participant.joined", this.participant);
    }), this.onParticipantLeaveIOC = (c) => {
      let { participants: p, localParticipant: h } = st("global-store"), f = $({}, p.value);
      delete f[c.id], p.publish(f), c.id === h.value.id && (this.logger.log("launcher service @ onParticipantLeave - local participant left"), this.publish("participant.local-left", c.data)), this.logger.log("launcher service @ onParticipantLeave - participant left", c.data), this.publish("participant.left", c.data), this.publish("participant.list-updated", Object.values(f));
    }, this.onParticipantUpdatedIOC = (c) => {
      let { localParticipant: p } = st("global-store");
      if (p.value && c.id === p.value.id) {
        let g = $($({}, p.value), c.data);
        p.publish(de($({}, g), { timestamp: c.timestamp })), this.publish("participant.updated", g), this.logger.log("Publishing ParticipantEvent.UPDATED", c.data);
      }
      let { participants: h } = st("global-store"), f = $({ id: c.id, name: c.name, timestamp: c.timestamp }, c.data);
      h.value[c.id] || this.publish("participant.joined", f);
      let m = Object.assign({}, h.value);
      if (m[c.id] = f, (0, JP.isEqual)(m, h.value)) return;
      h.publish(m);
      let y = Object.values(h.value);
      this.logger.log("Publishing ParticipantEvent.LIST_UPDATED", h.value), this.publish("participant.list-updated", y);
    }, this.logger = new qe("@superviz/sdk/launcher");
    let { localParticipant: i, group: r, isDomainWhitelisted: o } = this.useStore("global-store"), { localParticipant: a, participants: u } = this.useStore("core-store");
    i.publish($({}, e)), o.subscribe(this.onAuthentication), i.subscribe(this.onLocalParticipantUpdateOnStore), a.subscribe(this.onLocalParticipantUpdateOnCore), u.subscribe(this.onParticipantsListUpdateOnCore), r.publish(t), this.ioc = new HP(i.value), this.room = this.ioc.createRoom("launcher", "unlimited"), this.slotService = new QP(this.room, this.useStore), i.publish(de($({}, i.value), { slot: this.slotService.slot, activeComponents: [] })), this.participant = i.value, this.eventBus = new xh(), this.logger.log("launcher created"), this.startIOC();
  }
};
var eA = (e) => {
  if (typeof window < "u" && window.SUPERVIZ) return console.warn("[SUPERVIZ] Room already initialized"), { destroy: window.SUPERVIZ.destroy, subscribe: window.SUPERVIZ.subscribe, unsubscribe: window.SUPERVIZ.unsubscribe, addComponent: window.SUPERVIZ.addComponent, removeComponent: window.SUPERVIZ.removeComponent };
  let t = new XP(e);
  return typeof window < "u" && (window.SUPERVIZ = t), { destroy: t.destroy, subscribe: t.subscribe, unsubscribe: t.unsubscribe, addComponent: t.addComponent, removeComponent: t.removeComponent };
};
function Ih(e) {
  let t = /^.{2,64}$/, i = /^[-_&@+=,(){}\[\]\/«».:|'"#a-zA-Z0-9À-ÿ\s]*$/;
  return !(!t.test(e) || !i.test(e));
}
function tA(e) {
  return /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e);
}
var iA = ({ group: e, participant: t, roomId: i, customColors: r }) => {
  if (r && nA(r), !e || !e.name || !e.id) throw new Error("[SuperViz] Group fields is required");
  if (!t || !t.id) throw new Error("[SuperViz] Participant id is required");
  if (!i) throw new Error("[SuperViz] Room id is required");
  if (!Ih(i)) throw new Error(`[SuperViz] Room id is invalid, it should be between 2 and 64 characters and only accept letters, numbers and special characters: -_&@+=,(){}[]/«».:|'"`);
  if (!Ih(t.id)) throw new Error(`[SuperViz] Participant id is invalid, it should be between 2 and 64 characters and only accept letters, numbers and special characters: -_&@+=,(){}[]/«».:|'"`);
  if (t.email && !tA(t.email)) throw new Error("[SuperViz] Participant email is invalid");
};
var nA = (e) => {
  Object.entries(e).forEach(([t, i]) => {
    if (!Object.values(md).includes(t)) throw new Error(`[SuperViz] Color ${t} is not a valid color variable name. Please check the documentation for more information.`);
    if (!/^(\d{1,3}\s){2}\d{1,3}$/.test(i)) throw new Error(`[SuperViz] Color ${t} is not a valid color variable value. Please check the documentation for more information.`);
  });
};
var rA = (e) => {
  e && Object.entries(e).forEach(([t, i]) => {
    let r = i.replace(/\s/g, ", ");
    document.documentElement.style.setProperty(`--${t}`, r);
  });
};
var sA = (e, t) => he(void 0, null, function* () {
  var i, r, o, a, u;
  if (!(e && e.trim())) throw new Error("API key is required");
  if (!t) throw new Error("Options is required");
  iA(t), t.debug ? lh.debug.enable("*") : lh.debug.disable();
  let [{ apiUrl: c, conferenceLayerUrl: p }, h] = yield Promise.all([Sa.getRemoteConfig(t.environment), Sa.getFeatures(e)]);
  if (!(yield CC(c, e))) throw new Error("Failed to validate API key");
  let [f, m] = yield Promise.all([Qe.fetchWaterMark(c, e), Qe.fetchLimits(c, e)]).catch(() => {
    throw new Error("[SuperViz] Failed to load configuration from server");
  }), { participant: y, roomId: g, customColors: _ } = t;
  Q.setConfig({ apiUrl: c, apiKey: e, conferenceLayerUrl: p, environment: (i = t.environment) != null ? i : "prod", roomId: g, debug: t.debug, limits: m, waterMark: f, colors: _, features: h }), rA(_);
  let E = yield Qe.fetchParticipant(y.id).catch(() => null);
  if (!E && !y.name) throw new Error("[SuperViz] - Participant does not exist, create the user in the API or add the name in the initialization to initialize the SuperViz room.");
  return E || (yield Qe.createParticipant({ participantId: y.id, name: y == null ? void 0 : y.name, avatar: (r = y.avatar) == null ? void 0 : r.imageUrl, email: y == null ? void 0 : y.email })), eA(de($({}, t), { participant: { id: y.id, name: (o = y.name) != null ? o : E == null ? void 0 : E.name, avatar: (a = y.avatar) != null ? a : E == null ? void 0 : E.avatar, email: (u = y.email) != null ? u : E == null ? void 0 : E.email } }));
});
var lp = sA;
O();
typeof window < "u" && typeof HTMLElement < "u" && (import("./icon-3HSZY4BG-grgmZtww-Z4FVKSCM.js"), import("./dropdown-OIZAL2LO-CPX8Gnyu-GQYHPJ4I.js"), import("./tooltip-JQUVL2QH-D_rVn8ZB-FXEP66VY.js"), import("./modal-YJCZEQ42-CoycY_Js-GI5MXYVX.js"), import("./comments-MGTDGIFZ-B7MhYZyz-LHY4EZ7O.js"), import("./topbar-ZPQKL3NR-B___Gtx7-4P3BPDUK.js"), import("./content-BR3JBVI3-DcusmrRY-CF2AV2CY.js"), import("./comment-item-7VNMGU4V-BC2Rrs01-FRJ2AEEO.js"), import("./comment-input-VDWSGSQW-Cz_4CTkh-JPKVHVQ4.js"), import("./annotation-pin-K67PIXO5-DO-QXLt6-J74MUOMG.js"), import("./annotation-item-VHKOJQVW-Baurzr8--ADB4ZYMO.js"), import("./delete-comment-modal-JX3K2H44-XQyqkSFi-IPGNWVKJ.js"), import("./annotation-resolved-6VJKFGWE-DyTa30u8-2WPBGZT7.js"), import("./annotation-filter-E7SCYW2G-C-0oC5Cr-46AEFJVP.js"), import("./float-button-X32X4R7I-U8bGYxU--2IUQDAIF.js"), import("./mention-list-PEJOF3VQ-Cqe2LibN-MBFIF2IM.js"), import("./who-is-online-4MQU4252-D17VbSGQ-QZ5A6U2G.js"), import("./hello-world-DBOTV35Y-YvBfShgO-KB5N2U3K.js"));
O();
O();
function oA(e) {
  if (typeof document < "u") {
    let t = document.createElement("style");
    t.id = "superviz-style";
    let i = document.createTextNode(e);
    t.appendChild(i), document.head.appendChild(t);
  }
}
var aA = `@import"https://unpkg.com/@superviz/sv-icons@0.8.13/css/style.css";@import"https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap";:root{--sv-primary: 98, 16, 204}html,body{width:100%;height:100%;overflow:hidden}#sv-video-wrapper iframe{position:fixed;border:none;margin:0;padding:0;overflow:hidden;z-index:1000}#sv-video-wrapper iframe.sv-video-frame--right{top:var(--superviz-offset-top);right:var(--superviz-offset-right)}#sv-video-wrapper iframe.sv-video-frame--left{top:var(--superviz-offset-top);left:var(--superviz-offset-left)}#sv-video-wrapper iframe.sv-video-frame--bottom{bottom:var(--superviz-offset-bottom);right:var(--superviz-offset-right);width:100%}#sv-video-wrapper iframe.sv-video-frame--top{top:var(--superviz-offset-top);right:var(--superviz-offset-right);width:100%}#sv-video-wrapper iframe.sv-video-frame--no-overlay{display:none}.pointer-mouse{display:flex;height:15px;width:16px;background-image:url(https://production.cdn.superviz.com/static/pointers/0.svg);background-repeat:no-repeat}.mouse-user-name{display:block;position:absolute;border-radius:30px;padding:2px 8px;font-weight:700;font-size:14px;font-family:Roboto,sans-serif;line-height:22px;margin-left:10px;margin-top:-6px;background:#ff0;white-space:nowrap}.mouse-follower{position:absolute;display:block;z-index:2}
`;
oA(aA);
O();
var up = ((e) => (e.RIGHT = "right", e.CENTER = "center", e.LEFT = "left", e))(up || {});
var cp = ((e) => (e.GRID = "grid", e.LIST = "list", e))(cp || {});
var hp = ((e) => (e.RIGHT = "right", e.LEFT = "left", e.TOP = "top", e.BOTTOM = "bottom", e))(hp || {});
O();
var dp = ((e) => (e.STARTED = "STARTED", e.STOPPED = "STOPPED", e))(dp || {});
var pp = ((e) => (e.REALTIME_STATE_CHANGED = "realtime-component.state-changed", e))(pp || {});
O();
var fp = ((e) => (e.BLUR = "field.blur", e.FOCUS = "field.focus", e.CONTENT_CHANGE = "field.content-change", e.INTERACTION = "field.interaction", e))(fp || {});
O();
O();
O();
var Hi = class extends rl {
  constructor() {
    super(...arguments), this.isAttached = false, this.unsubscribeFrom = [], this.useStore = st.bind(this), this.attach = (e) => {
      var t;
      if (Object.values(e).includes(null) || Object.values(e).includes(void 0)) {
        let c = `${this.name} @ attach - params are required`;
        throw this.logger.log(c), new Error(c);
      }
      let { config: i, eventBus: r, ioc: o } = e, { isDomainWhitelisted: a, hasJoinedRoom: u } = this.useStore("global-store");
      if (!a.value) {
        let c = `Component ${this.name} can't be used because this website's domain is not whitelisted. Please add your domain in https://dashboard.superviz.com/developer`;
        this.logger.log(c);
        return;
      }
      if (Q.setConfig(i), this.eventBus = r, this.isAttached = true, this.ioc = o, this.connectionLimit = (t = e.connectionLimit) != null ? t : 50, this.room = o.createRoom(this.name, this.connectionLimit), !u.value) {
        this.logger.log(`${this.name} @ attach - not joined yet`), setTimeout(() => {
          this.logger.log(`${this.name} @ attach - retrying`), this.attach(e);
        }, 1e3);
        return;
      }
      this.logger.log(`${this.name} @ attached`), this.observers = {}, this.start(), this.publish("mount");
    }, this.detach = () => {
      if (!this.isAttached) {
        this.logger.log(`${this.name} @ detach - component is not attached`);
        return;
      }
      this.logger.log("detached"), this.publish("unmount"), this.destroy(), this.room.disconnect(), this.room = void 0, this.unsubscribeFrom.forEach((e) => e(this)), Object.values(this.observers).forEach((e) => {
        e.reset(), e.destroy();
      }), this.observers = void 0, this.isAttached = false;
    };
  }
};
var lA = class extends Hi {
  constructor(e, t) {
    var i, r, o;
    super(), this.sidebarOpen = false, this.layoutOptions = {}, this.openThreads = () => {
      var c;
      this.sidebarOpen || ((c = this.element) == null || c.setAttribute("open", ""), this.sidebarOpen = true, document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar", { detail: { open: this.sidebarOpen }, composed: true, bubbles: true })));
    }, this.closeThreads = () => {
      var c;
      this.sidebarOpen && ((c = this.element) == null || c.removeAttribute("open"), this.sidebarOpen = false, document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar", { detail: { open: this.sidebarOpen }, composed: true, bubbles: true })));
    }, this.togglePinActive = () => {
      if (this.pinActive) {
        this.disable();
        return;
      }
      this.enable();
    }, this.onPinFixed = (c) => {
      this.coordinates = c;
    }, this.toggleAnnotationSidebar = () => {
      this.element.toggleAttribute("open"), this.sidebarOpen = this.element.hasAttribute("open"), document.body.dispatchEvent(new CustomEvent("prepare-to-create-annotation", { detail: void 0, composed: true, bubbles: true })), document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar", { detail: { open: this.sidebarOpen }, composed: true, bubbles: true }));
    }, this.onSelectAnnotation = (c) => {
      this.sidebarOpen || this.toggleAnnotationSidebar();
    }, this.positionFloatingButton = () => {
      var c, p;
      this.button = document.createElement("superviz-comments-button");
      let h = (c = this.layoutOptions) == null ? void 0 : c.buttonLocation, f = (p = this.layoutOptions) == null ? void 0 : p.position;
      if (!h) {
        document.body.appendChild(this.button), this.button.commentsPosition = f;
        return;
      }
      let m = "", y = Object.values(Hh), g = false, _ = !y.includes(h.toLocaleLowerCase());
      if (_) {
        let E = window.document.body.querySelector(`#${h}`);
        E ? (E.appendChild(this.button), m = "position: relative") : (g = true, h = "top-left");
      }
      if (!_ || g) {
        document.body.appendChild(this.button);
        let [E, R] = h.split("-");
        m = `${E}: 20px; ${R}: 20px;`;
      }
      this.button.positionStyles = m, this.button.commentsPosition = f;
    }, this.positionComments = () => {
      var c;
      this.element = document.createElement("superviz-comments"), this.element.setAttribute("comments", JSON.stringify([])), this.element.side = "left", this.element.offset = this.offset, document.body.appendChild(this.element);
      let p = (c = this.layoutOptions) == null ? void 0 : c.position;
      if (!p) return;
      let h = p.toUpperCase();
      Ca[h] && (this.element.side = Ca[h]);
    }, this.createAnnotation = (c) => he(this, [c], function* ({ detail: p }) {
      try {
        let { text: h, mentions: f } = p, m = $({}, this.coordinates), y = yield Qe.createAnnotations(Q.get("apiUrl"), Q.get("apiKey"), { roomId: Q.get("roomId"), position: JSON.stringify(m), userId: this.localParticipantId }), g = yield this.createComment(y.uuid, h, f);
        this.addAnnotation(de($({}, y), { comments: [g] })), this.pinAdapter.removeAnnotationPin("temporary-pin"), document.body.dispatchEvent(new CustomEvent("select-annotation", { detail: { uuid: y.uuid, haltGoToPin: true, newPin: true }, composed: true, bubbles: true }));
      } catch (h) {
        this.logger.log("error when creating annotation", h);
      }
    }), this.deleteAnnotation = (c) => he(this, [c], function* ({ detail: p }) {
      try {
        let { uuid: h } = p;
        yield Qe.deleteAnnotation(Q.get("apiUrl"), Q.get("apiKey"), h);
        let f = this.annotations.filter((m) => m.uuid !== h);
        this.updateAnnotationList(f), this.pinAdapter.removeAnnotationPin(h), this.element.updateAnnotations(this.annotations);
      } catch (h) {
        this.logger.log("error when deleting annotation", h);
      }
    }), this.updateComment = (c) => he(this, [c], function* ({ detail: p }) {
      try {
        let { uuid: h, text: f, mentions: m } = p, y = yield Qe.updateComment(Q.get("apiUrl"), Q.get("apiKey"), h, f);
        yield Qe.createMentions({ commentsId: y.uuid, participants: m.map((_) => ({ id: _.userId })) });
        let g = this.annotations.map((_) => Object.assign({}, _, { comments: _.comments.map((E) => E.uuid === h ? Object.assign({}, E, { text: f, mentions: m }) : E) }));
        this.updateAnnotationList(g);
      } catch (h) {
        this.logger.log("error when updating comment", h);
      }
    }), this.resolveAnnotation = (c) => he(this, [c], function* ({ detail: p }) {
      try {
        let { uuid: h } = p, { resolved: f } = yield Qe.resolveAnnotation(Q.get("apiUrl"), Q.get("apiKey"), h), m = this.annotations.map((y) => y.uuid === h ? Object.assign({}, y, { resolved: f }) : y);
        if (this.updateAnnotationList(m), f) {
          this.pinAdapter.removeAnnotationPin(h);
          return;
        }
        this.pinAdapter.updateAnnotations(this.annotations);
      } catch (h) {
        this.logger.log("error when resolve annotation", h);
      }
    }), this.deleteComment = (c) => he(this, [c], function* ({ detail: p }) {
      try {
        let { uuid: h, annotationId: f } = p;
        if (!h || !f) return;
        yield Qe.deleteComment(Q.get("apiUrl"), Q.get("apiKey"), h);
        let m = this.annotations.find((g) => g.uuid === f);
        m.comments = m.comments.filter((g) => g.uuid !== h);
        let y = this.annotations.map((g) => g.uuid === f ? m : g);
        this.element.updateAnnotations(y), this.updateAnnotationList(y);
      } catch (h) {
        this.logger.log("error when deleting comment", h);
      }
    }), this.onAnnotationListUpdate = (c) => {
      let { data: p, clientId: h } = c;
      this.localParticipantId !== h && (this.annotations = p, this.element.updateAnnotations(this.annotations), this.pinAdapter.updateAnnotations(this.annotations));
    }, this.name = "comments", this.logger = new qe("@superviz/sdk/comments-component"), this.annotations = [], this.layoutOptions = { buttonLocation: (i = t == null ? void 0 : t.buttonLocation) != null ? i : "top-left", position: (r = t == null ? void 0 : t.position) != null ? r : "left" }, this.hideDefaultButton = (o = t == null ? void 0 : t.hideDefaultButton) != null ? o : false, this.setStyles(t == null ? void 0 : t.styles), this.offset = t == null ? void 0 : t.offset, setTimeout(() => {
      var c, p;
      e.setCommentsMetadata((p = (c = this.layoutOptions) == null ? void 0 : c.position) != null ? p : "left");
    }), this.pinAdapter = e;
    let { group: a, localParticipant: u } = this.useStore("global-store");
    a.subscribe(), u.subscribe((c) => {
      this.localParticipantId = c.id;
    });
  }
  enable() {
    this.pinAdapter.setActive(true), this.pinActive = true, this.publish("pin-mode.active"), document.body.dispatchEvent(new CustomEvent("toggle-pin-active", { detail: { isActive: true } }));
  }
  disable() {
    this.pinAdapter.setActive(false), this.pinActive = false, this.publish("pin-mode.inactive"), document.body.dispatchEvent(new CustomEvent("toggle-pin-active", { detail: { isActive: false } }));
  }
  start() {
    typeof window < "u" && (this.clientUrl = window.location.href, this.positionComments(), this.hideDefaultButton || this.positionFloatingButton(), this.fetchAnnotations(), this.waterMarkState(), this.participantsList(), this.addListeners(), this.pinAdapter.setPinsVisibility(true));
  }
  destroy() {
    var e;
    this.logger.log("comments component @ destroy"), this.destroyListeners(), (e = this.button) == null || e.remove(), this.element.remove(), this.element = void 0, this.pinAdapter.destroy();
  }
  addListeners() {
    var e;
    (e = this.button) == null || e.addEventListener("toggle", this.togglePinActive), this.element.addEventListener("close-threads", this.closeThreads), document.body.addEventListener("create-annotation", this.createAnnotation), this.element.addEventListener("resolve-annotation", this.resolveAnnotation), this.element.addEventListener("delete-annotation", this.deleteAnnotation), this.element.addEventListener("create-comment", ({ detail: t }) => {
      this.createComment(t.uuid, t.text, t.mentions, true);
    }), this.element.addEventListener("update-comment", this.updateComment), this.element.addEventListener("delete-comment", this.deleteComment), document.body.addEventListener("select-annotation", this.onSelectAnnotation), this.room.on("update-comments", this.onAnnotationListUpdate), this.pinAdapter.onPinFixedObserver.subscribe(this.onPinFixed);
  }
  destroyListeners() {
    var e;
    (e = this.button) == null || e.removeEventListener("toggle", this.togglePinActive), this.element.removeEventListener("close-threads", this.closeThreads), this.element.removeEventListener("resolve-annotation", this.resolveAnnotation), this.element.removeEventListener("create-comment", ({ detail: t }) => {
      this.createComment(t.uuid, t.text, t.mentions, true);
    }), this.element.removeEventListener("update-comment", this.updateComment), this.element.removeEventListener("delete-comment", this.deleteComment), document.body.removeEventListener("select-annotation", this.onSelectAnnotation), document.body.removeEventListener("create-annotation", this.createAnnotation), this.room.off("update-comments", this.onAnnotationListUpdate), this.pinAdapter.onPinFixedObserver.unsubscribe(this.onPinFixed);
  }
  setStyles(e = "") {
    if (!e) return;
    let t = document.createElement("style");
    t.textContent = e, t.id = "superviz-comments-styles", document.head.appendChild(t);
  }
  createComment(e, t) {
    return he(this, arguments, function* (i, r, o = [], a = false) {
      try {
        let u = yield Qe.createComment(Q.get("apiUrl"), Q.get("apiKey"), { annotationId: i, userId: this.localParticipantId, text: r });
        return yield Qe.createMentions({ commentsId: u.uuid, participants: o.map((c) => ({ id: c.userId, readed: 0 })) }), u.mentions = o, a && this.addComment(i, u), u;
      } catch (u) {
        this.logger.log("error when creating comment", u);
      }
    });
  }
  addAnnotation(e) {
    let t = [e, ...this.annotations];
    this.element.updateAnnotations(t), this.pinAdapter.updateAnnotations(t), this.updateAnnotationList(t);
  }
  updateAnnotationList(e) {
    this.annotations = e, this.room.emit("update-comments", e);
  }
  addComment(e, t) {
    let i = this.annotations.find((o) => o.uuid === e);
    i.comments.push(t);
    let r = this.annotations.map((o) => o.uuid === e ? i : o);
    this.updateAnnotationList(r), this.element.updateAnnotations(r);
  }
  fetchAnnotations() {
    return he(this, null, function* () {
      try {
        let e = yield Qe.fetchAnnotation(Q.get("apiUrl"), Q.get("apiKey"), { roomId: Q.get("roomId") });
        this.annotations = e, this.element.updateAnnotations(this.annotations), this.pinAdapter.updateAnnotations(this.annotations);
      } catch (e) {
        this.logger.log("error when fetching annotations", e);
      }
    });
  }
  waterMarkState() {
    return he(this, null, function* () {
      try {
        let e = yield Qe.fetchWaterMark(Q.get("apiUrl"), Q.get("apiKey"));
        this.element.waterMarkStatus(e);
      } catch (e) {
        this.logger.log("error when fetching waterMark", e);
      }
    });
  }
  participantsList() {
    return he(this, null, function* () {
      try {
        let e = (yield Qe.fetchParticipantsByGroup(this.group.id)).data;
        this.pinAdapter.participantsList = e, this.element.participantsList = e;
      } catch (e) {
        this.logger.log("error when fetching participantsList", e);
      }
    });
  }
};
O();
var uA = class {
  constructor(e, t) {
    if (this.isPinsVisible = true, this.selectedPin = null, this.temporaryPinCoordinates = null, this.commentsSide = "left", this.setCommentsMetadata = (i) => {
      this.commentsSide = i;
    }, this.resetPins = (i) => {
      i && (i == null ? void 0 : i.key) !== "Escape" || (this.resetSelectedPin(), this.removeAnnotationPin("temporary-pin"), this.temporaryPinCoordinates = null);
    }, this.animate = () => {
      (this.isActive || this.isPinsVisible) && (this.renderAnnotationsPins(), this.divWrapper = this.renderDivWrapper()), this.temporaryPinCoordinates && this.renderTemporaryPin(), this.animateFrame = requestAnimationFrame(this.animate);
    }, this.setMouseDownCoordinates = ({ x: i, y: r }) => {
      this.mouseDownCoordinates = { x: i, y: r };
    }, this.annotationSelected = ({ detail: { uuid: i, haltGoToPin: r, newPin: o } }) => {
      var a, u;
      if (!i) return;
      o && this.pins.get(i).setAttribute("newPin", "");
      let c = JSON.parse((u = (a = this.selectedPin) == null ? void 0 : a.getAttribute("annotation")) != null ? u : "{}");
      if (this.resetPins(), (c == null ? void 0 : c.uuid) === i) return;
      document.body.dispatchEvent(new CustomEvent("close-temporary-annotation"));
      let p = this.pins.get(i);
      p && (p.setAttribute("active", ""), this.selectedPin = p, !r && this.goToPin(i));
    }, this.onClick = (i) => {
      if (!this.isActive) return;
      let r = this.canvas.getBoundingClientRect(), { x: o, y: a } = this.mouseDownCoordinates, u = o - r.x, c = a - r.y, p = i.clientX - r.left, h = i.clientY - r.top;
      if (Math.hypot(p - u, h - c) > 10) return;
      let f = this.canvas.getContext("2d").getTransform().inverse(), m = new DOMPoint(p, h - 31).matrixTransform(f);
      this.onPinFixedObserver.publish({ x: m.x, y: m.y, type: "canvas" }), this.resetSelectedPin(), this.temporaryPinCoordinates = { x: m.x, y: m.y }, this.renderTemporaryPin();
      let y = document.getElementById("superviz-temporary-pin");
      this.movedTemporaryPin = !this.movedTemporaryPin, y.setAttribute("movedPosition", String(this.movedTemporaryPin)), !this.selectedPin && document.body.dispatchEvent(new CustomEvent("unselect-annotation"));
    }, this.onToggleAnnotationSidebar = ({ detail: i }) => {
      let { open: r } = i;
      r || (this.pins.forEach((o) => {
        o.removeAttribute("active");
      }), this.pins.has("temporary-pin") && this.removeAnnotationPin("temporary-pin"));
    }, this.hideTemporaryPin = (i) => {
      var r;
      let o = i.target, a = o.contains(this.canvas), { x: u, y: c } = i, { left: p, top: h, right: f, bottom: m } = this.canvas.getBoundingClientRect(), y = u > p && u < f && c > h && c < m;
      this.canvas.contains(o) || (r = this.pins.get("temporary-pin")) != null && r.contains(o) || a && y || (this.removeAnnotationPin("temporary-pin"), this.temporaryPinCoordinates = null);
    }, this.logger = new qe("@superviz/sdk/comments-component/canvas-pin-adapter"), this.canvas = document.getElementById(e), this.isActive = false, this.pins = /* @__PURE__ */ new Map(), this.goToPinCallback = t == null ? void 0 : t.onGoToPin, !this.canvas) {
      let i = `Canvas with id ${e} not found`;
      throw this.logger.log(i), new Error(i);
    }
    this.canvasSides = this.canvas.getBoundingClientRect(), document.body.style.position = "relative", this.onPinFixedObserver = new $e({ logger: this.logger }), this.divWrapper = this.renderDivWrapper(), this.annotations = [], this.renderAnnotationsPins(), this.animateFrame = requestAnimationFrame(this.animate), document.body.addEventListener("select-annotation", this.annotationSelected), document.body.addEventListener("keyup", this.resetPins);
  }
  destroy() {
    this.isActive = false, this.removeListeners(), this.removeAnnotationsPins(), this.pins = /* @__PURE__ */ new Map(), this.divWrapper.remove(), this.divWrapper = null, this.onPinFixedObserver.destroy(), this.onPinFixedObserver = null, this.canvas.style.cursor = "default", this.annotations = [], cancelAnimationFrame(this.animateFrame), document.body.removeEventListener("select-annotation", this.annotationSelected), document.body.removeEventListener("keyup", this.resetPins);
  }
  setPinsVisibility(e) {
    if (this.isPinsVisible = e, this.isPinsVisible) {
      this.renderAnnotationsPins();
      return;
    }
    this.removeAnnotationsPins();
  }
  setActive(e) {
    if (this.isActive !== e) {
      if (this.isActive = e, this.isActive) {
        this.originalCanvasCursor = this.canvas.style.cursor, this.canvas.style.cursor = 'url("https://production.cdn.superviz.com/static/pin-html.png") 0 100, pointer', this.addListeners();
        return;
      }
      this.resetPins(), this.removeListeners(), this.canvas.style.cursor = this.originalCanvasCursor;
    }
  }
  updateAnnotations(e) {
    this.logger.log("updateAnnotations", e), this.annotations = e, !(!this.isActive && !this.isPinsVisible) && (this.removeAnnotationsPins(), this.renderAnnotationsPins());
  }
  removeAnnotationPin(e) {
    let t = this.pins.get(e);
    t && (t.remove(), this.pins.delete(e), e !== "temporary-pin" && (this.annotations = this.annotations.filter((i) => i.uuid !== e)));
  }
  renderTemporaryPin() {
    let e = document.getElementById("superviz-temporary-pin");
    e || (e = document.createElement("superviz-comments-annotation-pin"), e.id = "superviz-temporary-pin", e.setAttribute("type", "add"), e.setAttribute("showInput", ""), e.setAttribute("containerSides", JSON.stringify(this.canvasSides)), e.setAttribute("commentsSide", this.commentsSide), e.setAttribute("position", JSON.stringify(this.temporaryPinCoordinates)), e.setAttribute("annotation", JSON.stringify({})), e.setAttribute("participantsList", JSON.stringify(this.participants)), e.setAttributeNode(document.createAttribute("active")), this.divWrapper.appendChild(e));
    let { x: t, y: i } = this.temporaryPinCoordinates, r = this.canvas.getContext("2d").getTransform(), o = r.e, a = r.f, u = r.a, c = r.d, p = t * u + o, h = i * c + a;
    e.setAttribute("position", JSON.stringify({ x: p, y: h })), this.pins.set("temporary-pin", e);
  }
  addListeners() {
    this.canvas.addEventListener("click", this.onClick), this.canvas.addEventListener("mousedown", this.setMouseDownCoordinates), document.body.addEventListener("toggle-annotation-sidebar", this.onToggleAnnotationSidebar), document.body.addEventListener("click", this.hideTemporaryPin);
  }
  removeListeners() {
    this.canvas.removeEventListener("click", this.onClick), this.canvas.removeEventListener("mousedown", this.setMouseDownCoordinates), document.body.removeEventListener("toggle-annotation-sidebar", this.onToggleAnnotationSidebar), document.body.addEventListener("click", this.hideTemporaryPin);
  }
  resetSelectedPin() {
    this.selectedPin && (this.selectedPin.removeAttribute("active"), this.selectedPin = null);
  }
  renderDivWrapper() {
    let e = this.canvas.getBoundingClientRect(), t = this.divWrapper;
    return t || (t = document.createElement("div"), t.id = "superviz-canvas-wrapper", ["", "static"].includes(this.canvas.parentElement.style.position) && (this.canvas.parentElement.style.position = "relative")), t.style.position = "absolute", t.style.top = `${this.canvas.offsetTop}px`, t.style.left = `${this.canvas.offsetLeft}px`, t.style.width = `${e.width}px`, t.style.height = `${e.height}px`, t.style.pointerEvents = "none", t.style.overflow = "hidden", document.getElementById("superviz-canvas-wrapper") || this.canvas.parentElement.appendChild(t), t;
  }
  renderAnnotationsPins() {
    if ((!this.annotations.length || this.canvas.style.display === "none") && !this.pins.get("temporary-pin")) {
      this.removeAnnotationsPins();
      return;
    }
    this.annotations.forEach((e) => {
      if (e.resolved) return;
      let t = JSON.parse(e.position);
      if ((t == null ? void 0 : t.type) !== "canvas") return;
      let { x: i, y: r } = t, o = this.canvas.getContext("2d").getTransform(), a = o.e, u = o.f, c = o.a, p = o.d, h = i * c + a, f = r * p + u;
      if (this.pins.has(e.uuid)) {
        let y = this.pins.get(e.uuid);
        if (this.divWrapper.clientWidth > h && this.divWrapper.clientHeight > f) {
          y.setAttribute("style", "opacity: 1"), this.pins.get(e.uuid).setAttribute("position", JSON.stringify({ x: h, y: f }));
          return;
        }
        y.setAttribute("style", "opacity: 0");
        return;
      }
      let m = document.createElement("superviz-comments-annotation-pin");
      m.setAttribute("type", "show"), m.setAttribute("participantsList", JSON.stringify(this.participants)), m.setAttribute("annotation", JSON.stringify(e)), m.setAttribute("position", JSON.stringify({ x: h, y: f })), m.id = e.uuid, this.divWrapper.appendChild(m), this.pins.set(e.uuid, m);
    });
  }
  removeAnnotationsPins() {
    this.pins.forEach((e) => {
      e.remove();
    }), this.pins.clear();
  }
  set participantsList(e) {
    this.participants = e;
  }
  goToPin(e) {
    let t = this.annotations.find((y) => y.uuid === e);
    if (!t) return;
    let i = JSON.parse(t.position);
    if ((i == null ? void 0 : i.type) !== "canvas") return;
    let r = this.canvas.getBoundingClientRect(), { width: o, height: a } = r, { x: u, y: c } = i, p = o / 2, h = a / 2, f = p - u, m = h - c;
    this.goToPinCallback && this.goToPinCallback({ x: f, y: m });
  }
};
O();
var cA = zt(wn());
var hA = class {
  constructor(e, t = {}) {
    if (this.isPinsVisible = true, this.selectedPin = null, this.dataAttribute = "data-superviz-id", this.commentsSide = "left", this.temporaryPinCoordinates = {}, this.elementsWithDataId = {}, this.divWrappers = /* @__PURE__ */ new Map(), this.voidElementsWrappers = /* @__PURE__ */ new Map(), this.VOID_ELEMENTS = ["area", "base", "br", "col", "embed", "hr", "img", "input", "link", "meta", "param", "source", "track", "wbr", "svg", "rect", "ellipse"], this.animate = () => {
      this.voidElementsWrappers && (this.updatePinsPositions(), this.animateFrame = requestAnimationFrame(this.animate));
    }, this.setCommentsMetadata = (o) => {
      this.commentsSide = o;
    }, this.hideTemporaryPin = (o) => {
      var a;
      let u = o.target, c = this.divWrappers.get(this.temporaryPinCoordinates.elementId);
      if (!c) return;
      let p = c.contains(u), h = (a = this.pins.get("temporary-pin")) == null ? void 0 : a.contains(u);
      p || h || (this.removeAnnotationPin("temporary-pin"), this.temporaryPinCoordinates = {});
    }, this.resetPins = (o) => {
      o && (o == null ? void 0 : o.key) !== "Escape" || (this.resetSelectedPin(), this.resetHoveredWrapper(), this.temporaryPinCoordinates.elementId && (this.removeAnnotationPin("temporary-pin"), this.temporaryPinCoordinates = {}));
    }, this.annotationSelected = ({ detail: { uuid: o, newPin: a } }) => {
      if (!o) return;
      a && this.pins.get(o).setAttribute("newPin", "");
      let u = this.annotations.find((h) => {
        var f;
        return h.uuid === ((f = this.selectedPin) == null ? void 0 : f.id);
      });
      if (this.resetPins(), (u == null ? void 0 : u.uuid) === o) return;
      document.body.dispatchEvent(new CustomEvent("close-temporary-annotation"));
      let c = this.pins.get(o);
      if (!c) return;
      c.setAttribute("active", ""), this.selectedPin = c;
      let p = this.annotations.find((h) => h.uuid === o);
      this.selectedPin.setAttribute("elementId", JSON.parse(p.position).elementId);
    }, this.onClick = (o) => {
      if (!this.isActive || o.target === this.pins.get("temporary-pin")) return;
      let a = o.target, u = o.currentTarget;
      if (a !== u && this.pins.has(a.id)) return;
      let c = u.getAttribute("data-wrapper-id"), p = u.getBoundingClientRect(), { x: h, y: f } = this.mouseDownCoordinates, m = o.clientX - p.left, y = o.clientY - p.top, g = h - p.x, _ = f - p.y;
      if (Math.hypot(m - g, y - _) > 10) return;
      let { width: E, height: R } = u.getBoundingClientRect(), N = 32, j = u.getBoundingClientRect().width / u.offsetWidth || 1;
      m = m * 100 / E, y = (y - N * j) * 100 / R, this.onPinFixedObserver.publish({ x: m, y, type: "html", elementId: c }), this.resetSelectedPin(), this.temporaryPinCoordinates = de($({}, this.temporaryPinCoordinates), { x: m, y }), this.renderTemporaryPin(c);
      let B = this.pins.get("temporary-pin");
      this.movedTemporaryPin = !this.movedTemporaryPin, B.setAttribute("movedPosition", String(this.movedTemporaryPin)), document.body.dispatchEvent(new CustomEvent("unselect-annotation"));
    }, this.onMouseDown = ({ x: o, y: a }) => {
      this.mouseDownCoordinates = { x: o, y: a };
    }, this.handleMutationObserverChanges = (o) => {
      o.forEach((a) => {
        var u;
        let { target: c, oldValue: p } = a, h = c.getAttribute(this.dataAttribute);
        if (!h && !p || h === p) return;
        let f = this.dataAttributeValueFilters.some((y) => p.match(y));
        if (!h && p && !f) {
          this.removeAnnotationPin("temporary-pin"), this.clearElement(p), ((u = this.selectedPin) == null ? void 0 : u.getAttribute("elementId")) === p && (document.body.dispatchEvent(new CustomEvent("unselect-annotation")), this.selectedPin = null);
          return;
        }
        let m = this.dataAttributeValueFilters.some((y) => h.match(y));
        (p && this.elementsWithDataId[p] || m) && this.clearElement(p), !m && (this.setElementReadyToPin(c, h), this.renderAnnotationsPins());
      });
    }, this.onToggleAnnotationSidebar = ({ detail: o }) => {
      let { open: a } = o;
      a || (this.resetSelectedPin(), this.pins.has("temporary-pin") && (this.removeAnnotationPin("temporary-pin"), this.temporaryPinCoordinates.elementId = void 0));
    }, this.onMouseEnter = (o) => {
      var a;
      let u = o.target;
      if (this.hoveredWrapper = u, !((a = u.getAttribute("data-wrapper-type")) != null && a.includes("ellipse"))) {
        this.hoveredWrapper.style.setProperty("outline", "1px solid rgb(var(--sv-primary))");
        return;
      }
      let c = u.querySelector("ellipse");
      c.setAttribute("stroke", "rgb(var(--sv-primary))"), c.setAttribute("stroke-width", "1");
    }, this.onMouseLeave = (o) => {
      var a;
      let u = o.target;
      if (this.hoveredWrapper = u, !((a = u.getAttribute("data-wrapper-type")) != null && a.includes("ellipse"))) {
        this.hoveredWrapper.style.setProperty("outline", "");
        return;
      }
      let c = u.querySelector("ellipse");
      c.removeAttribute("stroke"), c.removeAttribute("stroke-width");
    }, this.logger = new qe("@superviz/sdk/comments-component/container-pin-adapter"), this.container = document.getElementById(e), !this.container) {
      let o = `Element with id ${e} not found`;
      throw this.logger.log(o), new Error(o);
    }
    if (typeof t != "object") throw new Error("Second argument of the HTMLPin constructor must be an object");
    let { dataAttributeName: i, dataAttributeValueFilters: r } = t;
    if (i === "") throw new Error("dataAttributeName must be a non-empty string");
    if (i === null) throw new Error("dataAttributeName cannot be null");
    if (i !== void 0 && typeof i != "string") throw new Error("dataAttributeName must be a non-empty string");
    this.dataAttribute = i || this.dataAttribute, this.dataAttributeValueFilters = r || [], this.isActive = false, this.prepareElements(), this.mutationObserver = new MutationObserver(this.handleMutationObserverChanges), this.observeContainer(), this.pins = /* @__PURE__ */ new Map(), this.onPinFixedObserver = new $e({ logger: this.logger }), this.annotations = [], document.body.addEventListener("select-annotation", this.annotationSelected), document.body.addEventListener("keyup", this.resetPins), this.voidElementsWrappers.size && (this.animateFrame = requestAnimationFrame(this.animate));
  }
  destroy() {
    var e;
    this.logger.log("Destroying HTML Pin Adapter for Comments"), this.removeListeners(), this.removeObservers(), this.divWrappers.forEach((t) => t.remove()), this.divWrappers.clear(), this.pins.forEach((t) => t.remove()), this.pins.clear(), this.divWrappers = void 0, this.pins = void 0, this.elementsWithDataId = void 0, this.logger = void 0, this.onPinFixedObserver.destroy(), this.onPinFixedObserver = void 0, this.container = void 0, this.voidElementsWrappers.clear(), this.voidElementsWrappers = void 0, this.annotations = [], (e = this.svgWrappers) == null || e.remove(), this.svgWrappers = void 0, document.body.removeEventListener("select-annotation", this.annotationSelected), document.body.removeEventListener("toggle-annotation-sidebar", this.onToggleAnnotationSidebar), cancelAnimationFrame(this.animateFrame);
  }
  addElementListeners(e) {
    this.divWrappers.get(e).addEventListener("click", this.onClick, true), this.divWrappers.get(e).addEventListener("mousedown", this.onMouseDown), this.divWrappers.get(e).addEventListener("mouseenter", this.onMouseEnter), this.divWrappers.get(e).addEventListener("mouseleave", this.onMouseLeave);
  }
  removeElementListeners(e) {
    this.divWrappers.get(e).removeEventListener("click", this.onClick, true), this.divWrappers.get(e).removeEventListener("mousedown", this.onMouseDown), this.divWrappers.get(e).removeEventListener("mouseenter", this.onMouseEnter), this.divWrappers.get(e).removeEventListener("mouseleave", this.onMouseLeave);
  }
  set participantsList(e) {
    this.participants = e;
  }
  removeObservers() {
    this.mutationObserver.disconnect(), this.mutationObserver = void 0;
  }
  addListeners() {
    this.divWrappers.forEach((e, t) => this.addElementListeners(t)), document.body.addEventListener("toggle-annotation-sidebar", this.onToggleAnnotationSidebar), document.body.addEventListener("click", this.hideTemporaryPin);
  }
  removeListeners() {
    this.divWrappers.forEach((e, t) => this.removeElementListeners(t)), document.body.removeEventListener("keyup", this.resetPins), document.body.removeEventListener("click", this.hideTemporaryPin);
  }
  observeContainer() {
    this.mutationObserver.observe(this.container, { subtree: true, attributes: true, attributeFilter: [this.dataAttribute], attributeOldValue: true });
  }
  prepareElements() {
    this.container.querySelectorAll(`[${this.dataAttribute}]`).forEach((e) => {
      let t = e.getAttribute(this.dataAttribute);
      this.dataAttributeValueFilters.some((i) => t.match(i)) || this.setElementReadyToPin(e, t);
    });
  }
  addAllCursors() {
    this.divWrappers.forEach((e, t) => {
      this.addCursor(e, t);
    });
  }
  removeAddCursor() {
    this.divWrappers.forEach((e, t) => {
      let i = e, r = e.getAttribute("data-wrapper-type");
      if (r) {
        let o = r.split("-")[1];
        i = this.divWrappers.get(t).querySelector(o);
      }
      i.style.setProperty("cursor", "default"), i.style.setProperty("pointer-events", "none");
    });
  }
  setPinsVisibility(e) {
    this.isPinsVisible = e, this.isPinsVisible && this.renderAnnotationsPins(), this.removeAnnotationsPins();
  }
  removeAnnotationPin(e) {
    let t = this.pins.get(e);
    !t && e === "temporary-pin" || (t && (t.remove(), this.pins.delete(e)), e !== "temporary-pin" && (this.annotations = this.annotations.filter((i) => i.uuid !== e)));
  }
  updateAnnotations(e) {
    this.logger.log("updateAnnotations", e), this.annotations = e, this.isPinsVisible && (this.removeAnnotationsPins(), this.renderAnnotationsPins());
  }
  setActive(e) {
    if (this.isActive !== e) {
      if (this.isActive = e, this.isActive) {
        this.addListeners(), this.addAllCursors(), this.prepareElements();
        return;
      }
      this.resetPins(), this.removeListeners(), this.removeAddCursor();
    }
  }
  renderTemporaryPin(e) {
    var t, i;
    (t = this.temporaryPinCoordinates).elementId || (t.elementId = e);
    let r = this.pins.get("temporary-pin");
    if (e && e !== this.temporaryPinCoordinates.elementId && (this.pins.get("temporary-pin").remove(), this.pins.delete("temporary-pin"), this.temporaryPinCoordinates.elementId = e, r = null), !r) {
      let u = (i = this.elementsWithDataId[e]) == null ? void 0 : i.getBoundingClientRect();
      r = document.createElement("superviz-comments-annotation-pin"), r.id = "superviz-temporary-pin", r.setAttribute("type", "add"), r.setAttribute("showInput", ""), r.setAttribute("containerSides", JSON.stringify(u)), r.setAttribute("commentsSide", this.commentsSide), r.setAttribute("position", JSON.stringify(this.temporaryPinCoordinates)), r.setAttribute("annotation", JSON.stringify({})), r.setAttribute("participantsList", JSON.stringify(this.participants)), r.setAttribute("keepPositionRatio", ""), r.setAttributeNode(document.createAttribute("active")), this.addTemporaryPinToElement(e, r);
    }
    let { x: o, y: a } = this.temporaryPinCoordinates;
    r.setAttribute("position", JSON.stringify({ x: o, y: a })), this.pins.set("temporary-pin", r);
  }
  renderAnnotationsPins() {
    if (!this.annotations.length) {
      this.removeAnnotationsPins();
      return;
    }
    this.annotations.forEach((e) => {
      if (e.resolved) return;
      let { x: t, y: i, elementId: r, type: o } = JSON.parse(e.position);
      if (o !== "html" || this.pins.has(e.uuid) || !this.elementsWithDataId[r]) return;
      let a = this.divWrappers.get(r);
      if (!a) return;
      let u = this.createPin(e, t, i);
      a.appendChild(u), this.pins.set(e.uuid, u);
    });
  }
  updatePinsPositions() {
    this.voidElementsWrappers.forEach((e, t) => {
      let i = JSON.stringify(e.getBoundingClientRect()), r = this.elementsWithDataId[t].getBoundingClientRect();
      this.elementsWithDataId[t].tagName.toLowerCase() === "ellipse" && (r = this.elementsWithDataId[t].viewportElement.getBoundingClientRect()), !(0, cA.isEqual)(JSON.stringify(r), i) && (e.style.setProperty("top", `${r.top}px`), e.style.setProperty("left", `${r.left}px`), e.style.setProperty("width", `${r.width}px`), e.style.setProperty("height", `${r.height}px`));
    });
  }
  clearElement(e) {
    if (!this.elementsWithDataId[e]) return;
    let t = this.divWrappers.get(e);
    if (t) {
      let i = t.children, { length: r } = i;
      for (let o = 0; o < r; ++o) {
        let a = i.item(o);
        this.pins.delete(a.id);
      }
      t.remove();
    }
    this.voidElementsWrappers.delete(e), this.removeElementListeners(e), this.divWrappers.delete(e), this.elementsWithDataId[e] = void 0, this.voidElementsWrappers.size || (cancelAnimationFrame(this.animateFrame), this.animateFrame = void 0);
  }
  resetSelectedPin() {
    this.selectedPin && (this.selectedPin.removeAttribute("active"), this.selectedPin = null);
  }
  resetHoveredWrapper() {
    this.hoveredWrapper && this.onMouseLeave({ target: this.hoveredWrapper });
  }
  removeAnnotationsPins() {
    this.pins.forEach((e) => {
      e.remove();
    }), this.pins.clear();
  }
  setElementReadyToPin(e, t) {
    if (!this.elementsWithDataId[t]) {
      if (this.elementsWithDataId[t] = e, !this.divWrappers.get(t)) {
        let i = this.createWrapper(e, t);
        this.divWrappers.set(t, i);
      }
      !this.isActive || !this.isPinsVisible || (this.addCursor(this.divWrappers.get(t), t), this.addElementListeners(t));
    }
  }
  handleSvgElement(e, t) {
    let i = e.viewportElement;
    if (i === void 0) return;
    if (e.tagName.toLowerCase() === "svg") {
      let y = document.createElementNS("http://www.w3.org/2000/svg", "foreignObject");
      return y.setAttribute("height", "100%"), y.setAttribute("width", "100%"), y.style.setProperty("overflow", "visible"), y.appendChild(t), e.appendChild(y), e.style.setProperty("overflow", "visible"), t;
    }
    let r = e.tagName.toLowerCase(), o = r === "ellipse", a = r === "rect";
    if (!o && !a) return;
    let u = document.createElementNS("http://www.w3.org/2000/svg", "svg"), c = document.createElementNS("http://www.w3.org/2000/svg", r), p, h, f, m;
    if (a) {
      let y = e;
      y.getAttribute("x"), y.getAttribute("y"), p = y.getAttribute("width"), h = y.getAttribute("height"), f = y.getAttribute("rx"), m = y.getAttribute("ry"), c.setAttribute("fill", "transparent"), c.setAttribute("stroke", "transparent"), c.setAttribute("x", "0"), c.setAttribute("y", "0"), c.setAttribute("rx", f), c.setAttribute("ry", m);
    }
    if (o) {
      let y = e.getAttribute("cx"), g = e.getAttribute("cy");
      f = e.getAttribute("rx"), m = e.getAttribute("ry");
      let { width: _, height: E } = i.getBoundingClientRect();
      p = `${_}px`, h = `${E}px`, c.setAttribute("fill", "transparent"), c.setAttribute("stroke", "transparent"), c.setAttribute("cx", y), c.setAttribute("cy", g), c.setAttribute("rx", f), c.setAttribute("ry", m);
    }
    return c.setAttribute("height", h), c.setAttribute("width", p), u.setAttribute("height", h), u.setAttribute("width", p), u.appendChild(c), t.appendChild(u), e.style.setProperty("overflow", "visible"), t.setAttribute("data-wrapper-type", `svg-${r}`), t;
  }
  addTemporaryPinToElement(e, t) {
    if (!this.elementsWithDataId[e]) return;
    let i = this.divWrappers.get(e);
    i && i.appendChild(t);
  }
  createPin(e, t, i) {
    let r = document.createElement("superviz-comments-annotation-pin");
    return r.setAttribute("type", "show"), r.setAttribute("annotation", JSON.stringify(e)), r.setAttribute("position", JSON.stringify({ x: t, y: i })), r.setAttribute("keepPositionRatio", ""), r.setAttribute("participantsList", JSON.stringify(this.participants)), r.id = e.uuid, r;
  }
  addCursor(e, t) {
    let i = e, r = e.getAttribute("data-wrapper-type");
    if (r) {
      let o = r.split("-")[1];
      i = this.divWrappers.get(t).querySelector(o);
    }
    i.style.setProperty("cursor", 'url("https://production.cdn.superviz.com/static/pin-html.png") 0 100, pointer'), i.style.setProperty("pointer-events", "auto");
  }
  createWrapper(e, t) {
    var i;
    let r = `superviz-id-${t}`;
    if (this.divWrappers.get(t)) return;
    let o = e.getBoundingClientRect(), a = document.createElement("div");
    a.setAttribute("data-wrapper-id", t), a.id = r, a.style.position = "absolute", a.style.pointerEvents = "none", a.style.transform = "translateX(0) translateY(0) scale(1)", a.style.cursor = "default", a.style.top = "0", a.style.left = "0", a.style.width = "100%", a.style.height = "100%", a.style.pointerEvents = "none";
    let u = window.getComputedStyle(e).getPropertyValue("border-radius");
    if (a.style.borderRadius = u, !this.VOID_ELEMENTS.includes(this.elementsWithDataId[t].tagName.toLowerCase())) return this.elementsWithDataId[t].appendChild(a), this.setPositionNotStatic(this.elementsWithDataId[t]), a;
    a = (i = this.handleSvgElement(e, a)) != null ? i : a, a.style.position = "fixed", a.style.top = `${o.top}px`, a.style.left = `${o.left}px`, a.style.width = `${o.width}px`, a.style.height = `${o.height}px`;
    let c = this.elementsWithDataId[t].parentElement;
    return (!c || e.viewportElement) && (c = document.body), this.setPositionNotStatic(c), c.appendChild(a), this.voidElementsWrappers.set(t, a), this.animateFrame || (this.animateFrame = requestAnimationFrame(this.animate)), a;
  }
  setPositionNotStatic(e) {
    let { position: t } = window.getComputedStyle(e);
    t === "static" && e.style.setProperty("position", "relative");
  }
};
O();
O();
var ui = zt(yC());
var dA = class {
  constructor() {
    this.browser = ui.default.getParser(navigator.userAgent);
  }
  get clientStats() {
    return this.browser.getResult();
  }
  get isFirefox() {
    return this.browser.isBrowser(ui.default.BROWSER_MAP.firefox);
  }
  get isSafari() {
    return this.browser.isBrowser(ui.default.BROWSER_MAP.safari);
  }
  get isChrome() {
    return this.browser.isBrowser(ui.default.BROWSER_MAP.chrome);
  }
  get isIE() {
    return this.browser.isBrowser(ui.default.BROWSER_MAP.ie);
  }
  get isEdge() {
    return this.browser.isBrowser(ui.default.BROWSER_MAP.edge);
  }
  get isMobileDevice() {
    return (this.browser.is(ui.default.PLATFORMS_MAP.mobile) || this.browser.is(ui.default.PLATFORMS_MAP.tablet)) && !navigator.userAgent.match(/iPad/i);
  }
  get isTabletDevice() {
    return this.browser.is(ui.default.PLATFORMS_MAP.tablet);
  }
  get isAndroid() {
    return this.isMobileDevice && !!navigator.userAgent.match(/Android/i);
  }
  get isIpad() {
    return !!navigator.userAgent.match(/iPad/i);
  }
  get isIphone() {
    return this.isMobileDevice && !!navigator.userAgent.match(/iPhone/i);
  }
  get isAppleMobileDevice() {
    return this.isIpad || this.isIphone;
  }
};
O();
var pA = class {
  constructor() {
    this.updateMeetingConnectionStatus = (e) => {
      this.oldConnectionStatus = this.connectionStatus, this.connectionStatus = e, this.connectionStatusObserver.publish(e), this.logger.log("CONNECTION STATUS CHANGE", e);
    }, this.onUpdateBrowserOnlineStatus = (e) => {
      let { type: t } = e;
      if (t === "online") {
        this.updateMeetingConnectionStatus(1);
        return;
      }
      this.updateMeetingConnectionStatus(4);
    }, this.logger = new qe("@superviz/sdk/connection-service"), this.connectionStatus = 0, this.connectionStatusObserver = new $e({ logger: this.logger });
  }
  addListeners() {
    typeof window < "u" && (window.addEventListener("online", this.onUpdateBrowserOnlineStatus), window.addEventListener("offline", this.onUpdateBrowserOnlineStatus));
  }
  removeListeners() {
    typeof window < "u" && (window.removeEventListener("online", this.onUpdateBrowserOnlineStatus), window.removeEventListener("offline", this.onUpdateBrowserOnlineStatus));
  }
};
O();
O();
var fA = class {
  constructor(e, t, i) {
    this.myParticipant = {}, this.localRoomProperties = null, this.drawingData = null, this.state = 0, this.MESSAGE_SIZE_LIMIT = 6e4, this.useStore = st.bind(this), this.join = () => {
      this.room.presence.on(ee.LEAVE, this.onParticipantLeave), this.room.presence.on(ee.JOINED_ROOM, this.onPresenceEnter), this.enableSync && (this.room.on("update", this.updateLocalRoomState), this.drawingRoom.presence.on(ee.UPDATE, this.updateDrawing));
    }, this.updateMyProperties = (a) => {
      let u = a ?? {};
      this.isMessageTooBig(u) || this.left || !this.enableSync || this.isSyncFrozen || (u.avatar === void 0 && delete u.avatar, this.myParticipant = $($({}, this.myParticipant), u), this.room.presence.update(this.myParticipant), this.logger.log("REALTIME", "updating my properties", this.myParticipant));
    }, this.isMessageTooBig = (a, u = this.MESSAGE_SIZE_LIMIT) => {
      let c = JSON.stringify(a);
      return new TextEncoder().encode(c).length > u ? (this.logger.log("Message too long, the message limit size is 60kb."), true) : false;
    }, this.updateRoomProperties = (a) => {
      if (this.isMessageTooBig(a) || this.isSyncFrozen || this.left) return;
      let u = $($({}, this.localRoomProperties), a);
      this.localRoomProperties = u, this.room.emit("update", u);
    }, this.updateDrawingProperties = (a) => {
      this.isMessageTooBig(a) || this.isSyncFrozen || this.left || (this.drawingData = $($({}, this.drawingData), a), this.drawingRoom.presence.update(this.drawingData));
    }, this.setHost = (a) => {
      this.updateRoomProperties({ hostClientId: a });
    }, this.setKickParticipant = (a) => {
      if (!a) return;
      let { participants: u } = st("global-store"), c = u.value[a];
      this.updateRoomProperties({ kickParticipant: c });
    }, this.initializeRoomProperties = () => {
      let a = { isGridModeEnabled: false, hostClientId: null, followParticipantId: null, gather: false, transcript: "transcript.stop", kickParticipant: null };
      this.localRoomProperties = a, this.updateRoomProperties(a);
    }, this.onParticipantLeave = (a) => {
      var u;
      a.id === this.myParticipant.id && (this.left = true), a.id === ((u = this.localRoomProperties) == null ? void 0 : u.followParticipantId) && this.setFollowParticipant();
    }, this.start = () => he(this, null, function* () {
      this.started || (this.started = true, this.room.isJoined || (this.logger.log("room state service - not joined room yet"), setTimeout(() => {
        this.logger.log("room state service - retrying"), this.start();
      }, 2e3)), this.localRoomProperties = yield this.fetchRoomProperties(), this.localRoomProperties ? this.updateLocalRoomState({ data: this.localRoomProperties }) : this.initializeRoomProperties(), this.publishStateUpdate(4), this.logger.log("REALTIME", "Joined realtime room"));
    }), this.onPresenceEnter = () => {
      this.updateMyProperties();
    }, this.updateLocalRoomState = (a) => he(this, [a], function* ({ data: u }) {
      this.logger.log("REALTIME", "Room update received", u), this.localRoomProperties = Object.assign({}, this.localRoomProperties, u);
      let { followParticipantId: c, gather: p, hostId: h, isGridModeEnabled: f, transcript: m } = this.useStore("video-store");
      c.publish(u.followParticipantId), p.publish(u.gather), h.publish(u.hostClientId), f.publish(u.isGridModeEnabled), m.publish(u.transcript), u.kickParticipant && u.kickParticipant.id === this.myParticipant.id && (this.updateRoomProperties({ kickParticipant: null }), this.kickParticipantObserver.publish(this.myParticipant.id));
    }), this.updateDrawing = (a) => {
      if (a.id === this.myParticipant.id) return;
      let { drawing: u } = this.useStore("video-store");
      u.publish(a.data);
    }, this.freezeSync = (a) => {
      if (this.isSyncFrozen = a, a) {
        this.destroy();
        return;
      }
      this.join();
    }, this.room = e, this.drawingRoom = t, this.logger = i, this.kickParticipantObserver = new $e({ logger: this.logger });
    let { localParticipant: r, participants: o } = this.useStore("global-store");
    r.subscribe((a) => {
      this.enableSync = a.type !== "audience", this.myParticipant = $($({}, this.myParticipant), a);
    }), o.subscribe(), this.join();
  }
  setGridMode(e) {
    this.updateRoomProperties({ isGridModeEnabled: e });
  }
  setDrawing(e) {
    this.updateDrawingProperties(e);
  }
  setTranscript(e) {
    this.updateRoomProperties({ transcript: e });
  }
  fetchRoomProperties() {
    return he(this, null, function* () {
      if ((yield new Promise((r) => {
        this.room.presence.get((o) => {
          o || r(0), r(o.length);
        });
      })) <= 1) return null;
      let e = yield new Promise((r, o) => {
        this.room.history((a) => {
          a || o(a), a.events.length || r(null);
          let u = a.events.pop();
          r(u);
        });
      }), t = 1e3 * 60 * 60, i = (e == null ? void 0 : e.timestamp) < Date.now() - t;
      return !(e != null && e.data) || i ? null : e.data;
    });
  }
  publishStateUpdate(e) {
    if (this.state === e) return;
    this.state = e, this.logger.log("REALTIME", `Realtime state did change. New state: ${cd[this.state]}`);
    let { meetingState: t } = this.useStore("video-store");
    t.publish(this.state);
  }
  setFollowParticipant(e) {
    this.updateRoomProperties({ followParticipantId: e });
  }
  setGather(e) {
    this.updateRoomProperties({ gather: e });
  }
  destroy() {
    this.room.presence.off(ee.LEAVE), this.room.presence.off(ee.JOINED_ROOM), this.drawingRoom.presence.off(ee.UPDATE), this.room.off("update", this.updateLocalRoomState);
  }
};
O();
O();
var mA = class {
  build(e, t, i, r = {}, o = {}) {
    let a = document.querySelector(`#${e}`), u = new URL(t);
    if (this.wrapperId || this.element) throw new Error("Tried to initialize two frames with the same FrameBricklayer instance");
    this.element = document.createElement("iframe"), Object.entries(r).forEach(([c, p]) => {
      u.searchParams.set(c, p);
    }), Object.entries(o).forEach(([c, p]) => {
      this.element.setAttribute(c, p);
    }), this.element.src = u.toString(), this.element.id = i, a.appendChild(this.element), this.wrapperId = e;
  }
  destroy() {
    if (!this.wrapperId) throw new Error("Tried to destroy a frame before it was initialized");
    let e = document.querySelector(`#${this.wrapperId}`);
    e && e.querySelector(`#${this.element.id}`) && e.removeChild(this.element), this.wrapperId = null, this.element = null;
  }
};
O();
var vA = class {
  constructor(e) {
    this.observers = {}, this.sourceBlockList = ["vue-devtools-proxy", "vue-devtools-backend"], this.originBlockList = ["https://sketchfab.com"], this.publish = (u, c = {}) => {
      this.logger.log("MessageBridge", "Posting message to frame", u, c), this.contentWindow.postMessage({ type: u, data: c }, this.allowedOrigins);
    }, this.listen = (u, c) => {
      this.observers[u] || (this.observers[u] = new $e({ logger: this.logger })), this.observers[u].subscribe(c);
    }, this.onReceiveMessage = (u) => {
      let { type: c, data: p, source: h } = u.data;
      if (this.sourceBlockList.includes(h) || this.originBlockList.includes(u.origin)) return;
      let f = !!c, m = !this.domains.length || this.domains.includes(u.origin), y = this.observers.hasOwnProperty(c);
      if (this.logger.log("MessageBridge", `Message received -
        TYPE: ${u.type}
        ORIGIN: ${u.origin}
        DATA: ${JSON.stringify(u.data)} `), !f || !m || !y) {
        this.logger.log("MessageBridge", "Message discarded");
        return;
      }
      this.observers[c].publish(p);
    };
    let { contentWindow: t, domains: i = [], allowedOrigins: r = "*", sourceBlockList: o = [], logger: a } = e;
    if (this.logger = a, this.domains = i, this.allowedOrigins = r, this.sourceBlockList.push(...o), typeof window > "u") throw new Error("MessageBridge: window is undefined");
    this.contentWindow = t, window.addEventListener("message", this.onReceiveMessage);
  }
  destroy() {
    Object.entries(this.observers).forEach(([e, t]) => {
      t.reset(), delete this.observers[e];
    }), typeof window < "u" && window.removeEventListener("message", this.onReceiveMessage), delete this.logger, delete this.allowedOrigins, delete this.contentWindow, delete this.domains, delete this.observers, delete this.sourceBlockList;
  }
};
var Mh = "sv-video-frame";
var gA = class {
  constructor(e) {
    this.logger = new qe("@superviz/sdk/video-conference-manager"), this.frameStateObserver = new $e({ logger: this.logger }), this.frameSizeObserver = new $e({ logger: this.logger }), this.waitingForHostObserver = new $e({ logger: this.logger }), this.realtimeEventsObserver = new $e({ logger: this.logger }), this.sameAccountErrorObserver = new $e({ logger: this.logger }), this.devicesObserver = new $e({ logger: this.logger }), this.meetingStateObserver = new $e({ logger: this.logger }), this.meetingConnectionObserver = new $e({ logger: this.logger }), this.participantJoinedObserver = new $e({ logger: this.logger }), this.participantLeftObserver = new $e({ logger: this.logger }), this.participantListObserver = new $e({ logger: this.logger }), this.frameState = 0, this.layoutModalsAndCamerasConfig = (V, ve) => {
      let oe = V, Ne = ve, Ke = ["left", "right", "bottom", "top"].includes(Ne), Re = ["left", "right", "center"].includes(oe);
      return Ke || (Ne = "right"), Re || (oe = "right"), this.browserService.isMobileDevice ? (Ne = "bottom", { layoutPosition: oe, camerasPosition: Ne }) : (oe === "left" && Ne === "right" && (oe = "right"), oe === "right" && Ne === "left" && (oe = "left"), { layoutPosition: oe, camerasPosition: Ne });
    }, this.onFrameLoad = () => {
      this.messageBridge = new vA({ logger: this.logger, contentWindow: this.bricklayer.element.contentWindow }), this.addMessagesListeners(), this.updateFrameState(2), this.updateFrameLocale(), this.updateMeetingAvatars(), this.onWindowResize(), this.setCustomColors(), this.setCallbacks();
    }, this.setFrameOffset = (V) => {
      let ve = V ?? {};
      ["top", "bottom", "left", "right"].forEach((oe) => {
        Object.keys(ve).includes(oe) || (ve[oe] = 0);
      }), this.frameOffset = ve;
    }, this.setCustomColors = () => {
      this.customColors && this.messageBridge.publish("frame.color-list-update", this.customColors), this.styles && this.messageBridge.publish("frame.styles-update", this.styles);
    }, this.setCallbacks = () => {
      if (!this.callbacks) return;
      let V = { onToggleMicrophone: !!this.callbacks.onToggleMicrophone, onToggleCam: !!this.callbacks.onToggleCam, onToggleRecording: !!this.callbacks.onToggleRecording, onToggleChat: !!this.callbacks.onToggleChat, onToggleScreenShare: !!this.callbacks.onToggleScreenShare, onClickHangup: !!this.callbacks.onClickHangup, onToggleMeetingSetup: !!this.callbacks.onToggleMeetingSetup };
      this.messageBridge.listen("callback-called", (ve) => {
        var oe, Ne;
        (Ne = (oe = this.callbacks)[ve]) == null || Ne.call(oe);
      }), this.messageBridge.publish("frame.callbacks-update", JSON.stringify(V));
    }, this.setFrameStyle = (V) => {
      let ve = document.createElement("style"), { bottom: oe, left: Ne, right: Ke, top: Re } = this.frameOffset;
      if (ve.innerHTML = `
      :root {
        --superviz-offset-top: ${Re}px;
        --superviz-offset-right: ${Ke}px;
        --superviz-offset-left: ${Ne}px;
        --superviz-offset-bottom: ${oe}px;
      }     
    `, document.head.appendChild(ve), this.browserService.isMobileDevice) {
        this.bricklayer.element.classList.add("sv-video-frame--bottom");
        return;
      }
      this.bricklayer.element.classList.add(`sv-video-frame--${V}`);
    }, this.onFrameDimensionsUpdate = ({ width: V, height: ve }) => {
      if (typeof window > "u") return;
      let oe = document.getElementById(Mh), { bottom: Ne, right: Ke, left: Re, top: mi } = this.frameOffset, vi = this.isWaterMarkEnabled ? 40 : 0, Ri = `${V}px`, kt = `${ve + vi}px`;
      (V >= window.innerWidth || this.isHorizontalCameraEnabled) && (Ri = `calc(100% - ${Ke}px - ${Re}px)`), ve >= window.innerHeight && (kt = `calc(100% - ${mi}px - ${Ne}px)`), oe.style.width = Ri, oe.style.height = kt, this.frameSizeObserver.publish({ width: oe.offsetWidth, height: oe.offsetHeight });
    }, this.onWindowResize = () => {
      let { top: V, bottom: ve, right: oe, left: Ne } = this.frameOffset, { innerHeight: Ke, innerWidth: Re } = window, mi = Ke - V - ve, vi = Re - oe - Ne;
      this.messageBridge && this.messageBridge.publish("frame.parent-window-size-update", { height: mi, width: vi });
    }, this.updateFrameLocale = () => {
      var V, ve;
      if (!this.frameLocale || !((V = this.frameLocale) != null && V.language) && (ve = this.frameLocale) != null && ve.locales) return;
      let { language: oe, locales: Ne } = this.frameLocale, Ke = ["en", ...Ne.map((Re) => Re == null ? void 0 : Re.language)];
      if (oe && !Ke.includes(oe)) throw new Error("The default language is not available in the language listing.");
      this.messageBridge.publish("frame.locales-update", this.frameLocale);
    }, this.updateMeetingAvatars = () => {
      this.messageBridge.publish("frame.avatar-list-update", this.meetingAvatars);
    }, this.onParticipantJoined = (V) => {
      this.participantJoinedObserver.publish(V);
    }, this.onParticipantLeft = (V) => {
      this.participantLeftObserver.publish(V);
    }, this.onMeetingHostChange = (V) => {
      this.realtimeEventsObserver.publish({ event: "realtime.host-change", data: V });
    }, this.onMeetingKickParticipant = (V) => {
      this.realtimeEventsObserver.publish({ event: "meeting.kick-participant", data: V });
    }, this.onFollowParticipantDidChange = (V) => {
      this.realtimeEventsObserver.publish({ event: "realtime.follow-participant", data: V });
    }, this.onGoToDidChange = (V) => {
      this.realtimeEventsObserver.publish({ event: "realtime.go-to-participant", data: V });
    }, this.onGather = () => {
      this.realtimeEventsObserver.publish({ event: "realtime.gather", data: true });
    }, this.onGridModeChange = (V) => {
      this.realtimeEventsObserver.publish({ event: "realtime.grid-mode-change", data: V });
    }, this.onDrawingChange = (V) => {
      this.realtimeEventsObserver.publish({ event: "realtime.drawing-change", data: V });
    }, this.onTranscriptChange = (V) => {
      this.realtimeEventsObserver.publish({ event: "realtime.transcript-change", data: V });
    }, this.onSameAccountError = (V) => {
      this.sameAccountErrorObserver.publish(V);
    }, this.onDevicesChange = (V) => {
      this.devicesObserver.publish(V);
    }, this.meetingStateUpdate = (V) => {
      this.meetingStateObserver.publish(V);
    }, this.onConnectionStatusChange = (V) => {
      this.meetingConnectionObserver.publish(V);
    }, this.onWaitingForHostDidChange = (V) => {
      this.waitingForHostObserver.publish(V);
    }, this.onParticipantListUpdate = (V) => {
      this.participantListObserver.publish(V);
    };
    var t, i, r, o;
    let { language: a, canUseCams: u, canUseChat: c, canUseScreenshare: p, canUseDefaultAvatars: h, canUseFollow: f, canUseGoTo: m, canUseGather: y, canShowAudienceList: g, canUseDefaultToolbar: _, canUseRecording: E, browserService: R, offset: N, locales: j, avatars: B, customColors: K, styles: ie, waterMark: we, layoutPosition: pe, camerasPosition: Se, skipMeetingSettings: Le, devices: Oe, layoutMode: xe, collaborationMode: tt, callbacks: fi } = e;
    this.browserService = R;
    let pt = this.layoutModalsAndCamerasConfig(pe, Se), Ee = document.createElement("div");
    this.frameConfig = { apiKey: Q.get("apiKey"), apiUrl: Q.get("apiUrl"), debug: Q.get("debug"), roomId: Q.get("roomId"), limits: Q.get("limits"), collaborationMode: tt, canUseFollow: f, canUseGoTo: m, canUseCams: u, canUseChat: c, canUseGather: y, canUseScreenshare: p, canUseDefaultAvatars: h, canUseRecording: E, canShowAudienceList: g, camerasPosition: (t = pt.camerasPosition) != null ? t : "right", canUseDefaultToolbar: _, devices: { audioInput: (i = Oe == null ? void 0 : Oe.audioInput) != null ? i : true, audioOutput: (r = Oe == null ? void 0 : Oe.audioOutput) != null ? r : true, videoInput: (o = Oe == null ? void 0 : Oe.videoInput) != null ? o : true }, waterMark: we, layoutMode: xe, skipMeetingSettings: Le, layoutPosition: pt.layoutPosition, transcriptLangs: Q.get("features.transcriptLangs") }, this.customColors = K, this.callbacks = fi, this.styles = ie, Ee.classList.add("sv_video_wrapper"), Ee.id = "sv-video-wrapper", document.body.appendChild(Ee), this.updateFrameState(1), this.bricklayer = new mA(), this.bricklayer.build(Ee.id, Q.get("conferenceLayerUrl"), Mh, void 0, { allow: "camera *;microphone *; display-capture *;" }), this.setFrameOffset(N), this.setFrameStyle(pt.camerasPosition), this.bricklayer.element.addEventListener("load", this.onFrameLoad), this.frameLocale = { language: a, locales: j }, this.meetingAvatars = B, typeof window < "u" && (window.addEventListener("resize", this.onWindowResize), window.addEventListener("orientationchange", this.onWindowResize));
  }
  get isWaterMarkEnabled() {
    return this.browserService.isMobileDevice ? false : this.frameConfig.waterMark;
  }
  get isHorizontalCameraEnabled() {
    return this.browserService.isMobileDevice ? false : ["top", "bottom"].includes(this.frameConfig.camerasPosition);
  }
  addMessagesListeners() {
    this.messageBridge.listen("meeting.waiting-for-host", this.onWaitingForHostDidChange), this.messageBridge.listen("meeting.participant-joined", this.onParticipantJoined), this.messageBridge.listen("meeting.participant-list-update", this.onParticipantListUpdate), this.messageBridge.listen("meeting.participant-left", this.onParticipantLeft), this.messageBridge.listen("meeting.host-change", this.onMeetingHostChange), this.messageBridge.listen("meeting.kick-participant", this.onMeetingKickParticipant), this.messageBridge.listen("meeting.same-participant-error", this.onSameAccountError), this.messageBridge.listen("meeting.state-update", this.meetingStateUpdate), this.messageBridge.listen("meeting.connection-status-change", this.onConnectionStatusChange), this.messageBridge.listen("meeting.devices-change", this.onDevicesChange), this.messageBridge.listen("realtime.grid-mode-change", this.onGridModeChange), this.messageBridge.listen("realtime.drawing-change", this.onDrawingChange), this.messageBridge.listen("realtime.transcript-change", this.onTranscriptChange), this.messageBridge.listen("frame.dimensions-update", this.onFrameDimensionsUpdate), this.messageBridge.listen("realtime.follow-participant", this.onFollowParticipantDidChange), this.messageBridge.listen("realtime.go-to-participant", this.onGoToDidChange), this.messageBridge.listen("realtime.gather", this.onGather);
  }
  updateFrameState(e) {
    e !== this.frameState && (this.frameState = e, this.frameStateObserver.publish(this.frameState));
    let t = { 1: 6, 2: 7, 0: 8 };
    this.meetingStateUpdate(t[e]);
  }
  start(e) {
    this.messageBridge.publish("meeting.start", de($({}, e), { config: this.frameConfig }));
  }
  leave() {
    this.messageBridge.publish("meeting.leave"), this.destroy();
  }
  destroy() {
    var e, t, i, r, o, a, u, c, p, h;
    (e = this.messageBridge) == null || e.destroy(), (t = this.bricklayer) == null || t.destroy(), (i = this.frameSizeObserver) == null || i.destroy(), (r = this.realtimeEventsObserver) == null || r.destroy(), (o = this.sameAccountErrorObserver) == null || o.destroy(), (a = this.devicesObserver) == null || a.destroy(), (u = this.meetingStateObserver) == null || u.destroy(), (c = this.meetingConnectionObserver) == null || c.destroy(), (p = this.participantJoinedObserver) == null || p.destroy(), (h = this.participantLeftObserver) == null || h.destroy(), this.bricklayer = null, this.frameState = null, typeof window < "u" && (window.removeEventListener("resize", this.onWindowResize), window.removeEventListener("orientationchange", this.onWindowResize));
  }
  publishMessageToFrame(e, t) {
    this.messageBridge && this.messageBridge.publish(e, t);
  }
};
O();
var yA = class {
  constructor() {
    this.logger = new qe("@superviz/sdk/core-bridge"), this.logger.log("CoreBridge initialized");
  }
  updateLocalParticipant(e) {
    this.logger.log("updateLocalParticipant", e);
    let { localParticipant: t } = st("core-store");
    t.publish(e);
  }
  updateParticipantsList(e) {
    this.logger.log("updateParticipantsList", e);
    let { participants: t } = st("core-store");
    t.publish(e);
  }
};
var gs = new yA();
var bA = 1e3 * 60;
var Oi = null;
var wA = class extends Hi {
  constructor(e) {
    var t, i;
    super(), this.participantsOnMeeting = [], this.kickParticipantsOnHostLeave = false, this.startVideo = () => {
      var r, o, a, u, c, p, h, f, m, y, g, _, E, R, N, j, B, K, ie, we, pe, Se, Le, Oe, xe, tt, fi, pt, Ee, V, ve, oe, Ne, Ke, Re, mi, vi, Ri;
      let kt = ((r = this.params) == null ? void 0 : r.userType) !== "audience" && ((o = this.params) == null ? void 0 : o.defaultAvatars) === true;
      this.videoConfig = { language: (a = this.params) == null ? void 0 : a.language, canUseRecording: !!((u = this.params) != null && u.enableRecording), canShowAudienceList: (p = (c = this.params) == null ? void 0 : c.showAudienceList) != null ? p : true, canUseChat: !((h = this.params) != null && h.chatOff), canUseCams: !((f = this.params) != null && f.camsOff), canUseScreenshare: !((m = this.params) != null && m.screenshareOff), canUseDefaultAvatars: kt && !((g = (y = this.localParticipant) == null ? void 0 : y.avatar) != null && g.model3DUrl), canUseGather: !!((_ = this.params) != null && _.enableGather), canUseFollow: !!((E = this.params) != null && E.enableFollow), canUseGoTo: !!((R = this.params) != null && R.enableGoTo), canUseDefaultToolbar: (j = (N = this.params) == null ? void 0 : N.defaultToolbar) != null ? j : true, camerasPosition: (K = (B = this.params) == null ? void 0 : B.collaborationMode) == null ? void 0 : K.position, devices: (ie = this.params) == null ? void 0 : ie.devices, skipMeetingSettings: (we = this.params) == null ? void 0 : we.skipMeetingSettings, browserService: this.browserService, offset: (pe = this.params) == null ? void 0 : pe.offset, locales: (Le = (Se = this.params) == null ? void 0 : Se.locales) != null ? Le : [], avatars: (xe = (Oe = this.params) == null ? void 0 : Oe.avatars) != null ? xe : [], customColors: Q.get("colors"), waterMark: Q.get("waterMark"), styles: (tt = this.params) == null ? void 0 : tt.styles, collaborationMode: (Ee = (pt = (fi = this.params) == null ? void 0 : fi.collaborationMode) == null ? void 0 : pt.enabled) != null ? Ee : true, layoutPosition: ((ve = (V = this.params) == null ? void 0 : V.collaborationMode) == null ? void 0 : ve.enabled) === false ? "center" : (Ke = (Ne = (oe = this.params) == null ? void 0 : oe.collaborationMode) == null ? void 0 : Ne.modalPosition) != null ? Ke : "center", layoutMode: (vi = (mi = (Re = this.params) == null ? void 0 : Re.collaborationMode) == null ? void 0 : mi.initialView) != null ? vi : "list", callbacks: (Ri = this.params) == null ? void 0 : Ri.callbacks }, this.logger.log("video conference @ start video", this.videoConfig), this.videoManager = new gA(this.videoConfig), this.subscribeToVideoEvents();
    }, this.subscribeToVideoEvents = () => {
      this.logger.log("video conference @ subscribe to video events"), this.videoManager.meetingConnectionObserver.subscribe(this.connectionService.updateMeetingConnectionStatus), this.videoManager.participantListObserver.subscribe(this.onParticipantListUpdate), this.videoManager.waitingForHostObserver.subscribe(this.onWaitingForHost), this.videoManager.frameSizeObserver.subscribe(this.onFrameSizeDidChange), this.videoManager.meetingStateObserver.subscribe(this.onMeetingStateChange), this.videoManager.frameStateObserver.subscribe(this.onFrameStateChange), this.videoManager.realtimeEventsObserver.subscribe(this.onRealtimeEventFromFrame), this.videoManager.participantJoinedObserver.subscribe(this.onParticipantJoined), this.videoManager.participantLeftObserver.subscribe(this.onParticipantLeft), this.videoManager.sameAccountErrorObserver.subscribe(this.onSameAccountError), this.videoManager.devicesObserver.subscribe(this.onDevicesChange);
    }, this.unsubscribeFromVideoEvents = () => {
      this.videoManager && (this.logger.log("video conference @ unsubscribe from video events"), this.videoManager.meetingConnectionObserver.unsubscribe(this.connectionService.updateMeetingConnectionStatus), this.videoManager.participantListObserver.unsubscribe(this.onParticipantListUpdate), this.videoManager.waitingForHostObserver.unsubscribe(this.onWaitingForHost), this.videoManager.frameSizeObserver.unsubscribe(this.onFrameSizeDidChange), this.videoManager.meetingStateObserver.unsubscribe(this.onMeetingStateChange), this.videoManager.frameStateObserver.unsubscribe(this.onFrameStateChange), this.videoManager.realtimeEventsObserver.unsubscribe(this.onRealtimeEventFromFrame), this.videoManager.participantJoinedObserver.unsubscribe(this.onParticipantJoined), this.videoManager.participantLeftObserver.unsubscribe(this.onParticipantLeft), this.videoManager.sameAccountErrorObserver.unsubscribe(this.onSameAccountError), this.videoManager.devicesObserver.unsubscribe(this.onDevicesChange));
    }, this.suscribeToRealtimeEvents = () => {
      this.logger.log("video conference @ subscribe to realtime events"), this.room.presence.on(ee.UPDATE, this.onParticipantUpdateOnRealtime), this.room.presence.on(ee.JOINED_ROOM, this.onParticipantJoinedOnRealtime), this.room.presence.on(ee.LEAVE, this.onParticipantLeftOnRealtime);
    }, this.unsubscribeFromRealtimeEvents = () => {
      var r;
      this.logger.log("video conference @ unsubscribe from realtime events"), this.room.presence.off(ee.UPDATE), this.room.presence.off(ee.LEAVE), this.room.presence.off(ee.JOINED_ROOM), (r = this.roomState) == null || r.kickParticipantObserver.unsubscribe(this.onKickLocalParticipant);
    }, this.subscribeToStoreUpdates = () => {
      let { localParticipant: r, group: o, participants: a } = this.useStore("global-store");
      a.subscribe((y) => {
        let g = Object.values(y);
        this.onRealtimeParticipantsDidChange(g);
      });
      let { drawing: u, hostId: c, isGridModeEnabled: p, transcript: h, followParticipantId: f, gather: m } = this.useStore("video-store");
      r.subscribe((y) => {
        this.localParticipant = de($($({}, this.localParticipant), y), { type: this.params.userType });
      }), u.subscribe(this.setDrawing), c.subscribe(this.setHost), p.subscribe(this.setGridMode), h.subscribe(this.setTranscript), f.subscribe(this.setFollowParticipant), m.subscribe(this.setGather), o.subscribe();
    }, this.createParticipantFromPresence = (r) => {
      var o;
      return { participantId: r.id, id: r.id, color: ((o = r.data.slot) == null ? void 0 : o.color) || Jt.gray, avatar: r.data.avatar, type: r.data.type, name: r.data.name, isHost: r.data.isHost, timestamp: r.timestamp, slot: r.data.slot };
    }, this.onFrameSizeDidChange = (r) => {
      this.publish("frame.dimensions-update", r);
    }, this.onWaitingForHost = (r) => {
      this.publish("meeting.waiting-for-host", r);
    }, this.onConnectionStatusChange = (r) => {
      this.logger.log("video conference @ on connection status change", r);
      let o = [2, 4, 3, 6];
      o.includes(r) && this.roomState.freezeSync(true), o.includes(this.connectionService.oldConnectionStatus) && !o.includes(r) && this.roomState.freezeSync(false), this.publish("meeting.connection-status-change", r);
    }, this.onMeetingStateChange = (r) => {
      this.logger.log("video conference @ on meeting state change", r), this.publish("meeting.state-update", r);
    }, this.onSameAccountError = (r) => {
      this.publish("meeting.same-participant-error", r), this.detach();
    }, this.onDevicesChange = (r) => {
      this.publish("meeting.devices-change", r);
    }, this.onFrameStateChange = (r) => {
      this.logger.log("video conference @ on frame state change", r), r === 2 && (this.roomState = new fA(this.room, this.drawingRoom, this.logger), this.roomState.kickParticipantObserver.subscribe(this.onKickLocalParticipant), this.roomState.start(), this.params.userType !== "guest" && (this.localParticipant = Object.assign(this.localParticipant, { type: this.params.userType }), this.roomState.updateMyProperties($({}, this.localParticipant))), this.videoManager.start({ group: this.group, participant: this.localParticipant, roomId: Q.get("roomId") }), this.publish("meeting.start"));
    }, this.onRealtimeEventFromFrame = ({ event: r, data: o }) => {
      this.logger.log("video conference @ on realtime event from frame", r, o), { "realtime.host-change": (a) => this.roomState.setHost(a), "realtime.gather": (a) => this.roomState.setGather(a), "realtime.grid-mode-change": (a) => this.roomState.setGridMode(a), "realtime.drawing-change": (a) => {
        this.roomState.setDrawing(a);
      }, "realtime.follow-participant": (a) => {
        this.roomState.setFollowParticipant(a);
      }, "meeting.kick-participant": (a) => {
        this.roomState.setKickParticipant(a);
      }, "realtime.transcript-change": (a) => {
        this.roomState.setTranscript(a);
      }, "realtime.go-to-participant": (a) => {
        this.eventBus.publish("realtime.go-to-participant", a);
      } }[r](o), this.publish(r, o);
    }, this.onParticipantJoined = (r) => {
      var o;
      this.logger.log("video conference @ on participant joined", r), this.publish("meeting.participant-joined", r), this.publish("my-participant.joined", r), this.kickParticipantsOnHostLeave = !((o = this.params) != null && o.allowGuests);
      let { localParticipant: a, participants: u } = this.useStore("global-store"), c = r.name.trim();
      if (this.videoConfig.canUseDefaultAvatars) {
        this.roomState.updateMyProperties({ avatar: r.avatar, name: r.name, type: r.type, joinedMeeting: true }), gs.updateLocalParticipant(de($({}, a.value), { avatar: r.avatar, name: r.name, type: this.params.userType })), gs.updateParticipantsList(de($({}, u.value), { [r.id]: de($({}, u.value[r.id]), { avatar: r.avatar, name: r.name }) }));
        return;
      }
      gs.updateLocalParticipant(de($({}, a.value), { name: c, type: this.params.userType })), gs.updateParticipantsList(de($({}, u.value), { [r.id]: de($({}, u.value[r.id]), { name: c, type: this.params.userType }) })), this.roomState.updateMyProperties({ name: r.name, type: r.type, joinedMeeting: true });
    }, this.onParticipantLeft = (r) => {
      var o, a;
      this.logger.log("video conference @ on participant left", this.localParticipant);
      let { localParticipant: u, participants: c } = this.useStore("global-store");
      u.publish(de($({}, u.value), { activeComponents: (o = u.value.activeComponents) == null ? void 0 : o.filter((p) => p !== "videoConference") })), c.publish(de($({}, c.value), { [this.localParticipant.id]: de($({}, u.value), { activeComponents: (a = u.value.activeComponents) == null ? void 0 : a.filter((p) => p !== "videoConference") }) })), this.connectionService.removeListeners(), this.publish("my-participant.left", this.localParticipant), this.unsubscribeFromVideoEvents(), this.videoManager.leave(), this.videoManager = void 0, this.connectionService = void 0, this.detach();
    }, this.onParticipantListUpdate = (r) => {
      this.logger.log("video conference @ on participant list update", r);
      let o = Object.values(r).map((a) => {
        var u, c;
        return { id: a.id, slot: a.slot, avatar: a.avatar, name: a.name, type: a.type, isHost: (u = a.isHost) != null ? u : false, timestamp: a.timestamp, color: ((c = a.slot) == null ? void 0 : c.color) || Jt.gray };
      });
      this.publish("meeting.participant-list-update", o), this.participantsOnMeeting.length !== o.length && this.publish("meeting.amount-of-participants-update", o.length), this.participantsOnMeeting = o, this.validateIfInTheRoomHasHost();
    }, this.onKickLocalParticipant = () => {
      this.logger.log("video conference @ on kick local participant"), this.publish("meeting.kick-participant", this.localParticipant), this.detach();
    }, this.setDrawing = (r) => {
      var o;
      (o = this.videoManager) == null || o.publishMessageToFrame("realtime.drawing-change", r);
    }, this.setHost = (r) => {
      var o;
      (o = this.videoManager) == null || o.publishMessageToFrame("realtime.host-change", r), this.onHostParticipantDidChange(r);
    }, this.setGridMode = (r) => {
      var o;
      (o = this.videoManager) == null || o.publishMessageToFrame("realtime.grid-mode-change", r);
    }, this.setTranscript = (r) => {
      var o;
      (o = this.videoManager) == null || o.publishMessageToFrame("realtime.transcript-change", r);
    }, this.setFollowParticipant = (r) => {
      var o;
      (o = this.videoManager) == null || o.publishMessageToFrame("realtime.follow-participant", r), this.eventBus.publish("realtime.follow-participant", r);
    }, this.setGather = (r) => {
      if (!this.videoManager || !r) return;
      let { hostId: o, gather: a } = this.useStore("video-store");
      if (a.publish(false), o.value !== this.localParticipant.id) {
        this.eventBus.publish("realtime.go-to-participant", o.value);
        return;
      }
      this.videoManager.publishMessageToFrame("realtime.gather", r);
    }, this.onRealtimeParticipantsDidChange = (r) => {
      var o;
      this.logger.log("video conference @ on participants did change", r);
      let a = r.map((u) => {
        var c, p;
        return { id: u.id, timestamp: u.timestamp, participantId: u.id, color: ((c = u.slot) == null ? void 0 : c.color) || Jt.gray, name: u.name, isHost: (p = u.isHost) != null ? p : false, avatar: u.avatar, type: u.type, slot: u.slot };
      });
      (o = this.videoManager) == null || o.publishMessageToFrame("realtime.participant-list-update", a);
    }, this.onHostParticipantDidChange = (r) => {
      var o, a;
      this.logger.log("video conference @ on host participant did change", r), (o = this.videoManager) == null || o.publishMessageToFrame("realtime.host-change", r);
      let { participants: u } = this.useStore("global-store"), c = Object.values(u.value).find((h) => h.id === r), p = c ? { id: c.id, color: ((a = c.slot) == null ? void 0 : a.color) || Jt.gray, avatar: c.avatar, type: c.type, name: c.name, isHost: c.id === r } : null;
      Oi && p && (this.logger.log("video conference @ on host participant did change - clear kick all participants timeout"), clearTimeout(Oi), Oi = null), this.publish("meeting.host-change", p);
    }, this.onHostAvailabilityChange = (r) => {
      if (this.logger.log("launcher service @ onHostAvailabilityChange"), r) {
        this.publish("meeting.host-available");
        return;
      }
      this.publish("meeting.no-host-available");
    }, this.onParticipantJoinedOnRealtime = (r) => {
      this.logger.log("video conference @ on participant joined on realtime", r), this.publish("meeting.participant-joined", this.createParticipantFromPresence(r)), r.id === this.localParticipant.id && this.room.presence.update(this.localParticipant);
    }, this.onParticipantLeftOnRealtime = (r) => {
      this.logger.log("video conference @ on participant left on realtime", r), this.publish("meeting.participant-left", this.createParticipantFromPresence(r));
    }, this.onParticipantUpdateOnRealtime = (r) => {
      this.logger.log("video conference @ on participant update on realtime", r);
      let { localParticipant: o, participants: a } = this.useStore("global-store");
      r.data.id === this.localParticipant.id && this.publish("my-participant.update", this.createParticipantFromPresence(r)), a.publish(de($({}, a.value), { [r.data.id]: $($({}, o.value), r.data) }));
    }, this.validateIfInTheRoomHasHost = () => {
      var r, o;
      if (!this.roomState) return;
      let { hostId: a } = this.useStore("video-store"), { participants: u } = this.useStore("global-store"), c = Object.values(u.value), p = c.filter((m) => m.type === "host" && this.participantsOnMeeting.some((y) => y.id === m.id));
      !p.length && this.kickParticipantsOnHostLeave && ((r = this.localParticipant) == null ? void 0 : r.type) !== "host" && !Oi && (this.logger.log("video conference @ validate if in the room has host - init kick all participants timeout"), Oi = setTimeout(() => {
        this.logger.log("video conference @ validate if in the room has host - kick all participants"), this.onKickLocalParticipant();
      }, bA)), p.length && Oi && (this.logger.log("video conference @ validade if in the room has host - clear kick all participants timeout"), clearTimeout(Oi), Oi = null), this.onHostAvailabilityChange(!!p.length);
      let h = c.find((m) => (m == null ? void 0 : m.id) === (a == null ? void 0 : a.value));
      if (!p.length || h) return;
      let f = p.reduce((m, y) => (this.logger.log("video conference @ validate if in the room has host - reducing participants", { previous: m, current: y }), !m || (y == null ? void 0 : y.id) === a.value ? y : (y == null ? void 0 : y.timestamp) > m.timestamp ? m : y), null);
      this.room.presence.update(de($({}, this.localParticipant), { isHost: f.id === this.localParticipant.id })), !(!f || f.id !== ((o = this.localParticipant) == null ? void 0 : o.id)) && (this.logger.log("video conference @ validate if in the room has host - set host", f), a.publish(f.id), this.roomState.setHost(f.id));
    }, this.params = de($({}, e), { userType: (i = (t = e == null ? void 0 : e.participantType) != null ? t : e == null ? void 0 : e.userType) != null ? i : "guest" }), this.name = "videoConference", this.logger = new qe("@superviz/sdk/videoConference"), this.browserService = new dA(), this.connectionService = new pA(), this.connectionService.addListeners(), this.connectionService.connectionStatusObserver.subscribe(this.onConnectionStatusChange);
  }
  toggleMeetingSetup() {
    var e;
    return (e = this.videoManager) == null ? void 0 : e.publishMessageToFrame("meeting-controls.toggle-setup");
  }
  toggleMicrophone() {
    var e;
    if (this.localParticipant.type === "audience") {
      console.warn("[SuperViz] Audience cannot toggle microphone");
      return;
    }
    return (e = this.videoManager) == null ? void 0 : e.publishMessageToFrame("meeting-controls.toggle-microphone");
  }
  toggleCam() {
    var e;
    if (this.localParticipant.type === "audience") {
      console.warn("[SuperViz] Audience cannot toggle camera");
      return;
    }
    (e = this.videoManager) == null || e.publishMessageToFrame("meeting-controls.toggle-cam");
  }
  toggleScreenShare() {
    var e;
    if (this.localParticipant.type === "audience") {
      console.warn("[SuperViz] Audience cannot toggle screen share");
      return;
    }
    return (e = this.videoManager) == null ? void 0 : e.publishMessageToFrame("meeting-controls.toggle-screenshare");
  }
  toggleChat() {
    var e;
    return (e = this.videoManager) == null ? void 0 : e.publishMessageToFrame("meeting-controls.toggle-chat");
  }
  toggleRecording() {
    var e;
    if (this.localParticipant.isHost) {
      console.warn("[SuperViz] Only host can toggle recording");
      return;
    }
    return (e = this.videoManager) == null ? void 0 : e.publishMessageToFrame("meeting-controls.toggle-recording");
  }
  hangUp() {
    var e;
    (e = this.videoManager) == null || e.publishMessageToFrame("hang-up");
  }
  start() {
    this.logger.log("video conference @ start"), this.drawingRoom = this.ioc.createRoom("drawing"), this.subscribeToStoreUpdates(), this.suscribeToRealtimeEvents(), this.startVideo();
  }
  destroy() {
    var e, t, i;
    this.logger.log("video conference @ destroy");
    let { destroy: r } = this.useStore("video-store");
    r(), (e = this.roomState) == null || e.destroy(), this.drawingRoom.disconnect(), this.kickParticipantsOnHostLeave = false, this.publish("destroy"), this.unsubscribeFromRealtimeEvents(), this.unsubscribeFromVideoEvents(), (t = this.videoManager) == null || t.leave(), (i = this.connectionService) == null || i.removeListeners();
  }
};
O();
O();
var _A = zt(wn());
var CA = class extends Hi {
  constructor(e, t) {
    var i;
    if (super(), this.camera = { x: 0, y: 0, screen: { width: 0, height: 0 }, scale: 1 }, this.subscribeToRealtimeEvents = () => {
      this.logger.log("presence-mouse component @ subscribe to realtime events"), this.room.presence.on(ee.JOINED_ROOM, this.onPresenceJoinedRoom), this.room.presence.on(ee.LEAVE, this.onPresenceLeftRoom), this.room.presence.on(ee.UPDATE, this.onPresenceUpdate);
    }, this.unsubscribeFromRealtimeEvents = () => {
      this.logger.log("presence-mouse component @ unsubscribe from realtime events"), this.room.presence.off(ee.JOINED_ROOM), this.room.presence.off(ee.LEAVE), this.room.presence.off(ee.UPDATE);
    }, this.setParticipantPrivate = (o) => {
      this.isPrivate = o, this.room.presence.update({ visible: !o });
    }, this.onPresenceJoinedRoom = (o) => {
      o.id === this.localParticipant.id && this.room.presence.update(this.localParticipant);
    }, this.onPresenceLeftRoom = (o) => {
      this.removePresenceMouseParticipant(o.id);
    }, this.onPresenceUpdate = (o) => {
      if (this.following && this.presences.get(this.following) && this.goToMouse(this.following), o.id === this.localParticipant.id) return;
      let a = o.data;
      if (this.following && a.id !== this.following && this.presences.has(a.id)) {
        this.removePresenceMouseParticipant(a.id);
        return;
      }
      this.presences.set(a.id, a);
    }, this.animate = () => {
      this.getCamera(), this.renderDivWrapper(), this.updateParticipantsMouses(), requestAnimationFrame(this.animate);
    }, this.goToMouse = (o) => {
      let a = this.presences.get(o);
      if (!(a != null && a.camera)) return;
      let u = a.camera.x, c = a.camera.y, p = this.divWrapper.clientHeight / a.camera.screen.height, h = Math.min(p, 1), f = this.divWrapper.clientWidth / a.camera.screen.width, m = Math.min(f, 1);
      this.goToMouseCallback && this.goToMouseCallback({ x: u, y: c, scaleX: h, scaleY: m });
    }, this.onMyParticipantMouseMove = (0, _A.throttle)((o) => {
      let a = this.canvas.getContext("2d"), u = this.canvas.getBoundingClientRect(), c = o.x - u.left, p = o.y - u.top, h = (a == null ? void 0 : a.getTransform()).inverse(), f = new DOMPoint(c, p).matrixTransform(h), m = { x: f.x, y: f.y };
      this.room.presence.update(de($($({}, this.localParticipant), m), { visible: !this.isPrivate, camera: this.camera }));
    }, 30), this.onMyParticipantMouseOut = (o) => {
      let { x: a, y: u, width: c, height: p } = this.canvas.getBoundingClientRect();
      o.x > 0 && o.y > 0 && o.x < a + c && o.y < u + p || this.room.presence.update({ visible: false });
    }, this.updateParticipantsMouses = () => {
      this.presences.forEach((o) => {
        if (!(o != null && o.visible) || this.following && this.following !== o.id) {
          this.removePresenceMouseParticipant(o.id);
          return;
        }
        this.renderPresenceMouses(o);
      });
    }, this.getCamera = () => {
      var o;
      let a = (o = this.canvas) == null ? void 0 : o.getContext("2d"), u = a == null ? void 0 : a.getTransform(), c = u == null ? void 0 : u.e, p = u == null ? void 0 : u.f, h = u == null ? void 0 : u.a;
      this.camera = { screen: { width: this.divWrapper.clientHeight, height: this.divWrapper.clientWidth }, x: c, y: p, scale: h };
    }, this.renderPresenceMouses = (o) => {
      var a, u, c, p, h;
      let f = document.getElementById(`mouse-${o.id}`);
      f || (f = this.createMouseElement(o));
      let m = document.getElementById(`mouse-${o.id}`), y = document.getElementById(`mouse-${o.id}`);
      if (!m || !y) return;
      let g = m.getElementsByClassName("mouse-user-name")[0], _ = y.getElementsByClassName("pointer-mouse")[0];
      _ && (_.style.backgroundImage = `url(https://production.cdn.superviz.com/static/mouse-pointers/${(a = o.slot) == null ? void 0 : a.colorName}.svg)`), g && (g.style.color = (c = (u = o.slot) == null ? void 0 : u.textColor) != null ? c : "#fff", g.style.backgroundColor = (h = (p = o.slot) == null ? void 0 : p.color) != null ? h : Jt.gray, g.innerHTML = o.name);
      let { x: E, y: R } = o, N = this.canvas.getContext("2d"), j = N == null ? void 0 : N.getTransform(), B = j == null ? void 0 : j.e, K = j == null ? void 0 : j.f, ie = j.a, we = j.d, pe = E * ie + B, Se = R * we + K, Le = this.divWrapper.clientWidth > pe && this.divWrapper.clientHeight > Se && o.visible;
      f.style.opacity = Le ? "1" : "0", f.style.left = `${pe}px`, f.style.top = `${Se}px`;
    }, this.followMouse = (o) => {
      this.following = o, this.goToMouse(o);
    }, this.name = "presence", this.logger = new qe("@superviz/sdk/presence"), this.canvas = document.getElementById(e), this.presences = /* @__PURE__ */ new Map(), !this.canvas) {
      let o = `Canvas with id ${e} not found`;
      throw this.logger.log(o), new Error(o);
    }
    this.divWrapper = this.renderDivWrapper(), this.animateFrame = requestAnimationFrame(this.animate), this.goToMouseCallback = (i = t == null ? void 0 : t.callbacks) == null ? void 0 : i.onGoToPresence;
    let { localParticipant: r } = this.useStore("global-store");
    r.subscribe(), this.getCamera();
  }
  start() {
    this.logger.log("presence-mouse component @ start"), this.canvas.addEventListener("mousemove", this.onMyParticipantMouseMove), this.canvas.addEventListener("mouseout", this.onMyParticipantMouseOut), this.eventBus.subscribe("realtime.go-to-participant", this.goToMouse), this.eventBus.subscribe("realtime.local-follow-participant", this.followMouse), this.eventBus.subscribe("realtime.private-mode", this.setParticipantPrivate), this.subscribeToRealtimeEvents();
  }
  destroy() {
    this.logger.log("presence-mouse component @ destroy"), this.eventBus.unsubscribe("realtime.go-to-participant", this.goToMouse), this.eventBus.unsubscribe("realtime.local-follow-participant", this.followMouse), this.eventBus.unsubscribe("realtime.private-mode", this.setParticipantPrivate), this.unsubscribeFromRealtimeEvents(), cancelAnimationFrame(this.animateFrame), this.canvas.removeEventListener("mousemove", this.onMyParticipantMouseMove), this.canvas.removeEventListener("mouseout", this.onMyParticipantMouseOut), this.divWrapper.remove();
  }
  renderDivWrapper() {
    let e = this.canvas.getBoundingClientRect(), t = document.getElementById("superviz-presence-mouse-wrapper");
    return t || (t = document.createElement("div"), t.id = "superviz-presence-mouse-wrapper", this.canvas.parentElement.style.position = "relative", this.canvas.parentElement.appendChild(t)), t.style.position = "fixed", t.style.top = `${e.top}px`, t.style.left = `${e.left}px`, t.style.width = `${e.width}px`, t.style.height = `${e.height}px`, t.style.pointerEvents = "none", t.style.overflow = "hidden", t.style.zIndex = "2", t;
  }
  removePresenceMouseParticipant(e) {
    let t = document.getElementById(`mouse-${e}`);
    t && (t.remove(), this.presences.delete(e));
  }
  createMouseElement(e) {
    let t = document.createElement("div");
    t.setAttribute("id", `mouse-${e.id}`), t.setAttribute("class", "mouse-follower");
    let i = document.createElement("div");
    i.setAttribute("class", "pointer-mouse");
    let r = document.createElement("div");
    return r.setAttribute("class", "mouse-user-name"), r.innerHTML = e.name, t.appendChild(i), t.appendChild(r), t.style.left = "0px", t.style.top = "0px", this.divWrapper.appendChild(t), t;
  }
  transform(e) {
    console.warn("[SuperViz] - transform method not available when container is a canvas element.");
  }
};
O();
var EA = zt(wn());
O();
var Ja = ((e) => (e.AREA = "area", e.BASE = "base", e.BR = "br", e.COL = "col", e.EMBED = "embed", e.HR = "hr", e.IMG = "img", e.INPUT = "input", e.LINK = "link", e.META = "meta", e.PARAM = "param", e.SOURCE = "source", e.TRACK = "track", e.WBR = "wbr", e))(Ja || {});
var Ha = ((e) => (e.RECT = "rect", e.ELLIPSE = "ellipse", e.SVG = "svg", e))(Ha || {});
var PA = class extends Hi {
  constructor(e, t) {
    var i;
    if (super(), this.presences = /* @__PURE__ */ new Map(), this.mouses = /* @__PURE__ */ new Map(), this.transformation = { translate: { x: 0, y: 0 }, scale: 1 }, this.onMyParticipantMouseMove = (o) => {
      if (this.isPrivate) return;
      let a = o.currentTarget, { left: u, top: c } = a.getBoundingClientRect(), p = (o.x - u - this.transformation.translate.x) / this.transformation.scale, h = (o.y - c - this.transformation.translate.y) / this.transformation.scale;
      this.room.presence.update(de($({}, this.localParticipant), { x: p, y: h, visible: true, camera: this.camera }));
    }, this.onMyParticipantMouseLeave = (o) => {
      if (typeof window > "u") return;
      let { left: a, top: u, right: c, bottom: p } = this.container.getBoundingClientRect(), h = o.x > a && o.y > u && o.x < c && o.y < p, f = o.x > 0 && o.y > 0 && o.x < window.innerWidth && o.y < window.innerHeight;
      h && f || this.room.presence.update({ visible: false });
    }, this.goToMouse = (o) => {
      let a = this.mouses.get(o), u = this.presences.get(o);
      if (u) {
        if (this.goToPresenceCallback) {
          let c = this.camera.screen.width / u.camera.screen.width, p = this.camera.screen.height / u.camera.screen.height, h = u.camera.x * c, f = u.camera.y * p, m = u.camera.scale * c, y = u.camera.scale * p;
          this.goToPresenceCallback({ x: h, y: f, scaleX: m, scaleY: y });
          return;
        }
        a && a.scrollIntoView({ block: "center", inline: "center", behavior: "smooth" });
      }
    }, this.followMouse = (o) => {
      this.userBeingFollowedId = o, this.goToMouse(o);
    }, this.setParticipantPrivate = (o) => {
      this.isPrivate = o, this.room.presence.update({ visible: !o });
    }, this.onPresenceJoinedRoom = (o) => {
      o.id === this.localParticipant.id && this.room.presence.update(this.localParticipant);
    }, this.onPresenceLeftRoom = (o) => {
      this.removePresenceMouseParticipant(o.id);
    }, this.onPresenceUpdate = (o) => {
      if (o.id === this.localParticipant.id) return;
      let a = o.data;
      if (this.userBeingFollowedId && a.id !== this.userBeingFollowedId && this.presences.has(a.id)) {
        this.removePresenceMouseParticipant(a.id);
        return;
      }
      this.presences.set(a.id, a), this.animate(), this.updateParticipantsMouses();
    }, this.animate = () => {
      Ja[this.containerTagname] && this.updateVoidElementWrapper(), Ha[this.containerTagname] && this.updateSVGElementWrapper(), this.animationFrame = requestAnimationFrame(this.animate);
    }, this.updateParticipantsMouses = (o) => {
      this.presences.forEach((a) => {
        if (a.id !== this.localParticipant.id) {
          if (!(a != null && a.visible)) {
            this.removePresenceMouseParticipant(a.id);
            return;
          }
          this.renderPresenceMouses(a);
        }
      }), !o && this.presences.has(this.userBeingFollowedId) && this.goToMouse(this.userBeingFollowedId);
    }, this.renderPresenceMouses = (o) => {
      var a, u, c, p, h;
      if (o.id === this.localParticipant.id) return;
      let f = document.getElementById(`mouse-${o.id}`);
      if (f || (f = this.createMouseElement(o)), !f) return;
      let m = f.getElementsByClassName("mouse-user-name")[0], y = f.getElementsByClassName("pointer-mouse")[0];
      y && (y.style.backgroundImage = `url(https://production.cdn.superviz.com/static/mouse-pointers/${(a = o.slot) == null ? void 0 : a.colorName}.svg)`), m && (m.style.color = (c = (u = o.slot) == null ? void 0 : u.textColor) != null ? c : Jt.gray, m.style.backgroundColor = (h = (p = o.slot) == null ? void 0 : p.color) != null ? h : "#fff", m.innerHTML = o.name);
      let { x: g, y: _ } = o, { translate: { x: E, y: R }, scale: N } = this.transformation;
      f.style.left = `${E + g * N}px`, f.style.top = `${R + _ * N}px`;
    }, this.renderVoidElementWrapper = () => {
      let o = document.createElement("div"), { width: a, height: u, left: c, top: p } = this.container.getBoundingClientRect();
      o.style.position = "absolute", o.style.width = `${a}px`, o.style.height = `${u}px`, o.style.top = `${p}px`, o.style.left = `${c}px`, o.style.overflow = "visible", o.style.pointerEvents = "none", this.container.parentElement.appendChild(o), this.wrapper = o;
    }, this.renderSVGElementWrapper = () => {
      let o = this.containerTagname.toLowerCase();
      if (o === "svg") {
        this.createSVGWrapper();
        return;
      }
      if (o === "rect") {
        this.createRectWrapper();
        return;
      }
      o === "ellipse" && this.createEllipseWrapper();
    }, this.container = document.getElementById(e), this.logger = new qe("@superviz/sdk/presence"), !this.container) {
      let o = `Element with id ${e} not found`;
      throw this.logger.log(o), new Error(o);
    }
    this.camera = { x: 0, y: 0, scale: 1, screen: { width: this.container.clientWidth, height: this.container.clientHeight } }, this.name = "presence";
    let { localParticipant: r } = this.useStore("global-store");
    r.subscribe(), this.containerTagname = this.container.tagName.toUpperCase(), this.goToPresenceCallback = (i = t == null ? void 0 : t.callbacks) == null ? void 0 : i.onGoToPresence;
  }
  start() {
    this.logger.log("presence-mouse component @ start"), this.renderWrapper(), this.addListeners(), this.subscribeToRealtimeEvents(), this.eventBus.subscribe("realtime.private-mode", this.setParticipantPrivate), this.animationFrame = requestAnimationFrame(this.animate), this.eventBus.subscribe("realtime.go-to-participant", this.goToMouse), this.eventBus.subscribe("realtime.local-follow-participant", this.followMouse);
  }
  destroy() {
    cancelAnimationFrame(this.animationFrame), this.logger.log("presence-mouse component @ destroy"), this.removeListeners(), this.wrapper.remove(), this.presences.clear(), this.presences = void 0, this.container = void 0, this.wrapper = void 0, this.unsubscribeFromRealtimeEvents(), this.eventBus.unsubscribe("realtime.private-mode", this.setParticipantPrivate), this.eventBus.unsubscribe("realtime.go-to-participant", this.goToMouse), this.eventBus.unsubscribe("realtime.local-follow-participant", this.followMouse), this.logger = void 0;
  }
  subscribeToRealtimeEvents() {
    this.logger.log("presence-mouse component @ subscribe to realtime events"), this.room.presence.on(ee.JOINED_ROOM, this.onPresenceJoinedRoom), this.room.presence.on(ee.LEAVE, this.onPresenceLeftRoom), this.room.presence.on(ee.UPDATE, this.onPresenceUpdate);
  }
  unsubscribeFromRealtimeEvents() {
    this.logger.log("presence-mouse component @ unsubscribe from realtime events"), this.room.presence.off(ee.JOINED_ROOM), this.room.presence.off(ee.LEAVE), this.room.presence.off(ee.UPDATE);
  }
  addListeners() {
    this.pointerMoveObserver = Aa(this.container, "pointermove").pipe(p_(30)).subscribe(this.onMyParticipantMouseMove), this.container.addEventListener("pointerleave", this.onMyParticipantMouseLeave);
  }
  removeListeners() {
    var e;
    (e = this.pointerMoveObserver) == null || e.unsubscribe(), this.container.removeEventListener("pointerleave", this.onMyParticipantMouseLeave);
  }
  setPositionNotStatic() {
    let { position: e } = window.getComputedStyle(this.container);
    e === "static" && this.container.style.setProperty("position", "relative");
  }
  createMouseElement(e) {
    if (!this.wrapper) return;
    let t = document.createElement("div");
    t.setAttribute("id", `mouse-${e.id}`), t.setAttribute("class", "mouse-follower");
    let i = document.createElement("div");
    i.setAttribute("class", "pointer-mouse");
    let r = document.createElement("div");
    return r.setAttribute("class", "mouse-user-name"), r.innerHTML = e.name, t.appendChild(i), t.appendChild(r), t.style.left = "0px", t.style.top = "0px", this.wrapper.appendChild(t), this.mouses.set(e.id, t), t;
  }
  updateSVGPosition() {
    let e = this.container.parentElement.getBoundingClientRect(), t = this.container.getBoundingClientRect(), i = t.left - e.left, r = t.top - e.top, { width: o, height: a } = this.container.getBoundingClientRect();
    this.wrapper.style.setProperty("width", `${o}px`), this.wrapper.style.setProperty("height", `${a}px`), this.wrapper.style.setProperty("top", `${r}px`), this.wrapper.style.setProperty("left", `${i}px`);
  }
  createSVGWrapper() {
    let e = document.createElement("div"), t = this.container.parentElement.getBoundingClientRect(), i = this.container.getBoundingClientRect(), r = i.left - t.left, o = i.top - t.top, { width: a, height: u } = this.container.getBoundingClientRect();
    e.style.position = "fixed", e.style.width = `${a}px`, e.style.height = `${u}px`, e.style.top = `${o}px`, e.style.left = `${r}px`, e.style.overflow = "visible", e.style.pointerEvents = "none", e.id = "superviz-svg-wrapper", this.container.parentElement.appendChild(e), this.wrapper = e;
  }
  createRectWrapper() {
    let e = document.createElementNS("http://www.w3.org/2000/svg", "svg"), t = document.createElementNS("http://www.w3.org/2000/svg", "rect"), i = document.createElement("div"), r = this.container.getAttribute("width"), o = this.container.getAttribute("height"), a = this.container.getAttribute("rx"), u = this.container.getAttribute("ry");
    t.setAttribute("fill", "transparent"), t.setAttribute("stroke", "transparent"), t.setAttribute("x", "0"), t.setAttribute("y", "0"), t.setAttribute("rx", a), t.setAttribute("ry", u), t.setAttribute("height", o), t.setAttribute("width", r), e.setAttribute("height", o), e.setAttribute("width", r), e.appendChild(t), i.appendChild(e);
    let c = this.container.getBoundingClientRect();
    i.style.position = "fixed", i.style.top = `${c.top}px`, i.style.left = `${c.left}px`, i.style.width = `${c.width}px`, i.style.height = `${c.height}px`, i.style.overflow = "visible", i.style.pointerEvents = "none", i.id = "superviz-rect-wrapper";
    let p = this.container.viewportElement;
    for (; p.viewportElement; ) p = p.viewportElement;
    p.parentElement.appendChild(i), this.wrapper = i;
  }
  createEllipseWrapper() {
    let e = document.createElementNS("http://www.w3.org/2000/svg", "svg"), t = document.createElementNS("http://www.w3.org/2000/svg", "ellipse"), i = document.createElement("div"), r = this.container.getAttribute("cx"), o = this.container.getAttribute("cy"), a = this.container.getAttribute("rx"), u = this.container.getAttribute("ry"), c = Number(r) - Number(a), p = Number(o) - Number(u), h = String(2 * Number(r)), f = String(2 * Number(o));
    t.setAttribute("fill", "transparent"), t.setAttribute("stroke", "transparent"), t.setAttribute("x", "0"), t.setAttribute("y", "0"), t.setAttribute("rx", a), t.setAttribute("ry", u), t.setAttribute("cx", `${Number(r) - c}`), t.setAttribute("cy", `${Number(o) - p}`), t.setAttribute("height", f), t.setAttribute("width", h), e.setAttribute("height", f), e.setAttribute("width", h), e.appendChild(t), i.appendChild(e);
    let m = this.container.getBoundingClientRect();
    i.style.position = "fixed", i.style.top = `${m.top}px`, i.style.left = `${m.left}px`, i.style.width = `${m.width}px`, i.style.height = `${m.height}px`, i.style.overflow = "visible", i.style.pointerEvents = "none", i.id = "superviz-ellipse-wrapper";
    let y = this.container.viewportElement;
    for (; y.viewportElement; ) y = y.viewportElement;
    y.parentElement.appendChild(i), this.wrapper = i;
  }
  transform(e) {
    var t, i;
    this.transformation = e, this.camera = { x: e.translate.x, y: e.translate.y, scale: e.scale, screen: { width: ((t = this.wrapper) == null ? void 0 : t.clientWidth) || 1, height: ((i = this.wrapper) == null ? void 0 : i.clientHeight) || 1 } }, this.updateParticipantsMouses(true);
  }
  updateVoidElementWrapper() {
    let e = this.container.getBoundingClientRect(), t = this.wrapper.getBoundingClientRect(), i = this.container;
    if ((0, EA.isEqual)(e, t)) return;
    let r = i.offsetLeft, o = i.offsetTop;
    this.wrapper.style.setProperty("width", `${e.width}px`), this.wrapper.style.setProperty("height", `${e.height}px`), this.wrapper.style.setProperty("top", `${o}px`), this.wrapper.style.setProperty("left", `${r}px`), this.wrapper.id = "superviz-void-wrapper";
  }
  updateSVGElementWrapper() {
    let { left: e, top: t, width: i, height: r } = this.container.getBoundingClientRect(), { left: o, top: a, width: u, height: c } = this.wrapper.getBoundingClientRect();
    if (!(e === o && t === a && i === u && r === c)) {
      if (this.containerTagname.toLowerCase() === "svg") {
        this.updateSVGPosition();
        return;
      }
      this.wrapper.style.setProperty("width", `${i}px`), this.wrapper.style.setProperty("height", `${r}px`), this.wrapper.style.setProperty("top", `${t}px`), this.wrapper.style.setProperty("left", `${e}px`);
    }
  }
  renderWrapper() {
    if (!this.wrapper) {
      if (Ja[this.containerTagname]) {
        this.renderVoidElementWrapper();
        return;
      }
      if (Ha[this.containerTagname]) {
        this.renderSVGElementWrapper();
        return;
      }
      this.renderElementWrapper();
    }
  }
  removePresenceMouseParticipant(e) {
    let t = document.getElementById(`mouse-${e}`);
    t && (t.remove(), this.presences.delete(e), this.mouses.delete(e));
  }
  renderElementWrapper() {
    let e = document.createElement("div");
    e.style.position = "absolute", e.style.width = "100%", e.style.height = "100%", e.style.top = "0", e.style.left = "0", e.style.overflow = "visible", e.style.pointerEvents = "none", this.setPositionNotStatic(), this.container.appendChild(e), this.wrapper = e;
  }
};
var AA = class {
  constructor(e, t) {
    let i = document.getElementById(e);
    if (!i) throw new Error(`[Superviz] Container with id ${e} not found`);
    return i.tagName.toLowerCase() === "canvas" ? new CA(e, t) : new PA(e, t);
  }
  transform(e) {
  }
};
O();
O();
var SA = zt(fd());
O();
var OA = class {
  constructor(e) {
    this.room = e, this.logger = new qe("@superviz/sdk/realtime-presence");
  }
  update(e) {
    this.logger.log("Realtime Presence @ update presence", e), this.room.presence.update(e);
  }
  subscribe(e, t) {
    this.logger.log("Realtime Presence @ subscribe", e), this.room.presence.on(e, t);
  }
  unsubscribe(e) {
    this.logger.log("Realtime Presence @ unsubscribe", e), this.room.presence.off(e);
  }
  getAll() {
    return he(this, null, function* () {
      return this.logger.log("Realtime Presence @ get all"), new Promise((e, t) => {
        this.room.presence.get((i) => e(i), (i) => {
          let r = `[SuperViz] ${i.name} - ${i.message}`;
          this.logger.log(i), console.error(r), t(i);
        });
      });
    });
  }
};
var Rh = class extends rl {
  constructor(e, t, i, r) {
    super(), this.state = "DISCONNECTED", this.callbacksToSubscribeWhenJoined = [], this.publish = (0, SA.default)((o, a) => {
      if (this.state !== "CONNECTED") {
        let u = `Realtime channel ${this.name} is not started yet. You can't publish event ${o} before start`;
        this.logger.log(u), console.warn(`[SuperViz] ${u}`);
        return;
      }
      this.channel.emit(`message:${this.name}`, { name: o, payload: a });
    }, 30), this.subscribe = (o, a) => {
      if (this.state !== "CONNECTED") {
        this.callbacksToSubscribeWhenJoined.push({ event: o, callback: a });
        return;
      }
      this.observers[o] || (this.observers[o] = new $e()), this.observers[o].subscribe(a);
    }, this.unsubscribe = (o, a) => {
      var u;
      (u = this.observers[o]) == null || u.unsubscribe(a);
    }, this.fetchHistory = (o) => he(this, null, function* () {
      if (this.state !== "CONNECTED") {
        let a = "Realtime component is not started yet. You can't retrieve history before start";
        return this.logger.log(a), console.warn(`[SuperViz] ${a}`), null;
      }
      return yield new Promise((a, u) => {
        let c = (p) => {
          var h;
          (h = p.events) != null && h.length || a(null);
          let f = p.events.reduce((m, y) => {
            var g;
            return m[y.data.name] || (m[y.data.name] = []), m[y.data.name].push({ data: y.data.payload, connectionId: y.connectionId, name: y.data.name, participantId: (g = y.presence) == null ? void 0 : g.id, timestamp: y.timestamp }), m;
          }, {});
          o && !f[o] && u(new Error(`Event ${o} not found in the history`)), o && a(f[o]), a(f);
        };
        this.channel.history(c);
      });
    }), this.publishEventToClient = (o, a) => {
      var u;
      this.logger.log("realtime channel @ publishEventToClient", { event: o, data: a }), (u = this.observers[o]) == null || u.publish(a);
    }, this.name = e, this.ioc = t, this.logger = new qe("@superviz/sdk/realtime-channel"), this.channel = this.ioc.createRoom(`realtime:${this.name}`, r), this.localParticipant = i, this.subscribeToRealtimeEvents(), this.logger.log("started"), this.participant = new OA(this.channel);
  }
  disconnect() {
    return he(this, null, function* () {
      if (this.state === "DISCONNECTED") {
        this.logger.log("Realtime channel is already disconnected");
        return;
      }
      this.logger.log("destroyed"), this.changeState("DISCONNECTED"), this.channel.disconnect();
    });
  }
  changeState(e) {
    this.logger.log("realtime component @ changeState - state changed", e), this.state = e, this.publishEventToClient("realtime-channel.state-changed", this.state);
  }
  subscribeToRealtimeEvents() {
    this.channel.presence.on(ee.JOINED_ROOM, (e) => {
      e.id === this.localParticipant.id && (this.changeState("CONNECTED"), this.callbacksToSubscribeWhenJoined.forEach(({ event: t, callback: i }) => {
        this.subscribe(t, i);
      }), this.logger.log("joined room"), this.changeState("CONNECTED"));
    }), this.channel.on(`message:${this.name}`, (e) => {
      var t, i;
      this.logger.log("message received", e), this.publishEventToClient(e.data.name, { data: e.data.payload, participantId: (i = (t = e == null ? void 0 : e.presence) == null ? void 0 : t.id) != null ? i : null, name: e.data.name, timestamp: e.timestamp, connectionId: e.connectionId });
    });
  }
};
var TA = class extends Hi {
  constructor() {
    super(), this.state = "STOPPED", this.channels = /* @__PURE__ */ new Map(), this.callbacksToSubscribeWhenJoined = [], this.subscribe = (t, i) => {
      if (!this.channel) {
        this.callbacksToSubscribeWhenJoined.push({ event: t, callback: i });
        return;
      }
      this.channel.subscribe(t, i);
    }, this.publish = (t, i) => {
      var r;
      if (Qa[t.toUpperCase()]) {
        this.channel.publishEventToClient(t, i);
        return;
      }
      (r = this.channel) == null || r.publish(t, i);
    }, this.unsubscribe = (t, i) => {
      var r;
      (r = this.channel) == null || r.unsubscribe(t, i);
    }, this.name = "realtime", this.logger = new qe("@superviz/sdk/realtime-component");
    let { localParticipant: e } = this.useStore("global-store");
    e.subscribe();
  }
  connect(e) {
    if (!this.channel) return new Promise((i) => {
      let { localParticipant: r } = il();
      r.subscribe("connect-after-init", (o) => {
        o.activeComponents.includes("realtime") && (r.unsubscribe("connect-after-init"), i(this.connect(e)));
      });
    });
    let t = this.channels.get(e);
    return t || (t = new Rh(e, this.ioc, this.localParticipant, this.connectionLimit), this.channels.set(e, t), this.state === "STARTED") ? t : new Promise((i) => {
      this.subscribe("realtime-component.state-changed", (r) => {
        r === "STARTED" && i(t);
      });
    });
  }
  start() {
    this.logger.log("started"), this.channel = new Rh("default", this.ioc, this.localParticipant, this.connectionLimit), this.channel.subscribe("realtime-channel.state-changed", (e) => {
      e === "CONNECTED" && (this.callbacksToSubscribeWhenJoined.forEach(({ event: t, callback: i }) => {
        this.channel.subscribe(t, i);
      }), this.changeState("STARTED"), this.callbacksToSubscribeWhenJoined = [], this.channel.unsubscribe("realtime-channel.state-changed"), this.participant = this.channel.participant, this.channels.set("default", this.channel));
    });
  }
  destroy() {
    this.logger.log("destroyed"), this.changeState("STOPPED"), this.disconnectFromAllChannels();
  }
  disconnectFromAllChannels() {
    this.channels.forEach((e) => e.disconnect());
  }
  changeState(e) {
    var t;
    this.logger.log("realtime component @ changeState - state changed", e), this.state = e, (t = this.channel) == null || t.publishEventToClient("realtime-component.state-changed", this.state);
  }
};
O();
var xA = class extends Hi {
  constructor(e) {
    var t;
    super(), this.onParticipantListUpdate = (h) => {
      if (this.localParticipantId === void 0 || this.localParticipantId === "") return;
      if (!this.initialized) {
        this.initialized = true, this.initializeList();
        return;
      }
      let f = de($({}, h.data), { tooltip: this.getTooltipData(h.data), controls: this.getControls(h.data) }), { participants: m, extras: y } = this.useStore("who-is-online-store");
      if (m.value.some(({ id: g }) => g === h.data.id)) {
        this.updateParticipant(f);
        return;
      }
      if (y.value.some(({ id: g }) => g === h.data.id)) {
        this.updateExtra(f);
        return;
      }
      if (m.value.length < 4) {
        m.publish([...m.value, f]);
        return;
      }
      y.publish([...y.value, f]);
    }, this.onParticipantLeave = (h) => {
      let { participants: f, extras: m } = this.useStore("who-is-online-store");
      if (f.value.findIndex((g) => g.id === h.id) === -1) {
        let g = m.value.filter((_) => _.id !== h.id);
        m.publish(g);
        return;
      }
      let y = f.value.filter((g) => g.id !== h.id);
      if (m.value.length) {
        y.push(m.value[0]);
        let g = m.value.slice(1);
        m.publish(g);
      }
      f.publish(y);
    }, this.updateParticipant = (h) => {
      let { participants: f, extras: m } = this.useStore("who-is-online-store");
      if (h.isPrivate && h.id !== this.localParticipantId) {
        let g = f.value.filter(({ id: E }) => E !== h.id), _ = m.value.splice(0, 1);
        f.publish([...g, ..._]), m.publish([...m.value]);
        return;
      }
      let y = f.value.map((g) => g.id === h.id ? h : g);
      f.publish(y);
    }, this.updateExtra = (h) => {
      let { extras: f } = this.useStore("who-is-online-store");
      if (h.isPrivate && h.id !== this.localParticipantId) {
        let y = f.value.filter(({ id: g }) => g !== h.id);
        f.publish(y);
        return;
      }
      let m = f.value.map((y) => y.id === h.id ? h : y);
      f.publish(m);
    }, this.subscribeToLocalParticipantUpdates = (h) => {
      if (!h.slot) return;
      this.localParticipantId = h.id;
      let { privateMode: f, joinedPresence: m } = this.useStore("who-is-online-store"), y = this.isInPresence(h.activeComponents);
      m.publish(y);
      let g = this.getParticipant(h);
      this.room.presence.update(de($({}, g), { isPrivate: f.value }));
    }, this.goToMousePointer = (h) => {
      var f, m, y;
      let g = (y = (f = h.presence) == null ? void 0 : f.id) != null ? y : (m = h.detail) == null ? void 0 : m.id;
      g !== this.localParticipantId && (this.eventBus.publish("realtime.go-to-participant", g), this.publish("who-is-online.go-to-participant", g));
    }, this.followMousePointer = ({ detail: h }) => {
      this.eventBus.publish("realtime.local-follow-participant", h.id), this.following && this.publish("who-is-online.start-following-participant", this.following), this.following || this.publish("who-is-online.stop-following-participant"), h.source === "extras" && this.highlightParticipantBeingFollowed(), this.updateParticipantsControls(h.id);
    }, this.setPrivate = ({ detail: { isPrivate: h, id: f } }) => {
      let { privateMode: m, participants: y } = this.useStore("who-is-online-store"), g = y.value.find((_) => _.id === f);
      m.publish(h), this.eventBus.publish("realtime.private-mode", h), this.room.presence.update(de($({}, g), { isPrivate: h })), h && this.publish("who-is-online.enter-private-mode"), h || this.publish("who-is-online.leave-private-mode");
    }, this.setFollow = (h) => {
      let { id: f } = h.presence;
      if (f === this.localParticipantId) return;
      let { data: m } = h, { following: y } = this.useStore("who-is-online-store");
      y.publish(m), this.followMousePointer({ detail: { id: m } });
    }, this.follow = ({ detail: h }) => {
      let { everyoneFollowsMe: f } = this.useStore("who-is-online-store");
      f.publish(!!(h != null && h.id)), this.room.emit("who-is-online.start-follow-me", h), this.following && this.publish("who-is-online.start-follow-me", this.following), this.following || this.publish("who-is-online.stop-follow-me"), this.updateParticipantsControls(h == null ? void 0 : h.id);
    }, this.stopFollowing = (h) => {
      var f;
      if (h.id !== ((f = this.following) == null ? void 0 : f.id)) return;
      let { following: m } = this.useStore("who-is-online-store");
      m.publish(void 0), this.eventBus.publish("realtime.local-follow-participant", void 0), this.publish("who-is-online.stop-following-participant");
    }, this.gather = (h) => {
      this.room.emit("who-is-online.gather-all", h.detail.id), this.publish("who-is-online.gather-all", h.detail.id);
    }, this.onJoinedRoom = (h) => {
      if (h.id !== this.localParticipantId) return;
      let { localParticipant: f } = this.useStore("global-store");
      f.subscribe(this.subscribeToLocalParticipantUpdates);
    }, this.name = "whoIsOnline", this.logger = new qe("@superviz/sdk/who-is-online-component");
    let { disablePresenceControls: i, disableGoToParticipant: r, disableFollowParticipant: o, disablePrivateMode: a, disableGatherAll: u, disableFollowMe: c, following: p } = this.useStore("who-is-online-store");
    if (p.subscribe(), typeof e != "object") {
      this.position = e ?? "top-right";
      return;
    }
    typeof e == "object" && (this.position = (t = e.position) != null ? t : "top-right", this.setStyles(e.styles), i.publish(e.disablePresenceControls), r.publish(e.disableGoToParticipant), o.publish(e.disableFollowParticipant), a.publish(e.disablePrivateMode), u.publish(e.disableGatherAll), c.publish(e.disableFollowMe));
  }
  start() {
    let { localParticipant: e } = this.useStore("global-store");
    this.localParticipantId = e.value.id, this.subscribeToRealtimeEvents(), this.positionWhoIsOnline(), this.addListeners();
  }
  destroy() {
    this.unsubscribeFromRealtimeEvents(), this.removeListeners(), this.element.remove(), this.element = null, this.initialized = false;
    let { destroy: e } = this.useStore("who-is-online-store");
    e();
  }
  addListeners() {
    this.element.addEventListener("realtime.local-follow-participant", this.followMousePointer), this.element.addEventListener("realtime.go-to-participant", this.goToMousePointer), this.element.addEventListener("realtime.private-mode", this.setPrivate), this.element.addEventListener("realtime.follow-participant", this.follow), this.element.addEventListener("realtime.gather", this.gather);
  }
  removeListeners() {
    this.element.removeEventListener("realtime.local-follow-participant", this.followMousePointer), this.element.removeEventListener("realtime.go-to-participant", this.goToMousePointer), this.element.removeEventListener("realtime.private-mode", this.setPrivate), this.element.removeEventListener("realtime.follow-participant", this.follow), this.element.removeEventListener("realtime.gather", this.gather);
  }
  subscribeToRealtimeEvents() {
    this.room.presence.on(ee.UPDATE, this.onParticipantListUpdate), this.room.presence.on(ee.LEAVE, this.onParticipantLeave), this.room.presence.on(ee.LEAVE, this.stopFollowing), this.room.presence.on(ee.JOINED_ROOM, this.onJoinedRoom), this.room.on("who-is-online.gather-all", this.goToMousePointer), this.room.on("who-is-online.start-follow-me", this.setFollow);
  }
  unsubscribeFromRealtimeEvents() {
    this.room.presence.off(ee.UPDATE), this.room.presence.off(ee.LEAVE), this.room.presence.off(ee.JOINED_ROOM), this.room.off("who-is-online.gather-all", this.goToMousePointer), this.room.off("who-is-online.start-follow-me", this.setFollow);
  }
  initializeList() {
    let { participants: e, extras: t } = this.useStore("who-is-online-store");
    this.room.presence.get((i) => {
      let r = i.filter((c) => c.data.id).map(({ data: c }) => {
        let p = c.avatar;
        p || (p = this.getAvatar({ avatar: c.avatar, color: c.slot.color, name: c.name, letterColor: c.slot.textColor }));
        let h = this.getTooltipData(c), f = this.getControls(c);
        return de($({}, c), { tooltip: h, controls: f, avatar: p, isLocalParticipant: c.id === this.localParticipantId });
      });
      if (!r.length) return;
      let o = r.findIndex((c) => c.id === this.localParticipantId), a = r.splice(o, 1)[0], u = r.splice(0, 3);
      e.publish([a, ...u]), t.publish(r);
    });
  }
  setStyles(e = "") {
    if (!e) return;
    let t = document.createElement("style");
    t.textContent = e, t.id = "superviz-who-is-online-styles", document.head.appendChild(t);
  }
  positionWhoIsOnline() {
    if (this.element = document.createElement("superviz-who-is-online"), Object.values(Jh).includes(this.position.toLowerCase())) {
      document.body.appendChild(this.element);
      let [t, i] = this.position.split("-");
      this.element.position = `${t}: 20px; ${i}: 40px;`;
      return;
    }
    let e = document.getElementById(this.position);
    if (!e) {
      this.element.position = "top: 20px; right: 40px;", document.body.appendChild(this.element);
      return;
    }
    e.appendChild(this.element), this.element.position = "position: relative;";
  }
  getParticipant(e) {
    let { avatar: t, activeComponents: i, id: r, name: o, slot: { color: a, textColor: u } } = e, c = this.shouldDisableDropdown({ activeComponents: i, participantId: r }), p = this.getAvatar({ avatar: t, color: a, name: o, letterColor: u });
    return { id: r, name: o, avatar: p, disableDropdown: c, activeComponents: i, isPrivate: false };
  }
  shouldDisableDropdown({ activeComponents: e, participantId: t }) {
    let { joinedPresence: { value: i }, disablePresenceControls: { value: r }, disableFollowMe: { value: o }, disableFollowParticipant: { value: a }, disableGoToParticipant: { value: u }, disableGatherAll: { value: c }, disablePrivateMode: { value: p } } = this.useStore("who-is-online-store");
    return i === false || r === true || t === this.localParticipantId && o && p && c || t !== this.localParticipantId && a && u ? true : !(e != null && e.some((h) => h.toLowerCase().includes("presence")));
  }
  getTooltipData(e) {
    let { name: t, disableDropdown: i, id: r } = e, o = r === this.localParticipantId, a = { name: t };
    return o && (a.name += " (You)"), !i && !o && (a.info = "Click to follow"), a;
  }
  getAvatar({ avatar: e, color: t, name: i, letterColor: r }) {
    var o, a;
    let u = e == null ? void 0 : e.imageUrl, c = (a = (o = i == null ? void 0 : i.at(0)) == null ? void 0 : o.toUpperCase()) != null ? a : "A";
    return { imageUrl: u, firstLetter: c, color: t, letterColor: r };
  }
  getControls(e) {
    let { disablePresenceControls: t } = this.useStore("who-is-online-store"), { disableDropdown: i, id: r } = e;
    return t.value || i ? [] : r === this.localParticipantId ? this.getLocalParticipantControls() : this.getOtherParticipantsControls(r);
  }
  getOtherParticipantsControls(e) {
    var t;
    let { disableGoToParticipant: i, disableFollowParticipant: r, following: o } = this.useStore("who-is-online-store"), a = [];
    if (i.value || a.push({ label: "go to", icon: "place" }), !r.value) {
      let u = ((t = o.value) == null ? void 0 : t.id) === e, c = u ? "unfollow" : "follow", p = u ? "send-off" : "send";
      a.push({ label: c, icon: p });
    }
    return a;
  }
  getLocalParticipantControls() {
    let { disableFollowMe: { value: e }, disableGatherAll: { value: t }, disablePrivateMode: { value: i }, everyoneFollowsMe: { value: r }, privateMode: { value: o } } = this.useStore("who-is-online-store"), a = [];
    if (t || a.push({ label: "gather all", icon: "gather" }), !e) {
      let u = r ? "send-off" : "send", c = r ? "stop followers" : "everyone follows me";
      a.push({ label: c, icon: u });
    }
    if (!i) {
      let u = o ? "eye_inative" : "eye", c = o ? "leave private mode" : "private mode";
      a.push({ label: c, icon: u });
    }
    return a;
  }
  updateParticipantsControls(e) {
    let { participants: t } = this.useStore("who-is-online-store"), i = t.value.map((r) => {
      if (e && r.id !== e) return r;
      let o = this.getControls(r);
      return de($({}, r), { controls: o });
    });
    t.publish(i);
  }
  highlightParticipantBeingFollowed() {
    let { extras: e, participants: t, following: { value: i } } = this.useStore("who-is-online-store"), r = t.value[0], o = e.value.findIndex((c) => c.id === i.id), a = e.value.splice(o, 1)[0];
    t.value.unshift(r), t.value[1] = a;
    let u = t.value.pop();
    e.value.push(u), e.publish(e.value), t.publish(t.value);
  }
  isInPresence(e) {
    return e == null ? void 0 : e.some((t) => t.includes("presence"));
  }
};
O();
var kA = class extends Hi {
  constructor(e = {}) {
    super(), this.fields = {}, this.fieldsOriginalOutline = {}, this.focusList = {}, this.enabledOutlineFields = {}, this.enabledRealtimeSyncFields = {}, this.flags = {}, this.allowedTagNames = ["input", "textarea"], this.allowedInputTypes = ["text", "email", "date", "color", "datetime-local", "month", "number", "password", "range", "search", "tel", "time", "url", "week", "checkbox", "radio"], this.throwError = { onInvalidFieldsProp: (o) => {
      throw new Error(`"Fields" property must be either a string or an array of strings. Received type: ${o}`);
    }, onFieldNotFound: (o) => {
      throw new Error(`You must pass the id of an existing element. Element with id ${o} not found`);
    }, onInvalidTagName: (o) => {
      throw new Error(`You can't register an element with tag ${o}. Only the tags "${this.allowedTagNames.join(", ")}" are allowed`);
    }, onInvalidInputType: (o) => {
      throw new Error(`You can't register an input element of type ${o}. Only the types "${this.allowedInputTypes.join(", ")}" are allowed`);
    }, onDeregisterInvalidField: (o) => {
      throw new Error(`You can't deregister field of id ${o}. No field was registered with id ${o} `);
    } }, this.sync = (o) => {
      var a, u;
      let c = this.fields[o], p = this.hasCheckedProperty(c), h = { value: p ? c.checked : c.value, color: this.localParticipant.slot.color, fieldId: o, showOutline: this.canUpdateColor(o), syncContent: this.canSyncContent(o), attribute: p ? "checked" : "value" };
      (a = this.room) == null || a.emit("field.content-change" + o, h), (u = this.room) == null || u.emit("field.interaction" + o, h);
    }, this.handleInput = (o) => {
      var a, u, c, p;
      let h = o.target;
      (u = this.room) == null || u.emit("field.interaction" + h.id, { fieldId: h.id, color: (a = this.localParticipant.slot) == null ? void 0 : a.color });
      let f = this.canSyncContent(h.id);
      if (!f) return;
      let m = { value: h.value, color: (c = this.localParticipant.slot) == null ? void 0 : c.color, fieldId: h.id, showOutline: this.canUpdateColor(h.id), syncContent: f, attribute: "value" };
      (p = this.room) == null || p.emit("field.content-change" + h.id, m);
    }, this.handleChange = (o) => {
      var a;
      let u = o.target;
      if (!this.canSyncContent(u.id)) return;
      let c = { fieldId: u.id, value: u.checked, color: this.localParticipant.slot.color, showOutline: this.canUpdateColor(u.id), syncContent: this.canSyncContent(u.id), attribute: "checked" };
      (a = this.room) == null || a.emit("field.content-change" + u.id, c);
    }, this.handleFocus = (o) => {
      var a;
      let u = o.target, c = { color: this.localParticipant.slot.color, fieldId: u.id };
      (a = this.room) == null || a.emit("field.focus" + u.id, c);
    }, this.handleBlur = (o) => {
      var a;
      let u = o.target, c = { fieldId: u.id };
      (a = this.room) == null || a.emit("field.blur" + u.id, c);
    }, this.removeFieldColor = ({ presence: o, data: { fieldId: a } }) => {
      var u, c;
      ((u = this.focusList[a]) == null ? void 0 : u.id) !== o.id || !this.fields[a] || (this.fields[a].style.outline = (c = this.fieldsOriginalOutline[a]) != null ? c : "", delete this.fieldsOriginalOutline[a], delete this.focusList[a]);
    }, this.updateFieldColor = ({ presence: o, data: { color: a, fieldId: u }, timestamp: c }) => {
      var p;
      let h = (p = this.focusList[u]) != null ? p : {}, f = !h.id, m = o.id === this.localParticipant.id;
      if (f && m) {
        this.focusList[u] = { id: o.id, color: a, firstInteraction: c, lastInteraction: c };
        return;
      }
      if (h.id === o.id) {
        this.focusList[u].lastInteraction = c;
        return;
      }
      let y = c - h.lastInteraction >= 3e3, g = c - h.firstInteraction >= 1e4;
      if (!(y || g || f)) return;
      this.focusList[u] = { id: o.id, color: a, firstInteraction: c, lastInteraction: c };
      let _ = m ? this.fieldsOriginalOutline[u] : `1px solid ${a}`;
      this.fields[u].style.outline = _;
    }, this.updateFieldContent = (o) => {
      var a = o, { presence: u, data: { value: c, fieldId: p, color: h, showOutline: f, syncContent: m, attribute: y }, timestamp: g } = a, _ = Hc(a, ["presence", "data", "timestamp"]);
      this.publish("field.content-change", { value: c, fieldId: p, attribute: y, userId: u.id, userName: u.name, timestamp: g }), m && this.canSyncContent(p) && u.id !== this.localParticipant.id && (this.fields[p][y] = c), f && this.canUpdateColor(p) && this.updateFieldColor($({ presence: u, data: { color: h, fieldId: p }, timestamp: g }, _));
    }, this.publishTypedEvent = ({ presence: o, data: { fieldId: a, color: u } }) => {
      this.publish("field.interaction", { fieldId: a, userId: o.id, userName: o.name, color: u });
    }, this.canSyncContent = (o) => !this.flags.disableRealtimeSync && this.enabledRealtimeSyncFields[o] !== false || !!this.enabledRealtimeSyncFields[o], this.name = "formElements", this.logger = new qe("@superviz/sdk/presence-input-component");
    let t = e, { fields: i } = t, r = Hc(t, ["fields"]);
    if (this.flags = r ?? {}, typeof i == "string") {
      this.validateField(i), this.fields[i] = null;
      return;
    }
    if (Array.isArray(i)) {
      i.forEach((o) => {
        this.validateField(o), this.fields[o] = null;
      });
      return;
    }
    i !== void 0 && this.throwError.onInvalidFieldsProp(typeof i);
  }
  enableOutline(e) {
    let t = this.fields[e];
    t && (this.enabledOutlineFields[e] = true, this.fieldsOriginalOutline[e] = t.style.outline, t.addEventListener("focus", this.handleFocus), t.addEventListener("blur", this.handleBlur), this.room.on("field.focus" + e, this.updateFieldColor), this.room.on("field.blur" + e, this.removeFieldColor));
  }
  disableOutline(e) {
    var t, i;
    let r = this.fields[e];
    r && (this.enabledOutlineFields[e] = false, r.style.outline = (t = this.fieldsOriginalOutline[e]) != null ? t : "", r.removeEventListener("focus", this.handleFocus), r.removeEventListener("blur", this.handleBlur), this.room.off("field.focus" + e, this.updateFieldColor), this.room.off("field.blur" + e, this.removeFieldColor), (i = this.room) == null || i.emit("field.blur" + e, { fieldId: e }));
  }
  enableRealtimeSync(e) {
    this.enabledRealtimeSyncFields[e] = true;
  }
  disableRealtimeSync(e) {
    this.enabledRealtimeSyncFields[e] = false;
  }
  registerField(e) {
    this.validateField(e);
    let t = document.getElementById(e);
    this.fields[e] = t, this.addListenersToField(t), this.addRealtimeListenersToField(e), this.fieldsOriginalOutline[e] = t.style.outline;
  }
  deregisterField(e) {
    var t;
    this.fields[e] || this.throwError.onDeregisterInvalidField(e), this.removeListenersFromField(this.fields[e]), this.removeRealtimeListenersFromField(e), this.fields[e].style.outline = this.fieldsOriginalOutline[e], this.fields[e] = void 0, delete this.enabledOutlineFields[e], delete this.enabledRealtimeSyncFields[e], delete this.fieldsOriginalOutline[e], delete this.focusList[e], (t = this.room) == null || t.emit("field.blur" + e, { fieldId: e });
  }
  start() {
    let { localParticipant: e } = this.useStore("global-store");
    e.subscribe(), Object.entries(this.fields).forEach(([t]) => {
      this.registerField(t);
    });
  }
  destroy() {
    this.restoreOutlines(), this.deregisterAllFields(), this.fieldsOriginalOutline = void 0, this.focusList = void 0;
  }
  addListenersToField(e) {
    this.hasCheckedProperty(e) ? e.addEventListener("change", this.handleChange) : e.addEventListener("input", this.handleInput), !this.flags.disableOutline && (e.addEventListener("focus", this.handleFocus), e.addEventListener("blur", this.handleBlur));
  }
  addRealtimeListenersToField(e) {
    this.room && (this.room.on("field.content-change" + e, this.updateFieldContent), this.room.on("field.interaction" + e, this.publishTypedEvent), !this.flags.disableOutline && (this.room.on("field.focus" + e, this.updateFieldColor), this.room.on("field.blur" + e, this.removeFieldColor)));
  }
  removeListenersFromField(e) {
    this.hasCheckedProperty(e) ? e.removeEventListener("change", this.handleChange) : e.removeEventListener("input", this.handleInput), !this.flags.disableOutline && (e.removeEventListener("focus", this.handleFocus), e.removeEventListener("blur", this.handleBlur));
  }
  removeRealtimeListenersFromField(e) {
    this.room && (this.room.off("field.content-change" + e, this.updateFieldContent), this.room.off("field.interaction" + e, this.publishTypedEvent), !this.flags.disableOutline && (this.room.off("field.focus" + e, this.updateFieldColor), this.room.off("field.blur" + e, this.removeFieldColor)));
  }
  deregisterAllFields() {
    Object.keys(this.fields).forEach((e) => {
      this.deregisterField(e);
    }), this.fields = void 0;
  }
  validateField(e) {
    this.validateFieldId(e);
    let t = document.getElementById(e);
    this.validateFieldTagName(t), this.validateFieldType(t);
  }
  validateFieldTagName(e) {
    let t = e.tagName.toLowerCase();
    this.allowedTagNames.includes(t) || (this.logger.log("invalid element tagname"), this.throwError.onInvalidTagName(t));
  }
  validateFieldType(e) {
    if (e.tagName.toLowerCase() !== "input") return;
    let t = e.getAttribute("type"), i = this.allowedInputTypes.includes(t);
    t && !i && (this.logger.log("invalid input type"), this.throwError.onInvalidInputType(t));
  }
  validateFieldId(e) {
    document.getElementById(e) || this.throwError.onFieldNotFound(e);
  }
  restoreOutlines() {
    Object.entries(this.fields).forEach(([e]) => {
      this.fields[e].style.outline = this.fieldsOriginalOutline[e];
    });
  }
  hasCheckedProperty(e) {
    let t = e.tagName.toLowerCase(), i = e.getAttribute("type");
    return t === "input" && (i === "radio" || i === "checkbox");
  }
  canUpdateColor(e) {
    return !this.flags.disableOutline && this.enabledOutlineFields[e] !== false || this.enabledOutlineFields[e];
  }
};
typeof window < "u" && (window.SuperVizRoom = { init: lp, CommentEvent: Gh, MeetingEvent: Dh, DeviceEvent: Vh, RealtimeEvent: Uh, MeetingState: $h, MeetingConnectionStatus: Wh, MeetingControlsEvent: Bh, ParticipantEvent: zh, FrameEvent: jh, LayoutMode: cp, VideoConference: wA, MousePointers: AA, Realtime: TA, Comments: lA, CanvasPin: uA, HTMLPin: hA, WhoIsOnline: xA, FormElements: kA, ParticipantType: ap, LayoutPosition: up, CamerasPosition: hp, RealtimeComponentState: dp, RealtimeComponentEvent: pp, ComponentLifeCycleEvent: Qa, WhoIsOnlineEvent: Zh, StoreType: Kh, PresenceEvents: ee, FieldEvents: fp, PinMode: qh, Comment });
var XA = lp;
var IA = Object.create;
var fl = Object.defineProperty;
var MA = Object.defineProperties;
var RA = Object.getOwnPropertyDescriptor;
var FA = Object.getOwnPropertyDescriptors;
var mp = Object.getOwnPropertyNames;
var Fh = Object.getOwnPropertySymbols;
var LA = Object.getPrototypeOf;
var vp = Object.prototype.hasOwnProperty;
var NA = Object.prototype.propertyIsEnumerable;
var Lh = (e, t, i) => t in e ? fl(e, t, { enumerable: true, configurable: true, writable: true, value: i }) : e[t] = i;
var Wi = (e, t) => {
  for (var i in t || (t = {}))
    vp.call(t, i) && Lh(e, i, t[i]);
  if (Fh)
    for (var i of Fh(t))
      NA.call(t, i) && Lh(e, i, t[i]);
  return e;
};
var ys = (e, t) => MA(e, FA(t));
var ml = (e, t) => function() {
  return t || (0, e[mp(e)[0]])((t = { exports: {} }).exports, t), t.exports;
};
var DA = (e, t, i, r) => {
  if (t && typeof t == "object" || typeof t == "function")
    for (let o of mp(t))
      !vp.call(e, o) && o !== i && fl(e, o, { get: () => t[o], enumerable: !(r = RA(t, o)) || r.enumerable });
  return e;
};
var jA = (e, t, i) => (i = e != null ? IA(LA(e)) : {}, DA(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  fl(i, "default", { value: e, enumerable: true }),
  e
));
var gp = (e, t, i) => new Promise((r, o) => {
  var a = (p) => {
    try {
      c(i.next(p));
    } catch (h) {
      o(h);
    }
  }, u = (p) => {
    try {
      c(i.throw(p));
    } catch (h) {
      o(h);
    }
  }, c = (p) => p.done ? r(p.value) : Promise.resolve(p.value).then(a, u);
  c((i = i.apply(e, t)).next());
});
var BA = ml({
  "../../node_modules/.pnpm/ms@2.1.3/node_modules/ms/index.js"(e, t) {
    var i = 1e3, r = i * 60, o = r * 60, a = o * 24, u = a * 7, c = a * 365.25;
    t.exports = function(y, g) {
      g = g || {};
      var _ = typeof y;
      if (_ === "string" && y.length > 0)
        return p(y);
      if (_ === "number" && isFinite(y))
        return g.long ? f(y) : h(y);
      throw new Error(
        "val is not a non-empty string or a valid number. val=" + JSON.stringify(y)
      );
    };
    function p(y) {
      if (y = String(y), !(y.length > 100)) {
        var g = /^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(
          y
        );
        if (g) {
          var _ = parseFloat(g[1]), E = (g[2] || "ms").toLowerCase();
          switch (E) {
            case "years":
            case "year":
            case "yrs":
            case "yr":
            case "y":
              return _ * c;
            case "weeks":
            case "week":
            case "w":
              return _ * u;
            case "days":
            case "day":
            case "d":
              return _ * a;
            case "hours":
            case "hour":
            case "hrs":
            case "hr":
            case "h":
              return _ * o;
            case "minutes":
            case "minute":
            case "mins":
            case "min":
            case "m":
              return _ * r;
            case "seconds":
            case "second":
            case "secs":
            case "sec":
            case "s":
              return _ * i;
            case "milliseconds":
            case "millisecond":
            case "msecs":
            case "msec":
            case "ms":
              return _;
            default:
              return;
          }
        }
      }
    }
    function h(y) {
      var g = Math.abs(y);
      return g >= a ? Math.round(y / a) + "d" : g >= o ? Math.round(y / o) + "h" : g >= r ? Math.round(y / r) + "m" : g >= i ? Math.round(y / i) + "s" : y + "ms";
    }
    function f(y) {
      var g = Math.abs(y);
      return g >= a ? m(y, g, a, "day") : g >= o ? m(y, g, o, "hour") : g >= r ? m(y, g, r, "minute") : g >= i ? m(y, g, i, "second") : y + " ms";
    }
    function m(y, g, _, E) {
      var R = g >= _ * 1.5;
      return Math.round(y / _) + " " + E + (R ? "s" : "");
    }
  }
});
var UA = ml({
  "../../node_modules/.pnpm/debug@4.3.7/node_modules/debug/src/common.js"(e, t) {
    function i(r) {
      a.debug = a, a.default = a, a.coerce = m, a.disable = p, a.enable = c, a.enabled = h, a.humanize = BA(), a.destroy = y, Object.keys(r).forEach((g) => {
        a[g] = r[g];
      }), a.names = [], a.skips = [], a.formatters = {};
      function o(g) {
        let _ = 0;
        for (let E = 0; E < g.length; E++)
          _ = (_ << 5) - _ + g.charCodeAt(E), _ |= 0;
        return a.colors[Math.abs(_) % a.colors.length];
      }
      a.selectColor = o;
      function a(g) {
        let _, E = null, R, N;
        function j(...B) {
          if (!j.enabled)
            return;
          const K = j, ie = Number(/* @__PURE__ */ new Date()), we = ie - (_ || ie);
          K.diff = we, K.prev = _, K.curr = ie, _ = ie, B[0] = a.coerce(B[0]), typeof B[0] != "string" && B.unshift("%O");
          let pe = 0;
          B[0] = B[0].replace(/%([a-zA-Z%])/g, (Le, Oe) => {
            if (Le === "%%")
              return "%";
            pe++;
            const xe = a.formatters[Oe];
            if (typeof xe == "function") {
              const tt = B[pe];
              Le = xe.call(K, tt), B.splice(pe, 1), pe--;
            }
            return Le;
          }), a.formatArgs.call(K, B), (K.log || a.log).apply(K, B);
        }
        return j.namespace = g, j.useColors = a.useColors(), j.color = a.selectColor(g), j.extend = u, j.destroy = a.destroy, Object.defineProperty(j, "enabled", {
          enumerable: true,
          configurable: false,
          get: () => E !== null ? E : (R !== a.namespaces && (R = a.namespaces, N = a.enabled(g)), N),
          set: (B) => {
            E = B;
          }
        }), typeof a.init == "function" && a.init(j), j;
      }
      function u(g, _) {
        const E = a(this.namespace + (typeof _ > "u" ? ":" : _) + g);
        return E.log = this.log, E;
      }
      function c(g) {
        a.save(g), a.namespaces = g, a.names = [], a.skips = [];
        let _;
        const E = (typeof g == "string" ? g : "").split(/[\s,]+/), R = E.length;
        for (_ = 0; _ < R; _++)
          E[_] && (g = E[_].replace(/\*/g, ".*?"), g[0] === "-" ? a.skips.push(new RegExp("^" + g.slice(1) + "$")) : a.names.push(new RegExp("^" + g + "$")));
      }
      function p() {
        const g = [
          ...a.names.map(f),
          ...a.skips.map(f).map((_) => "-" + _)
        ].join(",");
        return a.enable(""), g;
      }
      function h(g) {
        if (g[g.length - 1] === "*")
          return true;
        let _, E;
        for (_ = 0, E = a.skips.length; _ < E; _++)
          if (a.skips[_].test(g))
            return false;
        for (_ = 0, E = a.names.length; _ < E; _++)
          if (a.names[_].test(g))
            return true;
        return false;
      }
      function f(g) {
        return g.toString().substring(2, g.toString().length - 2).replace(/\.\*\?$/, "*");
      }
      function m(g) {
        return g instanceof Error ? g.stack || g.message : g;
      }
      function y() {
        console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");
      }
      return a.enable(a.load()), a;
    }
    t.exports = i;
  }
});
var $A = ml({
  "../../node_modules/.pnpm/debug@4.3.7/node_modules/debug/src/browser.js"(e, t) {
    e.formatArgs = r, e.save = o, e.load = a, e.useColors = i, e.storage = u(), e.destroy = /* @__PURE__ */ (() => {
      let p = false;
      return () => {
        p || (p = true, console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."));
      };
    })(), e.colors = [
      "#0000CC",
      "#0000FF",
      "#0033CC",
      "#0033FF",
      "#0066CC",
      "#0066FF",
      "#0099CC",
      "#0099FF",
      "#00CC00",
      "#00CC33",
      "#00CC66",
      "#00CC99",
      "#00CCCC",
      "#00CCFF",
      "#3300CC",
      "#3300FF",
      "#3333CC",
      "#3333FF",
      "#3366CC",
      "#3366FF",
      "#3399CC",
      "#3399FF",
      "#33CC00",
      "#33CC33",
      "#33CC66",
      "#33CC99",
      "#33CCCC",
      "#33CCFF",
      "#6600CC",
      "#6600FF",
      "#6633CC",
      "#6633FF",
      "#66CC00",
      "#66CC33",
      "#9900CC",
      "#9900FF",
      "#9933CC",
      "#9933FF",
      "#99CC00",
      "#99CC33",
      "#CC0000",
      "#CC0033",
      "#CC0066",
      "#CC0099",
      "#CC00CC",
      "#CC00FF",
      "#CC3300",
      "#CC3333",
      "#CC3366",
      "#CC3399",
      "#CC33CC",
      "#CC33FF",
      "#CC6600",
      "#CC6633",
      "#CC9900",
      "#CC9933",
      "#CCCC00",
      "#CCCC33",
      "#FF0000",
      "#FF0033",
      "#FF0066",
      "#FF0099",
      "#FF00CC",
      "#FF00FF",
      "#FF3300",
      "#FF3333",
      "#FF3366",
      "#FF3399",
      "#FF33CC",
      "#FF33FF",
      "#FF6600",
      "#FF6633",
      "#FF9900",
      "#FF9933",
      "#FFCC00",
      "#FFCC33"
    ];
    function i() {
      if (typeof window < "u" && window.process && (window.process.type === "renderer" || window.process.__nwjs))
        return true;
      if (typeof navigator < "u" && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))
        return false;
      let p;
      return typeof document < "u" && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance || // Is firebug? http://stackoverflow.com/a/398120/376773
      typeof window < "u" && window.console && (window.console.firebug || window.console.exception && window.console.table) || // Is firefox >= v31?
      // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages
      typeof navigator < "u" && navigator.userAgent && (p = navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)) && parseInt(p[1], 10) >= 31 || // Double check webkit in userAgent just in case we are in a worker
      typeof navigator < "u" && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/);
    }
    function r(p) {
      if (p[0] = (this.useColors ? "%c" : "") + this.namespace + (this.useColors ? " %c" : " ") + p[0] + (this.useColors ? "%c " : " ") + "+" + t.exports.humanize(this.diff), !this.useColors)
        return;
      const h = "color: " + this.color;
      p.splice(1, 0, h, "color: inherit");
      let f = 0, m = 0;
      p[0].replace(/%[a-zA-Z%]/g, (y) => {
        y !== "%%" && (f++, y === "%c" && (m = f));
      }), p.splice(m, 0, h);
    }
    e.log = console.debug || console.log || (() => {
    });
    function o(p) {
      try {
        p ? e.storage.setItem("debug", p) : e.storage.removeItem("debug");
      } catch {
      }
    }
    function a() {
      let p;
      try {
        p = e.storage.getItem("debug");
      } catch {
      }
      return !p && typeof process < "u" && "env" in process && (p = process.env.DEBUG), p;
    }
    function u() {
      try {
        return localStorage;
      } catch {
      }
    }
    t.exports = UA()(e);
    var { formatters: c } = t.exports;
    c.j = function(p) {
      try {
        return JSON.stringify(p);
      } catch (h) {
        return "[UnexpectedJSONParseError]: " + h.message;
      }
    };
  }
});
var _a = () => /* @__PURE__ */ new Map();
var zA = (e, t, i) => {
  let r = e.get(t);
  return r === void 0 && e.set(t, r = i()), r;
};
var WA = () => /* @__PURE__ */ new Set();
var VA = Array.from;
var yp = class {
  constructor() {
    this._observers = _a();
  }
  /**
   * @template {keyof EVENTS & string} NAME
   * @param {NAME} name
   * @param {EVENTS[NAME]} f
   */
  on(e, t) {
    return zA(
      this._observers,
      /** @type {string} */
      e,
      WA
    ).add(t), t;
  }
  /**
   * @template {keyof EVENTS & string} NAME
   * @param {NAME} name
   * @param {EVENTS[NAME]} f
   */
  once(e, t) {
    const i = (...r) => {
      this.off(
        e,
        /** @type {any} */
        i
      ), t(...r);
    };
    this.on(
      e,
      /** @type {any} */
      i
    );
  }
  /**
   * @template {keyof EVENTS & string} NAME
   * @param {NAME} name
   * @param {EVENTS[NAME]} f
   */
  off(e, t) {
    const i = this._observers.get(e);
    i !== void 0 && (i.delete(t), i.size === 0 && this._observers.delete(e));
  }
  /**
   * Emit a named event. All registered event listeners that listen to the
   * specified name will receive the event.
   *
   * @todo This should catch exceptions
   *
   * @template {keyof EVENTS & string} NAME
   * @param {NAME} name The event name.
   * @param {Parameters<EVENTS[NAME]>} args The arguments that are applied to the event listener.
   */
  emit(e, t) {
    return VA((this._observers.get(e) || _a()).values()).forEach((i) => i(...t));
  }
  destroy() {
    this._observers = _a();
  }
};
var GA = class extends yp {
  constructor(e, t) {
    super(), this.doc = e, this.logger = t, this.clientID = 0, this.states = /* @__PURE__ */ new Map(), this._checkInterval = null, this.meta = /* @__PURE__ */ new Map(), this.participantIdToClientId = /* @__PURE__ */ new Map(), this.room = null, this.TIMEOUT_TIMER_MS = 3e4, this.YJS_STATE = "__yjs", this.previousState = null, this.participantId = "", this.setLocalState = (i) => {
      var r, o;
      if (this.logger.log("[SuperViz | Awareness] - Set local state", i), i === null) {
        if (!this.states.has(this.clientID)) return;
        this.states.delete(this.clientID), (r = this.room) == null || r.presence.update(ys(Wi({}, this.states.get(this.clientID)), {
          [this.YJS_STATE]: null,
          origin: "set local state null"
        }));
        const p = { added: [], updated: [], removed: [this.clientID] };
        this.emit("change", [
          p,
          "local"
          /* LOCAL */
        ]);
        return;
      }
      const a = { added: [], updated: [], removed: [] };
      let u = this.states.get(this.clientID);
      u ? a.updated.push(this.clientID) : (u = { [this.YJS_STATE]: {}, clientID: this.clientID }, a.added.push(this.clientID));
      const c = ys(Wi({}, u), { [this.YJS_STATE]: i, origin: "set local state" });
      this.states.set(this.clientID, c), (o = this.room) == null || o.presence.update(c), this.emit("change", [
        a,
        "local"
        /* LOCAL */
      ]);
    }, this.onLeave = (i) => {
      const r = this.participantIdToClientId.get(i.id);
      if (this.logger.log("[SuperViz | Awareness] - Participant left", { participant: i, clientID: r }), !r) return;
      if (r === this.clientID) {
        const a = Array.from(this.states.keys());
        this.removeAwarenessStates(
          a,
          "presence"
          /* PRESENCE */
        );
        return;
      }
      const o = { added: [], updated: [], removed: [r] };
      this.participantIdToClientId.delete(i.id), this.states.delete(r), this.emit("update", [
        o,
        "presence"
        /* PRESENCE */
      ]), this.emit("change", [
        o,
        "presence"
        /* PRESENCE */
      ]);
    }, this.onUpdate = (i) => {
      if (i.id === this.participantId) return;
      if (this.logger.log("[SuperViz | Awareness] - Participant updated", i), i.data[this.YJS_STATE] === null) {
        this.removeAwarenessStates(
          [i.data.clientID],
          "presence"
          /* PRESENCE */
        );
        return;
      }
      const r = [], o = [];
      let a = this.participantIdToClientId.get(i.id);
      a ? o.push(i.data.clientID) : (this.participantIdToClientId.set(i.id, i.data.clientID), a = i.data.clientID, r.push(i.data.clientID)), this.states.set(a, Wi(Wi({}, this.states.get(a) || {}), i.data)), this.emit("update", [
        { added: r, updated: o, removed: [] },
        "presence"
        /* PRESENCE */
      ]), this.emit("change", [
        { added: r, updated: o, removed: [] },
        "presence"
        /* PRESENCE */
      ]);
    }, this.onVisibilityChange = () => {
      if (document.visibilityState === "visible") {
        clearTimeout(this.visibilityTimeout), this.previousState && (this.setLocalState(this.previousState), this.previousState = null);
        return;
      }
      this.visibilityTimeout = setTimeout(() => {
        this.previousState = this.getLocalState(), this.setLocalState(null);
      }, this.TIMEOUT_TIMER_MS);
    }, this.clientID = this.doc.clientID;
  }
  /**
   * @function connect
   * @description Start the awareness service
   * @param {RealtimeRoom} room Main room in which it will propagate presence
   * @returns {void}
   */
  connect(e, t) {
    this.logger.log("[SuperViz | Awareness] - Connect awareness to room"), this.participantId = e, this.room = t, this.addRoomListeners(), this.addDocumentListeners(), this.initializePresences();
  }
  // #region public methods
  /**
   * @function destroy
   * @description Destroy the awareness service and clean up all the listeners, states, etc
   * @returns {void}
   */
  destroy() {
    this.logger.log("[SuperViz | Awareness] - Destroy awareness"), this.setLocalState(null), this.removeAwarenessStates(
      Array.from(this.states.keys()),
      "local"
      /* LOCAL */
    ), clearTimeout(this.visibilityTimeout), this.visibilityTimeout = void 0, this.removeDocumentListeners(), this.removeRoomListeners(), this.room = null, this.states.clear(), this.participantIdToClientId.clear(), this.onLeave({ id: this.participantId });
  }
  /**
   * @function getLocalState
   * @description Get the local state of the current participant, stores in the field yjs_state
   * @returns
   */
  getLocalState() {
    var e;
    this.logger.log(
      "[SuperViz | Awareness] - Get local state",
      (e = this.states.get(this.clientID)) == null ? void 0 : e[this.YJS_STATE]
    );
    const t = this.states.get(this.clientID);
    return !t || !t[this.YJS_STATE] ? null : t[this.YJS_STATE];
  }
  getStates() {
    const e = /* @__PURE__ */ new Map();
    return this.states.forEach((t, i) => {
      e.set(i, t[this.YJS_STATE]);
    }), this.logger.log("[SuperViz | Awareness] - Get states", e), e;
  }
  setLocalStateField(e, t) {
    this.logger.log("[SuperViz | Awareness] - Set local state field", { field: e, value: t });
    const i = this.getLocalState();
    this.setLocalState(ys(Wi({}, i || {}), {
      [e]: t
    }));
  }
  // #region events listeners
  addRoomListeners() {
    this.room.presence.on("presence.update", this.onUpdate), this.room.presence.on("presence.leave", this.onLeave);
  }
  removeRoomListeners() {
    this.room.presence.off("presence.update"), this.room.presence.off("presence.leave");
  }
  addDocumentListeners() {
    document.addEventListener("visibilitychange", this.onVisibilityChange);
  }
  removeDocumentListeners() {
    document.removeEventListener("visibilitychange", this.onVisibilityChange);
  }
  // #region private methods
  initializePresences() {
    this.room.presence.get((e) => {
      const t = [];
      e.forEach((o) => {
        const { clientID: a } = o.data;
        a && (t.push(a), this.participantIdToClientId.set(o.id, a), this.states.set(a, Wi({}, o.data)));
      });
      const { clientID: i } = this.doc;
      this.room.presence.update(ys(Wi({
        clientID: i,
        [this.YJS_STATE]: {}
      }, this.states.get(i) || {}), {
        origin: "on connect"
      }));
      const r = { added: t, updated: [], removed: [] };
      this.emit("change", [
        r,
        "presence"
        /* PRESENCE */
      ]);
    });
  }
  removeAwarenessStates(e, t) {
    this.logger.log("[SuperViz | Awareness] - Remove awareness states", { removed: e, origin: t });
    const i = { added: [], updated: [], removed: [] };
    e.forEach((r) => {
      this.states.get(r) && (this.states.delete(r), i.removed.push(r));
    }), this.emit("change", [i, t]);
  }
};
var ZA = jA($A());
var JA = class {
  constructor(e, t) {
    this.prefix = t, this.debug = (0, ZA.default)(e);
  }
  log(e, ...t) {
    this.debug(`${this.prefix} -`, e, ...t);
  }
};
function HA(e, t) {
  return gp(this, null, function* () {
    try {
      const i = yield fetch(`https://io.superviz.com/yjs/${e}:yjs-provider`, {
        headers: {
          "sv-api-key": t
        }
      });
      return i.status !== 200 ? [] : (yield i.json()).events.map((o) => new Uint8Array(o.update.data));
    } catch {
      return [];
    }
  });
}
var qA = {
  GLOBAL: "global-store"
};
var KA = class extends yp {
  constructor(e, t) {
    super(), this.doc = e, this.name = "yjsProvider", this._synced = false, this.state = "provider.disconnected", this.isAttached = false, this.localParticipant = null, this.room = null, this.ioc = null, this.fetch = () => gp(this, null, function* () {
      this.logger.log("Fetching the document"), this._synced = false;
      const i = yield HA(this.roomId, this.ioc.client.apiKey);
      this._synced = true, i.length && applyUpdateV2(this.doc, mergeUpdatesV2(i));
    }), this.updateDocument = (i) => {
      this.logger.log("Applying remote update", i), applyUpdateV2(this.doc, i, this);
    }, this.onDocUpdate = (i) => {
      this.logger.log("Local document update", i), this.beforeSendRealtimeMessage("provider.update", { update: i }), this.room.emit("provider.update", { update: i });
    }, this.onLocalJoinRoom = (i) => {
      var r;
      if (this.state === "provider.connected" || i.id !== this.localParticipant.id) return;
      this.logger.log("Joined the room", i), (r = this.awareness) == null || r.connect(this.localParticipant.id, this.room), this.changeState(
        "provider.connected"
        /* CONNECTED */
      ), this.emit("connect", []);
      const o = encodeStateAsUpdateV2(this.doc);
      this.beforeSendRealtimeMessage("provider.update", { update: o }), this.room.emit("provider.update", { update: o }), this.fetch();
    }, this.onConnectionChange = (i) => {
      i.state === "DISCONNECTED" && (this.logger.log("Disconnected from the room"), this.emit("disconnect", []));
    }, this.onRemoteDocUpdate = (i) => {
      var r;
      if (((r = i.presence) == null ? void 0 : r.id) === this.localParticipant.id) return;
      this.logger.log("Received remote document update", i);
      const o = new Uint8Array(i.data.update);
      this.onReceiveRealtimeMessage("provider.update", { update: o }), this.updateDocument(o);
    }, this.onReceiveRealtimeMessage = (i, r) => {
      this.logger.log("Received message from room", { name: i, data: r }), this.emit("message", [{ name: i, data: r }]);
    }, this.beforeSendRealtimeMessage = (i, r) => {
      this.logger.log("Sending message to room", { name: i, data: r }), this.emit("outgoingMessage", [{ name: i, data: r }]);
    }, this.document = e, this.logger = new JA("SuperVizYjsProvider", "[SuperViz | YjsProvider] - "), (t == null ? void 0 : t.awareness) !== false && (this.awareness = new GA(this.doc, this.logger));
  }
  // #region Public methods
  /**
   * @function attach
   */
  attach(e) {
    if (Object.values(e).includes(null) || Object.values(e).includes(void 0)) {
      const c = `${this.name} @ attach - params are required`;
      throw this.logger.log(c), new Error(c);
    }
    const { useStore: t, ioc: i, config: r } = e, { isDomainWhitelisted: o, hasJoinedRoom: a, localParticipant: u } = t(qA.GLOBAL);
    if (!o.value) {
      const c = `Component ${this.name} can't be used because this website's domain is not whitelisted. Please add your domain in https://dashboard.superviz.com/developer`;
      this.logger.log(c);
      return;
    }
    if (!a.value) {
      a.subscribe(() => this.attach(e));
      return;
    }
    this.roomId = r.roomId, this.ioc = i, this.localParticipant = u.value, this.isAttached = true, this.connect(), this.emit("mount", []);
  }
  detach() {
    if (!this.isAttached) {
      this.logger.log(`${this.name} @ detach - component is not attached`);
      return;
    }
    this.logger.log("detached"), this.destroyProvider(), super.destroy(), this.emit("unmount", []);
  }
  /**
   * @function connect
   * @description Connect to the room. With this, start to send and
   * receive awareness and document updates. This method is called
   * automatically when a SuperVizYjsProvider instance is created,
   * unless opted-out by passing "connect: false" in the constructor
   * options. Can't connect if it is already connected
   * @emits state
   * @returns {void}
   */
  connect() {
    this.state === "provider.disconnected" && (this.logger.log("Connecting to the room"), this.changeState(
      "provider.connecting"
      /* CONNECTING */
    ), this.doc.on("updateV2", this.onDocUpdate), this.startRealtime());
  }
  /**
   * @function destroy
   * @description Disconnect from the room and reset the instance state.
   * @emits state @returns {void}
   */
  destroyProvider() {
    var e;
    if (this.state === "provider.disconnected") {
      this.logger.log("Can't destroy. Provider disconnected");
      return;
    }
    this.logger.log("Destroying the provider"), this.emit("destroy", []), this._synced = false, (e = this.awareness) == null || e.destroy(), this.doc.off("updateV2", this.onDocUpdate), this.removeRoomListeners(), this.room && (this.room.disconnect(), this.room = null), this.changeState(
      "provider.disconnected"
      /* DISCONNECTED */
    );
  }
  /**
   * @type {boolean}
   * @description Whether the user is connected to the room or not
   */
  get synced() {
    return this._synced;
  }
  // #region Private methods
  /**
   * @function createRoom
   * @description Create a new room and set the realtime and room instances
   * @returns {void}
   */
  createRoom() {
    this.logger.log("Creating room"), this.room = this.ioc.createRoom("yjs-provider");
  }
  /**
   * @function addRoomListeners
   * @description Add listeners to the room instance
   * @returns {void}
   */
  addRoomListeners() {
    this.logger.log("Adding room listeners"), this.room.on("provider.update", this.onRemoteDocUpdate), this.room.presence.on("presence.joined-room", this.onLocalJoinRoom), this.ioc.client.connection.on(this.onConnectionChange);
  }
  /**
   * @function removeRoomListeners
   * @description Remove listeners from the room instance
   * @returns {void}
   */
  removeRoomListeners() {
    var e;
    this.logger.log("Removing room listeners"), this.room && (this.room.off("provider.update", this.onRemoteDocUpdate), this.room.presence.off("presence.joined-room")), (e = this.ioc) == null || e.client.connection.off();
  }
  /**
   * @function startRealtime
   * @description Start the real-time connection with the room
   * @returns {void}
   */
  startRealtime() {
    this.createRoom(), this.addRoomListeners();
  }
  /**
   * @function changeState
   * @description Change the state of the provider
   * @param {ProviderState | `${ProviderState}`} state The new state
   * @returns {void}
   */
  changeState(e) {
    this.logger.log("Changing state", e), this.emit("state", [e]), this.state = e;
  }
};
typeof window < "u" && (window.SuperVizYjsProvider = KA);

export {
  YA,
  $,
  de,
  Hc,
  QA,
  he,
  O,
  Dh,
  jh,
  zh,
  Qa,
  Jt,
  Q,
  st,
  ee,
  dp,
  pp,
  lA,
  uA,
  hA,
  wA,
  AA,
  TA,
  xA,
  kA,
  XA,
  KA
};
/*! Bundled license information:

@superviz/react-sdk/dist/index-CtPfqlcy.js:
  (*! Bundled license information:
  
  lodash/lodash.js:
    (**
     * @license
     * Lodash <https://lodash.com/>
     * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
     * Released under MIT license <https://lodash.com/license>
     * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
     * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
     *)
  *)
*/
//# sourceMappingURL=chunk-EQC6TVAW.js.map
