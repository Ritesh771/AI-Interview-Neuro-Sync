import {
  j
} from "./chunk-EJYZJ5Y3.js";
import "./chunk-NPBUWTT3.js";
import {
  s
} from "./chunk-XBJC4IFL.js";
import {
  f
} from "./chunk-OC6HSZIE.js";
import {
  Lt,
  Mt,
  T
} from "./chunk-3CQNC6PN.js";
import {
  O,
  QA
} from "./chunk-EQC6TVAW.js";
import "./chunk-IW2W7CGS.js";
import "./chunk-LK32TJAX.js";

// node_modules/@superviz/react-sdk/dist/content-BR3JBVI3-DcusmrRY.js
O();
var r = f(T);
var v = [r.styles, s];
var s2 = class extends r {
  constructor() {
    super(), this.unselectAnnotation = () => {
      this.selectedAnnotation = null;
    }, this.unselectAnnotationEsc = (t) => {
      t && (t == null ? void 0 : t.key) !== "Escape" || (this.selectedAnnotation = null);
    }, this.selectAnnotation = ({ detail: t }) => {
      let { uuid: n } = t;
      if (this.selectedAnnotation === n) {
        this.selectedAnnotation = null;
        return;
      }
      this.selectedAnnotation = n;
    }, this.checkLastAnnotation = (t) => {
      var n, i;
      let o = this.annotations.filter((a) => a.resolved), e = this.annotations.filter((a) => !a.resolved);
      return this.annotationFilter === "All comments" ? t === ((n = o[o.length - 1]) == null ? void 0 : n.uuid) : t === ((i = e[e.length - 1]) == null ? void 0 : i.uuid);
    }, this.annotations = [], this.participantsList = [];
  }
  updated(t) {
    super.updated(t), this.updateComplete.then(() => {
      let n = this.shadowRoot.querySelector(`[uuid='${this.selectedAnnotation}']`);
      if (!n) return;
      let i = this.lastCommentId === this.selectedAnnotation, o = i ? 0 : -150, e = n.getClientRects()[0];
      e && (this.scrollBy(0, e.y + o), i && setTimeout(() => {
        this.scrollBy(0, e.y + o);
      }, 200));
    });
  }
  connectedCallback() {
    super.connectedCallback(), window.document.body.addEventListener("select-annotation", this.selectAnnotation), window.document.body.addEventListener("keyup", this.unselectAnnotationEsc), window.document.body.addEventListener("unselect-annotation", this.unselectAnnotation);
  }
  disconnectedCallback() {
    super.disconnectedCallback(), window.document.body.removeEventListener("select-annotation", this.selectAnnotation), window.document.body.removeEventListener("keyup", this.unselectAnnotationEsc), window.document.body.removeEventListener("unselect-annotation", this.unselectAnnotation);
  }
  render() {
    return Mt` ${j(this.annotations.filter((t) => {
      var n;
      return (n = t.comments) == null ? void 0 : n.length;
    }), (t) => t.uuid, (t) => Mt`
        <superviz-comments-annotation-item
          annotation=${JSON.stringify(t)}
          selected="${this.selectedAnnotation}"
          annotationFilter=${this.annotationFilter}
          uuid=${t.uuid}
          ?resolved=${t.resolved}
          isLastComment=${this.checkLastAnnotation(t.uuid)}
          participantsList=${JSON.stringify(this.participantsList)}
        >
        </superviz-comments-annotation-item>
      `)}`;
  }
};
s2.styles = v, s2.properties = { annotations: { type: Object }, selectedAnnotation: { type: String }, annotationFilter: { type: String }, participantsList: { type: Object } }, s2 = QA([Lt("superviz-comments-content")], s2);
export {
  s2 as CommentsContent
};
//# sourceMappingURL=content-BR3JBVI3-DcusmrRY-CF2AV2CY.js.map
